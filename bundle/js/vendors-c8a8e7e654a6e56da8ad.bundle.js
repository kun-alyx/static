/*! For license information please see vendors-c8a8e7e654a6e56da8ad.bundle.js.LICENSE.txt */
(self.webpackChunkkemono_2_client=self.webpackChunkkemono_2_client||[]).push([[216],{5158:e=>{e.exports=function(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);const t=e<0,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return(t?"-":"")+e+" B";const r=Math.min(Math.floor(Math.log(e)/Math.log(1024)),n.length-1);e=Number(e/Math.pow(1024,r));const i=n[r];return e>=10||e%1==0?`${(t?"-":"")+e.toFixed(0)} ${i}`:`${(t?"-":"")+e.toFixed(1)} ${i}`}},1737:e=>{e.exports=function(e){if("number"!=typeof e||isNaN(e))throw new TypeError("Expected a number, got "+typeof e);var t=e<0,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return(t?"-":"")+e+" B";var r=Math.min(Math.floor(Math.log(e)/Math.log(1024)),n.length-1);e=Number(e/Math.pow(1024,r));var i=n[r];return e>=10||e%1==0?(t?"-":"")+e.toFixed(0)+" "+i:(t?"-":"")+e.toFixed(1)+" "+i}},130:(e,t,n)=>{const r=n(9480),i=n(3195),o=n(9819),a=n(412),s=n(6157),l=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function u(e){switch(e){case"ascii":return r;case"base64":return i;case"hex":return o;case"utf8":case"utf-8":case void 0:return a;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s;default:throw new Error(`Unknown encoding: ${e}`)}}function c(e){return e instanceof Uint8Array}function d(e,t,n){return"string"==typeof e?function(e,t){const n=u(t),r=new Uint8Array(n.byteLength(e));return n.write(r,e,0,r.byteLength),r}(e,t):Array.isArray(e)?function(e){const t=new Uint8Array(e.length);return t.set(e),t}(e):ArrayBuffer.isView(e)?function(e){const t=new Uint8Array(e.byteLength);return t.set(e),t}(e):function(e,t,n){return new Uint8Array(e,t,n)}(e,t,n)}function h(e,t,n,r,i){if(0===e.byteLength)return-1;if("string"==typeof n?(r=n,n=0):void 0===n?n=i?0:e.length-1:n<0&&(n+=e.byteLength),n>=e.byteLength){if(i)return-1;n=e.byteLength-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t)t=d(t,r);else if("number"==typeof t)return t&=255,i?e.indexOf(t,n):e.lastIndexOf(t,n);if(0===t.byteLength)return-1;if(i){let r=-1;for(let i=n;i<e.byteLength;i++)if(e[i]===t[-1===r?0:i-r]){if(-1===r&&(r=i),i-r+1===t.byteLength)return r}else-1!==r&&(i-=i-r),r=-1}else{n+t.byteLength>e.byteLength&&(n=e.byteLength-t.byteLength);for(let r=n;r>=0;r--){let n=!0;for(let i=0;i<t.byteLength;i++)if(e[r+i]!==t[i]){n=!1;break}if(n)return r}}return-1}function p(e,t,n,r){return h(e,t,n,r,!0)}function f(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}e.exports=t={isBuffer:c,isEncoding:function(e){try{return u(e),!0}catch{return!1}},alloc:function(e,n,r){const i=new Uint8Array(e);return void 0!==n&&t.fill(i,n,0,i.byteLength,r),i},allocUnsafe:function(e){return new Uint8Array(e)},allocUnsafeSlow:function(e){return new Uint8Array(e)},byteLength:function(e,t){return u(t).byteLength(e)},compare:function(e,t){if(e===t)return 0;const n=Math.min(e.byteLength,t.byteLength);e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i&&e.getUint32(r,l)===t.getUint32(r,l);r+=4);for(;r<n;r++){const n=e.getUint8(r),i=t.getUint8(r);if(n<i)return-1;if(n>i)return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0},concat:function(e,t){void 0===t&&(t=e.reduce(((e,t)=>e+t.byteLength),0));const n=new Uint8Array(t);let r=0;for(const t of e){if(r+t.byteLength>n.byteLength){const e=t.subarray(0,n.byteLength-r);return n.set(e,r),n}n.set(t,r),r+=t.byteLength}return n},copy:function(e,t,n=0,r=0,i=e.byteLength){if(i>0&&i<r)return 0;if(i===r)return 0;if(0===e.byteLength||0===t.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=e.byteLength)throw new RangeError("sourceStart is out of range");if(i<0)throw new RangeError("sourceEnd is out of range");n>=t.byteLength&&(n=t.byteLength),i>e.byteLength&&(i=e.byteLength),t.byteLength-n<i-r&&(i=t.length-n+r);const o=i-r;return e===t?t.copyWithin(n,r,i):t.set(e.subarray(r,i),n),o},equals:function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const n=e.byteLength;e=new DataView(e.buffer,e.byteOffset,e.byteLength),t=new DataView(t.buffer,t.byteOffset,t.byteLength);let r=0;for(let i=n-n%4;r<i;r+=4)if(e.getUint32(r,l)!==t.getUint32(r,l))return!1;for(;r<n;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0},fill:function(e,t,n,r,i){if("string"==typeof t?"string"==typeof n?(i=n,n=0,r=e.byteLength):"string"==typeof r&&(i=r,r=e.byteLength):"number"==typeof t?t&=255:"boolean"==typeof t&&(t=+t),n<0||e.byteLength<n||e.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=e.byteLength),r<=n)return e;if(t||(t=0),"number"==typeof t)for(let i=n;i<r;++i)e[i]=t;else{const o=(t=c(t)?t:d(t,i)).byteLength;for(let i=0;i<r-n;++i)e[i+n]=t[i%o]}return e},from:d,includes:function(e,t,n,r){return-1!==p(e,t,n,r)},indexOf:p,lastIndexOf:function(e,t,n,r){return h(e,t,n,r,!1)},swap16:function(e){const t=e.byteLength;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<t;n+=2)f(e,n,n+1);return e},swap32:function(e){const t=e.byteLength;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<t;n+=4)f(e,n,n+3),f(e,n+1,n+2);return e},swap64:function(e){const t=e.byteLength;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<t;n+=8)f(e,n,n+7),f(e,n+1,n+6),f(e,n+2,n+5),f(e,n+3,n+4);return e},toBuffer:function(e){return e},toString:function(e,t,n=0,r=e.byteLength){const i=e.byteLength;return n>=i||r<=n?"":(n<0&&(n=0),r>i&&(r=i),(0!==n||r<i)&&(e=e.subarray(n,r)),u(t).toString(e))},write:function(e,t,n,r,i){return void 0===n?i="utf8":void 0===r&&"string"==typeof n?(i=n,n=void 0):void 0===i&&"string"==typeof r&&(i=r,r=void 0),u(i).write(e,t,n,r)},writeDoubleLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(n,t,!0),n+8},writeFloatLE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(n,t,!0),n+4},writeUInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint32(n,t,!0),n+4},writeInt32LE:function(e,t,n){return void 0===n&&(n=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(n,t,!0),n+4},readDoubleLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},readFloatLE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},readUInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(t,!0)},readInt32LE:function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t,!0)}}},9480:e=>{function t(e){return e.length}e.exports={byteLength:t,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},write:function(e,n,r=0,i=t(n)){const o=Math.min(i,e.byteLength-r);for(let t=0;t<o;t++)e[r+t]=n.charCodeAt(t);return o}}},3195:e=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256);for(let e=0;e<64;e++)n[t.charCodeAt(e)]=e;function r(e){let t=e.length;return 61===e.charCodeAt(t-1)&&t--,t>1&&61===e.charCodeAt(t-1)&&t--,3*t>>>2}n[45]=62,n[95]=63,e.exports={byteLength:r,toString:function(e){const n=e.byteLength;let r="";for(let i=0;i<n;i+=3)r+=t[e[i]>>2]+t[(3&e[i])<<4|e[i+1]>>4]+t[(15&e[i+1])<<2|e[i+2]>>6]+t[63&e[i+2]];return n%3==2?r=r.substring(0,r.length-1)+"=":n%3==1&&(r=r.substring(0,r.length-2)+"=="),r},write:function(e,t,i=0,o=r(t)){const a=Math.min(o,e.byteLength-i);for(let r=0,i=0;i<a;r+=4){const o=n[t.charCodeAt(r)],a=n[t.charCodeAt(r+1)],s=n[t.charCodeAt(r+2)],l=n[t.charCodeAt(r+3)];e[i++]=o<<2|a>>4,e[i++]=(15&a)<<4|s>>2,e[i++]=(3&s)<<6|63&l}return a}}},9819:e=>{function t(e){return e.length>>>1}function n(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-65+10:e>=97&&e<=102?e-97+10:void 0}e.exports={byteLength:t,toString:function(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",r=0;for(let i=t-t%4;r<i;r+=4)n+=e.getUint32(r).toString(16).padStart(8,"0");for(;r<t;r++)n+=e.getUint8(r).toString(16).padStart(2,"0");return n},write:function(e,r,i=0,o=t(r)){const a=Math.min(o,e.byteLength-i);for(let t=0;t<a;t++){const o=n(r.charCodeAt(2*t)),a=n(r.charCodeAt(2*t+1));if(void 0===o||void 0===a)return e.subarray(0,t);e[i+t]=o<<4|a}return a}}},6157:e=>{function t(e){return 2*e.length}e.exports={byteLength:t,toString:function(e){const t=e.byteLength;let n="";for(let r=0;r<t-1;r+=2)n+=String.fromCharCode(e[r]+256*e[r+1]);return n},write:function(e,n,r=0,i=t(n)){const o=Math.min(i,e.byteLength-r);let a=o;for(let t=0;t<n.length&&!((a-=2)<0);++t){const i=n.charCodeAt(t),o=i>>8,a=i%256;e[r+2*t]=a,e[r+2*t+1]=o}return o}}},412:e=>{function t(e){let t=0;for(let n=0,r=e.length;n<r;n++){const i=e.charCodeAt(n);if(i>=55296&&i<=56319&&n+1<r){const r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){t+=4,n++;continue}}t+=i<=127?1:i<=2047?2:3}return t}let n,r;if("undefined"!=typeof TextDecoder){const e=new TextDecoder;n=function(t){return e.decode(t)}}else n=function(e){const t=e.byteLength;let n="",r=0;for(;r<t;){let i=e[r];if(i<=127){n+=String.fromCharCode(i),r++;continue}let o=0,a=0;if(i<=223?(o=1,a=31&i):i<=239?(o=2,a=15&i):i<=244&&(o=3,a=7&i),t-r-o>0){let t=0;for(;t<o;)i=e[r+t+1],a=a<<6|63&i,t+=1}else a=65533,o=t-r;n+=String.fromCodePoint(a),r+=o+1}return n};if("undefined"!=typeof TextEncoder){const e=new TextEncoder;r=function(n,r,i=0,o=t(r)){const a=Math.min(o,n.byteLength-i);return e.encodeInto(r,n.subarray(i,i+a)),a}}else r=function(e,n,r=0,i=t(n)){const o=Math.min(i,e.byteLength-r);e=e.subarray(r,r+o);let a=0,s=0;for(;a<n.length;){const t=n.codePointAt(a);if(t<=127){e[s++]=t,a++;continue}let r=0,i=0;for(t<=2047?(r=6,i=192):t<=65535?(r=12,i=224):t<=2097151&&(r=18,i=240),e[s++]=i|t>>r,r-=6;r>=0;)e[s++]=128|t>>r&63,r-=6;a+=t>=65536?2:1}return o};e.exports={byteLength:t,toString:n,write:r}},4184:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var a=i.apply(null,n);a&&e.push(a)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},2989:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(3645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,".uppy-Root{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;color:#333;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;line-height:1;position:relative;text-align:left}.uppy-Root[dir=rtl],[dir=rtl] .uppy-Root{text-align:right}.uppy-Root *,.uppy-Root :after,.uppy-Root :before{box-sizing:inherit}.uppy-Root [hidden]{display:none}.uppy-u-reset{all:initial;-webkit-appearance:none;appearance:none;box-sizing:border-box;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;line-height:1}[dir=rtl] .uppy-u-reset{text-align:right}.uppy-c-textInput{background-color:#fff;border:1px solid #ddd;border-radius:4px;font-family:inherit;font-size:14px;line-height:1.5;padding:6px 8px}.uppy-size--md .uppy-c-textInput{padding:8px 10px}.uppy-c-textInput:focus{border-color:#2275d799;box-shadow:0 0 0 3px #2275d726;outline:none}[data-uppy-theme=dark] .uppy-c-textInput{background-color:#333;border-color:#333;color:#eaeaea}[data-uppy-theme=dark] .uppy-c-textInput:focus{border-color:#525252;box-shadow:none}.uppy-c-icon{fill:currentColor;display:inline-block;max-height:100%;max-width:100%;overflow:hidden}.uppy-c-btn{align-items:center;color:inherit;display:inline-flex;font-family:inherit;font-size:inherit;font-weight:500;justify-content:center;line-height:1;transition-duration:.3s;transition-property:background-color,color;-webkit-user-select:none;user-select:none;white-space:nowrap}.uppy-c-btn,[dir=rtl] .uppy-c-btn{text-align:center}.uppy-c-btn:not(:disabled):not(.disabled){cursor:pointer}.uppy-c-btn::-moz-focus-inner{border:0}.uppy-c-btn-primary{background-color:#2275d7;border-radius:4px;color:#fff;font-size:14px;padding:10px 18px}.uppy-c-btn-primary:hover{background-color:#1b5dab}.uppy-c-btn-primary:focus{box-shadow:0 0 0 3px #2275d766;outline:none}.uppy-size--md .uppy-c-btn-primary{padding:13px 22px}[data-uppy-theme=dark] .uppy-c-btn-primary{color:#eaeaea}[data-uppy-theme=dark] .uppy-c-btn-primary:focus{outline:none}[data-uppy-theme=dark] .uppy-c-btn-primary::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-c-btn-primary:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-c-btn-link{background-color:initial;border-radius:4px;color:#525252;font-size:14px;line-height:1;padding:10px 15px}.uppy-c-btn-link:hover{color:#333}.uppy-c-btn-link:focus{box-shadow:0 0 0 3px #2275d740;outline:none}.uppy-size--md .uppy-c-btn-link{padding:13px 18px}[data-uppy-theme=dark] .uppy-c-btn-link{color:#eaeaea}[data-uppy-theme=dark] .uppy-c-btn-link:focus{outline:none}[data-uppy-theme=dark] .uppy-c-btn-link::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-c-btn-link:focus{box-shadow:0 0 0 2px #aae1ffd9}[data-uppy-theme=dark] .uppy-c-btn-link:hover{color:#939393}",""]);const o=i},5384:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(3645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,"@charset \"UTF-8\";.uppy-Informer{bottom:60px;left:0;position:absolute;right:0;text-align:center;z-index:1005}.uppy-Informer span>div{margin-bottom:6px}.uppy-Informer-animated{opacity:0;transform:translateY(350%);transition:all .3s ease-in;z-index:-1000}.uppy-Informer p{background-color:#757575;border-radius:18px;color:#fff;display:inline-block;font-size:12px;font-weight:400;line-height:1.4;margin:0;max-width:90%;padding:6px 15px}.uppy-size--md .uppy-Informer p{font-size:14px;line-height:1.3;max-width:500px;padding:10px 20px}[data-uppy-theme=dark] .uppy-Informer p{background-color:#333}[dir=ltr] .uppy-Informer p span{left:3px}[dir=rtl] .uppy-Informer p span{right:3px}[dir=ltr] .uppy-Informer p span{margin-left:-1px}[dir=rtl] .uppy-Informer p span{margin-right:-1px}.uppy-Informer p span{background-color:#fff;border-radius:50%;color:#525252;display:inline-block;font-size:10px;height:13px;line-height:12px;position:relative;top:-1px;vertical-align:middle;width:13px}.uppy-Informer p span:hover{cursor:help}.uppy-Informer p span:after{word-wrap:break-word;line-height:1.3}.uppy-Root [aria-label][role~=tooltip]{position:relative}.uppy-Root [aria-label][role~=tooltip]:after,.uppy-Root [aria-label][role~=tooltip]:before{-webkit-backface-visibility:hidden;backface-visibility:hidden;box-sizing:border-box;opacity:0;pointer-events:none;position:absolute;transform:translateZ(0);transform-origin:top;transition:all var(--microtip-transition-duration,.18s) var(--microtip-transition-easing,ease-in-out) var(--microtip-transition-delay,0s);will-change:transform;z-index:10}.uppy-Root [aria-label][role~=tooltip]:before{background-size:100% auto!important;content:\"\"}.uppy-Root [aria-label][role~=tooltip]:after{background:#111111e6;border-radius:4px;box-sizing:initial;color:#fff;content:attr(aria-label);font-size:var(--microtip-font-size,13px);font-weight:var(--microtip-font-weight,normal);padding:.5em 1em;text-transform:var(--microtip-text-transform,none);white-space:nowrap}.uppy-Root [aria-label][role~=tooltip]:focus:after,.uppy-Root [aria-label][role~=tooltip]:focus:before,.uppy-Root [aria-label][role~=tooltip]:hover:after,.uppy-Root [aria-label][role~=tooltip]:hover:before{opacity:1;pointer-events:auto}.uppy-Root [role~=tooltip][data-microtip-position|=top]:before{background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='12'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M2.658 0h32.004c-6 0-11.627 12.002-16.002 12.002C14.285 12.002 8.594 0 2.658 0Z'/%3E%3C/svg%3E\") no-repeat;bottom:100%;height:6px;left:50%;margin-bottom:5px;transform:translate3d(-50%,0,0);width:18px}.uppy-Root [role~=tooltip][data-microtip-position|=top]:after{bottom:100%;left:50%;margin-bottom:11px;transform:translate3d(-50%,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=top]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position|=top]:hover:before{transform:translate3d(-50%,-5px,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-left]:after{bottom:100%;transform:translate3d(calc(-100% + 16px),0,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-left]:hover:after{transform:translate3d(calc(-100% + 16px),-5px,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-right]:after{bottom:100%;transform:translate3d(-16px,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-right]:hover:after{transform:translate3d(-16px,-5px,0)}.uppy-Root [role~=tooltip][data-microtip-position|=bottom]:before{background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='12'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M33.342 12H1.338c6 0 11.627-12.002 16.002-12.002C21.715-.002 27.406 12 33.342 12Z'/%3E%3C/svg%3E\") no-repeat;bottom:auto;height:6px;left:50%;margin-bottom:0;margin-top:5px;top:100%;transform:translate3d(-50%,-10px,0);width:18px}.uppy-Root [role~=tooltip][data-microtip-position|=bottom]:after{left:50%;margin-top:11px;top:100%;transform:translate3d(-50%,-10px,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position|=bottom]:hover:before{transform:translate3d(-50%,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-left]:after{top:100%;transform:translate3d(calc(-100% + 16px),-10px,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-left]:hover:after{transform:translate3d(calc(-100% + 16px),0,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-right]:after{top:100%;transform:translate3d(-16px,-10px,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-right]:hover:after{transform:translate3d(-16px,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=left]:after,.uppy-Root [role~=tooltip][data-microtip-position=left]:before{bottom:auto;left:auto;right:100%;top:50%;transform:translate3d(10px,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-position=left]:before{background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='36'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M0 33.342V1.338c0 6 12.002 11.627 12.002 16.002C12.002 21.715 0 27.406 0 33.342Z'/%3E%3C/svg%3E\") no-repeat;height:18px;margin-bottom:0;margin-right:5px;width:6px}.uppy-Root [role~=tooltip][data-microtip-position=left]:after{margin-right:11px}.uppy-Root [role~=tooltip][data-microtip-position=left]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position=left]:hover:before{transform:translate3d(0,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-position=right]:after,.uppy-Root [role~=tooltip][data-microtip-position=right]:before{bottom:auto;left:100%;top:50%;transform:translate3d(-10px,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-position=right]:before{background:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='36'%3E%3Cpath fill='rgba(17, 17, 17, 0.9)' d='M12 2.658v32.004c0-6-12.002-11.627-12.002-16.002C-.002 14.285 12 8.594 12 2.658Z'/%3E%3C/svg%3E\") no-repeat;height:18px;margin-bottom:0;margin-left:5px;width:6px}.uppy-Root [role~=tooltip][data-microtip-position=right]:after{margin-left:11px}.uppy-Root [role~=tooltip][data-microtip-position=right]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position=right]:hover:before{transform:translate3d(0,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-size=small]:after{white-space:normal;width:80px}.uppy-Root [role~=tooltip][data-microtip-size=medium]:after{white-space:normal;width:150px}.uppy-Root [role~=tooltip][data-microtip-size=large]:after{white-space:normal;width:260px}.uppy-StatusBar{background-color:#fff;color:#fff;display:flex;font-size:12px;font-weight:400;height:46px;line-height:40px;position:relative;transition:height .2s;z-index:1001}[data-uppy-theme=dark] .uppy-StatusBar{background-color:#1f1f1f}.uppy-StatusBar:before{background-color:#eaeaea;bottom:0;content:\"\";height:2px;left:0;position:absolute;right:0;top:0;width:100%}[data-uppy-theme=dark] .uppy-StatusBar:before{background-color:#757575}.uppy-StatusBar[aria-hidden=true]{height:0;overflow-y:hidden}.uppy-StatusBar.is-complete .uppy-StatusBar-progress{background-color:#1bb240}.uppy-StatusBar.is-error .uppy-StatusBar-progress{background-color:#e32437}.uppy-StatusBar.is-complete .uppy-StatusBar-statusIndicator{color:#1bb240}.uppy-StatusBar.is-error .uppy-StatusBar-statusIndicator{color:#e32437}.uppy-StatusBar:not([aria-hidden=true]).is-waiting{background-color:#fff;border-top:1px solid #eaeaea;height:65px}[data-uppy-theme=dark] .uppy-StatusBar:not([aria-hidden=true]).is-waiting{background-color:#1f1f1f;border-top:1px solid #333}.uppy-StatusBar-progress{background-color:#2275d7;height:2px;position:absolute;transition:background-color,width .3s ease-out;z-index:1001}.uppy-StatusBar-progress.is-indeterminate{animation:uppy-StatusBar-ProgressStripes 1s linear infinite;background-image:linear-gradient(45deg,#0000004d 25%,#0000 0,#0000 50%,#0000004d 0,#0000004d 75%,#0000 0,#0000);background-size:64px 64px}@keyframes uppy-StatusBar-ProgressStripes{0%{background-position:0 0}to{background-position:64px 0}}.uppy-StatusBar.is-postprocessing .uppy-StatusBar-progress,.uppy-StatusBar.is-preprocessing .uppy-StatusBar-progress{background-color:#f6a623}.uppy-StatusBar.is-waiting .uppy-StatusBar-progress{display:none}[dir=ltr] .uppy-StatusBar-content{padding-left:10px}[dir=rtl] .uppy-StatusBar-content{padding-right:10px}.uppy-StatusBar-content{align-items:center;color:#333;display:flex;height:100%;position:relative;text-overflow:ellipsis;white-space:nowrap;z-index:1002}[dir=ltr] .uppy-size--md .uppy-StatusBar-content{padding-left:15px}[dir=rtl] .uppy-size--md .uppy-StatusBar-content{padding-right:15px}[data-uppy-theme=dark] .uppy-StatusBar-content{color:#eaeaea}[dir=ltr] .uppy-StatusBar-status{padding-right:.3em}[dir=rtl] .uppy-StatusBar-status{padding-left:.3em}.uppy-StatusBar-status{display:flex;flex-direction:column;font-weight:400;justify-content:center;line-height:1.4}.uppy-StatusBar-statusPrimary{display:flex;font-weight:500;line-height:1}.uppy-StatusBar-statusPrimary button.uppy-StatusBar-details{margin-left:5px}[data-uppy-theme=dark] .uppy-StatusBar-statusPrimary{color:#eaeaea}.uppy-StatusBar-statusSecondary{color:#757575;display:inline-block;font-size:11px;line-height:1.2;margin-top:1px;white-space:nowrap}[data-uppy-theme=dark] .uppy-StatusBar-statusSecondary{color:#bbb}[dir=ltr] .uppy-StatusBar-statusSecondaryHint{margin-right:5px}[dir=rtl] .uppy-StatusBar-statusSecondaryHint{margin-left:5px}.uppy-StatusBar-statusSecondaryHint{display:inline-block;line-height:1;vertical-align:middle}[dir=ltr] .uppy-size--md .uppy-StatusBar-statusSecondaryHint{margin-right:8px}[dir=rtl] .uppy-size--md .uppy-StatusBar-statusSecondaryHint{margin-left:8px}[dir=ltr] .uppy-StatusBar-statusIndicator{margin-right:7px}[dir=rtl] .uppy-StatusBar-statusIndicator{margin-left:7px}.uppy-StatusBar-statusIndicator{color:#525252;position:relative;top:1px}.uppy-StatusBar-statusIndicator svg{vertical-align:text-bottom}[dir=ltr] .uppy-StatusBar-actions{right:10px}[dir=rtl] .uppy-StatusBar-actions{left:10px}.uppy-StatusBar-actions{align-items:center;bottom:0;display:flex;position:absolute;top:0;z-index:1004}.uppy-StatusBar.is-waiting .uppy-StatusBar-actions{background-color:#fafafa;height:100%;padding:0 15px;position:static;width:100%}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actions{background-color:#1f1f1f}.uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts{flex-direction:column;height:90px}.uppy-size--md .uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts{flex-direction:row;height:65px}.uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts .uppy-StatusBar-actions{flex-direction:column;justify-content:center}.uppy-size--md .uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts .uppy-StatusBar-actions{flex-direction:row;justify-content:normal}.uppy-StatusBar-actionCircleBtn{cursor:pointer;line-height:1;margin:3px;opacity:.9}.uppy-StatusBar-actionCircleBtn:focus{outline:none}.uppy-StatusBar-actionCircleBtn::-moz-focus-inner{border:0}.uppy-StatusBar-actionCircleBtn:focus{box-shadow:0 0 0 3px #2275d780}[data-uppy-theme=dark] .uppy-StatusBar-actionCircleBtn:focus{outline:none}[data-uppy-theme=dark] .uppy-StatusBar-actionCircleBtn::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-StatusBar-actionCircleBtn:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-StatusBar-actionCircleBtn:hover{opacity:1}.uppy-StatusBar-actionCircleBtn:focus{border-radius:50%}.uppy-StatusBar-actionCircleBtn svg{vertical-align:bottom}.uppy-StatusBar-actionBtn{color:#2275d7;display:inline-block;font-size:10px;line-height:inherit;vertical-align:middle}.uppy-size--md .uppy-StatusBar-actionBtn{font-size:11px}.uppy-StatusBar-actionBtn--disabled{opacity:.4}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--disabled{opacity:.7}[dir=ltr] .uppy-StatusBar-actionBtn--retry{margin-right:6px}[dir=rtl] .uppy-StatusBar-actionBtn--retry{margin-left:6px}.uppy-StatusBar-actionBtn--retry{background-color:#ff4b23;border-radius:8px;color:#fff;height:16px;line-height:1;padding:1px 6px 3px 18px;position:relative}.uppy-StatusBar-actionBtn--retry:focus{outline:none}.uppy-StatusBar-actionBtn--retry::-moz-focus-inner{border:0}.uppy-StatusBar-actionBtn--retry:focus{box-shadow:0 0 0 3px #2275d780}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--retry:focus{outline:none}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--retry::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--retry:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-StatusBar-actionBtn--retry:hover{background-color:#f92d00}[dir=ltr] .uppy-StatusBar-actionBtn--retry svg{left:6px}[dir=rtl] .uppy-StatusBar-actionBtn--retry svg{right:6px}.uppy-StatusBar-actionBtn--retry svg{position:absolute;top:3px}.uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload{background-color:#1bb240;color:#fff;font-size:14px;line-height:1;padding:15px 10px;width:100%}.uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload:hover{background-color:#189c38}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload{background-color:#1c8b37}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload:hover{background-color:#18762f}.uppy-size--md .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload{padding:13px 22px;width:auto}.uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload.uppy-StatusBar-actionBtn--disabled:hover{background-color:#1bb240;cursor:not-allowed}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload.uppy-StatusBar-actionBtn--disabled:hover{background-color:#1c8b37}.uppy-StatusBar:not(.is-waiting) .uppy-StatusBar-actionBtn--upload{background-color:initial;color:#2275d7}[dir=ltr] .uppy-StatusBar-actionBtn--uploadNewlyAdded{padding-right:3px}[dir=ltr] .uppy-StatusBar-actionBtn--uploadNewlyAdded,[dir=rtl] .uppy-StatusBar-actionBtn--uploadNewlyAdded{padding-left:3px}[dir=rtl] .uppy-StatusBar-actionBtn--uploadNewlyAdded{padding-right:3px}.uppy-StatusBar-actionBtn--uploadNewlyAdded{border-radius:3px;padding-bottom:1px}.uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{outline:none}.uppy-StatusBar-actionBtn--uploadNewlyAdded::-moz-focus-inner{border:0}.uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{box-shadow:0 0 0 3px #2275d780}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{outline:none}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--uploadNewlyAdded::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-StatusBar.is-postprocessing .uppy-StatusBar-actionBtn--uploadNewlyAdded,.uppy-StatusBar.is-preprocessing .uppy-StatusBar-actionBtn--uploadNewlyAdded{display:none}.uppy-StatusBar-actionBtn--done{border-radius:3px;line-height:1;padding:7px 8px}.uppy-StatusBar-actionBtn--done:focus{outline:none}.uppy-StatusBar-actionBtn--done::-moz-focus-inner{border:0}.uppy-StatusBar-actionBtn--done:hover{color:#1b5dab}.uppy-StatusBar-actionBtn--done:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--done:focus{background-color:#333}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--done{color:#02baf2}.uppy-size--md .uppy-StatusBar-actionBtn--done{font-size:14px}.uppy-StatusBar-serviceMsg{color:#000;font-size:11px;line-height:1.1;padding-left:10px}.uppy-size--md .uppy-StatusBar-serviceMsg{font-size:14px;padding-left:15px}[data-uppy-theme=dark] .uppy-StatusBar-serviceMsg{color:#eaeaea}.uppy-StatusBar-serviceMsg-ghostsIcon{left:6px;opacity:.5;position:relative;top:2px;vertical-align:text-bottom;width:10px}.uppy-size--md .uppy-StatusBar-serviceMsg-ghostsIcon{left:10px;top:1px;width:15px}[dir=ltr] .uppy-StatusBar-details{left:2px}[dir=rtl] .uppy-StatusBar-details{right:2px}.uppy-StatusBar-details{-webkit-appearance:none;appearance:none;background-color:#939393;border-radius:50%;color:#fff;cursor:help;display:inline-block;font-size:10px;font-weight:600;height:13px;line-height:12px;position:relative;text-align:center;top:0;vertical-align:middle;width:13px}.uppy-StatusBar-details:after{word-wrap:break-word;line-height:1.3}[dir=ltr] .uppy-StatusBar-spinner{margin-right:10px}[dir=rtl] .uppy-StatusBar-spinner{margin-left:10px}.uppy-StatusBar-spinner{fill:#2275d7;animation-duration:1s;animation-iteration-count:infinite;animation-name:uppy-StatusBar-spinnerAnimation;animation-timing-function:linear}.uppy-StatusBar.is-postprocessing .uppy-StatusBar-spinner,.uppy-StatusBar.is-preprocessing .uppy-StatusBar-spinner{fill:#f6a623}@keyframes uppy-StatusBar-spinnerAnimation{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.uppy-ProviderBrowser-viewType--grid ul.uppy-ProviderBrowser-list,.uppy-ProviderBrowser-viewType--unsplash ul.uppy-ProviderBrowser-list{align-items:flex-start;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;padding:6px}.uppy-ProviderBrowser-viewType--grid ul.uppy-ProviderBrowser-list:after,.uppy-ProviderBrowser-viewType--unsplash ul.uppy-ProviderBrowser-list:after{content:\"\";flex:auto}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem{margin:0;position:relative;width:50%}.uppy-size--md .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem,.uppy-size--md .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem{width:33.3333%}.uppy-size--lg .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem,.uppy-size--lg .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem{width:25%}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem:before,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem:before{content:\"\";display:block;padding-top:100%}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--selected img,.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--selected svg,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--selected img,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--selected svg{opacity:.85}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--disabled,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--disabled{opacity:.5}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner{background-color:#93939333}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner,[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner{background-color:#eaeaea33}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview svg,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview svg{fill:#000000b3;height:30%;width:30%}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview svg,[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview svg{fill:#fffc}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner{border-radius:4px;bottom:7px;height:calc(100% - 14px);left:7px;overflow:hidden;position:absolute;right:7px;text-align:center;top:7px;width:calc(100% - 14px)}@media (hover:none){.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner .uppy-ProviderBrowserItem-author{display:block}}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner,[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner{box-shadow:0 0 0 3px #aae1ffb3}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner img,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner img{border-radius:4px;height:100%;object-fit:cover;width:100%}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-author{background:#0000004d;bottom:0;color:#fff;display:none;font-size:12px;font-weight:500;left:0;margin:0;padding:5px;position:absolute;text-decoration:none;width:100%}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-author:hover,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-author:hover{background:#0006;text-decoration:underline}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox{background-color:#2275d7;border-radius:50%;height:26px;opacity:0;position:absolute;right:16px;top:16px;width:26px;z-index:1002}[dir=ltr] .uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox:after,[dir=ltr] .uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox:after{left:7px}[dir=rtl] .uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox:after,[dir=rtl] .uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox:after{right:7px}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox:after,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox:after{height:7px;top:8px;width:12px}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--is-checked,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--is-checked{opacity:1}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:hover+label .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:hover+label .uppy-ProviderBrowserItem-author{display:block}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label{box-shadow:0 0 0 3px #2275d780}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label:focus,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label:focus{outline:none}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label::-moz-focus-inner,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label::-moz-focus-inner{border:0}.uppy-ProviderBrowser-viewType--list{background-color:#fff}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--list{background-color:#1f1f1f}.uppy-ProviderBrowser-viewType--list li.uppy-ProviderBrowserItem{align-items:center;display:flex;margin:0;padding:7px 15px}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--list li.uppy-ProviderBrowserItem{color:#eaeaea}.uppy-ProviderBrowser-viewType--list li.uppy-ProviderBrowserItem--disabled{opacity:.6}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox{margin-right:15px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox{margin-left:15px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox{background-color:#fff;border:1px solid #cfcfcf;border-radius:3px;height:17px;width:17px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:focus{border:1px solid #2275d7;box-shadow:0 0 0 3px #2275d740;outline:none}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:after{left:3px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:after{right:3px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:after{height:5px;opacity:0;top:4px;width:9px}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:focus{border-color:#02baf2b3;box-shadow:0 0 0 3px #02baf233}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox--is-checked{background-color:#2275d7;border-color:#2275d7}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox--is-checked:after{opacity:1}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner{align-items:center;display:flex;overflow:hidden;padding:2px;text-overflow:ellipsis;white-space:nowrap}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner:focus{outline:none;text-decoration:underline}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner img,[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner svg{margin-right:8px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner img,[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner svg{margin-left:8px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner span{line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem--disabled .uppy-ProviderBrowserItem-inner{cursor:default}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-iconWrap{margin-right:7px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-iconWrap{margin-left:7px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-iconWrap{width:20px}.uppy-ProviderBrowserItem-checkbox{cursor:pointer;flex-shrink:0;position:relative}.uppy-ProviderBrowserItem-checkbox:disabled{cursor:default}.uppy-ProviderBrowserItem-checkbox:after{border-bottom:2px solid #eaeaea;border-left:2px solid #eaeaea;content:\"\";cursor:pointer;position:absolute;transform:rotate(-45deg)}.uppy-ProviderBrowserItem-checkbox:disabled:after{cursor:default}[data-uppy-theme=dark] .uppy-ProviderBrowserItem-checkbox{background-color:#1f1f1f;border-color:#939393}[data-uppy-theme=dark] .uppy-ProviderBrowserItem-checkbox--is-checked{background-color:#333}.uppy-SearchProvider{align-items:center;display:flex;flex:1;flex-direction:column;height:100%;justify-content:center;width:100%}[data-uppy-theme=dark] .uppy-SearchProvider{background-color:#1f1f1f}.uppy-SearchProvider-input{margin-bottom:15px;max-width:650px;width:90%}.uppy-size--md .uppy-SearchProvider-input{margin-bottom:20px}.uppy-SearchProvider-input::-webkit-search-cancel-button{display:none}.uppy-SearchProvider-searchButton{padding:13px 25px}.uppy-size--md .uppy-SearchProvider-searchButton{padding:13px 30px}.uppy-DashboardContent-panelBody{align-items:center;display:flex;flex:1;justify-content:center}[data-uppy-theme=dark] .uppy-DashboardContent-panelBody{background-color:#1f1f1f}.uppy-Provider-auth,.uppy-Provider-empty,.uppy-Provider-error,.uppy-Provider-loading{align-items:center;color:#939393;display:flex;flex:1;flex-flow:column wrap;justify-content:center}.uppy-Provider-empty{color:#939393}.uppy-Provider-authIcon svg{height:75px;width:100px}.uppy-Provider-authTitle{color:#757575;font-size:17px;font-weight:400;line-height:1.4;margin-bottom:30px;max-width:500px;padding:0 15px;text-align:center}.uppy-size--md .uppy-Provider-authTitle{font-size:20px}[data-uppy-theme=dark] .uppy-Provider-authTitle{color:#cfcfcf}.uppy-Provider-btn-google{align-items:center;background:#4285f4;display:flex;padding:8px 12px!important}.uppy-Provider-btn-google:hover{background-color:#1266f1}.uppy-Provider-btn-google:focus{box-shadow:0 0 0 3px #4285f466;outline:none}.uppy-Provider-btn-google svg{margin-right:8px}[dir=ltr] .uppy-Provider-breadcrumbs{text-align:left}[dir=rtl] .uppy-Provider-breadcrumbs{text-align:right}.uppy-Provider-breadcrumbs{color:#525252;flex:1;font-size:12px;margin-bottom:10px}.uppy-size--md .uppy-Provider-breadcrumbs{margin-bottom:0}[data-uppy-theme=dark] .uppy-Provider-breadcrumbs{color:#eaeaea}[dir=ltr] .uppy-Provider-breadcrumbsIcon{margin-right:4px}[dir=rtl] .uppy-Provider-breadcrumbsIcon{margin-left:4px}.uppy-Provider-breadcrumbsIcon{color:#525252;display:inline-block;line-height:1;vertical-align:middle}.uppy-Provider-breadcrumbsIcon svg{fill:#525252;height:13px;width:13px}.uppy-Provider-breadcrumbs button{border-radius:3px;display:inline-block;line-height:inherit;padding:4px}.uppy-Provider-breadcrumbs button:focus{outline:none}.uppy-Provider-breadcrumbs button::-moz-focus-inner{border:0}.uppy-Provider-breadcrumbs button:hover{color:#1b5dab}.uppy-Provider-breadcrumbs button:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-Provider-breadcrumbs button:focus{background-color:#333}.uppy-Provider-breadcrumbs button:not(:last-of-type){text-decoration:underline}.uppy-Provider-breadcrumbs button:last-of-type{color:#333;cursor:normal;font-weight:500;pointer-events:none}.uppy-Provider-breadcrumbs button:hover{cursor:pointer}[data-uppy-theme=dark] .uppy-Provider-breadcrumbs button{color:#eaeaea}.uppy-ProviderBrowser{display:flex;flex:1;flex-direction:column;font-size:14px;font-weight:400;height:100%}.uppy-ProviderBrowser-user{color:#333;font-weight:500;margin:0 8px 0 0}[data-uppy-theme=dark] .uppy-ProviderBrowser-user{color:#eaeaea}[dir=ltr] .uppy-ProviderBrowser-user:after{left:4px}[dir=rtl] .uppy-ProviderBrowser-user:after{right:4px}.uppy-ProviderBrowser-user:after{color:#939393;content:\"Â·\";font-weight:400;position:relative}.uppy-ProviderBrowser-header{border-bottom:1px solid #eaeaea;position:relative;z-index:1001}[data-uppy-theme=dark] .uppy-ProviderBrowser-header{border-bottom:1px solid #333}.uppy-ProviderBrowser-headerBar{background-color:#fafafa;color:#757575;font-size:12px;line-height:1.4;padding:7px 15px;z-index:1001}.uppy-size--md .uppy-ProviderBrowser-headerBar{align-items:center;display:flex}[data-uppy-theme=dark] .uppy-ProviderBrowser-headerBar{background-color:#1f1f1f}.uppy-ProviderBrowser-headerBar--simple{display:block;justify-content:center;text-align:center}.uppy-ProviderBrowser-headerBar--simple .uppy-Provider-breadcrumbsWrap{display:inline-block;flex:none;vertical-align:middle}.uppy-ProviderBrowser-searchFilter{align-items:center;display:flex;height:30px;margin-bottom:15px;margin-top:15px;padding-left:8px;padding-right:8px;position:relative;width:100%}[dir=ltr] .uppy-ProviderBrowser-searchFilterInput{padding-left:30px}[dir=ltr] .uppy-ProviderBrowser-searchFilterInput,[dir=rtl] .uppy-ProviderBrowser-searchFilterInput{padding-right:30px}[dir=rtl] .uppy-ProviderBrowser-searchFilterInput{padding-left:30px}.uppy-ProviderBrowser-searchFilterInput{background-color:#eaeaea;border:0;border-radius:4px;color:#333;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;font-size:13px;height:30px;line-height:1.4;outline:0;width:100%;z-index:1001}.uppy-ProviderBrowser-searchFilterInput::-webkit-search-cancel-button{display:none}[data-uppy-theme=dark] .uppy-ProviderBrowser-searchFilterInput{background-color:#1f1f1f;color:#eaeaea}.uppy-ProviderBrowser-searchFilterInput:focus{background-color:#cfcfcf;border:0}[data-uppy-theme=dark] .uppy-ProviderBrowser-searchFilterInput:focus{background-color:#333}[dir=ltr] .uppy-ProviderBrowser-searchFilterIcon{left:16px}[dir=rtl] .uppy-ProviderBrowser-searchFilterIcon{right:16px}.uppy-ProviderBrowser-searchFilterIcon{color:#757575;height:12px;position:absolute;width:12px;z-index:1002}.uppy-ProviderBrowser-searchFilterInput::placeholder{color:#939393;opacity:1}[dir=ltr] .uppy-ProviderBrowser-searchFilterReset{right:16px}[dir=rtl] .uppy-ProviderBrowser-searchFilterReset{left:16px}.uppy-ProviderBrowser-searchFilterReset{border-radius:3px;color:#939393;cursor:pointer;height:22px;padding:6px;position:absolute;width:22px;z-index:1002}.uppy-ProviderBrowser-searchFilterReset:focus{outline:none}.uppy-ProviderBrowser-searchFilterReset::-moz-focus-inner{border:0}.uppy-ProviderBrowser-searchFilterReset:focus{box-shadow:0 0 0 3px #2275d780}.uppy-ProviderBrowser-searchFilterReset:hover{color:#757575}.uppy-ProviderBrowser-searchFilterReset svg{vertical-align:text-top}.uppy-ProviderBrowser-userLogout{border-radius:3px;color:#2275d7;cursor:pointer;line-height:inherit;padding:4px}.uppy-ProviderBrowser-userLogout:focus{outline:none}.uppy-ProviderBrowser-userLogout::-moz-focus-inner{border:0}.uppy-ProviderBrowser-userLogout:hover{color:#1b5dab}.uppy-ProviderBrowser-userLogout:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-ProviderBrowser-userLogout:focus{background-color:#333}.uppy-ProviderBrowser-userLogout:hover{text-decoration:underline}[data-uppy-theme=dark] .uppy-ProviderBrowser-userLogout{color:#eaeaea}.uppy-ProviderBrowser-body{flex:1;position:relative}.uppy-ProviderBrowser-list{-webkit-overflow-scrolling:touch;background-color:#fff;border-spacing:0;bottom:0;display:block;flex:1;height:100%;left:0;list-style:none;margin:0;overflow-x:hidden;overflow-y:auto;padding:0;position:absolute;right:0;top:0;width:100%}[data-uppy-theme=dark] .uppy-ProviderBrowser-list{background-color:#1f1f1f}.uppy-ProviderBrowser-list:focus{outline:none}.uppy-ProviderBrowserItem-inner{cursor:pointer;font-size:13px;font-weight:500}.uppy-ProviderBrowser-footer{align-items:center;background-color:#fff;border-top:1px solid #eaeaea;display:flex;height:65px;padding:0 15px}[dir=ltr] .uppy-ProviderBrowser-footer button{margin-right:8px}[dir=rtl] .uppy-ProviderBrowser-footer button{margin-left:8px}[data-uppy-theme=dark] .uppy-ProviderBrowser-footer{background-color:#1f1f1f;border-top:1px solid #333}.uppy-Dashboard-Item-previewInnerWrap{align-items:center;border-radius:3px;box-shadow:0 0 2px 0 #0006;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:hidden;position:relative;width:100%}.uppy-size--md .uppy-Dashboard-Item-previewInnerWrap{box-shadow:0 1px 2px #00000026}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-previewInnerWrap{box-shadow:none}.uppy-Dashboard-Item-previewInnerWrap:after{background-color:#000000a6;bottom:0;content:\"\";display:none;left:0;position:absolute;right:0;top:0;z-index:1001}.uppy-Dashboard-Item-previewLink{bottom:0;left:0;position:absolute;right:0;top:0;z-index:1002}.uppy-Dashboard-Item-previewLink:focus{box-shadow:inset 0 0 0 3px #76abe9}[data-uppy-theme=dark] .uppy-Dashboard-Item-previewLink:focus{box-shadow:inset 0 0 0 3px #016c8d}.uppy-Dashboard-Item-preview img.uppy-Dashboard-Item-previewImg{border-radius:3px;height:100%;object-fit:cover;transform:translateZ(0);width:100%}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-preview img.uppy-Dashboard-Item-previewImg{height:auto;max-height:100%;max-width:100%;object-fit:contain;padding:10px;width:auto}.uppy-Dashboard-Item-progress{color:#fff;left:50%;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%);transition:all .35 ease;width:120px;z-index:1002}.uppy-Dashboard-Item-progressIndicator{color:#fff;display:inline-block;height:38px;opacity:.9;width:38px}.uppy-size--md .uppy-Dashboard-Item-progressIndicator{height:55px;width:55px}button.uppy-Dashboard-Item-progressIndicator{cursor:pointer}button.uppy-Dashboard-Item-progressIndicator:focus{outline:none}button.uppy-Dashboard-Item-progressIndicator::-moz-focus-inner{border:0}button.uppy-Dashboard-Item-progressIndicator:focus .uppy-Dashboard-Item-progressIcon--bg,button.uppy-Dashboard-Item-progressIndicator:focus .uppy-Dashboard-Item-progressIcon--retry{fill:#76abe9}.uppy-Dashboard-Item-progressIcon--circle{height:100%;width:100%}.uppy-Dashboard-Item-progressIcon--bg{stroke:#fff6}.uppy-Dashboard-Item-progressIcon--progress{stroke:#fff;transition:stroke-dashoffset .5s ease-out}.uppy-Dashboard-Item-progressIcon--play{fill:#fff;stroke:#fff;transition:all .2s}.uppy-Dashboard-Item-progressIcon--cancel{fill:#fff;transition:all .2s}.uppy-Dashboard-Item-progressIcon--pause{fill:#fff;stroke:#fff;transition:all .2s}.uppy-Dashboard-Item-progressIcon--check{fill:#fff;transition:all .2s}.uppy-Dashboard-Item-progressIcon--retry{fill:#fff}[dir=ltr] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{right:-8px}[dir=rtl] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{left:-8px}[dir=ltr] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{left:auto}[dir=rtl] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{right:auto}.uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{top:-9px;transform:none;width:auto}.uppy-Dashboard-Item.is-error .uppy-Dashboard-Item-progressIndicator{height:18px;width:18px}.uppy-size--md .uppy-Dashboard-Item.is-error .uppy-Dashboard-Item-progressIndicator{height:28px;width:28px}.uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progressIndicator{height:18px;opacity:1;width:18px}.uppy-size--md .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progressIndicator{height:22px;width:22px}.uppy-Dashboard-Item.is-processing .uppy-Dashboard-Item-progress{opacity:0}[dir=ltr] .uppy-Dashboard-Item-fileInfo{padding-right:5px}[dir=rtl] .uppy-Dashboard-Item-fileInfo{padding-left:5px}[dir=ltr] .uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-right:10px}[dir=rtl] .uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-left:10px}[dir=ltr] .uppy-size--md.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-right:15px}[dir=rtl] .uppy-size--md.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-left:15px}.uppy-Dashboard-Item-name{word-wrap:anywhere;font-size:12px;font-weight:500;line-height:1.3;margin-bottom:5px;word-break:break-all}[data-uppy-theme=dark] .uppy-Dashboard-Item-name{color:#eaeaea}.uppy-size--md.uppy-Dashboard--singleFile .uppy-Dashboard-Item-name{font-size:14px;line-height:1.4}.uppy-Dashboard-Item-fileName{align-items:baseline;display:flex}.uppy-Dashboard-Item-fileName button{margin-left:5px}.uppy-Dashboard-Item-author{color:#757575;display:inline-block;font-size:11px;font-weight:400;line-height:1;margin-bottom:5px;vertical-align:bottom}.uppy-Dashboard-Item-author a{color:#757575}.uppy-Dashboard-Item-status{color:#757575;font-size:11px;font-weight:400;line-height:1}[data-uppy-theme=dark] .uppy-Dashboard-Item-status{color:#bbb}.uppy-Dashboard-Item-statusSize{display:inline-block;margin-bottom:5px;text-transform:uppercase;vertical-align:bottom}.uppy-Dashboard-Item-reSelect{color:#2275d7;font-family:inherit;font-size:inherit;font-weight:600}.uppy-Dashboard-Item-errorMessage{background-color:#fdeff1;color:#a51523;font-size:11px;font-weight:500;line-height:1.3;padding:5px 6px}.uppy-Dashboard-Item-errorMessageBtn{color:#a51523;cursor:pointer;font-size:11px;font-weight:500;text-decoration:underline}.uppy-Dashboard-Item-preview .uppy-Dashboard-Item-errorMessage{display:none}.uppy-size--md .uppy-Dashboard-Item-preview .uppy-Dashboard-Item-errorMessage{border-bottom-left-radius:3px;border-bottom-right-radius:3px;border-top:1px solid #f7c2c8;bottom:0;display:block;left:0;line-height:1.4;padding:6px 8px;position:absolute;right:0}.uppy-Dashboard-Item-fileInfo .uppy-Dashboard-Item-errorMessage{border:1px solid #f7c2c8;border-radius:3px;display:inline-block;position:static}.uppy-size--md .uppy-Dashboard-Item-fileInfo .uppy-Dashboard-Item-errorMessage{display:none}.uppy-Dashboard-Item-action{color:#939393;cursor:pointer}.uppy-Dashboard-Item-action:focus{outline:none}.uppy-Dashboard-Item-action::-moz-focus-inner{border:0}.uppy-Dashboard-Item-action:focus{box-shadow:0 0 0 3px #2275d780}.uppy-Dashboard-Item-action:hover{color:#1f1f1f;opacity:1}[data-uppy-theme=dark] .uppy-Dashboard-Item-action{color:#cfcfcf}[data-uppy-theme=dark] .uppy-Dashboard-Item-action:focus{outline:none}[data-uppy-theme=dark] .uppy-Dashboard-Item-action::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-Dashboard-Item-action:focus{box-shadow:0 0 0 2px #aae1ffd9}[data-uppy-theme=dark] .uppy-Dashboard-Item-action:hover{color:#eaeaea}.uppy-Dashboard-Item-action--remove{color:#1f1f1f;opacity:.95}.uppy-Dashboard-Item-action--remove:hover{color:#000;opacity:1}[dir=ltr] .uppy-size--md .uppy-Dashboard-Item-action--remove{right:-8px}[dir=rtl] .uppy-size--md .uppy-Dashboard-Item-action--remove{left:-8px}.uppy-size--md .uppy-Dashboard-Item-action--remove{height:18px;padding:0;position:absolute;top:-8px;width:18px;z-index:1002}.uppy-size--md .uppy-Dashboard-Item-action--remove:focus{border-radius:50%}[dir=ltr] .uppy-Dashboard--singleFile.uppy-size--height-md .uppy-Dashboard-Item-action--remove{right:8px}[dir=rtl] .uppy-Dashboard--singleFile.uppy-size--height-md .uppy-Dashboard-Item-action--remove{left:8px}.uppy-Dashboard--singleFile.uppy-size--height-md .uppy-Dashboard-Item-action--remove{position:absolute;top:8px}[data-uppy-theme=dark] .uppy-Dashboard-Item-action--remove{color:#525252}[data-uppy-theme=dark] .uppy-Dashboard-Item-action--remove:hover{color:#333}.uppy-Dashboard:not(.uppy-size--md):not(.uppy-Dashboard--singleFile.uppy-size--height-md) .uppy-Dashboard-Item-actionWrapper{align-items:center;display:flex}.uppy-Dashboard:not(.uppy-size--md):not(.uppy-Dashboard--singleFile.uppy-size--height-md) .uppy-Dashboard-Item-action{height:22px;margin-left:3px;padding:3px;width:22px}.uppy-Dashboard:not(.uppy-size--md):not(.uppy-Dashboard--singleFile.uppy-size--height-md) .uppy-Dashboard-Item-action:focus{border-radius:3px}.uppy-size--md .uppy-Dashboard-Item-action--copyLink,.uppy-size--md .uppy-Dashboard-Item-action--edit{height:16px;padding:0;width:16px}.uppy-size--md .uppy-Dashboard-Item-action--copyLink:focus,.uppy-size--md .uppy-Dashboard-Item-action--edit:focus{border-radius:3px}.uppy-Dashboard-Item{align-items:center;border-bottom:1px solid #eaeaea;display:flex;padding:10px}[dir=ltr] .uppy-Dashboard:not(.uppy-Dashboard--singleFile) .uppy-Dashboard-Item{padding-right:0}[dir=rtl] .uppy-Dashboard:not(.uppy-Dashboard--singleFile) .uppy-Dashboard-Item{padding-left:0}[data-uppy-theme=dark] .uppy-Dashboard-Item{border-bottom:1px solid #333}[dir=ltr] .uppy-size--md .uppy-Dashboard-Item{float:left}[dir=rtl] .uppy-size--md .uppy-Dashboard-Item{float:right}.uppy-size--md .uppy-Dashboard-Item{border-bottom:0;display:block;height:215px;margin:5px 15px;padding:0;position:relative;width:calc(33.333% - 30px)}.uppy-size--lg .uppy-Dashboard-Item{height:190px;margin:5px 15px;padding:0;width:calc(25% - 30px)}.uppy-size--xl .uppy-Dashboard-Item{height:210px;padding:0;width:calc(20% - 30px)}.uppy-Dashboard--singleFile .uppy-Dashboard-Item{border-bottom:0;display:flex;flex-direction:column;height:100%;max-width:400px;padding:15px;position:relative;width:100%}.uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-previewInnerWrap{opacity:.2}.uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-name{opacity:.7}.uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-preview:before{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='35' height='39'%3E%3Cpath d='M1.708 38.66c1.709 0 3.417-3.417 6.834-3.417 3.416 0 5.125 3.417 8.61 3.417 3.348 0 5.056-3.417 8.473-3.417 4.305 0 5.125 3.417 6.833 3.417.889 0 1.709-.889 1.709-1.709v-19.68C34.167-5.757 0-5.757 0 17.271v19.68c0 .82.888 1.709 1.708 1.709zm8.542-17.084a3.383 3.383 0 0 1-3.417-3.416 3.383 3.383 0 0 1 3.417-3.417 3.383 3.383 0 0 1 3.417 3.417 3.383 3.383 0 0 1-3.417 3.416zm13.667 0A3.383 3.383 0 0 1 20.5 18.16a3.383 3.383 0 0 1 3.417-3.417 3.383 3.383 0 0 1 3.416 3.417 3.383 3.383 0 0 1-3.416 3.416z' fill='%2523000'/%3E%3C/svg%3E\");background-position:50% 10px;background-repeat:no-repeat;background-size:25px;bottom:0;content:\"\";left:0;opacity:.5;position:absolute;right:0;top:0;z-index:1005}.uppy-size--md .uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-preview:before{background-position:50% 50%;background-size:40px}.uppy-Dashboard--singleFile .uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-preview:before{background-position:50% 50%;background-size:30%}.uppy-Dashboard-Item-preview{flex-grow:0;flex-shrink:0;height:50px;position:relative;width:50px}.uppy-size--md .uppy-Dashboard-Item-preview{height:140px;width:100%}.uppy-size--lg .uppy-Dashboard-Item-preview{height:120px}.uppy-size--xl .uppy-Dashboard-Item-preview{height:140px}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-preview{flex-grow:1;max-height:75%;width:100%}.uppy-Dashboard--singleFile.uppy-size--md .uppy-Dashboard-Item-preview{max-height:100%}[dir=ltr] .uppy-Dashboard-Item-fileInfoAndButtons{padding-right:8px}[dir=rtl] .uppy-Dashboard-Item-fileInfoAndButtons{padding-left:8px}[dir=ltr] .uppy-Dashboard-Item-fileInfoAndButtons{padding-left:12px}[dir=rtl] .uppy-Dashboard-Item-fileInfoAndButtons{padding-right:12px}.uppy-Dashboard-Item-fileInfoAndButtons{align-items:center;display:flex;flex-grow:1;justify-content:space-between}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfoAndButtons,.uppy-size--md .uppy-Dashboard-Item-fileInfoAndButtons{align-items:flex-start;padding:9px 0 0}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfoAndButtons{flex-grow:0;width:100%}.uppy-Dashboard-Item-fileInfo{flex-grow:1;flex-shrink:1}.uppy-Dashboard-Item-actionWrapper{flex-grow:0;flex-shrink:0}.uppy-Dashboard-Item.is-error .uppy-Dashboard-Item-previewInnerWrap:after,.uppy-Dashboard-Item.is-inprogress .uppy-Dashboard-Item-previewInnerWrap:after{display:block}.uppy-Dashboard-Item.is-inprogress:not(.is-resumable) .uppy-Dashboard-Item-action--remove{display:none}[dir=ltr] .uppy-Dashboard-Item-errorDetails{left:2px}[dir=rtl] .uppy-Dashboard-Item-errorDetails{right:2px}.uppy-Dashboard-Item-errorDetails{-webkit-appearance:none;appearance:none;background-color:#939393;border:none;border-radius:50%;color:#fff;cursor:help;flex-shrink:0;font-size:10px;font-weight:600;height:13px;line-height:12px;position:relative;text-align:center;top:0;width:13px}.uppy-Dashboard-Item-errorDetails:after{word-wrap:break-word;line-height:1.3}.uppy-Dashboard-FileCard{background-color:#fff;border-radius:5px;bottom:0;box-shadow:0 0 10px 4px #0000001a;display:flex;flex-direction:column;height:100%;left:0;position:absolute;right:0;top:0;width:100%;z-index:1005}.uppy-Dashboard-FileCard .uppy-DashboardContent-bar{border-top-left-radius:5px;border-top-right-radius:5px}.uppy-Dashboard-FileCard .uppy-Dashboard-FileCard-actions{border-bottom-left-radius:5px;border-bottom-right-radius:5px}.uppy-Dashboard-FileCard-inner{display:flex;flex-direction:column;flex-grow:1;flex-shrink:1;height:100%;min-height:0}.uppy-Dashboard-FileCard-preview{align-items:center;border-bottom:1px solid #eaeaea;display:flex;flex-grow:0;flex-shrink:1;height:60%;justify-content:center;min-height:0;position:relative}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-preview{background-color:#333;border-bottom:0}.uppy-Dashboard-FileCard-preview img.uppy-Dashboard-Item-previewImg{border-radius:3px;box-shadow:0 3px 20px #00000026;flex:0 0 auto;max-height:90%;max-width:90%;object-fit:cover}[dir=ltr] .uppy-Dashboard-FileCard-edit{right:10px}[dir=rtl] .uppy-Dashboard-FileCard-edit{left:10px}.uppy-Dashboard-FileCard-edit{background-color:#00000080;border-radius:50px;color:#fff;font-size:13px;padding:7px 15px;position:absolute;top:10px}.uppy-Dashboard-FileCard-edit:focus{outline:none}.uppy-Dashboard-FileCard-edit::-moz-focus-inner{border:0}.uppy-Dashboard-FileCard-edit:focus{box-shadow:0 0 0 3px #2275d780}.uppy-Dashboard-FileCard-edit:hover{background-color:#000c}.uppy-Dashboard-FileCard-info{-webkit-overflow-scrolling:touch;flex-grow:0;flex-shrink:0;height:40%;overflow-y:auto;padding:30px 20px 20px}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-info{background-color:#1f1f1f}.uppy-Dashboard-FileCard-fieldset{border:0;font-size:0;margin:auto auto 12px;max-width:640px;padding:0}.uppy-Dashboard-FileCard-label{color:#525252;display:inline-block;font-size:12px;vertical-align:middle;width:22%}.uppy-size--md .uppy-Dashboard-FileCard-label{font-size:14px}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-label{color:#eaeaea}.uppy-Dashboard-FileCard-input{display:inline-block;vertical-align:middle;width:78%}.uppy-Dashboard-FileCard-actions{align-items:center;background-color:#fafafa;border-top:1px solid #eaeaea;display:flex;flex-grow:0;flex-shrink:0;height:55px;padding:0 15px}.uppy-size--md .uppy-Dashboard-FileCard-actions{height:65px}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-actions{background-color:#1f1f1f;border-top:1px solid #333}[dir=ltr] .uppy-Dashboard-FileCard-actionsBtn{margin-right:10px}[dir=rtl] .uppy-Dashboard-FileCard-actionsBtn{margin-left:10px}.uppy-transition-slideDownUp-enter{opacity:.01;transform:translate3d(0,-105%,0);transition:transform .25s ease-in-out,opacity .25s ease-in-out}.uppy-transition-slideDownUp-enter.uppy-transition-slideDownUp-enter-active{opacity:1;transform:translateZ(0)}.uppy-transition-slideDownUp-leave{opacity:1;transform:translateZ(0);transition:transform .25s ease-in-out,opacity .25s ease-in-out}.uppy-transition-slideDownUp-leave.uppy-transition-slideDownUp-leave-active{opacity:.01;transform:translate3d(0,-105%,0)}@keyframes uppy-Dashboard-fadeIn{0%{opacity:0}to{opacity:1}}@keyframes uppy-Dashboard-fadeOut{0%{opacity:1}to{opacity:0}}@keyframes uppy-Dashboard-slideDownAndFadeIn{0%{opacity:0;transform:translate3d(-50%,-70%,0)}to{opacity:1;transform:translate3d(-50%,-50%,0)}}@keyframes uppy-Dashboard-slideDownAndFadeIn--small{0%{opacity:0;transform:translate3d(0,-20%,0)}to{opacity:1;transform:translateZ(0)}}@keyframes uppy-Dashboard-slideUpFadeOut{0%{opacity:1;transform:translate3d(-50%,-50%,0)}to{opacity:0;transform:translate3d(-50%,-70%,0)}}@keyframes uppy-Dashboard-slideUpFadeOut--small{0%{opacity:1;transform:translateZ(0)}to{opacity:0;transform:translate3d(0,-20%,0)}}.uppy-Dashboard--modal{z-index:1001}.uppy-Dashboard--modal[aria-hidden=true]{display:none}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideDownAndFadeIn--small .3s cubic-bezier(0,0,.2,1)}@media only screen and (min-width:820px){.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideDownAndFadeIn .3s cubic-bezier(0,0,.2,1)}}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose>.uppy-Dashboard-overlay{animation:uppy-Dashboard-fadeIn .3s cubic-bezier(0,0,.2,1)}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose.uppy-Dashboard--isClosing>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideUpFadeOut--small .3s cubic-bezier(0,0,.2,1)}@media only screen and (min-width:820px){.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose.uppy-Dashboard--isClosing>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideUpFadeOut .3s cubic-bezier(0,0,.2,1)}}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose.uppy-Dashboard--isClosing>.uppy-Dashboard-overlay{animation:uppy-Dashboard-fadeOut .3s cubic-bezier(0,0,.2,1)}.uppy-Dashboard-isFixed{height:100vh;overflow:hidden}.uppy-Dashboard--modal .uppy-Dashboard-overlay{background-color:#00000080;bottom:0;left:0;position:fixed;right:0;top:0;z-index:1001}.uppy-Dashboard-inner{background-color:#f4f4f4;border:1px solid #eaeaea;border-radius:5px;max-height:100%;max-width:100%;outline:none;position:relative}.uppy-size--md .uppy-Dashboard-inner{min-height:auto}@media only screen and (min-width:820px){.uppy-Dashboard-inner{height:500px;width:650px}}.uppy-Dashboard--modal .uppy-Dashboard-inner{z-index:1002}[data-uppy-theme=dark] .uppy-Dashboard-inner{background-color:#1f1f1f}.uppy-Dashboard--isDisabled .uppy-Dashboard-inner{cursor:not-allowed}.uppy-Dashboard-innerWrap{border-radius:5px;display:flex;flex-direction:column;height:100%;opacity:0;overflow:hidden;position:relative}.uppy-Dashboard--isInnerWrapVisible .uppy-Dashboard-innerWrap{opacity:1}.uppy-Dashboard--isDisabled .uppy-Dashboard-innerWrap{cursor:not-allowed;filter:grayscale(100%);opacity:.6;-webkit-user-select:none;user-select:none}.uppy-Dashboard--isDisabled .uppy-ProviderIconBg{fill:#9f9f9f}.uppy-Dashboard--isDisabled [aria-disabled],.uppy-Dashboard--isDisabled [disabled]{cursor:not-allowed;pointer-events:none}.uppy-Dashboard--modal .uppy-Dashboard-inner{border:none;bottom:15px;left:15px;position:fixed;right:15px;top:35px}@media only screen and (min-width:820px){.uppy-Dashboard--modal .uppy-Dashboard-inner{box-shadow:0 5px 15px 4px #00000026;left:50%;right:auto;top:50%;transform:translate(-50%,-50%)}}[dir=ltr] .uppy-Dashboard-close{right:-2px}[dir=rtl] .uppy-Dashboard-close{left:-2px}.uppy-Dashboard-close{color:#ffffffe6;cursor:pointer;display:block;font-size:27px;position:absolute;top:-33px;z-index:1005}.uppy-Dashboard-close:focus{outline:none}.uppy-Dashboard-close::-moz-focus-inner{border:0}.uppy-Dashboard-close:focus{color:#8cb8ed}@media only screen and (min-width:820px){[dir=ltr] .uppy-Dashboard-close{right:-35px}[dir=rtl] .uppy-Dashboard-close{left:-35px}.uppy-Dashboard-close{font-size:35px;top:-10px}}.uppy-Dashboard-serviceMsg{background-color:#fffbf7;border-bottom:1px solid #edd4b9;border-top:1px solid #edd4b9;font-size:12px;font-weight:500;line-height:1.3;padding:12px 0;position:relative;top:-1px;z-index:1004}.uppy-size--md .uppy-Dashboard-serviceMsg{font-size:14px;line-height:1.4}[data-uppy-theme=dark] .uppy-Dashboard-serviceMsg{background-color:#1f1f1f;border-bottom:1px solid #333;border-top:1px solid #333;color:#eaeaea}.uppy-Dashboard-serviceMsg-title{display:block;line-height:1;margin-bottom:4px;padding-left:42px}.uppy-Dashboard-serviceMsg-text{padding:0 15px}.uppy-Dashboard-serviceMsg-actionBtn{color:#2275d7;font-size:inherit;font-weight:inherit;vertical-align:initial}[data-uppy-theme=dark] .uppy-Dashboard-serviceMsg-actionBtn{color:#02baf2e6}.uppy-Dashboard-serviceMsg-icon{left:15px;position:absolute;top:10px}.uppy-Dashboard-AddFiles{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;position:relative;text-align:center}[data-uppy-drag-drop-supported=true] .uppy-Dashboard-AddFiles{border:1px dashed #dfdfdf;border-radius:3px;height:calc(100% - 14px);margin:7px}.uppy-Dashboard-AddFilesPanel .uppy-Dashboard-AddFiles{border:none;height:calc(100% - 54px)}.uppy-Dashboard--modal .uppy-Dashboard-AddFiles{border-color:#cfcfcf}[data-uppy-theme=dark] .uppy-Dashboard-AddFiles{border-color:#757575}.uppy-Dashboard-AddFiles-info{display:none;margin-top:auto;padding-bottom:15px;padding-top:15px}.uppy-size--height-md .uppy-Dashboard-AddFiles-info{display:block}.uppy-size--md .uppy-Dashboard-AddFiles-info{bottom:25px;left:0;padding-bottom:0;padding-top:30px;position:absolute;right:0}[data-uppy-num-acquirers=\"0\"] .uppy-Dashboard-AddFiles-info{margin-top:0}.uppy-Dashboard-browse{color:#2275d7e6;cursor:pointer}.uppy-Dashboard-browse:focus{outline:none}.uppy-Dashboard-browse::-moz-focus-inner{border:0}.uppy-Dashboard-browse:focus,.uppy-Dashboard-browse:hover{border-bottom:1px solid #2275d7}[data-uppy-theme=dark] .uppy-Dashboard-browse{color:#02baf2e6}[data-uppy-theme=dark] .uppy-Dashboard-browse:focus,[data-uppy-theme=dark] .uppy-Dashboard-browse:hover{border-bottom:1px solid #02baf2}.uppy-Dashboard-browseBtn{display:block;font-size:14px;font-weight:500;margin-bottom:5px;margin-top:8px;width:100%}.uppy-size--md .uppy-Dashboard-browseBtn{font-size:15px;margin:15px auto;padding:13px 44px;width:auto}.uppy-Dashboard-AddFiles-list{-webkit-overflow-scrolling:touch;display:flex;flex:1;flex-direction:column;margin-top:2px;overflow-y:auto;padding:2px 0;width:100%}.uppy-size--md .uppy-Dashboard-AddFiles-list{flex:none;flex-direction:row;flex-wrap:wrap;justify-content:center;margin-top:15px;max-width:600px;overflow-y:visible;padding-top:0}.uppy-DashboardTab{border-bottom:1px solid #eaeaea;text-align:center;width:100%}[data-uppy-theme=dark] .uppy-DashboardTab{border-bottom:1px solid #333}.uppy-size--md .uppy-DashboardTab{border-bottom:none;display:inline-block;margin-bottom:10px;width:auto}.uppy-DashboardTab-btn{align-items:center;-webkit-appearance:none;appearance:none;background-color:initial;color:#525252;cursor:pointer;flex-direction:row;height:100%;justify-content:left;padding:12px 15px;width:100%}.uppy-DashboardTab-btn:focus{outline:none}[dir=ltr] .uppy-size--md .uppy-DashboardTab-btn{margin-right:1px}[dir=rtl] .uppy-size--md .uppy-DashboardTab-btn{margin-left:1px}.uppy-size--md .uppy-DashboardTab-btn{border-radius:5px;flex-direction:column;padding:10px 3px;width:86px}[data-uppy-theme=dark] .uppy-DashboardTab-btn{color:#eaeaea}.uppy-DashboardTab-btn::-moz-focus-inner{border:0}.uppy-DashboardTab-btn:hover{background-color:#e9ecef}[data-uppy-theme=dark] .uppy-DashboardTab-btn:hover{background-color:#333}.uppy-DashboardTab-btn:active,.uppy-DashboardTab-btn:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-DashboardTab-btn:active,[data-uppy-theme=dark] .uppy-DashboardTab-btn:focus{background-color:#525252}.uppy-DashboardTab-btn svg{display:inline-block;max-height:100%;max-width:100%;overflow:hidden;transition:transform .15s ease-in-out;vertical-align:text-top}[dir=ltr] .uppy-DashboardTab-inner{margin-right:10px}[dir=rtl] .uppy-DashboardTab-inner{margin-left:10px}.uppy-DashboardTab-inner{align-items:center;background-color:#fff;border-radius:8px;box-shadow:0 1px 1px 0 #0000001a,0 1px 2px 0 #0000001a,0 2px 3px 0 #00000005;display:flex;height:32px;justify-content:center;width:32px}[dir=ltr] .uppy-size--md .uppy-DashboardTab-inner{margin-right:0}[dir=rtl] .uppy-size--md .uppy-DashboardTab-inner{margin-left:0}[data-uppy-theme=dark] .uppy-DashboardTab-inner{background-color:#323232;box-shadow:0 1px 1px 0 #0003,0 1px 2px 0 #0003,0 2px 3px 0 #00000014}.uppy-DashboardTab-name{font-size:14px;font-weight:400}.uppy-size--md .uppy-DashboardTab-name{font-size:12px;line-height:15px;margin-bottom:0;margin-top:8px}.uppy-DashboardTab-iconMyDevice{color:#2275d7}[data-uppy-theme=dark] .uppy-DashboardTab-iconMyDevice{color:#02baf2}.uppy-DashboardTab-iconBox{color:#0061d5}[data-uppy-theme=dark] .uppy-DashboardTab-iconBox{color:#eaeaea}.uppy-DashboardTab-iconDropbox{color:#0061fe}[data-uppy-theme=dark] .uppy-DashboardTab-iconDropbox{color:#eaeaea}.uppy-DashboardTab-iconUnsplash{color:#111}[data-uppy-theme=dark] .uppy-DashboardTab-iconUnsplash{color:#eaeaea}.uppy-DashboardTab-iconScreenRec{color:#2c3e50}[data-uppy-theme=dark] .uppy-DashboardTab-iconScreenRec{color:#eaeaea}.uppy-DashboardTab-iconAudio{color:#8030a3}[data-uppy-theme=dark] .uppy-DashboardTab-iconAudio{color:#bf6ee3}.uppy-Dashboard-input{height:.1px;opacity:0;overflow:hidden;position:absolute;width:.1px;z-index:-1}.uppy-DashboardContent-bar{align-items:center;background-color:#fafafa;border-bottom:1px solid #eaeaea;display:flex;flex-shrink:0;height:40px;justify-content:space-between;padding:0 10px;position:relative;width:100%;z-index:1004}.uppy-size--md .uppy-DashboardContent-bar{height:50px;padding:0 15px}[data-uppy-theme=dark] .uppy-DashboardContent-bar{background-color:#1f1f1f;border-bottom:1px solid #333}.uppy-DashboardContent-title{font-size:12px;font-weight:500;left:0;line-height:40px;margin:auto;max-width:170px;overflow-x:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0;white-space:nowrap;width:100%}.uppy-size--md .uppy-DashboardContent-title{font-size:14px;line-height:50px;max-width:300px}[data-uppy-theme=dark] .uppy-DashboardContent-title{color:#eaeaea}[dir=ltr] .uppy-DashboardContent-back,[dir=ltr] .uppy-DashboardContent-save{margin-left:-6px}[dir=rtl] .uppy-DashboardContent-back,[dir=rtl] .uppy-DashboardContent-save{margin-right:-6px}.uppy-DashboardContent-back,.uppy-DashboardContent-save{-webkit-appearance:none;background:none;border:0;border-radius:3px;color:inherit;color:#2275d7;cursor:pointer;font-family:inherit;font-size:inherit;font-size:12px;font-weight:400;line-height:1;margin:0;padding:7px 6px}.uppy-DashboardContent-back:focus,.uppy-DashboardContent-save:focus{outline:none}.uppy-DashboardContent-back::-moz-focus-inner,.uppy-DashboardContent-save::-moz-focus-inner{border:0}.uppy-DashboardContent-back:hover,.uppy-DashboardContent-save:hover{color:#1b5dab}.uppy-DashboardContent-back:focus,.uppy-DashboardContent-save:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-DashboardContent-back:focus,[data-uppy-theme=dark] .uppy-DashboardContent-save:focus{background-color:#333}.uppy-size--md .uppy-DashboardContent-back,.uppy-size--md .uppy-DashboardContent-save{font-size:14px}[data-uppy-theme=dark] .uppy-DashboardContent-back,[data-uppy-theme=dark] .uppy-DashboardContent-save{color:#02baf2}[dir=ltr] .uppy-DashboardContent-addMore{margin-right:-5px}[dir=rtl] .uppy-DashboardContent-addMore{margin-left:-5px}.uppy-DashboardContent-addMore{-webkit-appearance:none;background:none;border:0;border-radius:3px;color:inherit;color:#2275d7;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:500;height:29px;line-height:1;margin:0;padding:7px 8px;width:29px}.uppy-DashboardContent-addMore:focus{outline:none}.uppy-DashboardContent-addMore::-moz-focus-inner{border:0}.uppy-DashboardContent-addMore:hover{color:#1b5dab}.uppy-DashboardContent-addMore:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-DashboardContent-addMore:focus{background-color:#333}[dir=ltr] .uppy-size--md .uppy-DashboardContent-addMore{margin-right:-8px}[dir=rtl] .uppy-size--md .uppy-DashboardContent-addMore{margin-left:-8px}.uppy-size--md .uppy-DashboardContent-addMore{font-size:14px;height:auto;width:auto}[data-uppy-theme=dark] .uppy-DashboardContent-addMore{color:#02baf2}[dir=ltr] .uppy-DashboardContent-addMore svg{margin-right:4px}[dir=rtl] .uppy-DashboardContent-addMore svg{margin-left:4px}.uppy-DashboardContent-addMore svg{vertical-align:initial}.uppy-size--md .uppy-DashboardContent-addMore svg{height:11px;width:11px}.uppy-DashboardContent-addMoreCaption{display:none}.uppy-size--md .uppy-DashboardContent-addMoreCaption{display:inline}.uppy-DashboardContent-panel{background-color:#f5f5f5;flex:1}.uppy-Dashboard-AddFilesPanel,.uppy-DashboardContent-panel{border-radius:5px;bottom:0;display:flex;flex-direction:column;left:0;overflow:hidden;position:absolute;right:0;top:0;z-index:1005}.uppy-Dashboard-AddFilesPanel{background:#fafafa;background:linear-gradient(0deg,#fafafa 35%,#fafafad9);box-shadow:0 0 10px 5px #00000026}[data-uppy-theme=dark] .uppy-Dashboard-AddFilesPanel{background-color:#333;background-image:linear-gradient(0deg,#1f1f1f 35%,#1f1f1fd9)}.uppy-Dashboard--isAddFilesPanelVisible .uppy-Dashboard-files{filter:blur(2px)}.uppy-Dashboard-progress{bottom:0;height:12%;left:0;position:absolute;width:100%}.uppy-Dashboard-progressBarContainer.is-active{height:100%;left:0;position:absolute;top:0;width:100%;z-index:1004}.uppy-Dashboard-filesContainer{flex:1;margin:0;overflow-y:hidden;position:relative}.uppy-Dashboard-filesContainer:after{clear:both;content:\"\";display:table}.uppy-Dashboard-files{-webkit-overflow-scrolling:touch;flex:1;margin:0;overflow-y:auto;padding:0 0 10px}.uppy-size--md .uppy-Dashboard-files{padding-top:10px}.uppy-Dashboard--singleFile .uppy-Dashboard-filesInner{align-items:center;display:flex;height:100%;justify-content:center}.uppy-Dashboard-dropFilesHereHint{align-items:center;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='48' height='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 1v1C11.85 2 2 11.85 2 24s9.85 22 22 22 22-9.85 22-22S36.15 2 24 2V1zm0 0V0c13.254 0 24 10.746 24 24S37.254 48 24 48 0 37.254 0 24 10.746 0 24 0v1zm7.707 19.293a.999.999 0 1 1-1.414 1.414L25 16.414V34a1 1 0 1 1-2 0V16.414l-5.293 5.293a.999.999 0 1 1-1.414-1.414l7-7a.999.999 0 0 1 1.414 0l7 7z' fill='%232275D7'/%3E%3C/svg%3E\");background-position:50% 50%;background-repeat:no-repeat;border:1px dashed #2275d7;border-radius:3px;bottom:7px;color:#757575;display:flex;font-size:16px;justify-content:center;left:7px;padding-top:90px;position:absolute;right:7px;text-align:center;top:7px;visibility:hidden;z-index:2000}[data-uppy-theme=dark] .uppy-Dashboard-dropFilesHereHint{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='48' height='48' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 1v1C11.85 2 2 11.85 2 24s9.85 22 22 22 22-9.85 22-22S36.15 2 24 2V1zm0 0V0c13.254 0 24 10.746 24 24S37.254 48 24 48 0 37.254 0 24 10.746 0 24 0v1zm7.707 19.293a.999.999 0 1 1-1.414 1.414L25 16.414V34a1 1 0 1 1-2 0V16.414l-5.293 5.293a.999.999 0 1 1-1.414-1.414l7-7a.999.999 0 0 1 1.414 0l7 7z' fill='%2302BAF2'/%3E%3C/svg%3E\");border-color:#02baf2;color:#bbb}.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-dropFilesHereHint{visibility:visible}.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-files,.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-progressindicators,.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-serviceMsg,.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-DashboardContent-bar{opacity:.15}.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-AddFiles{opacity:.03}.uppy-Dashboard-AddFiles-title{color:#000;font-size:17px;font-weight:500;line-height:1.35;margin-bottom:5px;margin-top:15px;padding:0 15px;text-align:inline-start;width:100%}.uppy-size--md .uppy-Dashboard-AddFiles-title{font-size:21px;font-weight:400;margin-top:5px;max-width:480px;padding:0 35px;text-align:center}[data-uppy-num-acquirers=\"0\"] .uppy-Dashboard-AddFiles-title{text-align:center}[data-uppy-theme=dark] .uppy-Dashboard-AddFiles-title{color:#eaeaea}.uppy-Dashboard-AddFiles-title button{font-weight:500}.uppy-size--md .uppy-Dashboard-AddFiles-title button{font-weight:400}.uppy-Dashboard-note{color:#757575;font-size:14px;line-height:1.25;margin:auto;max-width:350px;padding:0 15px;text-align:center}.uppy-size--md .uppy-Dashboard-note{line-height:1.35;max-width:600px}[data-uppy-theme=dark] .uppy-Dashboard-note{color:#cfcfcf}a.uppy-Dashboard-poweredBy{color:#939393;display:inline-block;font-size:11px;margin-top:8px;text-align:center;text-decoration:none}.uppy-Dashboard-poweredByIcon{fill:none;stroke:#939393;margin-left:1px;margin-right:1px;opacity:.9;position:relative;top:1px;vertical-align:text-top}.uppy-Dashboard-Item-previewIcon{height:25px;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:25px;z-index:100}.uppy-size--md .uppy-Dashboard-Item-previewIcon{height:38px;width:38px}.uppy-Dashboard-Item-previewIcon svg{height:100%;width:100%}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-previewIcon{height:100%;max-height:60%;max-width:60%;width:100%}.uppy-Dashboard-Item-previewIconWrap{height:76px;max-height:75%;position:relative}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-previewIconWrap{height:100%;width:100%}.uppy-Dashboard-Item-previewIconBg{filter:drop-shadow(rgba(0,0,0,.1) 0 1px 1px);height:100%;width:100%}.uppy-Dashboard-upload{height:50px;position:relative;width:50px}.uppy-size--md .uppy-Dashboard-upload{height:60px;width:60px}.uppy-Dashboard-upload .uppy-c-icon{position:relative;top:1px;width:50%}[dir=ltr] .uppy-Dashboard-uploadCount{right:-12px}[dir=rtl] .uppy-Dashboard-uploadCount{left:-12px}.uppy-Dashboard-uploadCount{background-color:#1bb240;border-radius:50%;color:#fff;font-size:8px;height:16px;line-height:16px;position:absolute;top:-12px;width:16px}.uppy-size--md .uppy-Dashboard-uploadCount{font-size:9px;height:18px;line-height:18px;width:18px}",""]);const o=i},9526:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(3645),i=n.n(r),o=n(1667),a=n.n(o),s=n(1630),l=n(6199),u=n(2183),c=n(9465),d=n(895),h=n(9671),p=n(1533),f=i()((function(e){return e[1]})),m=a()(s),g=a()(l),y=a()(u),v=a()(c),b=a()(d),_=a()(h),E=a()(p);f.push([e.id,".fluid_video_wrapper {\n    animation: none;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-duration: 0;\n    animation-fill-mode: none;\n    animation-iteration-count: 1;\n    animation-name: none;\n    animation-play-state: running;\n    animation-timing-function: ease;\n    backface-visibility: visible;\n    background: 0;\n    background-attachment: scroll;\n    background-clip: border-box;\n    background-color: transparent;\n    background-image: none;\n    background-origin: padding-box;\n    background-position: 0 0;\n    background-position-x: 0;\n    background-position-y: 0;\n    background-repeat: repeat;\n    background-size: auto auto;\n    border: 0;\n    border-style: none;\n    border-width: medium;\n    border-color: inherit;\n    border-bottom: 0;\n    border-bottom-color: inherit;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n    border-bottom-style: none;\n    border-bottom-width: medium;\n    border-collapse: separate;\n    border-image: none;\n    border-left: 0;\n    border-left-color: inherit;\n    border-left-style: none;\n    border-left-width: medium;\n    border-radius: 0;\n    border-right: 0;\n    border-right-color: inherit;\n    border-right-style: none;\n    border-right-width: medium;\n    border-spacing: 0;\n    border-top: 0;\n    border-top-color: inherit;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    border-top-style: none;\n    border-top-width: medium;\n    bottom: auto;\n    box-shadow: none;\n    -webkit-box-sizing: content-box;\n    -moz-box-sizing: content-box;\n    box-sizing: content-box;\n    caption-side: top;\n    clear: none;\n    clip: auto;\n    color: inherit;\n    columns: auto;\n    column-count: auto;\n    column-fill: balance;\n    column-gap: normal;\n    column-rule: medium none currentColor;\n    column-rule-color: currentColor;\n    column-rule-style: none;\n    column-rule-width: none;\n    column-span: 1;\n    column-width: auto;\n    content: normal;\n    counter-increment: none;\n    counter-reset: none;\n    cursor: auto;\n    direction: ltr;\n    display: inline;\n    empty-cells: show;\n    float: none;\n    font: normal;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-size: medium;\n    font-style: normal;\n    font-variant: normal;\n    font-weight: normal;\n    height: auto;\n    hyphens: none;\n    left: auto;\n    letter-spacing: normal;\n    line-height: normal;\n    list-style: none;\n    list-style-image: none;\n    list-style-position: outside;\n    list-style-type: disc;\n    margin: 0;\n    margin-bottom: 0;\n    margin-left: 0;\n    margin-right: 0;\n    margin-top: 0;\n    max-height: none;\n    max-width: none;\n    min-height: 0;\n    min-width: 0;\n    opacity: 1;\n    orphans: 0;\n    outline: 0;\n    outline-color: invert;\n    outline-style: none;\n    outline-width: medium;\n    overflow: visible;\n    overflow-x: visible;\n    overflow-y: visible;\n    padding: 0;\n    padding-bottom: 0;\n    padding-left: 0;\n    padding-right: 0;\n    padding-top: 0;\n    page-break-after: auto;\n    page-break-before: auto;\n    page-break-inside: auto;\n    perspective: none;\n    perspective-origin: 50% 50%;\n    position: static;\n    /* May need to alter quotes for different locales (e.g fr) */\n    quotes: '\\201C' '\\201D' '\\2018' '\\2019';\n    right: auto;\n    tab-size: 8;\n    table-layout: auto;\n    text-align: inherit;\n    text-align-last: auto;\n    text-decoration: none;\n    text-decoration-color: inherit;\n    text-decoration-line: none;\n    text-decoration-style: solid;\n    text-indent: 0;\n    text-shadow: none;\n    text-transform: none;\n    top: auto;\n    transform: none;\n    transform-style: flat;\n    transition: none;\n    transition-delay: 0s;\n    transition-duration: 0s;\n    transition-property: none;\n    transition-timing-function: ease;\n    unicode-bidi: normal;\n    vertical-align: baseline;\n    visibility: visible;\n    white-space: normal;\n    widows: 0;\n    width: auto;\n    word-spacing: normal;\n    z-index: auto;\n    -webkit-tap-highlight-color: transparent;\n}\n\n.fluid_video_wrapper canvas {\n    pointer-events: none;\n}\n\n.fluid_video_wrapper,\n.fluid_video_wrapper * {\n    -webkit-box-sizing: content-box;\n    -moz-box-sizing: content-box;\n    box-sizing: content-box;\n}\n\n.fluid_video_wrapper:after, .fluid_video_wrapper:before {\n    content: none;\n}\n\n.fluid_video_wrapper {\n    position: relative;\n    display: inline-block;\n}\n\n.fluid_video_wrapper video {\n    position: relative;\n    background-color: #000000;\n    display: block;\n}\n\n.fluid_video_wrapper .vast_video_loading {\n    display: table;\n    text-align: center;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    pointer-events: auto;\n    z-index: 1;\n}\n\n.fluid_video_wrapper .vast_video_loading:before {\n    background-image: url("+m+");\n    background-position: center, center;\n    background-repeat: no-repeat, repeat;\n    background-color: rgba(0, 0, 0, 0.2);\n    content: '';\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n}\n\n.skip_button {\n    position: absolute;\n    bottom: 50px;\n    right: 0;\n    background-color: rgba(0, 0, 0, 0.7);\n    padding: 13px 21px 13px 21px;\n}\n\n.skip_button, .skip_button a {\n    color: #ffffff;\n    text-decoration: none;\n    cursor: pointer;\n    z-index: 10;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n}\n\n.skip_button a span.skip_button_icon {\n    display: inline-block;\n    text-align: left;\n    width: 21px;\n    position: relative;\n    bottom: 20px;\n}\n\n.skip_button a span.skip_button_icon:before {\n    background: url("+g+') no-repeat;\n    position: absolute;\n    height: 18px;\n    width: 18px;\n    top: 6px;\n    content: "";\n    opacity: 0.8;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n    background-position: -122px -57px;\n}\n\n.skip_button a span.skip_button_icon:before:hover {\n    opacity: 1;\n}\n\n.skip_button_disabled {\n    cursor: default !important;\n    padding: 13px 21px 13px 21px;\n}\n\n.close_button {\n    position: absolute;\n    background: #000000 url('+y+") no-repeat scroll center center;\n    height: 16px;\n    width: 16px;\n    top: 0;\n    right: 0;\n    background-size: 18px 18px;\n    cursor: pointer;\n    padding: 1px;\n    z-index: 31;\n}\n\n.close_button:hover {\n    background-color: #000000;\n    border: 1px solid #ffffff;\n}\n\n.vast_clickthrough_layer {\n    /*IE Fix*/\n    background-color: white;\n    opacity: 0;\n}\n\n.fluid_ad_playing {\n    position: absolute;\n    background-color: black;\n    opacity: 0.8;\n    border-radius: 1px;\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n    line-height: 18px;\n    z-index: 10;\n    padding: 13px 21px 13px 21px;\n}\n\n.fluid_ad_cta {\n    position: absolute;\n    background-color: rgba(0, 0, 0, 0.7);\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    text-align: right;\n    cursor: pointer;\n    z-index: 10;\n    padding: 13px 21px 13px 13px;\n    max-width: 50%;\n}\n\n.fluid_ad_cta.left {\n    text-align: left;\n}\n\n.fluid_ad_cta a {\n    text-decoration: none;\n    color: #ffffff;\n    line-height: 18px;\n}\n\n.fluid_ad_cta:hover,\n.skip_button:not(.skip_button_disabled):hover {\n    background-color: rgba(0, 0, 0, 1);\n}\n\n.fluid_html_on_pause,\n.fluid_pseudo_poster {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    margin: auto;\n    z-index: 0;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    pointer-events: none;\n}\n\n.fluid_html_on_pause * {\n    pointer-events: auto;\n}\n\n/*Mobile Layout*/\n.fluid_video_wrapper.mobile .skip_button {\n    bottom: 50px;\n}\n\n/*\n.fluid_video_wrapper.mobile .fluid_ad_cta {\n        bottom: 125px;\n}\n*/\n.fluid_initial_play {\n    width: 60px;\n    height: 60px;\n    border-radius: 50px;\n    cursor: pointer;\n}\n\n.fluid_initial_play_button {\n    margin-top: 15px;\n    margin-left: 23px;\n    border-style: solid;\n    border-width: 15px 0 15px 21px;\n    border-color: transparent transparent transparent #ffffff;\n}\n\n.fluid_initial_pause_button {\n    margin-top: 15px;\n    margin-left: 17px;\n    width: 8px;\n    height: 31px;\n    border: 9px solid white;\n    border-top: 0;\n    border-bottom: 0;\n}\n\n.fluid_timeline_preview {\n    bottom: 11px;\n    color: #ffffff;\n    font-size: 13px;\n    line-height: 18px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    text-align: start;\n    padding: 13px 21px 13px 21px;\n    background-color: rgba(0, 0, 0, 0.85);\n    border-radius: 1px;\n}\n\n/* Duration */\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration {\n    display: inline-block;\n    position: absolute;\n    left: 32px;\n    height: 24px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-size: 13px;\n    font-weight: normal;\n    font-style: normal;\n    text-align: left;\n    text-decoration: none;\n    line-height: 21px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration.cardboard_time {\n    left: 13px;\n    top: -15px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration.cardboard_time .ad_timer_prefix {\n    color: #F2C94C;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .ad_countdown .ad_timer_prefix {\n    color: #F2C94C;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .ad_countdown {\n    /*display: none;*/\n    position: absolute;\n    right: 0;\n    width: 75px;\n    bottom: 5px;\n    height: 24px;\n    color: red;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-size: 13px;\n    font-weight: normal;\n    font-style: normal;\n    text-align: left;\n    text-decoration: none;\n    line-height: 21px;\n}\n\n.initial_controls_show {\n    visibility: visible !important;\n    opacity: 1 !important;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container {\n    color: white;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: -moz-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* FF3.6-15 */\n    background: -webkit-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* Chrome10-25,Safari5.1-6 */\n    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#ad000000', GradientType=0); /* IE6-9 */\n    height: 100%;\n    width: 100%;\n    z-index: 0;\n    pointer-events: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel {\n    height: 96px;\n    width: 72px;\n    left: 10px;\n    top: 10px;\n    position: absolute;\n    background: rgba(0, 0, 0, 0.7);\n    text-align: center;\n    border-radius: 6px;\n    overflow: hidden;\n    pointer-events: auto;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_button {\n    cursor: pointer;\n    display: inline-block;\n    text-align: left;\n    height: 24px;\n    width: 24px;\n    position: relative;\n    background: url("+g+") no-repeat;\n    opacity: 0.8;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_button:hover {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_up {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(270deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(270deg); /* IE 9 */\n    transform: rotate(270deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    left: calc(50% - 12px);\n    top: 0;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_left {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(180deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(1890deg); /* IE 9 */\n    transform: rotate(180deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    left: 0;\n    top: 24px;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_right {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    right: 0;\n    top: 24px;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_down {\n    background-position: -336px -55px;\n    -webkit-transform: rotate(90deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(90deg); /* IE 9 */\n    transform: rotate(90deg); /* Firefox 16+, IE 10+, Opera  */\n    display: block;\n    left: calc(50% - 12px);\n    top: 48px;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_zoomdefault {\n    background-position: -336px -17px;\n    top: 72px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    position: absolute;\n    left: calc(50% - 12px);\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_zoomin {\n    background-position: -305px -55px;\n    top: 72px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    position: absolute;\n    right: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vr_container .fluid_vr_joystick_panel .fluid_vr_joystick_zoomout {\n    background-position: -305px -17px;\n    top: 72px;\n    -webkit-transform: rotate(0deg); /* Chrome, Opera 15+, Safari 3.1+ */\n    -ms-transform: rotate(0deg); /* IE 9 */\n    transform: rotate(0deg); /* Firefox 16+, IE 10+, Opera  */\n    position: absolute;\n    left: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.fluid_vr_controls_container {\n    width: 50% !important;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.fluid_vr2_controls_container {\n    width: 50% !important;\n    left: 50%;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container {\n    color: white;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: -moz-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* FF3.6-15 */\n    background: -webkit-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* Chrome10-25,Safari5.1-6 */\n    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.6) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#ad000000', GradientType=0); /* IE6-9 */\n    height: 53px;\n    z-index: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vpaid_iframe {\n    position: absolute;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    left: 0;\n    z-index: -10;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vpaid_nonlinear_slot_iframe {\n    z-index: 30;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_vpaid_slot {\n    position: absolute !important;\n    top: 0 !important;\n    width: 100% !important;\n    height: 100% !important;\n    left: 0 !important;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_subtitles_container {\n    color: white;\n    position: absolute;\n    bottom: 46px;\n    left: 0;\n    right: 0;\n    height: auto;\n    z-index: 1;\n    text-align: center;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_subtitles_container div {\n    display: inline;\n    background: black;\n    color: white;\n    font-size: 1em;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    padding: 0.25em;\n    border-radius: 4px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fade_out {\n    visibility: hidden;\n    opacity: 0;\n    -webkit-transition: visibility 0.5s, opacity 0.5s; /* Safari */\n    transition: visibility 0.5s, opacity 0.5s;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fade_in {\n    visibility: visible;\n    opacity: 1;\n    -webkit-transition: visibility 0.5s, opacity 0.5s; /* Safari */\n    transition: visibility 0.5s, opacity 0.5s;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default.pseudo_fullscreen {\n    width: 100% !important;\n    height: 100% !important;\n    top: 0;\n    left: 0;\n    position: fixed;\n    z-index: 99999;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default:-webkit-full-screen {\n    width: 100% !important;\n    height: 100% !important;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default:-ms-fullscreen {\n    width: 100% !important;\n    height: 100% !important;\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu {\n    background-color: #000000;\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n    z-index: 11;\n    opacity: 0.8;\n    border-radius: 1px;\n}\n\n/* IE 10+ */\n_:-ms-lang(x),\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu {\n    text-align: left;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul li {\n    padding: 13px 71px 13px 21px;\n    cursor: pointer;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul li + li {\n    border-top: 1px solid #000000;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_context_menu ul li:hover {\n    background-color: #1e1e1e;\n    color: #fbfaff;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_left {\n    width: 24px;\n    left: 20px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.skip_controls .fluid_controls_left {\n    width: 80px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button {\n    width: 24px;\n    height: 24px;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right {\n    left: 60px;\n    right: 20px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.skip_controls .fluid_controls_right {\n    left: 110px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_left,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right {\n    position: absolute;\n    height: 24px;\n    top: 23px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container {\n    height: 14px;\n    position: absolute;\n    left: 13px;\n    right: 13px;\n    z-index: 1;\n    top: 8px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress {\n    position: absolute;\n    top: 5px;\n    width: 100%;\n    height: 4px;\n    background-color: rgba(255, 255, 255, 0.25);\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_buffered {\n    position: absolute;\n    top: 5px;\n    width: 0;\n    height: 3px;\n    background-color: rgba(255, 255, 255, 0.5);\n    z-index: -1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentprogress {\n    position: absolute;\n    height: 3px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_progress,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_buffered,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_ad_markers_holder {\n    margin-top: -1px;\n    height: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container:hover .fluid_controls_progress .fluid_controls_currentprogress {\n    height: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_timeline_preview_container {\n    border: 1px solid #262626;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_timeline_preview_container, .fluid_timeline_preview_container_shadow {\n    bottom: 14px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    background-color: white;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_ad_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    opacity: 0;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider:hover .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container.fluid_slider .fluid_controls_progress .fluid_controls_currentprogress .fluid_controls_currentpos {\n    -webkit-transition: opacity 0.3s; /* Safari */\n    transition: opacity 0.3s;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_ad_markers_holder {\n    position: absolute;\n    top: 5px;\n    width: 100%;\n    height: 3px;\n    z-index: 2;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_ad_marker {\n    position: absolute;\n    background-color: #FFCC00;\n    height: 100%;\n    width: 6px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container {\n    height: 24px;\n    width: 56px;\n    left: 25px;\n    top: -1px;\n    z-index: 2;\n    opacity: 0.8;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container:hover {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume {\n    position: relative;\n    height: 3px;\n    width: 100%;\n    margin-top: 10px;\n    background-color: rgba(171, 172, 172, 0.68);\n    z-index: 3;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume .fluid_control_currentvolume {\n    float: left;\n    background-color: white;\n    height: 3px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume .fluid_control_currentvolume .fluid_control_volume_currentpos {\n    background-color: white;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentpos {\n    right: -4px;\n    z-index: 3;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container .fluid_control_volume .fluid_control_currentvolume .fluid_control_volume_currentpos,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentpos {\n    width: 11px;\n    height: 11px;\n    position: absolute;\n    top: -4px;\n    border-radius: 6px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_progress_container .fluid_controls_progress .fluid_controls_currentpos {\n    width: 13px;\n    height: 13px;\n    position: absolute;\n    top: -4px;\n    border-radius: 6px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.no_volume_bar .fluid_controls_right .fluid_control_volume_container {\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_slider {\n    cursor: pointer;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container div div {\n    display: block;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_fullscreen,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_fullscreen_exit,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_mini_player {\n    float: right;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_cardboard {\n    font-size: 13px;\n    height: 24px;\n    line-height: 24px;\n    float: right;\n    cursor: pointer;\n    position: relative;\n    text-align: right;\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_title,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_title {\n    width: 80px;\n    overflow: hidden;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_video_playback_rates {\n    position: absolute;\n    bottom: 25px;\n    right: 3px;\n    z-index: 888888;\n    opacity: 99%;\n    background-color: rgba(0, 0, 0, 1);\n    border-radius: 2px;\n    color: #ffffff;\n    font-size: 13px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n    text-align: start;\n    width: max-content;\n    padding: 0.5em;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list .fluid_subtitle_list_item,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list .fluid_video_source_list_item {\n    padding: 12px 34px 12px 24px;\n    line-height: 15px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list .fluid_video_source_list_item:hover,\n.fluid_video_playback_rates_item:hover,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list .fluid_subtitle_list_item:hover {\n    background-color: #3a3a3a;\n}\n\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_volume,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_mute {\n    position: absolute;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_volume,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button.fluid_button_mute {\n    left: -10px;\n}\n\n/* Button Icons */\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mini_player {\n    display: inline-block;\n    text-align: left;\n    height: 24px;\n    width: 24px;\n    position: relative;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mini_player:before{\n    background: url("+g+') no-repeat;\n    position: absolute;\n    height: 24px;\n    width: 24px;\n    top: 1px;\n    left: 5px;\n    content: "";\n    opacity: 0.8;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play:before {\n    background-position: -15px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause:before {\n    background-position: -15px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume:before {\n    background-position: -52px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute:before {\n    background-position: -52px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen:before {\n    background-position: -88px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit:before {\n    background-position: -88px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source:before {\n    background-position: -122px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate:before {\n    background-position: -232px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download:before {\n    background-position: -194px -18px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre:before {\n    background-position: -195px -56px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles:before {\n    background-position: -269px -19px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard:before {\n    background-position: -269px -56px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back:before {\n    background: url('+v+") no-repeat;\n    background-position: -2px -2px;\n}\n\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward:before {\n    background: url("+b+") no-repeat;\n    background-position: -2px -2px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mini_player:before {\n    background: url("+_+") no-repeat 0 0;\n    background-size: 20px;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode .fluid_controls_container .fluid_button.fluid_button_mini_player:before {\n    background: url("+E+") no-repeat 0 0;\n    background-size: 20px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back {\n    margin-left: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen_exit:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_fullscreen:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mute:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_volume:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_pause:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_play:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_back:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_skip_forward:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard:hover:before,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_mini_player:hover:before {\n    opacity: 1;\n}\n\n.fp_title {\n    position: absolute;\n    top: 10px;\n    left: 10px;\n    color: #ffffff;\n    font-size: 15px;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    font-weight: normal;\n    white-space: nowrap;\n}\n\n/* Pulse class and keyframe animation */\n.transform-active {\n    animation: flash 1s infinite;\n    display: inline-block !important;\n    opacity: 0;\n}\n\n@-webkit-keyframes flash {\n    0% {\n        opacity: 0.6;\n        -webkit-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.5);\n    }\n    70% {\n        -webkit-box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);\n    }\n    100% {\n        opacity: 0;\n        display: none;\n        -webkit-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n    }\n}\n\n@keyframes flash {\n    0% {\n        opacity: 0.6;\n        -moz-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.5);\n        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.6);\n    }\n    70% {\n        -moz-box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);\n        box-shadow: 0 0 0 20px rgba(255, 255, 255, 0);\n    }\n    100% {\n        opacity: 0;\n        display: none;\n        -moz-box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n        box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);\n    }\n}\n\n.fluid_nonLinear_top, .fluid_nonLinear_middle, .fluid_nonLinear_bottom {\n    flex-direction: column;\n    align-items: center;\n    cursor: pointer;\n    display: flex;\n    vertical-align: middle;\n    align-content: center;\n    border: 1px solid #777777;\n    position: absolute;\n    left: 50%;\n    margin-right: -50%;\n    background-color: rgba(0, 0, 0, 0.7);\n}\n\n.fluid_nonLinear_top {\n    top: 20px;\n    transform: translate(-50%);\n}\n\n.fluid_nonLinear_middle {\n    top: 50%;\n    transform: translate(-50%, -50%);\n}\n\n.fluid_nonLinear_bottom {\n    bottom: 50px;\n    transform: translate(-50%);\n}\n\n.fluid_vpaidNonLinear_top, .fluid_vpaidNonLinear_middle, .fluid_vpaidNonLinear_bottom {\n    flex-direction: column;\n    align-items: center;\n    cursor: pointer;\n    vertical-align: middle;\n    align-content: center;\n    position: absolute;\n    display: flex;\n}\n\n.fluid_vpaidNonLinear_frame {\n    margin: auto;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fluid_vpaidNonLinear_top {\n    top: 20px;\n}\n\n.fluid_vpaidNonLinear_middle {\n    top: 50%;\n}\n\n.fluid_vpaidNonLinear_bottom {\n    bottom: 50px;\n}\n\n.add_icon_clickthrough {\n    color: #F2C94C;\n    line-height: 18px;\n    text-overflow: ellipsis;\n    max-width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n    display: inline-block;\n}\n\n.add_icon_clickthrough:before {\n    background: url("+g+') no-repeat;\n    height: 18px;\n    width: 18px;\n    top: 30px;\n    padding: 3px 22px 0 0;\n    content: "";\n    background-position: -162px -57px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard {\n    float: right;\n    padding-right: 5px;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_theatre,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_playback_rate,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_video_source,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_download,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_subtitles,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_button.fluid_button_cardboard {\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_subtitles .fluid_subtitles_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_button_video_source .fluid_video_sources_list,\n.fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_video_playback_rates {\n    z-index: 888888 !important;\n    opacity: 0.9 !important;\n}\n\n.fluid_video_playback_rates_item {\n    padding: 9px 25px 9px 25px;\n    line-height: 15px;\n    text-align: center;\n}\n\n.fluid_theatre_mode {\n    position: fixed;\n    float: left;\n    top: 0;\n    z-index: 10;\n    box-shadow: 0px 15px 25px rgba(0, 0, 0, 0.8);\n}\n\n.fluid_mini_player_mode {\n    position: fixed;\n    bottom: 10px;\n    right: 10px;\n    z-index: 10;\n}\n\n.source_button_icon {\n    background: url('+g+") no-repeat;\n    float: left;\n    cursor: pointer;\n    height: 18px;\n    width: 18px;\n    background-position: -164px -21px;\n    opacity: 0;\n}\n\n.subtitle_button_icon {\n    background: url("+g+") no-repeat;\n    float: left;\n    cursor: pointer;\n    height: 18px;\n    width: 18px;\n    background-position: -164px -21px;\n    opacity: 0;\n}\n\n.source_selected {\n    opacity: 1 !important;\n}\n\n.subtitle_selected {\n    opacity: 1 !important;\n}\n\n@media only screen and (min-device-width: 375px) {\n    .fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_fluid_control_duration {\n        left: 105px;\n    }\n\n    .fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container.no_volume_bar .fluid_fluid_control_duration {\n        left: 32px;\n    }\n\n    .fluid_video_wrapper.fluid_player_layout_default .fluid_controls_container .fluid_controls_right .fluid_control_volume_container {\n        display: block;\n    }\n}\n\n.fp_logo {\n    visibility: hidden;\n    opacity: 0;\n    -webkit-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    -moz-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    -ms-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    -o-transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n    transition: visibility 0.3s ease-in-out, opacity 0.3s ease-in-out;\n}\n\n.fp_hd_source::before {\n    font-weight: bolder;\n    font-size: 6pt;\n    content: 'HD';\n    padding-left: 3px;\n}\n\n/** MiniPlayer */\n\n.fluid_video_wrapper.fluid_player_layout_default .mini-player-close-button-wrapper {\n    display: none;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode .mini-player-close-button-wrapper {\n    position: absolute;\n    background: rgb(0,0,0);\n    background: linear-gradient(45deg, rgba(0,0,0,0) 90%, rgba(0,0,0,0.6) 110%);\n    height: 100%;\n    width: 100%;\n    top: 0;\n    right: 0;\n    z-index: 31;\n    display: block;\n    opacity: 0;\n    -webkit-transition: opacity 0.3s ease-in-out;\n    -moz-transition: opacity 0.3s ease-in-out;\n    -ms-transition: opacity 0.3s ease-in-out;\n    -o-transition: opacity 0.3s ease-in-out;\n    transition: opacity 0.3s ease-in-out;\n    pointer-events: none;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode .mini-player-close-button {\n    position: absolute;\n    background: transparent url("+y+") no-repeat scroll center center;\n    height: 22px;\n    width: 22px;\n    top: 6px;\n    right: 6px;\n    background-size: 22px;\n    cursor: pointer;\n    z-index: 32;\n    display: block;\n    pointer-events: all;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode:hover .mini-player-close-button-wrapper {\n    opacity: 1;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode .disable-mini-player-mobile {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: none;\n}\n\n.fluidplayer-miniplayer-player-placeholder {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: #fff;\n    font-size: 1.5rem;\n    font-family: -apple-system, BlinkMacSystemFont, 'segoe ui', roboto, oxygen-sans, ubuntu, cantarell, 'helvetica neue', 'arial', sans-serif, 'apple color emoji', 'segoe ui emoji', 'segoe ui symbol';\n    background: #000 url("+_+") no-repeat 50% calc(50% - 48px);\n    background-size: 48px;\n    cursor: pointer;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode.fluid_video_wrapper.fluid_mini_player_mode--top-left {\n    top: 10px;\n    left: 10px;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode.fluid_video_wrapper.fluid_mini_player_mode--top-right {\n    top: 10px;\n    right: 10px;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode.fluid_video_wrapper.fluid_mini_player_mode--bottom-left {\n    bottom: 10px;\n    left: 10px;\n}\n\n.fluid_video_wrapper.fluid_mini_player_mode.fluid_video_wrapper.fluid_mini_player_mode--bottom-right {\n    bottom: 10px;\n    right: 10px;\n}\n\n@media screen and (max-width: 768px) {\n    .fluid_video_wrapper.fluid_mini_player_mode > *:not(video, .ad_countdown, .fluid_nonLinear_ad, .disable-mini-player-mobile) {\n        display: none;\n    }\n\n    .fluid_video_wrapper.fluid_mini_player_mode .fluid_nonLinear_ad {\n        z-index: 100;\n    }\n\n    .fluid_video_wrapper.fluid_mini_player_mode .fluid_nonLinear_bottom {\n        bottom: 16px;\n    }\n\n    .fluid_video_wrapper.fluid_mini_player_mode .fluid_nonLinear_top {\n        top: 16px;\n    }\n\n    .fluid_video_wrapper.fluid_mini_player_mode .ad_countdown {\n        display: inline-block !important;\n    }\n\n    .fluid_video_wrapper.fluid_mini_player_mode .disable-mini-player-mobile {\n        display: block;\n        touch-action: none;\n    }\n\n    .fluidplayer-miniplayer-player-placeholder {\n        font-size: 1.25rem !important;\n        background-size: 32px !important;\n        background-position-y: calc(50% - 32px) !important;\n    }\n}\n\n.fluid_video_wrapper .fluid_player_skip_offset {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    pointer-events: none;\n}\n\n.fluid_video_wrapper .fluid_player_skip_offset__backward {\n    display: flex;\n    align-items: center;\n    margin: 10% 10% 10% 0;\n}\n\n.fluid_video_wrapper .fluid_player_skip_offset__backward-icon {\n    background: rgba(0, 0, 0, .5) url("+v+") no-repeat -2px 3px;\n    width: 150px;\n    height: 150px;\n    background-size: contain;\n    opacity: 0;\n    transition: opacity 400ms ease-in;\n    border-radius: 150px;\n    margin-left: 20%;\n    pointer-events: none;\n    background-origin: content-box;\n    padding: 10px;\n}\n\n.fluid_video_wrapper .fluid_player_skip_offset__forward {\n    display: flex;\n    align-items: center;\n    flex-direction: row-reverse;\n    margin: 10% 0 10% 10%;\n}\n\n.fluid_video_wrapper .fluid_player_skip_offset__forward-icon {\n    background: rgba(0, 0, 0, .5) url("+b+") no-repeat -2px 3px;\n    width: 150px;\n    height: 150px;\n    background-size: cover;\n    opacity: 0;\n    transition: opacity 400ms ease-in;\n    border-radius: 150px;\n    margin-right: 20%;\n    pointer-events: none;\n    background-origin: content-box;\n    padding: 10px;\n}\n\n.fluid_video_wrapper .fluid_player_skip_offset__backward-icon.animate,\n.fluid_video_wrapper .fluid_player_skip_offset__forward-icon.animate {\n    opacity: 1;\n    transition: opacity 150ms ease-out;\n}\n\n@media screen and (max-width: 768px) {\n    .fluid_video_wrapper .fluid_player_skip_offset__backward-icon,\n    .fluid_video_wrapper .fluid_player_skip_offset__forward-icon {\n        width: 50px;\n        height: 50px;\n        border-radius: 50px;\n        background-position-x: 0;\n        background-position-y: 0;\n        padding: 5px;\n    }\n}\n",""]);const w=f},5506:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(3645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,"/*!\nPure v3.0.0\nCopyright 2013 Yahoo!\nLicensed under the BSD License.\nhttps://github.com/pure-css/pure/blob/master/LICENSE\n*/\n/*!\nnormalize.css v | MIT License | https://necolas.github.io/normalize.css/\nCopyright (c) Nicolas Gallagher and Jonathan Neal\n*/\n/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}html{font-family:sans-serif}.hidden,[hidden]{display:none!important}.pure-img{max-width:100%;height:auto;display:block}",""]);const o=i},6998:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(3645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,"/*!\nPure v3.0.0\nCopyright 2013 Yahoo!\nLicensed under the BSD License.\nhttps://github.com/pure-css/pure/blob/master/LICENSE\n*/\n.pure-g{display:flex;flex-flow:row wrap;align-content:flex-start}.pure-u{display:inline-block;vertical-align:top}.pure-u-1,.pure-u-1-1,.pure-u-1-12,.pure-u-1-2,.pure-u-1-24,.pure-u-1-3,.pure-u-1-4,.pure-u-1-5,.pure-u-1-6,.pure-u-1-8,.pure-u-10-24,.pure-u-11-12,.pure-u-11-24,.pure-u-12-24,.pure-u-13-24,.pure-u-14-24,.pure-u-15-24,.pure-u-16-24,.pure-u-17-24,.pure-u-18-24,.pure-u-19-24,.pure-u-2-24,.pure-u-2-3,.pure-u-2-5,.pure-u-20-24,.pure-u-21-24,.pure-u-22-24,.pure-u-23-24,.pure-u-24-24,.pure-u-3-24,.pure-u-3-4,.pure-u-3-5,.pure-u-3-8,.pure-u-4-24,.pure-u-4-5,.pure-u-5-12,.pure-u-5-24,.pure-u-5-5,.pure-u-5-6,.pure-u-5-8,.pure-u-6-24,.pure-u-7-12,.pure-u-7-24,.pure-u-7-8,.pure-u-8-24,.pure-u-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-1-24{width:4.1667%}.pure-u-1-12,.pure-u-2-24{width:8.3333%}.pure-u-1-8,.pure-u-3-24{width:12.5%}.pure-u-1-6,.pure-u-4-24{width:16.6667%}.pure-u-1-5{width:20%}.pure-u-5-24{width:20.8333%}.pure-u-1-4,.pure-u-6-24{width:25%}.pure-u-7-24{width:29.1667%}.pure-u-1-3,.pure-u-8-24{width:33.3333%}.pure-u-3-8,.pure-u-9-24{width:37.5%}.pure-u-2-5{width:40%}.pure-u-10-24,.pure-u-5-12{width:41.6667%}.pure-u-11-24{width:45.8333%}.pure-u-1-2,.pure-u-12-24{width:50%}.pure-u-13-24{width:54.1667%}.pure-u-14-24,.pure-u-7-12{width:58.3333%}.pure-u-3-5{width:60%}.pure-u-15-24,.pure-u-5-8{width:62.5%}.pure-u-16-24,.pure-u-2-3{width:66.6667%}.pure-u-17-24{width:70.8333%}.pure-u-18-24,.pure-u-3-4{width:75%}.pure-u-19-24{width:79.1667%}.pure-u-4-5{width:80%}.pure-u-20-24,.pure-u-5-6{width:83.3333%}.pure-u-21-24,.pure-u-7-8{width:87.5%}.pure-u-11-12,.pure-u-22-24{width:91.6667%}.pure-u-23-24{width:95.8333%}.pure-u-1,.pure-u-1-1,.pure-u-24-24,.pure-u-5-5{width:100%}",""]);const o=i},1211:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(3645),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,"/*!\nPure v3.0.0\nCopyright 2013 Yahoo!\nLicensed under the BSD License.\nhttps://github.com/pure-css/pure/blob/master/LICENSE\n*/\n@media screen and (min-width:35.5em){.pure-u-sm-1,.pure-u-sm-1-1,.pure-u-sm-1-12,.pure-u-sm-1-2,.pure-u-sm-1-24,.pure-u-sm-1-3,.pure-u-sm-1-4,.pure-u-sm-1-5,.pure-u-sm-1-6,.pure-u-sm-1-8,.pure-u-sm-10-24,.pure-u-sm-11-12,.pure-u-sm-11-24,.pure-u-sm-12-24,.pure-u-sm-13-24,.pure-u-sm-14-24,.pure-u-sm-15-24,.pure-u-sm-16-24,.pure-u-sm-17-24,.pure-u-sm-18-24,.pure-u-sm-19-24,.pure-u-sm-2-24,.pure-u-sm-2-3,.pure-u-sm-2-5,.pure-u-sm-20-24,.pure-u-sm-21-24,.pure-u-sm-22-24,.pure-u-sm-23-24,.pure-u-sm-24-24,.pure-u-sm-3-24,.pure-u-sm-3-4,.pure-u-sm-3-5,.pure-u-sm-3-8,.pure-u-sm-4-24,.pure-u-sm-4-5,.pure-u-sm-5-12,.pure-u-sm-5-24,.pure-u-sm-5-5,.pure-u-sm-5-6,.pure-u-sm-5-8,.pure-u-sm-6-24,.pure-u-sm-7-12,.pure-u-sm-7-24,.pure-u-sm-7-8,.pure-u-sm-8-24,.pure-u-sm-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-sm-1-24{width:4.1667%}.pure-u-sm-1-12,.pure-u-sm-2-24{width:8.3333%}.pure-u-sm-1-8,.pure-u-sm-3-24{width:12.5%}.pure-u-sm-1-6,.pure-u-sm-4-24{width:16.6667%}.pure-u-sm-1-5{width:20%}.pure-u-sm-5-24{width:20.8333%}.pure-u-sm-1-4,.pure-u-sm-6-24{width:25%}.pure-u-sm-7-24{width:29.1667%}.pure-u-sm-1-3,.pure-u-sm-8-24{width:33.3333%}.pure-u-sm-3-8,.pure-u-sm-9-24{width:37.5%}.pure-u-sm-2-5{width:40%}.pure-u-sm-10-24,.pure-u-sm-5-12{width:41.6667%}.pure-u-sm-11-24{width:45.8333%}.pure-u-sm-1-2,.pure-u-sm-12-24{width:50%}.pure-u-sm-13-24{width:54.1667%}.pure-u-sm-14-24,.pure-u-sm-7-12{width:58.3333%}.pure-u-sm-3-5{width:60%}.pure-u-sm-15-24,.pure-u-sm-5-8{width:62.5%}.pure-u-sm-16-24,.pure-u-sm-2-3{width:66.6667%}.pure-u-sm-17-24{width:70.8333%}.pure-u-sm-18-24,.pure-u-sm-3-4{width:75%}.pure-u-sm-19-24{width:79.1667%}.pure-u-sm-4-5{width:80%}.pure-u-sm-20-24,.pure-u-sm-5-6{width:83.3333%}.pure-u-sm-21-24,.pure-u-sm-7-8{width:87.5%}.pure-u-sm-11-12,.pure-u-sm-22-24{width:91.6667%}.pure-u-sm-23-24{width:95.8333%}.pure-u-sm-1,.pure-u-sm-1-1,.pure-u-sm-24-24,.pure-u-sm-5-5{width:100%}}@media screen and (min-width:48em){.pure-u-md-1,.pure-u-md-1-1,.pure-u-md-1-12,.pure-u-md-1-2,.pure-u-md-1-24,.pure-u-md-1-3,.pure-u-md-1-4,.pure-u-md-1-5,.pure-u-md-1-6,.pure-u-md-1-8,.pure-u-md-10-24,.pure-u-md-11-12,.pure-u-md-11-24,.pure-u-md-12-24,.pure-u-md-13-24,.pure-u-md-14-24,.pure-u-md-15-24,.pure-u-md-16-24,.pure-u-md-17-24,.pure-u-md-18-24,.pure-u-md-19-24,.pure-u-md-2-24,.pure-u-md-2-3,.pure-u-md-2-5,.pure-u-md-20-24,.pure-u-md-21-24,.pure-u-md-22-24,.pure-u-md-23-24,.pure-u-md-24-24,.pure-u-md-3-24,.pure-u-md-3-4,.pure-u-md-3-5,.pure-u-md-3-8,.pure-u-md-4-24,.pure-u-md-4-5,.pure-u-md-5-12,.pure-u-md-5-24,.pure-u-md-5-5,.pure-u-md-5-6,.pure-u-md-5-8,.pure-u-md-6-24,.pure-u-md-7-12,.pure-u-md-7-24,.pure-u-md-7-8,.pure-u-md-8-24,.pure-u-md-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-md-1-24{width:4.1667%}.pure-u-md-1-12,.pure-u-md-2-24{width:8.3333%}.pure-u-md-1-8,.pure-u-md-3-24{width:12.5%}.pure-u-md-1-6,.pure-u-md-4-24{width:16.6667%}.pure-u-md-1-5{width:20%}.pure-u-md-5-24{width:20.8333%}.pure-u-md-1-4,.pure-u-md-6-24{width:25%}.pure-u-md-7-24{width:29.1667%}.pure-u-md-1-3,.pure-u-md-8-24{width:33.3333%}.pure-u-md-3-8,.pure-u-md-9-24{width:37.5%}.pure-u-md-2-5{width:40%}.pure-u-md-10-24,.pure-u-md-5-12{width:41.6667%}.pure-u-md-11-24{width:45.8333%}.pure-u-md-1-2,.pure-u-md-12-24{width:50%}.pure-u-md-13-24{width:54.1667%}.pure-u-md-14-24,.pure-u-md-7-12{width:58.3333%}.pure-u-md-3-5{width:60%}.pure-u-md-15-24,.pure-u-md-5-8{width:62.5%}.pure-u-md-16-24,.pure-u-md-2-3{width:66.6667%}.pure-u-md-17-24{width:70.8333%}.pure-u-md-18-24,.pure-u-md-3-4{width:75%}.pure-u-md-19-24{width:79.1667%}.pure-u-md-4-5{width:80%}.pure-u-md-20-24,.pure-u-md-5-6{width:83.3333%}.pure-u-md-21-24,.pure-u-md-7-8{width:87.5%}.pure-u-md-11-12,.pure-u-md-22-24{width:91.6667%}.pure-u-md-23-24{width:95.8333%}.pure-u-md-1,.pure-u-md-1-1,.pure-u-md-24-24,.pure-u-md-5-5{width:100%}}@media screen and (min-width:64em){.pure-u-lg-1,.pure-u-lg-1-1,.pure-u-lg-1-12,.pure-u-lg-1-2,.pure-u-lg-1-24,.pure-u-lg-1-3,.pure-u-lg-1-4,.pure-u-lg-1-5,.pure-u-lg-1-6,.pure-u-lg-1-8,.pure-u-lg-10-24,.pure-u-lg-11-12,.pure-u-lg-11-24,.pure-u-lg-12-24,.pure-u-lg-13-24,.pure-u-lg-14-24,.pure-u-lg-15-24,.pure-u-lg-16-24,.pure-u-lg-17-24,.pure-u-lg-18-24,.pure-u-lg-19-24,.pure-u-lg-2-24,.pure-u-lg-2-3,.pure-u-lg-2-5,.pure-u-lg-20-24,.pure-u-lg-21-24,.pure-u-lg-22-24,.pure-u-lg-23-24,.pure-u-lg-24-24,.pure-u-lg-3-24,.pure-u-lg-3-4,.pure-u-lg-3-5,.pure-u-lg-3-8,.pure-u-lg-4-24,.pure-u-lg-4-5,.pure-u-lg-5-12,.pure-u-lg-5-24,.pure-u-lg-5-5,.pure-u-lg-5-6,.pure-u-lg-5-8,.pure-u-lg-6-24,.pure-u-lg-7-12,.pure-u-lg-7-24,.pure-u-lg-7-8,.pure-u-lg-8-24,.pure-u-lg-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-lg-1-24{width:4.1667%}.pure-u-lg-1-12,.pure-u-lg-2-24{width:8.3333%}.pure-u-lg-1-8,.pure-u-lg-3-24{width:12.5%}.pure-u-lg-1-6,.pure-u-lg-4-24{width:16.6667%}.pure-u-lg-1-5{width:20%}.pure-u-lg-5-24{width:20.8333%}.pure-u-lg-1-4,.pure-u-lg-6-24{width:25%}.pure-u-lg-7-24{width:29.1667%}.pure-u-lg-1-3,.pure-u-lg-8-24{width:33.3333%}.pure-u-lg-3-8,.pure-u-lg-9-24{width:37.5%}.pure-u-lg-2-5{width:40%}.pure-u-lg-10-24,.pure-u-lg-5-12{width:41.6667%}.pure-u-lg-11-24{width:45.8333%}.pure-u-lg-1-2,.pure-u-lg-12-24{width:50%}.pure-u-lg-13-24{width:54.1667%}.pure-u-lg-14-24,.pure-u-lg-7-12{width:58.3333%}.pure-u-lg-3-5{width:60%}.pure-u-lg-15-24,.pure-u-lg-5-8{width:62.5%}.pure-u-lg-16-24,.pure-u-lg-2-3{width:66.6667%}.pure-u-lg-17-24{width:70.8333%}.pure-u-lg-18-24,.pure-u-lg-3-4{width:75%}.pure-u-lg-19-24{width:79.1667%}.pure-u-lg-4-5{width:80%}.pure-u-lg-20-24,.pure-u-lg-5-6{width:83.3333%}.pure-u-lg-21-24,.pure-u-lg-7-8{width:87.5%}.pure-u-lg-11-12,.pure-u-lg-22-24{width:91.6667%}.pure-u-lg-23-24{width:95.8333%}.pure-u-lg-1,.pure-u-lg-1-1,.pure-u-lg-24-24,.pure-u-lg-5-5{width:100%}}@media screen and (min-width:80em){.pure-u-xl-1,.pure-u-xl-1-1,.pure-u-xl-1-12,.pure-u-xl-1-2,.pure-u-xl-1-24,.pure-u-xl-1-3,.pure-u-xl-1-4,.pure-u-xl-1-5,.pure-u-xl-1-6,.pure-u-xl-1-8,.pure-u-xl-10-24,.pure-u-xl-11-12,.pure-u-xl-11-24,.pure-u-xl-12-24,.pure-u-xl-13-24,.pure-u-xl-14-24,.pure-u-xl-15-24,.pure-u-xl-16-24,.pure-u-xl-17-24,.pure-u-xl-18-24,.pure-u-xl-19-24,.pure-u-xl-2-24,.pure-u-xl-2-3,.pure-u-xl-2-5,.pure-u-xl-20-24,.pure-u-xl-21-24,.pure-u-xl-22-24,.pure-u-xl-23-24,.pure-u-xl-24-24,.pure-u-xl-3-24,.pure-u-xl-3-4,.pure-u-xl-3-5,.pure-u-xl-3-8,.pure-u-xl-4-24,.pure-u-xl-4-5,.pure-u-xl-5-12,.pure-u-xl-5-24,.pure-u-xl-5-5,.pure-u-xl-5-6,.pure-u-xl-5-8,.pure-u-xl-6-24,.pure-u-xl-7-12,.pure-u-xl-7-24,.pure-u-xl-7-8,.pure-u-xl-8-24,.pure-u-xl-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-xl-1-24{width:4.1667%}.pure-u-xl-1-12,.pure-u-xl-2-24{width:8.3333%}.pure-u-xl-1-8,.pure-u-xl-3-24{width:12.5%}.pure-u-xl-1-6,.pure-u-xl-4-24{width:16.6667%}.pure-u-xl-1-5{width:20%}.pure-u-xl-5-24{width:20.8333%}.pure-u-xl-1-4,.pure-u-xl-6-24{width:25%}.pure-u-xl-7-24{width:29.1667%}.pure-u-xl-1-3,.pure-u-xl-8-24{width:33.3333%}.pure-u-xl-3-8,.pure-u-xl-9-24{width:37.5%}.pure-u-xl-2-5{width:40%}.pure-u-xl-10-24,.pure-u-xl-5-12{width:41.6667%}.pure-u-xl-11-24{width:45.8333%}.pure-u-xl-1-2,.pure-u-xl-12-24{width:50%}.pure-u-xl-13-24{width:54.1667%}.pure-u-xl-14-24,.pure-u-xl-7-12{width:58.3333%}.pure-u-xl-3-5{width:60%}.pure-u-xl-15-24,.pure-u-xl-5-8{width:62.5%}.pure-u-xl-16-24,.pure-u-xl-2-3{width:66.6667%}.pure-u-xl-17-24{width:70.8333%}.pure-u-xl-18-24,.pure-u-xl-3-4{width:75%}.pure-u-xl-19-24{width:79.1667%}.pure-u-xl-4-5{width:80%}.pure-u-xl-20-24,.pure-u-xl-5-6{width:83.3333%}.pure-u-xl-21-24,.pure-u-xl-7-8{width:87.5%}.pure-u-xl-11-12,.pure-u-xl-22-24{width:91.6667%}.pure-u-xl-23-24{width:95.8333%}.pure-u-xl-1,.pure-u-xl-1-1,.pure-u-xl-24-24,.pure-u-xl-5-5{width:100%}}@media screen and (min-width:120em){.pure-u-xxl-1,.pure-u-xxl-1-1,.pure-u-xxl-1-12,.pure-u-xxl-1-2,.pure-u-xxl-1-24,.pure-u-xxl-1-3,.pure-u-xxl-1-4,.pure-u-xxl-1-5,.pure-u-xxl-1-6,.pure-u-xxl-1-8,.pure-u-xxl-10-24,.pure-u-xxl-11-12,.pure-u-xxl-11-24,.pure-u-xxl-12-24,.pure-u-xxl-13-24,.pure-u-xxl-14-24,.pure-u-xxl-15-24,.pure-u-xxl-16-24,.pure-u-xxl-17-24,.pure-u-xxl-18-24,.pure-u-xxl-19-24,.pure-u-xxl-2-24,.pure-u-xxl-2-3,.pure-u-xxl-2-5,.pure-u-xxl-20-24,.pure-u-xxl-21-24,.pure-u-xxl-22-24,.pure-u-xxl-23-24,.pure-u-xxl-24-24,.pure-u-xxl-3-24,.pure-u-xxl-3-4,.pure-u-xxl-3-5,.pure-u-xxl-3-8,.pure-u-xxl-4-24,.pure-u-xxl-4-5,.pure-u-xxl-5-12,.pure-u-xxl-5-24,.pure-u-xxl-5-5,.pure-u-xxl-5-6,.pure-u-xxl-5-8,.pure-u-xxl-6-24,.pure-u-xxl-7-12,.pure-u-xxl-7-24,.pure-u-xxl-7-8,.pure-u-xxl-8-24,.pure-u-xxl-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-xxl-1-24{width:4.1667%}.pure-u-xxl-1-12,.pure-u-xxl-2-24{width:8.3333%}.pure-u-xxl-1-8,.pure-u-xxl-3-24{width:12.5%}.pure-u-xxl-1-6,.pure-u-xxl-4-24{width:16.6667%}.pure-u-xxl-1-5{width:20%}.pure-u-xxl-5-24{width:20.8333%}.pure-u-xxl-1-4,.pure-u-xxl-6-24{width:25%}.pure-u-xxl-7-24{width:29.1667%}.pure-u-xxl-1-3,.pure-u-xxl-8-24{width:33.3333%}.pure-u-xxl-3-8,.pure-u-xxl-9-24{width:37.5%}.pure-u-xxl-2-5{width:40%}.pure-u-xxl-10-24,.pure-u-xxl-5-12{width:41.6667%}.pure-u-xxl-11-24{width:45.8333%}.pure-u-xxl-1-2,.pure-u-xxl-12-24{width:50%}.pure-u-xxl-13-24{width:54.1667%}.pure-u-xxl-14-24,.pure-u-xxl-7-12{width:58.3333%}.pure-u-xxl-3-5{width:60%}.pure-u-xxl-15-24,.pure-u-xxl-5-8{width:62.5%}.pure-u-xxl-16-24,.pure-u-xxl-2-3{width:66.6667%}.pure-u-xxl-17-24{width:70.8333%}.pure-u-xxl-18-24,.pure-u-xxl-3-4{width:75%}.pure-u-xxl-19-24{width:79.1667%}.pure-u-xxl-4-5{width:80%}.pure-u-xxl-20-24,.pure-u-xxl-5-6{width:83.3333%}.pure-u-xxl-21-24,.pure-u-xxl-7-8{width:87.5%}.pure-u-xxl-11-12,.pure-u-xxl-22-24{width:91.6667%}.pure-u-xxl-23-24{width:95.8333%}.pure-u-xxl-1,.pure-u-xxl-1-1,.pure-u-xxl-24-24,.pure-u-xxl-5-5{width:100%}}@media screen and (min-width:160em){.pure-u-xxxl-1,.pure-u-xxxl-1-1,.pure-u-xxxl-1-12,.pure-u-xxxl-1-2,.pure-u-xxxl-1-24,.pure-u-xxxl-1-3,.pure-u-xxxl-1-4,.pure-u-xxxl-1-5,.pure-u-xxxl-1-6,.pure-u-xxxl-1-8,.pure-u-xxxl-10-24,.pure-u-xxxl-11-12,.pure-u-xxxl-11-24,.pure-u-xxxl-12-24,.pure-u-xxxl-13-24,.pure-u-xxxl-14-24,.pure-u-xxxl-15-24,.pure-u-xxxl-16-24,.pure-u-xxxl-17-24,.pure-u-xxxl-18-24,.pure-u-xxxl-19-24,.pure-u-xxxl-2-24,.pure-u-xxxl-2-3,.pure-u-xxxl-2-5,.pure-u-xxxl-20-24,.pure-u-xxxl-21-24,.pure-u-xxxl-22-24,.pure-u-xxxl-23-24,.pure-u-xxxl-24-24,.pure-u-xxxl-3-24,.pure-u-xxxl-3-4,.pure-u-xxxl-3-5,.pure-u-xxxl-3-8,.pure-u-xxxl-4-24,.pure-u-xxxl-4-5,.pure-u-xxxl-5-12,.pure-u-xxxl-5-24,.pure-u-xxxl-5-5,.pure-u-xxxl-5-6,.pure-u-xxxl-5-8,.pure-u-xxxl-6-24,.pure-u-xxxl-7-12,.pure-u-xxxl-7-24,.pure-u-xxxl-7-8,.pure-u-xxxl-8-24,.pure-u-xxxl-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-xxxl-1-24{width:4.1667%}.pure-u-xxxl-1-12,.pure-u-xxxl-2-24{width:8.3333%}.pure-u-xxxl-1-8,.pure-u-xxxl-3-24{width:12.5%}.pure-u-xxxl-1-6,.pure-u-xxxl-4-24{width:16.6667%}.pure-u-xxxl-1-5{width:20%}.pure-u-xxxl-5-24{width:20.8333%}.pure-u-xxxl-1-4,.pure-u-xxxl-6-24{width:25%}.pure-u-xxxl-7-24{width:29.1667%}.pure-u-xxxl-1-3,.pure-u-xxxl-8-24{width:33.3333%}.pure-u-xxxl-3-8,.pure-u-xxxl-9-24{width:37.5%}.pure-u-xxxl-2-5{width:40%}.pure-u-xxxl-10-24,.pure-u-xxxl-5-12{width:41.6667%}.pure-u-xxxl-11-24{width:45.8333%}.pure-u-xxxl-1-2,.pure-u-xxxl-12-24{width:50%}.pure-u-xxxl-13-24{width:54.1667%}.pure-u-xxxl-14-24,.pure-u-xxxl-7-12{width:58.3333%}.pure-u-xxxl-3-5{width:60%}.pure-u-xxxl-15-24,.pure-u-xxxl-5-8{width:62.5%}.pure-u-xxxl-16-24,.pure-u-xxxl-2-3{width:66.6667%}.pure-u-xxxl-17-24{width:70.8333%}.pure-u-xxxl-18-24,.pure-u-xxxl-3-4{width:75%}.pure-u-xxxl-19-24{width:79.1667%}.pure-u-xxxl-4-5{width:80%}.pure-u-xxxl-20-24,.pure-u-xxxl-5-6{width:83.3333%}.pure-u-xxxl-21-24,.pure-u-xxxl-7-8{width:87.5%}.pure-u-xxxl-11-12,.pure-u-xxxl-22-24{width:91.6667%}.pure-u-xxxl-23-24{width:95.8333%}.pure-u-xxxl-1,.pure-u-xxxl-1-1,.pure-u-xxxl-24-24,.pure-u-xxxl-5-5{width:100%}}@media screen and (min-width:240em){.pure-u-x4k-1,.pure-u-x4k-1-1,.pure-u-x4k-1-12,.pure-u-x4k-1-2,.pure-u-x4k-1-24,.pure-u-x4k-1-3,.pure-u-x4k-1-4,.pure-u-x4k-1-5,.pure-u-x4k-1-6,.pure-u-x4k-1-8,.pure-u-x4k-10-24,.pure-u-x4k-11-12,.pure-u-x4k-11-24,.pure-u-x4k-12-24,.pure-u-x4k-13-24,.pure-u-x4k-14-24,.pure-u-x4k-15-24,.pure-u-x4k-16-24,.pure-u-x4k-17-24,.pure-u-x4k-18-24,.pure-u-x4k-19-24,.pure-u-x4k-2-24,.pure-u-x4k-2-3,.pure-u-x4k-2-5,.pure-u-x4k-20-24,.pure-u-x4k-21-24,.pure-u-x4k-22-24,.pure-u-x4k-23-24,.pure-u-x4k-24-24,.pure-u-x4k-3-24,.pure-u-x4k-3-4,.pure-u-x4k-3-5,.pure-u-x4k-3-8,.pure-u-x4k-4-24,.pure-u-x4k-4-5,.pure-u-x4k-5-12,.pure-u-x4k-5-24,.pure-u-x4k-5-5,.pure-u-x4k-5-6,.pure-u-x4k-5-8,.pure-u-x4k-6-24,.pure-u-x4k-7-12,.pure-u-x4k-7-24,.pure-u-x4k-7-8,.pure-u-x4k-8-24,.pure-u-x4k-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-x4k-1-24{width:4.1667%}.pure-u-x4k-1-12,.pure-u-x4k-2-24{width:8.3333%}.pure-u-x4k-1-8,.pure-u-x4k-3-24{width:12.5%}.pure-u-x4k-1-6,.pure-u-x4k-4-24{width:16.6667%}.pure-u-x4k-1-5{width:20%}.pure-u-x4k-5-24{width:20.8333%}.pure-u-x4k-1-4,.pure-u-x4k-6-24{width:25%}.pure-u-x4k-7-24{width:29.1667%}.pure-u-x4k-1-3,.pure-u-x4k-8-24{width:33.3333%}.pure-u-x4k-3-8,.pure-u-x4k-9-24{width:37.5%}.pure-u-x4k-2-5{width:40%}.pure-u-x4k-10-24,.pure-u-x4k-5-12{width:41.6667%}.pure-u-x4k-11-24{width:45.8333%}.pure-u-x4k-1-2,.pure-u-x4k-12-24{width:50%}.pure-u-x4k-13-24{width:54.1667%}.pure-u-x4k-14-24,.pure-u-x4k-7-12{width:58.3333%}.pure-u-x4k-3-5{width:60%}.pure-u-x4k-15-24,.pure-u-x4k-5-8{width:62.5%}.pure-u-x4k-16-24,.pure-u-x4k-2-3{width:66.6667%}.pure-u-x4k-17-24{width:70.8333%}.pure-u-x4k-18-24,.pure-u-x4k-3-4{width:75%}.pure-u-x4k-19-24{width:79.1667%}.pure-u-x4k-4-5{width:80%}.pure-u-x4k-20-24,.pure-u-x4k-5-6{width:83.3333%}.pure-u-x4k-21-24,.pure-u-x4k-7-8{width:87.5%}.pure-u-x4k-11-12,.pure-u-x4k-22-24{width:91.6667%}.pure-u-x4k-23-24{width:95.8333%}.pure-u-x4k-1,.pure-u-x4k-1-1,.pure-u-x4k-24-24,.pure-u-x4k-5-5{width:100%}}",""]);const o=i},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&i[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},1667:e=>{"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},5176:e=>{var t;self,t=()=>(()=>{var e={4593:(e,t)=>{var n,r,i,o,l,u={};n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=function(e){for(var t=0,r=[],i=0|e.length/3;0<i--;){var o=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,r.push(n.charAt(63&o>>18)),r.push(n.charAt(63&o>>12)),r.push(n.charAt(63&o>>6)),r.push(n.charAt(63&o))}return 2==e.length-t?(o=(e[t]<<16)+(e[t+1]<<8),r.push(n.charAt(63&o>>18)),r.push(n.charAt(63&o>>12)),r.push(n.charAt(63&o>>6)),r.push("=")):1==e.length-t&&(o=e[t]<<16,r.push(n.charAt(63&o>>18)),r.push(n.charAt(63&o>>12)),r.push("==")),r.join("")},i=function(){for(var e=[],t=0;t<64;++t)e[n.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),o=function(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var o=(i[e.charCodeAt(t)]<<18)+(i[e.charCodeAt(t+1)]<<12)+(i[e.charCodeAt(t+2)]<<6)+i[e.charCodeAt(t+3)];n.push(255&o>>16),n.push(255&o>>8),n.push(255&o),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n},l={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},u.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},u.encodeASCII=function(e){var t=l.encode(e);return r(t)},u.decodeASCII=function(e){var t=o(e);return l.decode(t)},u.encode=function(e){var t=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t}(e);return r(t)},u.decode=function(e){return function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")}(o(e))},t.decode=u.decode,t.decodeArray=u.decodeArray,t.encode=u.encode,t.encodeASCII=u.encodeASCII},452:(e,t)=>{!function(e){"use strict";var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r=15,i=32,o={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},a={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},l={25:2,26:4,29:6,30:8,31:10,27:13,28:15},u=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},d=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},h=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};h.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var p=function(e,t,n,r,i,o){this.uchar=e||" ",this.penState=new h(t,n,r,i,o)};p.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var f=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new p);this.pos=0,this.currPenState=new h};f.prototype={equals:function(e){for(var t=!0,n=0;n<i;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=i?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<i;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var m=function(){this.rows=[];for(var e=0;e<r;e++)this.rows.push(new f);this.currRow=14,this.nrRollUpRows=null,this.reset()};m.prototype={reset:function(){for(var e=0;e<r;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<r;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<r;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<r;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var o={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(o)},setBkgData:function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",i=-1,o=0;o<r;o++){var a=this.rows[o].getTextString();a&&(i=o+1,e?t.push("Row "+i+': "'+a+'"'):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var g=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new m,this.nonDisplayedMemory=new m,this.lastOutputScreen=new m,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};g.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=c.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var y=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new g(1,t),new g(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};y.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,o=!1;this.lastTime=e,c.setTime(e);for(var a=0;a<t.length;a+=2)r=127&t[a],i=127&t[a+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+d([r,i])+") is dropped")):0!==r||0!==i?(c.log("DATA","["+d([t[a],t[a+1]])+"] -> ("+d([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),n||(o=this.parseChars(r,i))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(o):c.log("WARNING","No channel found yet. TEXT-MODE?")),n?this.dataCounters.cmd+=2:o?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+d([r,i])+" orig: "+d([t[a],t[a+1]])))):this.dataCounters.padding+=2},parseCmd:function(e,t){var n;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),c.log("DEBUG","MIDROW ("+d([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,r;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,r=64<=t&&t<=95?1===n?o[e]:s[e]:1===n?a[e]:l[e];var i=this.interpretPAC(r,t);return this.channels[n-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r,i=null,o=null,a=null;if(e>=25?(i=2,a=e-8):(i=1,a=e),17<=a&&a<=19?(r=17===a?t+80:18===a?t+112:t+144,c.log("INFO","Special char '"+n(r)+"' in channel "+i),o=[r],this.lastCmdA=e,this.lastCmdB=t):32<=e&&e<=127&&(o=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null),o){var s=d(o);c.log("DEBUG","Char codes =  "+s.join(","))}return o},parseBackgroundAttributes:function(e,t){var n,r,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=u[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}},e.logger=c,e.PenState=h,e.CaptionScreen=m,e.Cea608Parser=y,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,o=[],a=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),o=n.getUint16(r+1),a=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==o&&1195456820==a&&3==s};i<t+n;){if(r=e.getUint32(i),6==(31&e.getUint8(i+4)))for(var s=i+5,l=-1;s<i+4+r-1;){l=0;for(var u=255;255===u;)l+=u=e.getUint8(s),s++;var c=0;for(u=255;255===u;)c+=u=e.getUint8(s),s++;a(l,c,e,s)&&o.push([s,c]),s+=c}i+=r+4}return o},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var o=0;o<i;o++){var a=e.getUint8(n),s=4&a,l=3&a;n++;var u=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&u)+(127&c)!=0&&(0===l?(r[0].push(u),r[0].push(c)):1===l&&(r[1].push(u),r[1].push(c)))}return r}}(t)},8416:(e,t,n)=>{"use strict";var r=n(7688),i=n(5448),o=n(6398),a=n(2032),s=(n(5530),"undefined"!=typeof window&&window||n.g),l=s.dashjs;l||(l=s.dashjs={}),l.MediaPlayer=r.Z,l.FactoryMaker=i.Z,l.Debug=o.Z,l.Version=(0,a.e)()},6398:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(5595),i=n(8512),o=n(5448),a=1,s=2,l=3,u=4,c=5;function d(e){e=e||{};var t,n,o,d,h=this.context,p=(0,r.Z)(h).getInstance(),f=e.settings,m=[];function g(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w.apply(void 0,[a,this].concat(t))}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w.apply(void 0,[s,this].concat(t))}function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w.apply(void 0,[l,this].concat(t))}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w.apply(void 0,[u,this].concat(t))}function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w.apply(void 0,[c,this].concat(t))}function w(e,t){var r="",a=null;n&&(a=(new Date).getTime(),r+="["+(a-d)+"]"),o&&t&&t.getClassName&&(r+="["+t.getClassName()+"]",t.getType&&(r+="["+t.getType()+"]")),r.length>0&&(r+=" ");for(var s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];Array.apply(null,l).forEach((function(e){r+=e+" "})),m[e]&&f&&f.get().debug.logLevel>=e&&m[e](r),f&&f.get().debug.dispatchEvent&&p.trigger(i.Z.LOG,{message:r,level:e})}return t={getLogger:function(e){return{fatal:y.bind(e),error:v.bind(e),warn:b.bind(e),info:_.bind(e),debug:E.bind(e)}},setLogTimestampVisible:function(e){n=e},setCalleeNameVisible:function(e){o=e}},n=!0,o=!0,d=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(m[a]=g(window.console.error),m[s]=g(window.console.error),m[l]=g(window.console.warn),m[u]=g(window.console.info),m[c]=g(window.console.debug)),t}d.__dashjs_factory_name="Debug";var h=o.Z.getSingletonFactory(d);h.LOG_LEVEL_NONE=0,h.LOG_LEVEL_FATAL=a,h.LOG_LEVEL_ERROR=s,h.LOG_LEVEL_WARNING=l,h.LOG_LEVEL_INFO=u,h.LOG_LEVEL_DEBUG=c,o.Z.updateSingletonFactory(d.__dashjs_factory_name,h);const p=h},5595:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i=n(8825);function o(){var e={};function t(t,n,r){var i=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0})),i):i}var n={on:function(n,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);var a=o.priority||0;if(!(t(n,r,i)>=0)){e[n]=e[n]||[];var s={callback:r,scope:i,priority:a};i&&i.getStreamId&&(s.streamId=i.getStreamId()),i&&i.getType&&(s.mediaType=i.getType()),o&&o.mode&&(s.mode=o.mode);var l=e[n].some((function(t,r){if(t&&a>t.priority)return e[n].splice(r,0,s),!0}));l||e[n].push(s)}},off:function(n,r,i){if(n&&r&&e[n]){var o=t(n,r,i);o<0||(e[n][o]=null)}},trigger:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,r.streamId&&(n.streamId=r.streamId),r.mediaType&&(n.mediaType=r.mediaType),e[t].filter((function(e){return!(!e||r.streamId&&e.streamId&&e.streamId!==r.streamId||r.mediaType&&e.mediaType&&e.mediaType!==r.mediaType||r.mode&&e.mode&&e.mode!==r.mode||!e.mode&&r.mode&&r.mode===i.Z.EVENT_MODE_ON_RECEIVE)})).forEach((function(e){return e&&e.callback.call(e.scope,n)}))}},reset:function(){e={}}};return n}o.__dashjs_factory_name="EventBus";var a=r.Z.getSingletonFactory(o);a.EVENT_PRIORITY_LOW=0,a.EVENT_PRIORITY_HIGH=5e3,r.Z.updateSingletonFactory(o.__dashjs_factory_name,a);const s=a},5448:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(){var e,t=[],n={},r={};function i(e,n){for(var r in t){var i=t[r];if(i.context===e&&i.name===n)return i.instance}return null}function o(e,t){return t[e]}function a(e,t,n){e in n&&(n[e]=t)}function s(t,n,r){var i,o=t.__dashjs_factory_name,a=n[o];if(a){var s=a.instance;if(!a.override)return s.apply({context:n,factory:e},r);for(var l in i=t.apply({context:n},r),s=s.apply({context:n,factory:e,parent:i},r))i.hasOwnProperty(l)&&(i[l]=s[l])}else i=t.apply({context:n},r);return i.getClassName=function(){return o},i}return e={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})},getSingletonInstance:i,setSingletonInstance:function(e,n,r){for(var i in t){var o=t[i];if(o.context===e&&o.name===n)return void(t[i].instance=r)}t.push({name:n,context:e,instance:r})},deleteSingletonInstances:function(e){t=t.filter((function(t){return t.context!==e}))},getSingletonFactory:function(e){var r=o(e.__dashjs_factory_name,n);return r||(r=function(n){var r;return void 0===n&&(n={}),{getInstance:function(){return r||(r=i(n,e.__dashjs_factory_name)),r||(r=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}},n[e.__dashjs_factory_name]=r),r},getSingletonFactoryByName:function(e){return o(e,n)},updateSingletonFactory:function(e,t){a(e,t,n)},getClassFactory:function(e){var t=o(e.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},r[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return o(e,r)},updateClassFactory:function(e,t){a(e,t,r)}},e}()},1264:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(5448),i=n(703),o=n(6398),a=n(3393),s=n(7855),l=n(5595),u=n(8512);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){var e,t,n=this.context,r=(0,l.Z)(n).getInstance(),h={"streaming.delay.liveDelay":u.Z.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":u.Z.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX},p={debug:{logLevel:o.Z.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,parseInbandPrft:!1,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:a.Z.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:a.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:a.Z.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:a.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,fragmentRequestProgressTimeout:-1,manifestRequestTimeout:1e4,retryIntervals:(e={},d(e,s.w.MPD_TYPE,500),d(e,s.w.XLINK_EXPANSION_TYPE,500),d(e,s.w.MEDIA_SEGMENT_TYPE,1e3),d(e,s.w.INIT_SEGMENT_TYPE,1e3),d(e,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),d(e,s.w.INDEX_SEGMENT_TYPE,1e3),d(e,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),d(e,s.w.LICENSE,1e3),d(e,s.w.OTHER_TYPE,1e3),d(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},d(t,s.w.MPD_TYPE,3),d(t,s.w.XLINK_EXPANSION_TYPE,1),d(t,s.w.MEDIA_SEGMENT_TYPE,3),d(t,s.w.INIT_SEGMENT_TYPE,3),d(t,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),d(t,s.w.INDEX_SEGMENT_TYPE,3),d(t,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),d(t,s.w.LICENSE,3),d(t,s.w.OTHER_TYPE,3),d(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:a.Z.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:a.Z.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:a.Z.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},f=i.Z.clone(p);function m(e,t,n){for(var o in e)e.hasOwnProperty(o)&&(t.hasOwnProperty(o)?"object"!==c(e[o])||e[o]instanceof Array||null===e[o]?(t[o]=i.Z.clone(e[o]),h[n+o]&&r.trigger(h[n+o])):m(e[o],t[o],n.slice()+o+"."):console.error("Settings parameter "+n+o+" is not supported"))}return{get:function(){return f},update:function(e){"object"===c(e)&&m(e,f,"")},reset:function(){f=i.Z.clone(p)}}}h.__dashjs_factory_name="Settings";const p=r.Z.getSingletonFactory(h)},703:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(3875),i=n.n(r),o=n(1067);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}const s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"mixin",value:function(t,n,r){var i,o={};if(t)for(var s in n)n.hasOwnProperty(s)&&(i=n[s],s in t&&(t[s]===i||s in o&&o[s]===i)||("object"===a(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],i,r):t[s]=r(i)));return t}},{key:"clone",value:function(t){if(!t||"object"!==a(t))return t;var n;if(t instanceof Array){n=[];for(var r=0,i=t.length;r<i;++r)r in t&&n.push(e.clone(t[r]))}else n={};return e.mixin(n,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach((function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)})),n.href}catch(t){return e}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var o=n[r],a=o.indexOf(": ");a>0&&(t[o.substring(0,a)]=o.substring(a+2))}return t}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}},{key:"getRelativeUrl",value:function(e,t){try{var n=new URL(e),r=new URL(t);if(n.protocol=r.protocol,n.origin!==r.origin)return t;var o=i().relative(n.pathname.substr(0,n.pathname.lastIndexOf("/")),r.pathname.substr(0,r.pathname.lastIndexOf("/"))),a=0===o.length?1:0;return o+=r.pathname.substr(r.pathname.lastIndexOf("/")+a,r.pathname.length-1),r.pathname.length<o.length?r.pathname:o}catch(e){return t}}},{key:"parseUserAgent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=null===e&&"undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";return(0,o.UAParser)(t)}catch(e){return{}}}},{key:"stringHasProtocol",value:function(e){return/(http(s?)):\/\//i.test(e)}}],t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e,t),e}()},2032:(e,t,n)=>{"use strict";function r(){return"4.7.1"}n.d(t,{e:()=>r})},2230:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return(t=[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}()},4351:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}n.d(t,{Z:()=>s});const s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=a(t);if(n){var i=a(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return o(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=r.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CMSD_STATIC_HEADER="cmsdStaticHeader",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.INBAND_EVENTS="inbandEvents",e.INITIAL_STREAM_SWITCH="initialStreamSwitch",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",e.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD="serviceLocationLocationBlacklistAdd",e.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED="serviceLocationLocationBlacklistChanged",e.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",e.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",e.SOURCE_BUFFER_ERROR="sourceBufferError",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEEK_TARGET="seekTarget",e.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",e.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",e.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",e.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",e.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",e}return s}(n(8342).Z)},8512:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}n.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=a(t);if(n){var i=a(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return o(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),r.apply(this,arguments)}return s}(n(4351).Z))},8342:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return(t=[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}()},9326:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(3186),i=n(7855),o=n(5448),a=n(8825),s=n(7387),l=n(1553);function u(e){var t,n,o,u,c,d=(e=e||{}).eventBus,h=e.debug,p=e.urlUtils,f=e.type,m=e.streamInfo,g=e.segmentsController,y=e.timelineConverter,v=e.baseURLController;function b(){return f}function _(){o=null}function E(e,t,n){var r,i,o=v.resolve(n.path),a={};return o&&t!==o.url&&p.isRelative(t)?(r=o.url,i=o.serviceLocation,a=o.queryParams,t&&(r=p.resolve(t,r))):r=t,!p.isRelative(r)&&(e.url=r,e.serviceLocation=i,e.queryParams=a,!0)}function w(e,t){if(null==t)return null;var n=new r.Z,o=t.representation,a=o.adaptation.period.mpd.manifest.Period_asArray[o.adaptation.period.index].AdaptationSet_asArray[o.adaptation.index].Representation_asArray[o.index].bandwidth,l=t.media;return l=(0,s.vi)(l,"Number",t.replacementNumber),l=(0,s.vi)(l,"Time",t.replacementTime),l=(0,s.vi)(l,"Bandwidth",a),l=(0,s.Aj)(l,o.id),l=(0,s.eR)(l),n.mediaType=b(),n.type=i.w.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.mediaStartTime=t.mediaStartTime,n.duration=t.duration,n.timescale=o.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.availabilityTimeComplete=o.availabilityTimeComplete,n.wallStartTime=t.wallStartTime,n.quality=o.index,n.index=t.index,n.mediaInfo=e,n.adaptationIndex=o.adaptation.index,n.representationId=o.id,E(n,l,o)?n:void 0}function T(e,t,r){var i=null;if(!t||!t.segmentInfoType)return i;var a=g.getSegmentByTime(t,r);return a&&(o=a,n.debug("Index for time "+r+" is "+a.index),i=w(e,a)),i}function A(){n.debug("Dynamic stream complete"),c=!0}return t={initialize:function(e){u=e,c=!1,g.initialize(e)},getStreamId:function(){return m.id},getType:b,getStreamInfo:function(){return m},getInitRequest:function(e,t){return t?function(e,t,n){var o=new r.Z,a=t.adaptation.period,l=a.start;if(o.mediaType=n,o.type=i.w.INIT_SEGMENT_TYPE,o.range=t.range,o.availabilityStartTime=y.calcAvailabilityStartTimeFromPresentationTime(l,t,u),o.availabilityEndTime=y.calcAvailabilityEndTimeFromPresentationTime(l+a.duration,t,u),o.quality=t.index,o.mediaInfo=e,o.representationId=t.id,E(o,t.initialization,t))return o.url=(0,s.vi)(o.url,"Bandwidth",t.bandwidth),o}(e,t,b()):null},getSegmentRequestForTime:T,getCurrentIndex:function(){return o?o.index:-1},getNextSegmentRequest:function(e,t){var r=null;if(!t||!t.segmentInfoType)return null;var i=o?o.index+1:0,a=g.getSegmentByIndex(t,i,o?o.mediaStartTime:-1);if(a)r=w(e,a),o=a;else{if(u&&!c)return n.debug(b()+" No segment found at index: "+i+". Wait for next loop"),null;c=!0}return r},isLastSegmentRequested:function(e,t){if(!e||!o)return!1;if(c)return!0;if(!isFinite(e.adaptation.period.duration))return!1;if(o.presentationStartTime+o.duration>t)return!1;if(e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.numberOfSegments)&&!isNaN(o.index)&&o.index>=e.mediaFinishedInformation.numberOfSegments-1){if(!u||e.segmentInfoType===l.Z.SEGMENT_TEMPLATE)return!0;if(u&&e.segmentInfoType===l.Z.SEGMENT_LIST&&e.adaptation.period.nextPeriodId)return!0}return!!(u&&e.adaptation.period.nextPeriodId&&e.segmentInfoType===l.Z.SEGMENT_TIMELINE&&e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&o&&!isNaN(o.mediaStartTime)&&!isNaN(o.duration)&&o.mediaStartTime+o.duration>=e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)},reset:function(){_(),d.off(a.Z.DYNAMIC_TO_STATIC,A,t)},getNextSegmentRequestIdempotent:function(e,t){var n=o?o.index+1:0,r=g.getSegmentByIndex(t,n,o?o.mediaStartTime:-1);return r?w(e,r):null},getValidTimeAheadOfTargetTime:function(e,t,n,r){try{if(isNaN(e)||!t||!n)return NaN;if(e<0&&(e=0),isNaN(r)&&(r=.5),T(t,n,e))return e;if(n.adaptation.period.start+n.adaptation.period.duration<e)return NaN;for(var i=isFinite(n.adaptation.period.duration)?n.adaptation.period.start+n.adaptation.period.duration:e+30,o=Math.min(e+r,i),a=NaN,s=null;o<=i;){var l=null;if(o<=i&&(l=T(t,n,o)),l){a=o,s=l;break}o+=r}if(s){var u=s.startTime+s.duration;return e>s.startTime&&u-e>r?e:!isNaN(s.startTime)&&e<s.startTime&&a>s.startTime?s.startTime+.001:Math.min(u-r,a)}return a}catch(e){return NaN}}},n=h.getLogger(t),_(),d.on(a.Z.DYNAMIC_TO_STATIC,A,t),t}u.__dashjs_factory_name="DashHandler";const c=o.Z.getClassFactory(u)},1553:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.SUPPLEMENTAL_PROPERTY_ASARRAY="SupplementalProperty_asArray",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.INBAND="inband",this.TYPE="type",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.VIEWPOINT_ASARRAY="Viewpoint_asArray",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PATCH_LOCATION_AS_ARRAY="PatchLocation_asArray",this.LOCATION="Location",this.LOCATION_AS_ARRAY="Location_asArray",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.CLIENT_REQUIREMENT="clientRequirement",this.TTL="ttl",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",PATHWAY_PRIORITY:"PATHWAY-PRIORITY",PATHWAY_CLONES:"PATHWAY-CLONES",BASE_ID:"BASE-ID",ID:"ID",URI_REPLACEMENT:"URI-REPLACEMENT",HOST:"HOST",PARAMS:"PARAMS"},this.PRODUCER_REFERENCE_TIME_TYPE={ENCODER:"encoder",CAPTURED:"captured",APPLICATION:"application"},this.SEGMENT_ALIGNMENT="segmentAlignment",this.SUB_SEGMENT_ALIGNMENT="subsegmentAlignment"}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}())},7802:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(5448),i=n(1724),o=n(3636),a=n(1736),s=n(5246);function l(e){e=e||{};var t,n,r=this.context,l=e.dashConstants,u=e.type,c=e.segmentBaseController;function d(e){return e?e.segments?n[l.SEGMENT_BASE]:n[e.segmentInfoType]:null}return t={initialize:function(t){n[l.SEGMENT_TIMELINE]=(0,i.Z)(r).create(e,t),n[l.SEGMENT_TEMPLATE]=(0,o.Z)(r).create(e,t),n[l.SEGMENT_LIST]=(0,a.Z)(r).create(e,t),n[l.SEGMENT_BASE]=(0,s.Z)(r).create(e,t)},updateInitData:function(e,t){return t?Promise.resolve():c.getSegmentBaseInitSegment({representation:e,mediaType:u})},updateSegmentData:function(e,t){return t?Promise.resolve():c.getSegmentList({mimeType:e.mimeType,representation:e,mediaType:u})},getSegmentByIndex:function(e,t,n){var r=d(e);return r?r.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=d(e);return n?n.getSegmentByTime(e,t):null},getMediaFinishedInformation:function(e){var t=d(e);return t?t.getMediaFinishedInformation(e):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}},n={},t}l.__dashjs_factory_name="SegmentsController";const u=r.Z.getClassFactory(l)},1736:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i=n(3393),o=n(7387);function a(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR)}function a(e,i){if(r(),!e)return null;var a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=a.SegmentURL_asArray.length,l=e&&!isNaN(e.startNumber)?e.startNumber:1,u=Math.max(l-1,0),c=Math.max(i-u,0),d=null;if(c<s){var h=a.SegmentURL_asArray[c];(d=(0,o.NF)(n,t,e,i))&&(d.replacementTime=(l+i-1)*e.segmentDuration,d.media=h.media?h.media:"",d.mediaRange=h.mediaRange,d.indexRange=h.indexRange)}return d}return{getSegmentByIndex:a,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var o=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return a(e,Math.floor(o/i))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,r=e&&!isNaN(e.startNumber)?e.startNumber:1,i=Math.max(r-1,0);return t.numberOfSegments=i+n.SegmentURL_asArray.length,t}}}a.__dashjs_factory_name="ListSegmentsGetter";const s=r.Z.getClassFactory(a)},5246:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5448),i=n(3393);function o(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR)}function r(e,t){if(n(),!e)return null;var r,i=e.segments?e.segments.length:-1;if(t<i&&(r=e.segments[t])&&r.index===t)return r;for(var o=0;o<i;o++)if((r=e.segments[o])&&r.index===t)return r;return null}return{getSegmentByIndex:r,getSegmentByTime:function(e,t){n();var i=function(e,t){if(!e)return-1;var n,r,i,o,a,s=e.segments,l=s?s.length:null,u=-1;if(s&&l>0)for(a=0;a<l;a++)if(i=(r=s[a]).presentationStartTime,t+(n=(o=r.duration)/2)>=i&&t-n<i+o){u=r.index;break}return u}(e,t);return r(e,i)},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return e&&e.segments?(t.numberOfSegments=e.segments.length,t):t}}}o.__dashjs_factory_name="SegmentBaseGetter";const a=r.Z.getClassFactory(o)},7387:(e,t,n)=>{"use strict";n.d(t,{Aj:()=>a,NF:()=>c,TJ:()=>d,eR:()=>o,vi:()=>s});var r=n(2011);function i(e,t){for(;e.length<t;)e="0"+e;return e}function o(e){return e?e.split("$$").join("$"):e}function a(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function s(e,t,n){var r,o,a,s,l,u,c=t.length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((o=e.indexOf("$",r+c))<0)return e;if((a=e.indexOf("%0",r+c))>r&&a<o)switch(s=e.charAt(o-1),l=parseInt(e.substring(a+2,o-1),10),s){case"d":case"i":case"u":u=i(n.toString(),l);break;case"x":u=i(n.toString(16),l);break;case"X":u=i(n.toString(16),l).toUpperCase();break;case"o":u=i(n.toString(8),l);break;default:return e}else u=n;e=e.substring(0,r)+u+e.substring(o+1)}}function l(e,t,n,i,o,a,s,l){var u,c=new r.Z;return c.representation=e,c.duration=t,c.presentationStartTime=n,c.mediaStartTime=i,c.availabilityStartTime=o.calcAvailabilityStartTimeFromPresentationTime(a,e,s),c.availabilityEndTime=o.calcAvailabilityEndTimeFromPresentationTime(a+t,e,s),c.wallStartTime=o.calcWallTimeForSegment(c,s),c.replacementNumber=(u=l,c.representation.startNumber+u),c.index=l,c}function u(e,t,n,r){var i=t.adaptation.period;if(isFinite(i.duration)&&i.start+i.duration<=n.presentationStartTime)return!1;if(r){if("INF"===t.availabilityTimeOffset)return!0;var o=e.getClientReferenceTime();return n.availabilityStartTime.getTime()<=o&&(!isFinite(n.availabilityEndTime)||n.availabilityEndTime.getTime()>=o)}return!0}function c(e,t,n,r){var i,o,a;i=n.segmentDuration,isNaN(i)&&(i=n.adaptation.period.duration),o=parseFloat((n.adaptation.period.start+r*i).toFixed(5)),a=parseFloat((o+i).toFixed(5));var s=l(n,i,o,e.calcMediaTimeFromPresentationTime(o,n),e,a,t,r);return u(e,n,s,t)?s:null}function d(e,t,n,r,i,o,a,c,d,h){var p,f,m=r/o,g=i/o;return p=e.calcPresentationTimeFromMediaTime(m,n),u(e,n,f=l(n,g,p,m,e,p+g,t,d),t)?(f.replacementTime=h||r,a=s(a,"Number",f.replacementNumber),a=s(a,"Time",f.replacementTime),f.media=a,f.mediaRange=c,f):null}},3636:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i=n(3393),o=n(7387);function a(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR)}function a(e,i){if(r(),!e)return null;var a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;i=Math.max(i,0);var s=(0,o.NF)(n,t,e,i);if(s){s.replacementTime=Math.round((i-1)*e.segmentDuration*e.timescale,10);var l=a.media;l=(0,o.vi)(l,"Number",s.replacementNumber),l=(0,o.vi)(l,"Time",s.replacementTime),s.media=l}return s}return{getSegmentByIndex:a,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var o=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return a(e,Math.floor(o/i))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.segmentDuration;return isNaN(n)?t.numberOfSegments=1:t.numberOfSegments=Math.ceil(e.adaptation.period.duration/n),t}}}a.__dashjs_factory_name="TemplateSegmentsGetter";const s=r.Z.getClassFactory(a)},1724:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i=n(3393),o=n(7387);function a(e,t){var n=(e=e||{}).timelineConverter,r=e.dashMetrics;function a(){if(!n)throw new Error(i.Z.MISSING_CONFIG_ERROR)}function s(e,t){var n,r,i,o,a,s,u,c=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,d=c.SegmentTimeline,h=c.SegmentURL_asArray,p=0,f=-1;u=e.timescale;var m=!1;for(i=0,o=(n=d.S_asArray).length;i<o&&!m;i++)for(s=0,(r=n[i]).hasOwnProperty("r")&&(s=r.r),r.hasOwnProperty("t")&&(p=r.t),s<0&&(s=l(e,n[i+1],r,u,p/u)),a=0;a<=s&&!m;a++)(m=t(p,c,h,r,u,++f,i))&&(e.segmentDuration=r.d/u),p+=r.d}function l(e,t,i,o,a){var s;if(t&&t.hasOwnProperty("t"))s=t.t/o;else try{var l=0;if(isNaN(e.adaptation.period.start)||isNaN(e.adaptation.period.duration)||!isFinite(e.adaptation.period.duration)){var u=r.getCurrentDVRInfo();l=isNaN(u.end)?0:u.end}else l=e.adaptation.period.start+e.adaptation.period.duration;s=n.calcMediaTimeFromPresentationTime(l,e),e.segmentDuration=i.d/o}catch(e){s=0}return Math.max(Math.ceil((s-a)/(i.d/o))-1,0)}return{getSegmentByIndex:function(e,r,i){if(a(),!e)return null;var l=null,u=!1;return s(e,(function(r,a,s,c,d,h,p){if(u||i<0){var f=a.media,m=c.mediaRange;return s&&(f=s[p].media||"",m=s[p].mediaRange),l=(0,o.TJ)(n,t,e,r,c.d,d,f,m,h,c.tManifest),!0}return r>=i*d-.5*c.d&&(u=!0),!1})),l},getSegmentByTime:function(e,r){if(a(),!e)return null;void 0===r&&(r=null);var i=null,l=n.calcMediaTimeFromPresentationTime(r,e);return s(e,(function(r,a,s,u,c,d,h){var p=parseFloat((l*c).toPrecision(15));if(p<r+u.d&&p>=r){var f=a.media,m=u.mediaRange;return s&&(f=s[h].media||"",m=s[h].mediaRange),i=(0,o.TJ)(n,t,e,r,u.d,c,f,m,d,u.tManifest),!0}return!1})),i},getMediaFinishedInformation:function(e){if(!e)return 0;var t,n,r,i,o,a,s,u=(e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList).SegmentTimeline,c=0,d=0,h=0;for(s=e.timescale,i=(t=u.S_asArray).length,r=0;r<i;r++)for(a=0,(n=t[r]).hasOwnProperty("r")&&(a=n.r),n.hasOwnProperty("t")&&(d=(c=n.t)/s),a<0&&(a=l(e,t[r+1],n,s,d)),o=0;o<=a;o++)h++,d=(c+=n.d)/s;return{numberOfSegments:h,mediaTimeOfLastSignaledSegment:d}}}}a.__dashjs_factory_name="TimelineSegmentsGetter";const s=r.Z.getClassFactory(a)},2011:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null}},2610:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},7688:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ao});var r=n(452),i=n.n(r),o=n(3393),a=n(1553),s=n(3860),l=n(5595),u=n(8512),c=n(5448),d=n(6398),h=n(8825);function p(){var e,t,n,r,i,a,c,p,f,m,g,y,v,b,_,E,w,T,A,S,x,I,R,C,M=this.context,L=(0,l.Z)(M).getInstance();function P(){k(),b=!1,m=0,g=0,E=0,I=!1,w=!0,T=!1,R=!1,A=NaN,c&&(L.off(u.Z.DATA_UPDATE_COMPLETED,X,e),L.off(u.Z.LOADING_PROGRESS,ge,e),L.off(u.Z.MANIFEST_UPDATED,_e,e),L.off(u.Z.STREAMS_COMPOSED,Ee,e),L.off(h.Z.PLAYBACK_ENDED,fe,e),L.off(h.Z.STREAM_INITIALIZING,ve,e),L.off(h.Z.REPRESENTATION_SWITCH,be,e),L.off(h.Z.BUFFER_LEVEL_STATE_CHANGED,ee,e),$(),c.removeEventListener("canplay",Q),c.removeEventListener("canplaythrough",J),c.removeEventListener("play",te),c.removeEventListener("waiting",ne),c.removeEventListener("playing",re),c.removeEventListener("pause",ie),c.removeEventListener("error",me),c.removeEventListener("seeking",oe),c.removeEventListener("seeked",ae),c.removeEventListener("timeupdate",se),c.removeEventListener("progress",le),c.removeEventListener("ratechange",ue),c.removeEventListener("loadedmetadata",ce),c.removeEventListener("loadeddata",de),c.removeEventListener("stalled",ye),c.removeEventListener("ended",he),c.removeEventListener("volumechange",pe)),f=null,c=null,y=null,v=null}function D(){return parseFloat((O(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)-z()).toFixed(5))}function O(e){var t=e||y;return t.start+t.duration}function N(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y&&c&&c.getElement()?(e&&v&&U(z()),c.play()):b=!0}function k(){y&&c&&c.pause()}function F(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];y&&c&&c.getElement()&&e!==(isNaN(A)?c.getTime():A)&&((S=!0===r)||(A=e),t.info("Requesting seek to time: "+e+(S?" (internal)":"")),v&&i&&U(e),c.setCurrentTime(e,n))}function B(){if(y&&c&&v){var e=n&&n.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO,t=i.getCurrentDVRInfo(e);return t&&t.range?t.range.end:0}}function U(e){var t=new Date(p.getClientReferenceTime()),n=a.getRegularPeriods()[0],r=p.calcPresentationTimeFromWallTime(t,n);m=r-e}function z(){return y&&c?c.getTime():null}function G(){return y&&c?c.isPaused():null}function V(){return y&&c?c.isSeeking():null}function j(){return y&&c?c.isStalled():null}function H(){return y&&c?c.getPlaybackRate():null}function Z(){return y&&c?c.getEnded():null}function q(){return v}function W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!G()&&v&&0!==c.getReadyState()&&!V()&&!I){e||(e=n.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO);var r=z(),i=Y(r,e);!isNaN(i)&&i!==r&&!V()&&(j()||x||1===c.getReadyState())&&(t.debug("UpdateCurrentTime: Seek to actual time: ".concat(i," from currentTime: ").concat(r)),F(i,!1,!1))}}function Y(e,t){var n=i.getCurrentDVRInfo(t),r=n?n.range:null;return r?e>r.end?Math.max(r.end-m,r.start):e>0&&e+.25<r.start&&Math.abs(e-r.start)<31536e4?T?Math.max(r.end-m,r.start):r.start:e:NaN}function K(){null===f&&(f=setInterval((function(){var e;L.trigger(u.Z.WALLCLOCK_TIME_UPDATED,{isDynamic:v,time:new Date}),q()&&(n.addDVRMetric(),G()?(e=Date.now(),(!_||e>_+500)&&(_=e,se())):W())}),C.get().streaming.wallclockTimeUpdateInterval))}function $(){clearInterval(f),f=null}function X(e){var t=a.convertRepresentationToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&y.id===n.id&&(y=n)}function Q(){L.trigger(u.Z.CAN_PLAY)}function J(){L.trigger(u.Z.CAN_PLAY_THROUGH)}function ee(e){e.streamId===n.getActiveStreamInfo().id&&(x=e.state===s.Z.BUFFER_EMPTY,C.get().streaming.buffer.setStallState&&c.setStallState(e.mediaType,e.state===s.Z.BUFFER_EMPTY))}function te(){t.info("Native video element event: play"),W(),K(),L.trigger(u.Z.PLAYBACK_STARTED,{startTime:z()})}function ne(){t.info("Native video element event: waiting"),L.trigger(u.Z.PLAYBACK_WAITING,{playingTime:z()})}function re(){t.info("Native video element event: playing"),S=!1,L.trigger(u.Z.PLAYBACK_PLAYING,{playingTime:z()})}function ie(){t.info("Native video element event: pause"),L.trigger(u.Z.PLAYBACK_PAUSED,{ended:Z()})}function oe(){if(!S){var e=z();isNaN(A)||A===e||(e=A),A=NaN,t.info("Seeking to: "+e),K(),L.trigger(u.Z.PLAYBACK_SEEKING,{seekTime:e,streamId:y.id})}}function ae(){t.info("Native video element event: seeked"),S=!1,L.trigger(u.Z.PLAYBACK_SEEKED)}function se(){y&&L.trigger(u.Z.PLAYBACK_TIME_UPDATED,{timeToEnd:D(),time:z(),streamId:y.id})}function le(){L.trigger(u.Z.PLAYBACK_PROGRESS,{streamId:y.id})}function ue(){var e=H();t.info("Native video element event: ratechange: ",e),L.trigger(u.Z.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function ce(){t.info("Native video element event: loadedmetadata"),L.trigger(u.Z.PLAYBACK_METADATA_LOADED),K()}function de(){t.info("Native video element event: loadeddata"),L.trigger(u.Z.PLAYBACK_LOADED_DATA)}function he(){t.info("Native video element event: ended"),k(),$();var e=n?n.getActiveStreamInfo():null;e&&L.trigger(u.Z.PLAYBACK_ENDED,{isLast:e.isLast})}function pe(){L.trigger(u.Z.PLAYBACK_VOLUME_CHANGED)}function fe(e){if(f&&e.isLast){t.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var n=e.seekTime?e.seekTime:O();c.setCurrentTime(n),k(),$()}}function me(e){var t=e.target||e.srcElement;L.trigger(u.Z.PLAYBACK_ERROR,{error:t.error})}function ge(e){if(!1===e.stream&&T&&!isNaN(e.request.duration)){var n=1.2*e.request.duration;n>m&&(t.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",n.toFixed(2)),m=n,g=n)}}function ye(e){L.trigger(u.Z.PLAYBACK_STALLED,{e})}function ve(e){var n;(n=e.mediaInfo)&&n.supplementalProperties&&"true"===n.supplementalProperties[o.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]&&(t.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),T=!0)}function be(e){var t=n.getActiveStreamInfo();e&&t&&e.currentRepresentation&&e.streamId&&e.streamId===t.id&&e.mediaType&&(e.mediaType===o.Z.VIDEO||e.mediaType===o.Z.AUDIO)&&(w=e.currentRepresentation.availabilityTimeComplete,(T=!w)&&!R&&(R=!0))}function _e(){I=!0}function Ee(){I=!1}return e={initialize:function(t,n){y=t,!0!==n&&(c.addEventListener("canplay",Q),c.addEventListener("canplaythrough",J),c.addEventListener("play",te),c.addEventListener("waiting",ne),c.addEventListener("playing",re),c.addEventListener("pause",ie),c.addEventListener("error",me),c.addEventListener("seeking",oe),c.addEventListener("seeked",ae),c.addEventListener("timeupdate",se),c.addEventListener("progress",le),c.addEventListener("ratechange",ue),c.addEventListener("loadedmetadata",ce),c.addEventListener("loadeddata",de),c.addEventListener("stalled",ye),c.addEventListener("ended",he),c.addEventListener("volumechange",pe),v=y.manifestInfo.isDynamic,x=!1,S=!1,L.on(u.Z.DATA_UPDATE_COMPLETED,X,e),L.on(u.Z.LOADING_PROGRESS,ge,e),L.on(u.Z.MANIFEST_UPDATED,_e,e),L.on(u.Z.STREAMS_COMPOSED,Ee,e),L.on(h.Z.PLAYBACK_ENDED,fe,e,{priority:l.Z.EVENT_PRIORITY_HIGH}),L.on(h.Z.STREAM_INITIALIZING,ve,e),L.on(h.Z.REPRESENTATION_SWITCH,be,e),L.on(h.Z.BUFFER_LEVEL_STATE_CHANGED,ee,e),b&&(b=!1,N()))},setConfig:function(e){e&&(e.streamController&&(n=e.streamController),e.serviceDescriptionController&&(r=e.serviceDescriptionController),e.dashMetrics&&(i=e.dashMetrics),e.adapter&&(a=e.adapter),e.videoModel&&(c=e.videoModel),e.timelineConverter&&(p=e.timelineConverter),e.settings&&(C=e.settings))},getTimeToStreamEnd:D,getBufferLevel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null;return n.getActiveStreamProcessors().forEach((function(n){if(!e||0===e.length||-1===e.indexOf(n.getType())){var r=n.getBufferLevel();t=null===t?r:Math.min(t,r)}})),t},getPlaybackStalled:function(){return x},getTime:z,getLowLatencyModeEnabled:function(){return T},getInitialCatchupModeActivated:function(){return R},getIsManifestUpdateInProgress:function(){return I},getPlaybackRate:H,getPlayedRanges:function(){return y&&c?c.getPlayedRanges():null},getEnded:Z,getIsDynamic:q,getStreamController:function(){return n},computeAndSetLiveDelay:function(e,t){var n,i,o,s=!isNaN(e)&&isFinite(e)?e:NaN,l=a.getSuggestedPresentationDelay(),u=r.getServiceDescriptionSettings();return n=isNaN(C.get().streaming.delay.liveDelay)?null===C.get().streaming.delay.liveDelayFragmentCount||isNaN(C.get().streaming.delay.liveDelayFragmentCount)||isNaN(s)?u&&!isNaN(u.liveDelay)&&u.liveDelay>0?u.liveDelay:!0===C.get().streaming.delay.useSuggestedPresentationDelay&&null!==l&&!isNaN(l)&&l>0?l:isNaN(s)?t&&!isNaN(t.minBufferTime)?4*t.minBufferTime:4*y.manifestInfo.minBufferTime:4*s:s*C.get().streaming.delay.liveDelayFragmentCount:C.get().streaming.delay.liveDelay,null!==(o=a.getAvailabilityStartTime())&&(E=o),i=t&&t.dvrWindowSize>0?Math.min(n,t.dvrWindowSize):n,m=i,g=i,i},getLiveDelay:function(){return m},getOriginalLiveDelay:function(){return g},getCurrentLiveLatency:function(){if(!v||isNaN(E))return NaN;var e=z();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*p.getClientTimeOffset();return Math.max(((t-E-1e3*e)/1e3).toFixed(3),0)},play:N,isPaused:G,isStalled:j,pause:k,isSeeking:V,getStreamEndTime:O,seek:F,seekToOriginalLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=B();0!==r&&F(r-(m=g),e,t,n)},seekToCurrentLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=B();0!==r&&F(r-m,e,t,n)},reset:P,updateCurrentTime:W,getAvailabilityStartTime:function(){return E}},t=(0,d.Z)(M).getInstance().getLogger(e),P(),e}p.__dashjs_factory_name="PlaybackController";const f=c.Z.getSingletonFactory(p);var m=n(3186),g="loading",y="executed",v="failed";function b(e){var t,n,r,i,o=(e=e||{}).eventBus,a=e.events,s=e.dashMetrics,l=e.fragmentLoader,u=e.debug,c=e.streamInfo,d=e.type;function h(e){var t;return!!e&&(t=!1,r.some((function(n){if(r=e,i=n,!isNaN(r.index)&&r.startTime===i.startTime&&r.adaptationIndex===i.adaptationIndex&&r.type===i.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,n)||function(e,t){return e.action===m.Z.ACTION_COMPLETE&&e.action===t.action}(e,n))return t=!0;var r,i})),t)}function p(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function f(e){r=r.filter((function(t){var n=p(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n}))}function b(e,t){t<=e+.5||(r=r.filter((function(n){var r=p(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r})))}function _(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r],o=i.startTime,a=o+i.duration;if(n=isNaN(n)?p(i):n,!isNaN(o)&&!isNaN(a)&&t+n>=o&&t-n<a||isNaN(o)&&isNaN(t))return i}return null}function E(e,t){s.addSchedulingInfo(e,t),s.addRequestsQueue(e.mediaType,i,r)}function w(e){e.sender===l&&(i.splice(i.indexOf(e.request),1),e.response&&!e.error&&r.push(e.request),E(e.request,e.error?v:y),o.trigger(a.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:d}))}function T(e){e.sender===l&&o.trigger(a.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:d})}function A(e){e.sender===l&&o.trigger(a.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:c.id,mediaType:d})}function S(){r=[],i=[]}return t={getStreamId:function(){return c.id},getType:function(){return d},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach((function(t){var o=function(e){var t;switch(e){case g:t=i;break;case y:t=r;break;default:t=[]}return t}(t);n=n.concat(function(e,t){return t.hasOwnProperty("time")?[_(e,t.time,t.threshold)]:e.filter((function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0}))}(o,e))})),n},isFragmentLoaded:h,isFragmentLoadedOrPending:function(e){var t,n=!1,r=0;if(!(n=h(e)))for(r=0;r<i.length;r++)t=i[r],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n},removeExecutedRequestsBeforeTime:f,removeExecutedRequestsAfterTime:function(e){r=r.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)b(n,e.start(r)),n=e.end(r);t>0&&b(n,t)}else f()},abortRequests:function(){n.debug("abort requests"),l.abort(),i=[]},executeRequest:function(e){e.action===m.Z.ACTION_DOWNLOAD?(E(e,g),i.push(e),function(e){o.trigger(a.FRAGMENT_LOADING_STARTED,{request:e},{streamId:c.id,mediaType:d}),l.load(e)}(e)):n.warn("Unknown request action.")},reset:function(){o.off(a.LOADING_COMPLETED,w,this),o.off(a.LOADING_DATA_PROGRESS,T,this),o.off(a.LOADING_ABANDONED,A,this),l&&l.reset(),S()},resetInitialSettings:S,addExecutedRequest:function(e){r.push(e)}},n=u.getLogger(t),S(),o.on(a.LOADING_COMPLETED,w,t),o.on(a.LOADING_DATA_PROGRESS,T,t),o.on(a.LOADING_ABANDONED,A,t),t}b.__dashjs_factory_name="FragmentModel";var _=c.Z.getClassFactory(b);_.FRAGMENT_MODEL_LOADING=g,_.FRAGMENT_MODEL_EXECUTED=y,_.FRAGMENT_MODEL_CANCELED="canceled",_.FRAGMENT_MODEL_FAILED=v,c.Z.updateClassFactory(b.__dashjs_factory_name,_);const E=_;var w=n(5459);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function A(e,t){return A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},A(e,t)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}const x=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=S(t);if(n){var i=S(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=r.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return i}(n(2230).Z));var I=n(1264),R=n(7855);function C(e){var t,n,r,i,a,s,l=this.context,c=(0,I.Z)(l).getInstance(),h=e.textController,p=e.eventBus,f=[],m=[],g=!1,y=e.mediaSource,v=null;function b(e){return new Promise((function(t){P((function(){i.changeType&&i.changeType(e),t()}))}))}function _(e){return i=h.getTextSourceBuffer(e),Promise.resolve()}function E(){if("function"==typeof i.addEventListener)try{i.addEventListener("updateend",M,!1),i.addEventListener("error",L,!1),i.addEventListener("abort",L,!1)}catch(e){s=setInterval(M,50)}else s=setInterval(M,50)}function T(e){return new Promise((function(t){i&&c.get().streaming.buffer.useAppendWindow?P((function(){try{if(!i)return void t();var n=y.duration,o=0;e&&!isNaN(e.start)&&!isNaN(e.duration)&&isFinite(e.duration)&&(n=e.start+e.duration),e&&!isNaN(e.start)&&(o=e.start),i.appendWindowEnd===n&&i.appendWindowStart===o||(i.appendWindowStart=0,i.appendWindowEnd=n+.01,i.appendWindowStart=Math.max(o-.1,0),r.debug("Updated append window for ".concat(a.type,". Set start to ").concat(i.appendWindowStart," and end to ").concat(i.appendWindowEnd))),t()}catch(e){r.warn("Failed to set append window"),t()}})):t()}))}function A(e){return new Promise((function(t){i?P((function(){try{i.timestampOffset===e||isNaN(e)||(i.timestampOffset=e,r.debug("Set MSE timestamp offset to ".concat(e))),t()}catch(e){t()}})):t()}))}function S(){if(!g&&m.length>0){g=!0;var e=m[0];m.splice(0,1);var t=function(){g=!1,m.length>0&&S.call(this),e&&e.data&&e.data.segmentType&&e.data.segmentType!==R.w.INIT_SEGMENT_TYPE&&delete e.data.bytes,e.promise.resolve({chunk:e.data})};try{v=e.request,0===e.data.bytes.byteLength?t.call(this):(i.appendBuffer?i.appendBuffer(e.data.bytes):i.append(e.data.bytes,e.data),P(t.bind(this)))}catch(t){r.fatal('SourceBuffer append failed "'+t+'"'),m.length>0?S():g=!1,delete e.data.bytes,e.promise.reject({chunk:e.data,error:new w.Z(t.code,t.message)})}}}function C(){f.length>0&&(i.updating||(f.shift()(),C()))}function M(){i.updating||C()}function L(e){var t,r,i=e.target||{};t=u.Z.SOURCE_BUFFER_ERROR,r={error:i,lastRequestAppended:v}||{},p.trigger(t,r,{streamId:a.streamInfo.id,mediaType:n})}function P(e){f.push(e),i.updating||C()}return t={getType:function(){return n},getAllBufferRanges:function(){try{return i.buffered}catch(e){return r.error("getAllBufferRanges exception: "+e.message),null}},getBuffer:function(){return i},append:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(r,i){e?(m.push({data:e,promise:{resolve:r,reject:i},request:n}),P(S.bind(t))):i({chunk:e,error:new w.Z(x.APPEND_ERROR_CODE,x.APPEND_ERROR_MESSAGE)})}))},remove:function(e){return new Promise((function(t,n){var r=e.start,o=e.end;r>=0&&o>r?P((function(){try{i.remove(r,o),P((function(){t({from:r,to:o,unintended:!1}),e.resolve&&e.resolve()}))}catch(t){n({from:r,to:o,unintended:!1,error:new w.Z(x.REMOVE_ERROR_CODE,x.REMOVE_ERROR_MESSAGE)}),e.reject&&e.reject(t)}})):t()}))},abort:function(){return new Promise((function(e){try{m=[],"open"===y.readyState?P((function(){try{i&&i.abort(),e()}catch(t){e()}})):i&&i.setTextTrack&&"ended"===y.readyState?(i.abort(),e()):e()}catch(t){e()}}))},reset:function(){if(i){try{f=[],function(){try{"function"==typeof i.removeEventListener&&(i.removeEventListener("updateend",M,!1),i.removeEventListener("error",L,!1),i.removeEventListener("abort",L,!1)),clearInterval(s)}catch(e){r.error(e)}}(),g=!1,m=[],i.getClassName&&"TextSourceBuffer"===i.getClassName()||(r.debug("Removing sourcebuffer from media source"),y.removeSourceBuffer(i))}catch(e){}i=null}v=null},updateTimestampOffset:A,initializeForStreamSwitch:function(e,t,r){n=(a=e).type;var o=a.codec;!function(e){i=e.getBuffer()}(r),E();var s=[];return s.push(new Promise((function(e){P((function(){var t=i.appendWindowStart,n=i.appendWindowEnd;i&&(i.abort(),i.appendWindowStart=t,i.appendWindowEnd=n),e()}))}))),s.push(T(a.streamInfo)),c.get().streaming.buffer.useChangeTypeForTrackSwitch&&s.push(b(o)),t&&void 0!==t.MSETimeOffset&&s.push(A(t.MSETimeOffset)),Promise.all(s)},initializeForFirstUse:function(e,t,r){n=(a=t).type;var s=a.codec;try{if(s.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return _(e);i=y.addSourceBuffer(s),E();var l=[];return l.push(T(a.streamInfo)),r&&void 0!==r.MSETimeOffset&&l.push(A(r.MSETimeOffset)),Promise.all(l)}catch(t){return a.type==o.Z.TEXT&&!a.isFragmented||-1!==s.indexOf('codecs="stpp')||-1!==s.indexOf('codecs="vtt')?_(e):Promise.reject(t)}},updateAppendWindow:T,changeType:b},r=(0,d.Z)(l).getInstance().getLogger(t),t}C.__dashjs_factory_name="SourceBufferSink";const M=c.Z.getClassFactory(C);function L(e){var t,n,r,i=this.context,o=[],a=e;function s(e,t){return o=o.filter((function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))})),Promise.resolve()}return t={getAllBufferRanges:function(){for(var e=[],t=0;t<o.length;t++){var n=o[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var r={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(r,"length",{get:function(){return e.length}}),r},append:function(e){return"InitializationSegment"!==e.segmentType?(o.push(e),o.sort((function(e,t){return e.start-t.start})),r=null):r=e,n.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),a&&a({chunk:e}),Promise.resolve()},remove:s,abort:function(){return Promise.resolve()},discharge:function(e,t){var n=function(e,t){return o.filter((function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)}))}(e,t);return r&&(n.push(r),r=null),s(e,t),n},reset:function(){o=[],r=null,a=null},updateTimestampOffset:function(){return Promise.resolve()},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},n=(0,d.Z)(i).getInstance().getLogger(t),t}L.__dashjs_factory_name="PreBufferSink";const P=c.Z.getClassFactory(L);function D(){var e={};return{save:function(t){var n=t.streamId,r=t.representationId;e[n]=e[n]||{},e[n][r]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}D.__dashjs_factory_name="InitCache";const O=c.Z.getSingletonFactory(D);var N=.01,k="BufferController";function F(e){e=e||{};var t,n,r,i,a,c,p,f,m,g,y,v,b,_,T,A,S,I,C,L,D,F=this.context,B=(0,l.Z)(F).getInstance(),U=e.errHandler,z=e.fragmentModel,G=e.representationController,V=e.adapter,j=e.textController,H=e.abrController,Z=e.playbackController,q=e.streamInfo,W=e.type,Y=e.settings;function K(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,r){c=e,m&&t&&"function"==typeof m.discharge?(g=m,X(t).then((function(){n()})).catch((function(e){r(e)}))):n()}))}function $(e){return V.convertRepresentationToRepresentationInfo(G.getRepresentationForQuality(e))}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise((function(n,r){I&&e?c?(y=!1,Q(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))):(y=!0,function(){var e=this;return new Promise((function(t,n){var r=H.getQualityFor(W,q.id);m=P(F).create(re.bind(e)),be($(r)).then((function(){t(m)})).catch((function(){n()}))}))}().then((function(e){n(e)})).catch((function(e){r(e)}))):n(null)}))}function Q(e,t){return new Promise((function(r,i){var a=H.getQualityFor(W,q.id);m=M(F).create({mediaSource:c,textController:j,eventBus:B}),function(e,t,n){var r=$(n);return t&&t[W]&&(W===o.Z.VIDEO||W===o.Z.AUDIO)?m.initializeForStreamSwitch(e,r,t[W]):m.initializeForFirstUse(q,e,r)}(e,t,a).then((function(){return be($(a))})).then((function(){r(m)})).catch((function(e){n.fatal("Caught error on create SourceBuffer: "+e),U.error(new w.Z(x.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,x.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+W)),i(e)}))}))}function J(e){Y.get().streaming.cacheInitSegments&&(n.info("Init fragment finished loading saving to",W+"'s init cache"),I.save(e.chunk)),n.debug("Append Init fragment",W," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),te(e.chunk)}function ee(e){te(e.chunk,e.request)}function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;m.append(e,t).then((function(e){re(e)})).catch((function(e){re(e)})),e.mediaInfo.type===o.Z.VIDEO&&Ie(u.Z.VIDEO_CHUNK_RECEIVED,{chunk:e})}function ne(e){if(e&&e.length>0)for(var t=0,r=e.length;t<r;t++)n.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",Z.getTime())}function re(e){if(e.error)return 22===e.error.code&&function(){if(S=!0,a=.8*Ae(),n.warn("Quota exceeded, Critical Buffer: "+a),a>0){var e=Math.max(.2*a,1),t=a-e,r=Math.min(Y.get().streaming.buffer.bufferTimeAtTopQuality,.9*t),i=Math.min(Y.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*t),o={streaming:{buffer:{bufferToKeep:parseFloat(e.toFixed(5)),bufferTimeAtTopQuality:parseFloat(r.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(i.toFixed(5))}}};Y.update(o)}}(),void(22!==e.error.code&&xe()||(n.warn("Clearing playback buffer to overcome quota exceed situation"),Ie(u.Z.QUOTA_EXCEEDED,{criticalBufferLevel:a,quotaExceededTime:e.chunk.start}),ge(me())));if(m&&(ce(),S=!1,(_=e.chunk)&&_.endFragment)){_&&!isNaN(_.index)&&(p=Math.max(_.index,p),de());var t=m.getAllBufferRanges();_.segmentType===R.w.MEDIA_SEGMENT_TYPE&&(ne(t),ae(),function(){if(!isNaN(D)&&!y)if(W===o.Z.AUDIO||W===o.Z.VIDEO){var e=Z.getTime(),t=ue(e,0),n=ue(D,0);if(t&&n&&t.start===n.start)D=NaN;else{var r=G.getCurrentRepresentation().segmentDuration,i=ue(D,r);i&&(Y.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(e-D)>r?D<=i.end&&Z.seek(Math.max(D,i.start),!1,!0):e<i.start&&Z.seek(i.start,!1,!0))}}else D=NaN}());var r=!1;v&&(v.indexOf(_)>0&&(r=!0),v=null),_&&!r&&Ie(u.Z.BYTES_APPENDED_END_FRAGMENT,{quality:_.quality,startTime:_.start,index:_.index,bufferedRanges:t,segmentType:_.segmentType,mediaType:W})}}function ie(){return new Promise((function(e,t){var n=oe();if(!n||0===n.length)return ae(),void e();ge(n).then((function(){e()})).catch((function(e){t(e)}))}))}function oe(e){var t=[],r=m.getAllBufferRanges();if(!r||0===r.length)return t;if(!e&&0!==e||isNaN(e))t.push({start:r.start(0),end:r.end(r.length-1)+.5});else{var i=function(e,t){var n=Y.get().streaming.buffer.bufferToKeep,r=t.start(0);if(e-r>n){var i=Math.max(0,e-n),o=z.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:e,threshold:N})[0];if(o&&(i=Math.min(o.startTime,i)),i>0)return{start:r,end:i}}return null}(e,r),o=function(e,t){var r=t.end(t.length-1)+.5,i=Se(e),o=q.manifestInfo.duration>=Y.get().streaming.buffer.longFormContentDurationThreshold?Y.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Y.get().streaming.buffer.bufferTimeAtTopQuality,a=isNaN(i)?e:Math.min(i,e+o);if(a>=t.end(t.length-1))return null;var s=z.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:e,threshold:N})[0];if(s&&(a=Math.max(s.startTime+s.duration,a)),Y.get().streaming.buffer.avoidCurrentTimeRangePruning)for(var l=0;l<t.length;l++)if(t.start(l)<=e&&e<=t.end(l)&&t.start(l)<=a&&a<=t.end(l)){var u=a;a=l+1<t.length?t.start(l+1):t.end(l)+1,n.debug("Buffered range ["+t.start(l)+", "+t.end(l)+"] overlaps with targetTime "+e+" and range to be pruned ["+u+", "+r+"], using ["+a+", "+r+"] instead"+(a<r?"":" (no actual pruning)"));break}return a<t.end(t.length-1)?{start:a,end:r}:null}(e,r);i&&t.push(i),o&&t.push(o)}return t}function ae(){(!L||W===o.Z.TEXT&&j.isTextEnabled())&&ce()}function se(){he()}function le(){he(),D=NaN}function ue(e,t){var n,r,i=m.getAllBufferRanges(),o=0,a=0,s=null,l=null,u=0,c=isNaN(t)?.15:t;if(null!=i){for(r=0,n=i.length;r<n;r++)if(o=i.start(r),a=i.end(r),null===s)u=Math.abs(o-e),(e>=o&&e<a||u<=c)&&(s=o,l=a);else{if(!((u=o-l)<=c))break;l=a}if(null!==s)return{start:s,end:l}}return null}function ce(){if(Z){var e=Z.getTime()||0;y&&(e=isNaN(D)?0:D);var t=Y.get().streaming.gaps.jumpGaps&&!isNaN(Y.get().streaming.gaps.smallGapLimit)?Y.get().streaming.gaps.smallGapLimit:NaN;i=Math.max(function(e,t){var n;return Y.get().streaming.gaps.jumpGaps&&(t=Y.get().streaming.gaps.smallGapLimit),null===(n=ue(e,t))?0:n.end-e}(e,t),0),Ie(u.Z.BUFFER_LEVEL_UPDATED,{mediaType:W,bufferLevel:i}),he()}}function de(){var e=p>=f-1,t=Z.getTimeToStreamEnd(q)-i<1e-5;!e&&!t||r||(Te(!0),n.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(q.id," and type ").concat(W)))}function he(){W!==o.Z.AUDIO&&W!==o.Z.VIDEO||((!Z.getLowLatencyModeEnabled()&&i<Y.get().streaming.buffer.stallThreshold||0===i)&&!r?pe(s.Z.BUFFER_EMPTY):(r||i>=Y.get().streaming.buffer.stallThreshold||Z.getLowLatencyModeEnabled()&&i>0)&&pe(s.Z.BUFFER_LOADED))}function pe(e){b===e||e===s.Z.BUFFER_EMPTY&&0===Z.getTime()||W===o.Z.TEXT&&!j.isTextEnabled()||(b=e,Ie(u.Z.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Ie(e===s.Z.BUFFER_LOADED?u.Z.BUFFER_LOADED:u.Z.BUFFER_EMPTY),n.debug(e===s.Z.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function fe(){m&&W!==o.Z.TEXT&&(r||ge(me()))}function me(){var e=[],t=m.getAllBufferRanges();if(!t||0===t.length)return e;var n=Z.getTime(),r=Math.max(0,n-Y.get().streaming.buffer.bufferToKeep),i=z.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:n,threshold:N})[0];if(i)r=Math.min(i.startTime,r);else if(0===n&&Z.getIsDynamic())return[];if(t.start(0)<=r){for(var o={start:0,end:r},a=0;a<t.length&&t.end(a)<=r;a++)o.end=t.end(a);o.start<o.end&&e.push(o)}return e}function ge(e){return new Promise((function(t,n){if(e&&m&&0!==e.length){var r=[];e.forEach((function(e){r.push(function(e){return new Promise((function(t,n){e.resolve=t,e.reject=n,C.push(e)}))}(e))})),A||ye(),Promise.all(r).then((function(){t()})).catch((function(e){n(e)}))}else t()}))}function ye(){try{if(0===C.length||!m)return n.debug("Nothing to prune, halt pruning"),C=[],void(A=!1);var e=m.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return n.debug("SourceBuffer is empty (or does not exist), halt pruning"),C=[],void(A=!1);var t=C.shift();n.debug("".concat(W,": Removing buffer from: ").concat(t.start," to ").concat(t.end)),A=!0,Z.getTime()<t.end&&Te(!1),m.remove(t).then((function(e){ve(e)})).catch((function(e){ve(e)}))}catch(e){A=!1}}function ve(e){n.debug("onRemoved buffer from:",e.from,"to",e.to),ne(m.getAllBufferRanges()),0===C.length&&(A=!1,ce()),e.unintended&&(n.warn("Detected unintended removal from:",e.from,"to",e.to,"setting streamprocessor time to",e.from),Ie(u.Z.SEEK_TARGET,{time:e.from})),A?ye():(L?L=!1:ce(),Ie(u.Z.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:xe(),quotaExceeded:S}))}function be(e){return new Promise((function(t){e&&void 0!==e.MSETimeOffset&&m&&m.updateTimestampOffset?m.updateTimestampOffset(e.MSETimeOffset).then((function(){t()})).catch((function(){t()})):t()}))}function _e(){return m&&!r?m.updateAppendWindow(q):Promise.resolve()}function Ee(){++T*(Y.get().streaming.wallclockTimeUpdateInterval/1e3)>=Y.get().streaming.buffer.bufferPruningInterval&&(T=0,fe())}function we(){he()}function Te(e){(r=e)?Ie(u.Z.BUFFERING_COMPLETED):f=Number.POSITIVE_INFINITY}function Ae(){try{var e,t,n=m.getAllBufferRanges(),r=0;if(!n)return r;for(t=0,e=n.length;t<e;t++)r+=n.end(t)-n.start(t);return r}catch(e){return 0}}function Se(e){try{var t=e,n=m.getAllBufferRanges();if(!n||0===n.length)return NaN;for(var r=0;t===e&&r<n.length;){var i=n.start(r),o=n.end(r);t>=i&&t<=o&&(t=o),r+=1}return t===e?NaN:t}catch(e){}}function xe(){var e=Ae();return isNaN(e)||e<a}function Ie(e,t){var n=t||{};B.trigger(e,n,{streamId:q.id,mediaType:W})}function Re(e,t){if(a=Number.POSITIVE_INFINITY,b=void 0,f=Number.POSITIVE_INFINITY,p=0,_=null,r=!1,A=!1,S=!1,i=0,T=0,C=[],D=NaN,y=!1,m){var n=m;m=null,e||t||n.abort().then((function(){n.reset(t),n=null}))}L=!1}return t={initialize:function(e){K(e),B.on(u.Z.INIT_FRAGMENT_LOADED,J,t),B.on(u.Z.MEDIA_FRAGMENT_LOADED,ee,t),B.on(u.Z.WALLCLOCK_TIME_UPDATED,Ee,t),B.on(h.Z.PLAYBACK_PLAYING,le,t),B.on(h.Z.PLAYBACK_PROGRESS,ae,t),B.on(h.Z.PLAYBACK_TIME_UPDATED,ae,t),B.on(h.Z.PLAYBACK_RATE_CHANGED,we,t),B.on(h.Z.PLAYBACK_STALLED,se,t)},getStreamId:function(){return q.id},getType:function(){return W},getBufferControllerType:function(){return k},createBufferSink:X,dischargePreBuffer:function(){if(m&&g&&"function"==typeof g.discharge){var e=g.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+W+"PreBuffer discharge, adding buffer for:",r=0;r<e.length;r++)t+=" start: "+e.start(r)+", end: "+e.end(r)+";";n.debug(t)}else n.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");v=[];for(var i=g.discharge(),o=null,a=0;a<i.length;a++){var s=i[a];if(s.segmentType!==R.w.INIT_SEGMENT_TYPE){var l=I.extract(s.streamId,s.representationId);l&&o!==l&&(v.push(l),m.append(l),o=l)}v.push(s),m.append(s)}g.reset(),g=null}},getBuffer:function(){return m},getBufferLevel:function(){return i},getRangeAt:ue,hasBufferAtTime:function(e){try{var t=m.getAllBufferRanges();if(!t||0===t.length)return!1;for(var r=0;r<t.length;){var i=t.start(r),o=t.end(r);if(e>=i&&e<=o)return!0;r+=1}return!1}catch(e){return n.error(e),!1}},pruneBuffer:fe,setMediaSource:K,getMediaSource:function(){return c},appendInitSegmentFromCache:function(e){var t=I.extract(q.id,e);return!!t&&(n.info("Append Init fragment",W," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),te(t),!0)},getIsBufferingCompleted:function(){return r},setIsBufferingCompleted:Te,getIsPruningInProgress:function(){return A},reset:function(e,t){B.off(u.Z.INIT_FRAGMENT_LOADED,J,this),B.off(u.Z.MEDIA_FRAGMENT_LOADED,ee,this),B.off(u.Z.WALLCLOCK_TIME_UPDATED,Ee,this),B.off(h.Z.PLAYBACK_PLAYING,le,this),B.off(h.Z.PLAYBACK_PROGRESS,ae,this),B.off(h.Z.PLAYBACK_TIME_UPDATED,ae,this),B.off(h.Z.PLAYBACK_RATE_CHANGED,we,this),B.off(h.Z.PLAYBACK_STALLED,se,this),Re(e,t)},prepareForPlaybackSeek:function(){return r&&Te(!1),m.abort()},prepareForReplacementTrackSwitch:function(e){return new Promise((function(t,n){m.abort().then((function(){return _e()})).then((function(){return Y.get().streaming.buffer.useChangeTypeForTrackSwitch?m.changeType(e):Promise.resolve()})).then((function(){return ie()})).then((function(){Te(!1),t()})).catch((function(e){n(e)}))}))},prepareForNonReplacementTrackSwitch:function(e){return new Promise((function(t,n){_e().then((function(){return Y.get().streaming.buffer.useChangeTypeForTrackSwitch?m.changeType(e):Promise.resolve()})).then((function(){t()})).catch((function(e){n(e)}))}))},prepareForForceReplacementQualitySwitch:function(e){return new Promise((function(t,n){m.abort().then((function(){return _e()})).then((function(){return ie()})).then((function(){return be(e)})).then((function(){Te(!1),t()})).catch((function(e){n(e)}))}))},updateAppendWindow:_e,getAllRangesWithSafetyFactor:oe,getContinuousBufferTimeForTargetTime:Se,clearBuffers:ge,pruneAllSafely:ie,updateBufferTimestampOffset:be,setSeekTarget:function(e){D=e},segmentRequestingCompleted:function(e){isNaN(e)||(f=e,de())}},n=(0,d.Z)(F).getInstance().getLogger(t),I=O(F).getInstance(),Re(),t}F.__dashjs_factory_name=k;const B=c.Z.getClassFactory(F);var U="NotFragmentedTextBufferController";function z(e){e=e||{};var t,n,r,i,o,a,s=this.context,c=(0,l.Z)(s).getInstance(),d=e.textController,h=e.errHandler,p=e.streamInfo,f=e.type;function m(e){i=e}function g(e){var t,r;n!==e&&(n=e)&&(t=u.Z.BUFFERING_COMPLETED,r={},c.trigger(t,r,{streamId:p.id,mediaType:f}))}function y(e){e.chunk.bytes&&!n&&(a.save(e.chunk),o.append(e.chunk),g(!0))}return t={initialize:function(e){m(e)},getStreamId:function(){return p.id},getType:function(){return f},getBufferControllerType:function(){return U},createBufferSink:function(e){return new Promise((function(t,n){try{(o=M(s).create({mediaSource:i,textController:d,eventBus:c})).initializeForFirstUse(p,e),r||(o.getBuffer()&&"function"==typeof o.getBuffer().initialize&&o.getBuffer().initialize(),r=!0),t(o)}catch(e){h.error(new w.Z(x.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,x.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+f)),n(e)}}))},dischargePreBuffer:function(){},getBuffer:function(){return o},getBufferLevel:function(){return 0},getRangeAt:function(){return null},pruneBuffer:function(){},hasBufferAtTime:function(){return!0},getAllRangesWithSafetyFactor:function(){return[]},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY},setMediaSource:m,getMediaSource:function(){return i},appendInitSegmentFromCache:function(e){return null!==a.extract(p.id,e)},getIsBufferingCompleted:function(){return n},setIsBufferingCompleted:g,getIsPruningInProgress:function(){return!1},reset:function(e){c.off(u.Z.INIT_FRAGMENT_LOADED,y,t),!e&&o&&(o.abort(),o.reset(),o=null)},clearBuffers:function(){return Promise.resolve()},prepareForPlaybackSeek:function(){return Promise.resolve()},prepareForReplacementTrackSwitch:function(){return n=!1,Promise.resolve()},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve()},pruneAllSafely:function(){return Promise.resolve()},updateBufferTimestampOffset:function(){return Promise.resolve()},segmentRequestingCompleted:function(){}},r=!1,i=null,n=!1,a=O(s).getInstance(),c.on(u.Z.INIT_FRAGMENT_LOADED,y,t),t}z.__dashjs_factory_name=U;const G=c.Z.getClassFactory(z);function V(e){e=e||{};var t,n,r,i,a,c,p,f,m,g,y,v,b=this.context,_=(0,l.Z)(b).getInstance(),w=e.dashMetrics,T=e.mediaPlayerModel,A=e.fragmentModel,S=e.abrController,x=e.playbackController,I=e.textController,R=e.type,C=e.bufferController,M=e.representationController,L=e.settings;function P(e){if(!C.getIsBufferingCompleted()){D();var t=isNaN(e)?0:e;a=setTimeout(O,t)}}function D(){a&&(clearTimeout(a),a=null)}function O(){try{if(function(){try{return R===o.Z.TEXT&&!I.isTextEnabled()||x.isPaused()&&(!x.getStreamController().getInitialPlayback()||!x.getStreamController().getAutoPlay())&&!L.get().streaming.scheduling.scheduleWhilePaused}catch(e){return!1}}())return void D();if(function(){try{return M.getCurrentRepresentationInfo()&&(isNaN(m)||g||(e=n.id,t=S.getMaxAllowedIndexFor(R,e),!(!isNaN(f)&&f==t||(r.info("Top quality "+R+" index has changed from "+f+" to "+t),f=t,0)))||function(){var e=M.getCurrentRepresentationInfo();return!R||!e||w.getCurrentBufferLevel(R)<N()}())}catch(e){return!1}var e,t}()){var e=!1;v&&(e=S.checkPlaybackQuality(R,n.id)),e||(i=M.getCurrentRepresentationInfo(),y||i.quality!==m||g?(g?(r.debug("Switch track for "+R+", representation id = "+i.id),g=!1):r.debug("Quality has changed, get init request for representationid = "+i.id),_.trigger(u.Z.INIT_FRAGMENT_NEEDED,{representationId:i.id,sender:t},{streamId:n.id,mediaType:R}),v=!1,y=!1):(r.debug("Media segment needed for ".concat(R," and stream id ").concat(n.id)),_.trigger(u.Z.MEDIA_FRAGMENT_NEEDED,{},{streamId:n.id,mediaType:R}),v=!0))}else P(x.getLowLatencyModeEnabled()?L.get().streaming.scheduling.lowLatencyTimeout:L.get().streaming.scheduling.defaultTimeout)}catch(e){P(x.getLowLatencyModeEnabled()?L.get().streaming.scheduling.lowLatencyTimeout:L.get().streaming.scheduling.defaultTimeout)}var i}function N(){var e=NaN,t=M.getCurrentRepresentationInfo();return R&&t?(e=R===o.Z.TEXT?function(){try{if(I.isTextEnabled()){var e=M.getCurrentRepresentationInfo();if(isNaN(e.fragmentDuration)){var t=w.getCurrentSchedulingInfo(s.Z.SCHEDULING_INFO);return t?t.duration:0}return e.fragmentDuration}return 0}catch(e){return 0}}():R===o.Z.AUDIO&&c?function(){try{var e=w.getCurrentBufferLevel(o.Z.VIDEO),t=M.getCurrentRepresentationInfo();return isNaN(t.fragmentDuration)?e+1:Math.max(e+1,t.fragmentDuration)}catch(e){return 0}}():function(){try{var e=M.getCurrentRepresentationInfo().mediaInfo.streamInfo;return S.isPlayingAtTopQuality(e)?e.manifestInfo.duration>=L.get().streaming.buffer.longFormContentDurationThreshold?L.get().streaming.buffer.bufferTimeAtTopQualityLongForm:L.get().streaming.buffer.bufferTimeAtTopQuality:T.getStableBufferTime()}catch(e){return T.getStableBufferTime()}}(),e):e}function k(){F(!0)}function F(e){if(x&&A){var t=A.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:x.getTime(),threshold:0})[0];t&&x.getTime()>=t.startTime&&((!p.mediaInfo||t.mediaInfo.type===p.mediaInfo.type&&t.mediaInfo.id!==p.mediaInfo.id)&&e&&_.trigger(u.Z.TRACK_CHANGE_RENDERED,{mediaType:R,oldMediaInfo:p.mediaInfo,newMediaInfo:t.mediaInfo,streamId:n.id}),t.quality===p.quality&&t.adaptationIndex===p.adaptationIndex||!e||(r.debug("Quality change rendered for streamId ".concat(n.id," and type ").concat(R)),_.trigger(u.Z.QUALITY_CHANGE_RENDERED,{mediaType:R,oldQuality:p.quality,newQuality:t.quality,streamId:n.id})),p={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function B(){A.abortRequests(),D()}function U(){L.get().streaming.scheduling.scheduleWhilePaused||P()}function z(e){w.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function G(){v=!0,i=0,m=NaN,p={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},f=NaN,g=!1,y=!1}return t={initialize:function(e){c=e,_.on(u.Z.URL_RESOLUTION_FAILED,B,t),_.on(h.Z.PLAYBACK_STARTED,U,t),_.on(h.Z.PLAYBACK_RATE_CHANGED,z,t),_.on(h.Z.PLAYBACK_TIME_UPDATED,k,t)},getType:function(){return R},getStreamId:function(){return n.id},setTimeToLoadDelay:function(e){i=e},getTimeToLoadDelay:function(){return i},setSwitchTrack:function(e){g=e},getSwitchTrack:function(){return g},startScheduleTimer:P,clearScheduleTimer:D,reset:function(){_.off(u.Z.URL_RESOLUTION_FAILED,B,t),_.off(h.Z.PLAYBACK_STARTED,U,t),_.off(h.Z.PLAYBACK_RATE_CHANGED,z,t),_.off(h.Z.PLAYBACK_TIME_UPDATED,k,t),D(),F(!1),G(),n=null},getBufferTarget:N,getPlaybackController:function(){return x},setCheckPlaybackQuality:function(e){v=e},setInitSegmentRequired:function(e){y=e},setLastInitializedQuality:function(e){m=e}},r=(0,d.Z)(b).getInstance().getLogger(t),G(),n=e.streamInfo,t}V.__dashjs_factory_name="ScheduleController";const j=c.Z.getClassFactory(V);var H=n(7387);function Z(e){var t,n,r,i,a,s,l=(e=e||{}).eventBus,u=e.events,c=e.abrController,d=e.dashMetrics,p=e.playbackController,f=e.timelineConverter,m=e.type,g=e.streamInfo,y=e.dashConstants,v=e.segmentsController,b=e.isDynamic,_=e.adapter;function E(){return m}function w(){return r}function T(){return s}function A(){n=null,r=!0,i=[],a=null}function S(e){return new Promise((function(t,n){var r=e.hasInitialization(),o=e.hasSegments(),a=[];a.push(v.updateInitData(e,r)),a.push(v.updateSegmentData(e,o)),Promise.all(a).then((function(n){var r;n[0]&&!n[0].error&&(e=function(e,t){return t&&!t.error&&t.representation?t.representation:e}(e,n[0])),n[1]&&!n[1].error&&(e=function(e,t){if(t&&!t.error){var n,r,i,o,a=t.segments,s=[],l=0;for(n=0,r=a?a.length:0;n<r;n++)i=a[n],(o=(0,H.TJ)(f,b,e,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,l))&&(s.push(o),o=null,l++);return s.length>0&&(e.segments=s),e}}(e,n[1])),(r=e).mediaFinishedInformation=v.getMediaFinishedInformation(r),function(e){if(w()){var t,n,r=d.getCurrentManifestUpdate(),o=!1;if(r){for(var a=0;a<r.representationInfo.length;a++)if((t=r.representationInfo[a]).index===e.index&&t.mediaType===E()){o=!0;break}o||d.addManifestUpdateRepresentationInfo(e,E())}if(function(){for(var e=0,t=i.length;e<t;e++){var n=i[e].segmentInfoType;if(!i[e].hasInitialization()||(n===y.SEGMENT_BASE||n===y.BASE_URL)&&!i[e].segments)return!1}return!0}()){c.setPlaybackQuality(m,g,(n=s,i.indexOf(n)));var l=d.getCurrentDVRInfo(m);l&&d.updateManifestUpdateInfo({latency:l.range.end-p.getTime()}),d.getCurrentRepresentationSwitch(T().adaptation.type)||x(),R()}}}(e),t()})).catch((function(e){n(e)}))}))}function x(){!function(){if(!(c&&d&&p&&f))throw new Error(o.Z.MISSING_CONFIG_ERROR)}();var e=new Date,t=T(),n=1e3*p.getTime();t&&d.addRepresentationSwitch(t.adaptation.type,e,n,t.id),l.trigger(h.Z.REPRESENTATION_SWITCH,{mediaType:m,streamId:g.id,currentRepresentation:t,numberOfRepresentations:i.length},{streamId:g.id,mediaType:m})}function I(e){return null==e||e>=i.length?null:i[e]}function R(e){r=!1,l.trigger(u.DATA_UPDATE_COMPLETED,{data:n,currentRepresentation:s,error:e},{streamId:g.id,mediaType:m})}function C(e){s=e,a=_.convertRepresentationToRepresentationInfo(s)}function M(e){if(e.newDuration){var t=T();t&&t.adaptation.period&&(t.adaptation.period.duration=e.newDuration)}}return t={getStreamId:function(){return g.id},getType:E,getData:function(){return n},isUpdating:w,updateData:function(e,t,a,s,l){return new Promise((function(u,c){if(r=!0,i=t,n=e,C(I(l)),a!==o.Z.VIDEO&&a!==o.Z.AUDIO&&(a!==o.Z.TEXT||!s))return R(),void u();for(var d=[],h=0,p=i.length;h<p;h++){var f=i[h];d.push(S(f))}Promise.all(d).then((function(){C(I(l)),u()})).catch((function(e){c(e)}))}))},getCurrentRepresentation:T,getCurrentRepresentationInfo:function(){return a},getRepresentationForQuality:I,prepareQualityChange:function(e){C(I(e)),x()},reset:function(){l.off(h.Z.MANIFEST_VALIDITY_CHANGED,M,t),A()}},A(),l.on(h.Z.MANIFEST_VALIDITY_CHANGED,M,t),t}Z.__dashjs_factory_name="RepresentationController";const q=c.Z.getClassFactory(Z);var W=n(3106),Y=n(9326),K=n(7473),$=n(2594);function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Q=function e(){X(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};Q.INITIAL_PLAYOUT_START_REASON="initial_playout",Q.SEEK_START_REASON="seek",Q.RESUME_FROM_PAUSE_START_REASON="resume",Q.METRICS_COLLECTION_START_REASON="metrics_collection_start";var J=function e(){X(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};J.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",J.REBUFFERING_REASON="rebuffering",J.USER_REQUEST_STOP_REASON="user_request",J.END_OF_PERIOD_STOP_REASON="end_of_period",J.END_OF_CONTENT_STOP_REASON="end_of_content",J.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",J.FAILURE_STOP_REASON="failure";var ee=n(7802);function te(){return{ntpToUTC:function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime()}}}te.__dashjs_factory_name="TimeUtils";const ne=c.Z.getSingletonFactory(te);function re(e){e=e||{};var t,n,r,i,c,p,f,m,g,y,v,b,_,T,A=this.context,S=(0,l.Z)(A).getInstance(),I=e.streamInfo,C=e.type,M=e.errHandler,L=e.mimeType,P=e.timelineConverter,D=e.adapter,O=e.manifestModel,N=e.mediaPlayerModel,k=e.fragmentModel,F=e.abrController,U=e.playbackController,z=e.mediaController,V=e.textController,H=e.dashMetrics,Z=e.settings,X=e.boxParser,Q=e.segmentBlacklistController;function te(){return I.id}function re(){return C}function ie(){return D.getIsTextTrack(m.getData())}function oe(){c=[],i=null,_=0,g=!1,y=!1,T=null}function ae(e){return!isNaN(e)&&!isNaN(I.duration)&&isFinite(I.duration)&&e>=I.start+I.duration}function se(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.sender)if(U.getIsManifestUpdateInProgress())de();else if((!ie()||V.isTextEnabled())&&p&&e.representationId&&!p.appendInitSegmentFromCache(e.representationId)){var n=m.getCurrentRepresentation();if(0===n.range)return void le();var r=v?v.getInitRequest(i,n):null;r?k.executeRequest(r):t&&(f.setInitSegmentRequired(!0),de())}}function le(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(U.getIsManifestUpdateInProgress()||p.getIsPruningInProgress())de();else{var n=function(){var e,t=xe();if(isNaN(_)||re()===o.Z.TEXT&&!V.isTextEnabled())return null;if(v){var n=m&&t?m.getRepresentationForQuality(t.quality):null;e=g?v.getSegmentRequestForTime(i,n,_):v.getNextSegmentRequest(i,n)}return e}();n?(g=!1,ue(n)):ce(t)}}function ue(e){isNaN(e.startTime+e.duration)||(_=e.startTime+e.duration),e.delayLoadingTime=(new Date).getTime()+f.getTimeToLoadDelay(),f.setTimeToLoadDelay(0),function(e){var t=e.url;return e.range&&(t=t.concat("_",e.range)),Q.contains(t)}(e)?(n.warn("Fragment request url ".concat(e.url," for stream id ").concat(I.id," and media type ").concat(C," is on the ignore list and will be skipped")),de()):(n.debug("Next fragment request url for stream id ".concat(I.id," and media type ").concat(C," is ").concat(e.url)),k.executeRequest(e))}function ce(e){var t,o=m.getCurrentRepresentation();if(!Z.get().streaming.gaps.enableSeekFix||!g&&0!==U.getTime()||(r?r&&o.segmentInfoType===a.Z.SEGMENT_TIMELINE&&(t=v.getValidTimeAheadOfTargetTime(_,i,o,Z.get().streaming.gaps.threshold)):t=v.getValidTimeAheadOfTargetTime(_,i,o,Z.get().streaming.gaps.threshold),isNaN(t)||t===_)){if(v.isLastSegmentRequested(o,_)){var s=v.getCurrentIndex();return n.debug("Segment requesting for stream ".concat(I.id," has finished")),S.trigger(u.Z.STREAM_REQUESTING_COMPLETED,{segmentIndex:s},{streamId:I.id,mediaType:C}),p.segmentRequestingCompleted(s),void f.clearScheduleTimer()}e&&de()}else U.isSeeking()||0===U.getTime()?(n.warn("Adjusting playback time ".concat(t," because of gap in the manifest. Seeking by ").concat(t-_)),U.seek(t,!1,!1)):(n.warn("Adjusting buffering time ".concat(t," because of gap in the manifest. Adjusting time by ").concat(t-_)),De(t),e&&de())}function de(){f.startScheduleTimer(U.getLowLatencyModeEnabled()?Z.get().streaming.scheduling.lowLatencyTimeout:Z.get().streaming.scheduling.defaultTimeout)}function he(e){e.error||p.getIsBufferingCompleted()||p.updateBufferTimestampOffset(e.currentRepresentation)}function pe(e){H.addBufferState(C,e.state,f.getBufferTarget()),e.state!==s.Z.BUFFER_EMPTY||U.isSeeking()||(n.info("Buffer is empty! Stalling!"),H.pushPlayListTraceMetrics(new Date,J.REBUFFERING_REASON))}function fe(e){k.syncExecutedRequestsWithBufferedRange(p.getBuffer().getAllBufferRanges(),I.duration),e.quotaExceeded&&e.from>U.getTime()&&De(e.from),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&f.startScheduleTimer()}function me(e){if(e&&e.lastRequestAppended&&e.lastRequestAppended.url){var t=e.lastRequestAppended.url;e.lastRequestAppended.range&&(t=t.concat("_",e.lastRequestAppended.range)),n.warn("Blacklisting segment with url ".concat(t)),Q.add(t)}}function ge(e){if(n.debug("Appended bytes for ".concat(e.mediaType," and stream id ").concat(e.streamId)),e.segmentType===R.w.INIT_SEGMENT_TYPE){var t=e.quality;f.setLastInitializedQuality(t),n.info("["+C+"] lastInitializedRepresentationInfo changed to "+e.quality)}T?ye(T):f.startScheduleTimer(0)}function ye(e){var t=k.getRequests({state:E.FRAGMENT_MODEL_LOADING});if(t&&t.length>0)return n.debug("Preparing for default quality switch: Waiting for ongoing segment request to be finished before applying switch."),void(T=e);p.updateBufferTimestampOffset(e).then((function(){i.segmentAlignment||i.subSegmentAlignment?f.startScheduleTimer():Le(),T=null,y=!1})).catch((function(){T=null,y=!1}))}function ve(e){n.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),U.isSeeking()||f.getSwitchTrack()||y||(n.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),e.request&&e.request.isInitializationRequest()?f.setInitSegmentRequired(!0):De(e.request.startTime+e.request.duration/2),f.startScheduleTimer(0))}function be(e){n.info("OnFragmentLoadingCompleted for stream id "+I.id+" and media type "+C+" - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),ie()&&f.startScheduleTimer(0),e.error&&e.request.serviceLocation&&function(e){n.info("Fragment loading completed with an error"),e&&e.request&&e.request.type&&(e.request.type===R.w.INIT_SEGMENT_TYPE?se({representationId:e.request.representationId,sender:{}},!1):e.request.type===R.w.MEDIA_SEGMENT_TYPE&&(De(e.request.startTime+e.request.duration/2),le({},!1)))}(e)}function _e(){De(U.getTime()),Se().startScheduleTimer()}function Ee(e){var t=e.currentTrackInfo;if(t){var n=c.find((function(e){return e.index===t.index&&e.lang===t.lang}));n&&Ae(n).then((function(){p.setIsBufferingCompleted(!1),De(U.getTime()),f.setInitSegmentRequired(!0),f.startScheduleTimer()}))}}function we(e){De(e.quotaExceededTime),f.clearScheduleTimer()}function Te(){return p?p.getBuffer():null}function Ae(e){e===i||e&&i&&e.type!==i.type||(i=e);var t=D.getRealAdaptation(I,i),n=D.getVoRepresentations(i);if(m){var a,s=m.getData(),l=F.getMaxAllowedIndexFor(C,I.id),u=F.getMinAllowedIndexFor(C,I.id),c=null;return null!==s&&s.id===t.id||C===o.Z.TEXT?a=F.getQualityFor(C,I.id):(c=F.getThroughputHistory().getAverageThroughput(C,r)||F.getInitialBitrateFor(C,I.id),a=F.getQualityForBitrate(i,c,I.id)),void 0!==u&&a<u&&(a=u),a>l&&(a=l),m.updateData(t,n,C,i.isFragmented,a)}return Promise.resolve()}function Se(){return f}function xe(e){var t;return void 0!==e?((0,W.SE)(e),t=m?m.getRepresentationForQuality(e):null):t=m?m.getCurrentRepresentation():null,D.convertRepresentationToRepresentationInfo(t)}function Ie(){return!!p&&p.getIsBufferingCompleted()}function Re(e){if(Z.get().streaming.enableManifestTimescaleMismatchFix){var t=e.chunk,n=t.bytes,r=xe(t.quality),i=m&&r?m.getRepresentationForQuality(r.quality):null;r&&i&&(i.timescale=X.getMediaTimescaleFromMoov(n))}}function Ce(e){var t=e.chunk,n=t.bytes,r=t.quality,i=xe(r),o=m&&i?m.getRepresentationForQuality(i.quality):null;if(i&&o){var s;if(Z.get().streaming.parseInbandPrft&&e.request.type===R.w.MEDIA_SEGMENT_TYPE){var l=function(e,t){var n=e.getBoxes("prft"),r=[];return n.forEach((function(e){r.push(function(e,t){var n="unknown";switch(e.flags){case 0:n=a.Z.PRODUCER_REFERENCE_TIME_TYPE.ENCODER;break;case 16:n=a.Z.PRODUCER_REFERENCE_TIME_TYPE.APPLICATION;break;case 24:n=a.Z.PRODUCER_REFERENCE_TIME_TYPE.CAPTURED}var r=1e3*e.ntp_timestamp_sec+e.ntp_timestamp_frac/Math.pow(2,32)*1e3;return{type:n,ntpTimestamp:r=ne(A).getInstance().ntpToUTC(r),mediaTime:e.media_time/t}}(e,t))})),r}(s=s||X.parse(n),o.timescale);l&&l.length&&S.trigger(h.Z.INBAND_PRFT,{data:l},{streamId:I.id,mediaType:C})}var c=D.getEventsFor(i.mediaInfo,null,I),d=D.getEventsFor(i,o,I);if(c&&c.length>0||d&&d.length>0){var p=k.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,quality:r,index:t.index})[0],f=function(e,t,n,r){try{for(var i={},o=[],a=n.concat(r),s=0,l=a.length;s<l;s++)i[a[s].schemeIdUri+"/"+a[s].value]=a[s];var u=e.getBoxes("emsg");if(!u||0===u.length)return o;for(var c=e.getBox("sidx"),d=!c||isNaN(c.earliest_presentation_time)||isNaN(c.timescale)?t&&!isNaN(t.mediaStartTime)?t.mediaStartTime:0:c.earliest_presentation_time/c.timescale,h=Math.max(d,0),p=m.getCurrentRepresentation(),f=0,g=u.length;f<g;f++){var y=D.getEvent(u[f],i,h,p);y&&o.push(y)}return o}catch(e){return[]}}(s=s||X.parse(n),p,c,d);S.trigger(u.Z.INBAND_EVENTS,{events:f},{streamId:I.id})}}}function Me(){var e=U.getTime();Z.get().streaming.buffer.flushBufferAtTrackSwitch&&U.seek(e+.001,!1,!0),De(e),p.setSeekTarget(e),f.startScheduleTimer()}function Le(){var e=U.getTime(),t=p.getContinuousBufferTimeForTargetTime(e);De(isNaN(t)?e:t),f.startScheduleTimer()}function Pe(e){e&&!isNaN(e.time)&&(De(e.time),p.setSeekTarget(e.time))}function De(e){_=e,g=!0}return t={initialize:function(n,i,s){b=(0,ee.Z)(A).create({events:u.Z,eventBus:S,streamInfo:I,timelineConverter:P,dashConstants:a.Z,segmentBaseController:e.segmentBaseController,type:C}),v=(0,Y.Z)(A).create({streamInfo:I,type:C,timelineConverter:P,dashMetrics:H,mediaPlayerModel:N,baseURLController:e.baseURLController,errHandler:M,segmentsController:b,settings:Z,boxParser:X,events:u.Z,eventBus:S,errors:x,debug:(0,d.Z)(A).getInstance(),requestModifier:(0,K.Z)(A).getInstance(),dashConstants:a.Z,constants:o.Z,urlUtils:(0,$.Z)(A).getInstance()}),r=I.manifestInfo.isDynamic,v.initialize(r),F.registerStreamType(C,t),m=q(A).create({streamInfo:I,type:C,abrController:F,dashMetrics:H,playbackController:U,timelineConverter:P,dashConstants:a.Z,events:u.Z,eventBus:S,errors:x,isDynamic:r,adapter:D,segmentsController:b}),p=function(e,t){return e?e!==o.Z.TEXT||t?B(A).create({streamInfo:I,type:e,mediaPlayerModel:N,manifestModel:O,fragmentModel:k,errHandler:M,mediaController:z,representationController:m,adapter:D,textController:V,abrController:F,playbackController:U,settings:Z}):G(A).create({streamInfo:I,type:e,mimeType:L,fragmentModel:k,textController:V,errHandler:M,settings:Z}):(M.error(new w.Z(x.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,x.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}(C,s),p&&p.initialize(n),(f=j(A).create({streamInfo:I,type:C,mimeType:L,adapter:D,dashMetrics:H,mediaPlayerModel:N,fragmentModel:k,abrController:F,playbackController:U,textController:V,mediaController:z,bufferController:p,representationController:m,settings:Z})).initialize(i),_=0,g=!1},getStreamId:te,getType:re,isUpdating:function(){return!!m&&m.isUpdating()},getBufferController:function(){return p},dischargePreBuffer:function(){p.dischargePreBuffer()},getFragmentModel:function(){return k},getScheduleController:Se,getRepresentationController:function(){return m},getRepresentationInfo:xe,getBufferLevel:function(){return p?p.getBufferLevel():0},isBufferingCompleted:Ie,createBufferSinks:function(e){var t=Te();return t?Promise.resolve(t):p?p.createBufferSink(i,e):Promise.resolve(null)},updateStreamInfo:function(e){return I=e,Ie()?Promise.resolve():p.updateAppendWindow()},getStreamInfo:function(){return I},selectMediaInfo:Ae,clearMediaInfoArray:function(){c=[]},addMediaInfo:function(e){-1===c.indexOf(e)&&c.push(e)},prepareTrackSwitch:function(){return new Promise((function(e){n.debug("Preparing track switch for type ".concat(C));var t=C===o.Z.TEXT||Z.get().streaming.trackSwitchMode[C]===o.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&U.getTimeToStreamEnd(I)>Z.get().streaming.buffer.stallThreshold;if(p.getIsBufferingCompleted()&&!t)return p.prepareForNonReplacementTrackSwitch(i.codec).then((function(){S.trigger(u.Z.BUFFERING_COMPLETED,{},{streamId:I.id,mediaType:C})})).catch((function(){S.trigger(u.Z.BUFFERING_COMPLETED,{},{streamId:I.id,mediaType:C})})),void e();f.clearScheduleTimer(),f.setSwitchTrack(!0),t?(S.trigger(u.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:C,streamId:I.id},{mediaType:C,streamId:I.id}),k.abortRequests(),p.prepareForReplacementTrackSwitch(i.codec).then((function(){var e=xe();return p.updateBufferTimestampOffset(e)})).then((function(){Me(),e()})).catch((function(){Me(),e()}))):p.prepareForNonReplacementTrackSwitch(i.codec).then((function(){Le(),e()})).catch((function(){Le(),e()}))}))},prepareQualityChange:function(e){T&&n.warning("Canceling queued representation switch to ".concat(T.quality," for ").concat(C)),n.debug("Preparing quality switch for type ".concat(C));var t=e.newQuality;y=!0,f.clearScheduleTimer(),m.prepareQualityChange(t);var r=xe(t);e.reason&&e.reason.forceReplace?function(e){k.abortRequests(),S.trigger(u.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:C,streamId:I.id},{mediaType:C,streamId:I.id}),p.prepareForForceReplacementQualitySwitch(e).then((function(){Me(),y=!1})).catch((function(){Me(),y=!1}))}(r):Z.get().streaming.buffer.fastSwitchEnabled?function(e){var t=U.getTime(),n=1.5*(isNaN(e.fragmentDuration)?1:e.fragmentDuration),r=k.getRequests({state:E.FRAGMENT_MODEL_EXECUTED,time:t+n,threshold:0})[0];if(r&&!ie()){var i=p.getBufferLevel(),o=F.getAbandonmentStateFor(I.id,C);r.quality<e.quality&&i>=n&&o!==s.Z.ABANDON_LOAD?p.updateBufferTimestampOffset(e).then((function(){k.abortRequests(),De(t+n),f.setCheckPlaybackQuality(!1),f.startScheduleTimer(),y=!1})).catch((function(){y=!1})):ye(e)}else f.startScheduleTimer(),y=!1}(r):ye(r),H.pushPlayListTraceMetrics(new Date,J.REPRESENTATION_SWITCH_STOP_REASON),H.createPlaylistTraceMetrics(r.id,1e3*U.getTime(),U.getPlaybackRate())},getMediaInfo:function(){return i},getMediaSource:function(){return p.getMediaSource()},setMediaSource:function(e){return p.setMediaSource(e,i)},getBuffer:Te,setExplicitBufferingTime:De,finalisePlayList:function(e,t){H.pushPlayListTraceMetrics(e,t)},probeNextRequest:function(){var e=xe(),t=m&&e?m.getRepresentationForQuality(e.quality):null;return v.getNextSegmentRequestIdempotent(i,t)},prepareInnerPeriodPlaybackSeeking:function(e){return new Promise((function(t){if(p.hasBufferAtTime(e.seekTime))return p.pruneBuffer(),ae(p.getContinuousBufferTimeForTargetTime(e.seekTime))&&p.setIsBufferingCompleted(!0),void t();f.clearScheduleTimer(),k.abortRequests(),p.prepareForPlaybackSeek().then((function(){var t=p.getAllRangesWithSafetyFactor(e.seekTime);return p.clearBuffers(t)})).then((function(){var n=p.getContinuousBufferTimeForTargetTime(e.seekTime);if(ae(n))p.setIsBufferingCompleted(!0),t();else{var r=isNaN(n)?e.seekTime:n;De(r),p.setSeekTarget(r);var i=[];i.push(p.updateAppendWindow());var o=xe();i.push(p.updateBufferTimestampOffset(o)),Promise.all(i).then((function(){f.setInitSegmentRequired(!0),f.setCheckPlaybackQuality(!1),f.startScheduleTimer(),t()}))}})).catch((function(e){n.error(e)}))}))},prepareOuterPeriodPlaybackSeeking:function(){return new Promise((function(e,t){try{f.clearScheduleTimer(),k.abortRequests(),p.prepareForPlaybackSeek().then((function(){return p.pruneAllSafely()})).then((function(){e()}))}catch(e){t(e)}}))},reset:function(e,n){v&&v.reset(),p&&(p.reset(e,n),p=null),f&&(f.reset(),f=null),m&&(m.reset(),m=null),b&&(b=null),F&&F.unRegisterStreamType(te(),C),S.off(u.Z.DATA_UPDATE_COMPLETED,he,t),S.off(u.Z.INIT_FRAGMENT_NEEDED,se,t),S.off(u.Z.MEDIA_FRAGMENT_NEEDED,le,t),S.off(u.Z.INIT_FRAGMENT_LOADED,Re,t),S.off(u.Z.MEDIA_FRAGMENT_LOADED,Ce,t),S.off(u.Z.BUFFER_LEVEL_STATE_CHANGED,pe,t),S.off(u.Z.BUFFER_CLEARED,fe,t),S.off(u.Z.SEEK_TARGET,Pe,t),S.off(u.Z.FRAGMENT_LOADING_ABANDONED,ve,t),S.off(u.Z.FRAGMENT_LOADING_COMPLETED,be,t),S.off(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,_e,t),S.off(u.Z.SET_NON_FRAGMENTED_TEXT,Ee,t),S.off(u.Z.QUOTA_EXCEEDED,we,t),S.off(u.Z.SOURCE_BUFFER_ERROR,me,t),S.off(u.Z.BYTES_APPENDED_END_FRAGMENT,ge,t),oe(),C=null,I=null}},n=(0,d.Z)(A).getInstance().getLogger(t),oe(),S.on(u.Z.DATA_UPDATE_COMPLETED,he,t,{priority:l.Z.EVENT_PRIORITY_HIGH}),S.on(u.Z.INIT_FRAGMENT_NEEDED,se,t),S.on(u.Z.MEDIA_FRAGMENT_NEEDED,le,t),S.on(u.Z.INIT_FRAGMENT_LOADED,Re,t),S.on(u.Z.MEDIA_FRAGMENT_LOADED,Ce,t),S.on(u.Z.BUFFER_LEVEL_STATE_CHANGED,pe,t),S.on(u.Z.BUFFER_CLEARED,fe,t),S.on(u.Z.SEEK_TARGET,Pe,t),S.on(u.Z.FRAGMENT_LOADING_ABANDONED,ve,t),S.on(u.Z.FRAGMENT_LOADING_COMPLETED,be,t),S.on(u.Z.QUOTA_EXCEEDED,we,t),S.on(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,_e,t),S.on(u.Z.SET_NON_FRAGMENTED_TEXT,Ee,t),S.on(u.Z.SOURCE_BUFFER_ERROR,me,t),S.on(u.Z.BYTES_APPENDED_END_FRAGMENT,ge,t),t}re.__dashjs_factory_name="StreamProcessor";const ie=c.Z.getClassFactory(re),oe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};var ae=n(9032);function se(e,t){if(e){if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ue(e){e=e||{};var t,n,r=this.context,i=e.requestModifier,a=e.lowLatencyThroughputModel,s=e.boxParser,l=(0,I.Z)(r).getInstance();function u(e){var t,r=new Date,u=e.request,h=new Headers;if(u.range&&h.append("Range","bytes="+u.range),e.headers)for(var p in e.headers){var f=e.headers[p];f&&h.append(p,f)}u.requestStartDate||(u.requestStartDate=r),i&&i.modifyRequestHeader&&i.modifyRequestHeader({setRequestHeader:function(e,t){h.append(e,t)}},{url:e.url}),"function"==typeof window.AbortController&&(t=new AbortController,e.abortController=t,t.signal.onabort=e.onabort);var m={method:e.method,headers:h,credentials:e.withCredentials?"include":void 0,signal:t?t.signal:void 0},g=l.get().streaming.abr.fetchThroughputCalculationMode,y=Date.now(),v=0;new Promise((function(e){if(g===o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&a&&(v=a.getThroughputCapacityDelayMS(u,1e3*n.getCurrentBufferLevel(u.mediaType))))return setTimeout(e,v);e()})).then((function(){var t=Date.now();fetch(e.url,m).then((function(r){e.response||(e.response={}),e.response.status=r.status,e.response.statusText=r.statusText,e.response.responseURL=r.url,r.ok||e.onerror();var i,l="",h=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=se(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(r.headers.keys());try{for(h.s();!(i=h.n()).done;){var p=i.value;l+=p+": "+r.headers.get(p)+"\r\n"}}catch(e){h.e(e)}finally{h.f()}if(e.response.responseHeaders=l,!r.body)return r.arrayBuffer().then((function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()}));var f,m,b,_=parseInt(r.headers.get("Content-Length"),10),E=0,w=!1,T=new Uint8Array,A=0;if(g===o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&a){var S=t,x=0,I=function(e){if(Array.isArray(e))return e}(b=r.body.tee())||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),2!==n.length);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(b)||se(b,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),R=I[0],C=I[1];f=R.getReader(),m=[],f.read().then((function r(i){var o=i.value,s=i.done;if(x=Date.now(),o&&o.length){var c=x-S,d=o.length;m.push({chunkDownloadTimeRelativeMS:x-t,chunkDownloadDurationMS:c,chunkBytes:d,kbps:Math.round(8*d/(c/1e3)),bufferLevel:n.getCurrentBufferLevel(u.mediaType)})}if(s){var h=x-t,p=m.reduce((function(e,t){return e+t.chunkBytes}),0);return a.addMeasurement(u,h,m,y,v,l),void e.progress({loaded:p,total:p,lengthComputable:!0,time:a.getEstimatedDownloadDurationMS(u),stream:!0})}return S=Date.now(),f.read().then(r)})),e.reader=C.getReader()}else e.reader=r.body.getReader();var M=[],L=[],P=[],D=!0;c(e,(function t(n){var r=n.value;if(n.done){if(T){if(g!==o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var i=null,a=null;g===o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(i=function(e,t){try{var n,r;n=e.filter((function(t,n){return n<e.length-1})),r=t.filter((function(e,n){return n<t.length-1}));var i=[];if(n.length>1){for(var o=0,a=0,s=0;s<n.length;s++)if(n[s]&&r[s]){var l=r[s].ts-n[s].ts;if(l>1)i.push(8*r[s].bytes/l),a=0;else{0===a&&(a=n[s].ts,o=0);var u=r[s].ts-a;u>1?(o+=r[s].bytes,i.push(8*o/u),a=0):o+=r[s].bytes}}if(i.length>0)return i.reduce((function(e,t){return e+t}),0)/i.length}return null}catch(e){return null}}(L,P),i&&(a=8*E/i)):g===o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(a=d(M,E)),e.progress({loaded:E,total:isNaN(_)?E:_,lengthComputable:!0,time:a,stream:!0})}e.response.response=T.buffer}return e.onload(),void e.onend()}if(r&&r.length>0){T=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(T,r),E+=r.length,M.push({ts:Date.now(),bytes:r.length}),g===o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&D&&s.findLastTopIsoBoxCompleted(["moof"],T,A).found&&(D=!1,L.push({ts:performance.now(),bytes:r.length}));var l=s.findLastTopIsoBoxCompleted(["moov","mdat"],T,A);if(l.found){var u,h=l.lastCompletedOffset+l.size;g!==o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||D||(D=!0,P.push({ts:performance.now(),bytes:T.length})),h===T.length?(u=T,T=new Uint8Array):(u=new Uint8Array(T.subarray(0,h)),T=T.subarray(h)),e.progress({data:u.buffer,lengthComputable:!1,noTrace:!0}),A=0}else A=l.lastCompletedOffset,w||(e.progress({lengthComputable:!1,noTrace:!0}),w=!0)}c(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))}))}function c(e,t){e.reader.read().then(t).catch((function(t){e.onerror&&200===e.response.status&&e.onerror(t)}))}function d(e,t){try{if((e=e.filter((function(n){return n.bytes>t/4/e.length}))).length>1){var n=0,r=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach((function(t,i){var o=e[i+1];if(o){var a=o.ts-t.ts;n+=a<r?a:0}})),n}return null}catch(e){return null}}return t={load:function(e){i&&i.modifyRequest?(0,K.k)(e,i).then((function(){return u(e)})):u(e)},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:d,setup:function(e){n=e.dashMetrics}},t}ue.__dashjs_factory_name="FetchLoader";const ce=c.Z.getClassFactory(ue);var de=n(1180);const he=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.frameRate=null}var t;return(t=[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==a.Z.BASE_URL&&this.segmentInfoType!==a.Z.SEGMENT_BASE&&!this.indexRange}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),pe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null};var fe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};fe.DEFAULT_ID="defaultId";const me=fe,ge=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};var ye=n(2610);const ve=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="",this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};var be=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.queryParams={}};be.DEFAULT_DVB_PRIORITY=1,be.DEFAULT_DVB_WEIGHT=1;const _e=be,Ee=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0},we=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null},Te=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultServiceLocation=null,this.defaultServiceLocationArray=[],this.queryBeforeStart=!1,this.serverUrl=null,this.clientRequirement=!0},Ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri=null,this.value=null,this.id=null}var t;return(t=[{key:"init",value:function(e){return e&&(this.schemeIdUri=e.schemeIdUri?e.schemeIdUri:null,this.value=e.value?e.value:null,this.id=e.id?e.id:null),this}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();var Se=n(3101),xe=n.n(Se);function Ie(){return{areEqual:function(e,t){return xe()(e,t)}}}Ie.__dashjs_factory_name="ObjectUtils";const Re=c.Z.getSingletonFactory(Ie);var Ce=n(7803);const Me=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||null,this.queryParams={}},Le=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||null,this.ttl=r||NaN,this.queryParams={}};function Pe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=De(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function De(e,t){if(e){if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oe(e,t):void 0}}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ne(){var e,t,n,r,i=this.context,s=(0,$.Z)(i).getInstance(),l=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function u(e,t){if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.Representation_asArray&&e.Representation_asArray.length){var n=b(e.Representation_asArray[0]);if(n&&n.length>0&&Ce.Y.indexOf(n[0].schemeIdUri)>=0)return t===o.Z.IMAGE}if(e.ContentComponent_asArray&&e.ContentComponent_asArray.length>0){if(e.ContentComponent_asArray.length>1)return t===o.Z.MUXED;if(e.ContentComponent_asArray[0].contentType===t)return!0}var r=t===o.Z.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(t);if(e.Representation_asArray&&e.Representation_asArray.length){var i=e.Representation_asArray[0].codecs;if(r.test(i))return!0}if(e.hasOwnProperty(a.Z.MIME_TYPE))return r.test(e.mimeType);if(e.Representation_asArray)for(var s,l=0;l<e.Representation_asArray.length;l++)if((s=e.Representation_asArray[l]).hasOwnProperty(a.Z.MIME_TYPE))return r.test(s.mimeType);return!1}function c(e){if(!e)throw new Error("adaptation is not defined");if(e.hasOwnProperty(a.Z.SEGMENT_TEMPLATE)||e.hasOwnProperty(a.Z.SEGMENT_TIMELINE)||e.hasOwnProperty(a.Z.SEGMENT_LIST)||e.hasOwnProperty(a.Z.SEGMENT_BASE))return!0;if(e.Representation_asArray&&e.Representation_asArray.length>0){var t=e.Representation_asArray[0];if(t.hasOwnProperty(a.Z.SEGMENT_TEMPLATE)||t.hasOwnProperty(a.Z.SEGMENT_TIMELINE)||t.hasOwnProperty(a.Z.SEGMENT_LIST)||t.hasOwnProperty(a.Z.SEGMENT_BASE))return!0}return!1}function h(e){return u(e,o.Z.VIDEO)}function p(e){return u(e,o.Z.TEXT)}function f(e){return u(e,o.Z.IMAGE)}function m(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort((function(e,t){return e.bandwidth-t.bandwidth})),e}function g(e,t){return e&&e.Period_asArray&&l(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function y(e){return e&&e.Period_asArray?e.Period_asArray:[]}function v(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===a.Z.DYNAMIC),t}function b(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map((function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}})):null}function _(e){if(!e||!e.S_asArray)return NaN;var t=e.S_asArray[0],n=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:n.t-t.t}function E(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=me.DEFAULT_ID+"_"+t;return e.hasOwnProperty(a.Z.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function T(e,t,n){var r,i=[];if(!e)return i;for(r=0;r<e.length;r++){var s=new Ee;if(s.timescale=1,s.representation=t,!e[r].hasOwnProperty(o.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");s.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty(a.Z.TIMESCALE)&&(s.timescale=e[r].timescale),e[r].hasOwnProperty(a.Z.VALUE)&&(s.value=e[r].value),i.push(s),s.period=n}return i}function A(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some((function(n){if(n){var i=new _e,o=n.__text||n;return s.isRelative(o)&&(r=!0,e.baseUri&&(o=s.resolve(o,e.baseUri))),i.url=o,n.hasOwnProperty(a.Z.SERVICE_LOCATION)&&n.serviceLocation.length?i.serviceLocation=n.serviceLocation:i.serviceLocation=o,n.hasOwnProperty(a.Z.DVB_PRIORITY)&&(i.dvb_priority=n[a.Z.DVB_PRIORITY]),n.hasOwnProperty(a.Z.DVB_WEIGHT)&&(i.dvb_weight=n[a.Z.DVB_WEIGHT]),n.hasOwnProperty(a.Z.AVAILABILITY_TIME_OFFSET)&&(i.availabilityTimeOffset=n[a.Z.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(a.Z.AVAILABILITY_TIME_COMPLETE)&&(i.availabilityTimeComplete="false"!==n[a.Z.AVAILABILITY_TIME_COMPLETE]),t.push(i),r}})),t}function S(e){var t=new Te;return t.serverUrl=e.__text,e.hasOwnProperty(a.Z.DEFAULT_SERVICE_LOCATION)&&(t.defaultServiceLocation=e[a.Z.DEFAULT_SERVICE_LOCATION],t.defaultServiceLocationArray=t.defaultServiceLocation.split(" ")),e.hasOwnProperty(a.Z.QUERY_BEFORE_START)&&(t.queryBeforeStart="true"===e[a.Z.QUERY_BEFORE_START].toLowerCase()),e.hasOwnProperty(a.Z.CLIENT_REQUIREMENT)&&(t.clientRequirement="false"!==e[a.Z.CLIENT_REQUIREMENT].toLowerCase()),t}return e={getIsTypeOf:u,getIsText:p,getIsFragmented:c,getProducerReferenceTimesForAdaptation:function(e){var t=e&&e.hasOwnProperty(a.Z.PRODUCERREFERENCETIME_ASARRAY)?e[a.Z.PRODUCERREFERENCETIME_ASARRAY]:[];(e&&e.hasOwnProperty(a.Z.REPRESENTATION_ASARRAY)?e[a.Z.REPRESENTATION_ASARRAY]:[]).forEach((function(e){var n;e.hasOwnProperty(a.Z.PRODUCERREFERENCETIME_ASARRAY)&&t.push.apply(t,function(e){if(Array.isArray(e))return Oe(e)}(n=e[a.Z.PRODUCERREFERENCETIME_ASARRAY])||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(n)||De(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}));var n=[];return t.forEach((function(e){var t=new we;e.hasOwnProperty(a.Z.ID)&&(t[a.Z.ID]=e[a.Z.ID],e.hasOwnProperty(a.Z.WALL_CLOCK_TIME)&&(t[a.Z.WALL_CLOCK_TIME]=e[a.Z.WALL_CLOCK_TIME],e.hasOwnProperty(a.Z.PRESENTATION_TIME)&&(t[a.Z.PRESENTATION_TIME]=e[a.Z.PRESENTATION_TIME],e.hasOwnProperty(a.Z.INBAND)&&(t[a.Z.INBAND]="false"!==e[a.Z.INBAND]),e.hasOwnProperty(a.Z.TYPE)&&(t[a.Z.TYPE]=e[a.Z.TYPE]),n.push(t))))})),n},getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(a.Z.LANG)&&(t=e.lang),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(a.Z.VIEWPOINT_ASARRAY)&&e[a.Z.VIEWPOINT_ASARRAY].length?e[a.Z.VIEWPOINT_ASARRAY].map((function(e){return(new Ae).init(e)})):[]},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(a.Z.ROLE_ASARRAY)&&e[a.Z.ROLE_ASARRAY].length?e[a.Z.ROLE_ASARRAY].map((function(e){return(new Ae).init(e)})):[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(a.Z.ACCESSIBILITY_ASARRAY)&&e[a.Z.ACCESSIBILITY_ASARRAY].length?e[a.Z.ACCESSIBILITY_ASARRAY].map((function(e){return(new Ae).init(e)})):[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(a.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[a.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[a.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map((function(e){return(new Ae).init(e)})):[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(a.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[a.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[a.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map((function(e){return(new Ae).init(e)})):[]},getAdaptationForIndex:function(e,t,n){var r=g(t,n);return r.length>0&&l(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var r=g(t,n),o=0;o<r.length;o++)if(Re(i).getInstance().areEqual(r[o],e))return o;return-1},getAdaptationForId:function(e,t,n){var r,i,o=g(t,n);for(r=0,i=o.length;r<i;r++)if(o[r].hasOwnProperty(a.Z.ID)&&o[r].id===e)return o[r];return null},getAdaptationsForType:function(e,t,n){var r,i,o=g(e,t),a=[];for(r=0,i=o.length;r<i;r++)u(o[r],n)&&a.push(m(o[r]));return a},getRealPeriods:y,getRealPeriodForIndex:function(e,t){var n=y(t);return n.length>0&&l(e)?n[e]:null},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=l(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r&&(r=r.replace(/\sprofiles=[^;]*/g,"")),r},getSelectionPriority:function(e){try{var t=e&&void 0!==e.selectionPriority?parseInt(e.selectionPriority):1;return isNaN(t)?1:t}catch(e){return 1}},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(a.Z.CENC_DEFAULT_KID)?e[a.Z.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(a.Z.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:v,getId:function(e){return e&&e[a.Z.ID]||null},hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(a.Z.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(a.Z.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getPublishTime:function(e){return e&&e.hasOwnProperty(a.Z.PUBLISH_TIME)?new Date(e[a.Z.PUBLISH_TIME]):null},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=m(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map((function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}}))},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&l(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,r,i,o=[],s=function(e){if(e&&e.period&&l(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&l(e.index))return m(t.AdaptationSet_asArray[e.index])}}(e);if(s&&s.Representation_asArray){if(e&&e.period&&l(e.period.index)){var u=A(e.period.mpd.manifest);u&&(n=u[0])}for(var d=0,h=s.Representation_asArray.length;d<h;++d){var f=s.Representation_asArray[d],g=new he;if(g.index=d,g.adaptation=e,f.hasOwnProperty(a.Z.ID)&&(g.id=f.id),f.hasOwnProperty(a.Z.CODECS)&&(g.codecs=f.codecs),f.hasOwnProperty(a.Z.MIME_TYPE)&&(g.mimeType=f[a.Z.MIME_TYPE]),f.hasOwnProperty(a.Z.CODEC_PRIVATE_DATA)&&(g.codecPrivateData=f.codecPrivateData),f.hasOwnProperty(a.Z.BANDWITH)&&(g.bandwidth=f.bandwidth),f.hasOwnProperty(a.Z.WIDTH)&&(g.width=f.width),f.hasOwnProperty(a.Z.HEIGHT)&&(g.height=f.height),f.hasOwnProperty(a.Z.SCAN_TYPE)&&(g.scanType=f.scanType),f.hasOwnProperty(a.Z.MAX_PLAYOUT_RATE)&&(g.maxPlayoutRate=f.maxPlayoutRate),f.hasOwnProperty(a.Z.SEGMENT_BASE)?(t=f.SegmentBase,g.segmentInfoType=a.Z.SEGMENT_BASE):f.hasOwnProperty(a.Z.SEGMENT_LIST)?(t=f.SegmentList).hasOwnProperty(a.Z.SEGMENT_TIMELINE)?g.segmentInfoType=a.Z.SEGMENT_TIMELINE:g.segmentInfoType=a.Z.SEGMENT_LIST:f.hasOwnProperty(a.Z.SEGMENT_TEMPLATE)?((t=f.SegmentTemplate).hasOwnProperty(a.Z.SEGMENT_TIMELINE)?g.segmentInfoType=a.Z.SEGMENT_TIMELINE:g.segmentInfoType=a.Z.SEGMENT_TEMPLATE,t.hasOwnProperty(a.Z.INITIALIZATION_MINUS)&&(g.initialization=t.initialization.split("$Bandwidth$").join(f.bandwidth).split("$RepresentationID$").join(f.id))):g.segmentInfoType=a.Z.BASE_URL,g.essentialProperties=b(f),t){if(t.hasOwnProperty(a.Z.INITIALIZATION)){var y=t.Initialization;y.hasOwnProperty(a.Z.SOURCE_URL)&&(g.initialization=y.sourceURL),y.hasOwnProperty(a.Z.RANGE)&&(g.range=y.range)}else p(s)&&c(s)&&s.mimeType&&-1===s.mimeType.indexOf("application/mp4")&&(g.range=0);t.hasOwnProperty(a.Z.TIMESCALE)&&(g.timescale=t.timescale),t.hasOwnProperty(a.Z.DURATION)?g.segmentDuration=t.duration/g.timescale:f.hasOwnProperty(a.Z.SEGMENT_TEMPLATE)&&(t=f.SegmentTemplate).hasOwnProperty(a.Z.SEGMENT_TIMELINE)&&(g.segmentDuration=_(t.SegmentTimeline)/g.timescale),t.hasOwnProperty(a.Z.MEDIA)&&(g.media=t.media),t.hasOwnProperty(a.Z.START_NUMBER)&&(g.startNumber=t.startNumber),t.hasOwnProperty(a.Z.INDEX_RANGE)&&(g.indexRange=t.indexRange),t.hasOwnProperty(a.Z.PRESENTATION_TIME_OFFSET)&&(g.presentationTimeOffset=t.presentationTimeOffset/g.timescale),t.hasOwnProperty(a.Z.AVAILABILITY_TIME_OFFSET)?g.availabilityTimeOffset=t.availabilityTimeOffset:n&&void 0!==n.availabilityTimeOffset&&(g.availabilityTimeOffset=n.availabilityTimeOffset),t.hasOwnProperty(a.Z.AVAILABILITY_TIME_COMPLETE)?g.availabilityTimeComplete="false"!==t.availabilityTimeComplete:n&&void 0!==n.availabilityTimeComplete&&(g.availabilityTimeComplete=n.availabilityTimeComplete)}g.MSETimeOffset=(i=(r=g).presentationTimeOffset,r.adaptation.period.start-i),g.path=[e.period.index,e.index,d],o.push(g)}}return o},getAdaptationsForPeriod:function(e){var n,r,i,s=e&&l(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,c=[];if(s&&s.AdaptationSet_asArray)for(i=0;i<s.AdaptationSet_asArray.length;i++)r=s.AdaptationSet_asArray[i],n=new pe,r.hasOwnProperty(a.Z.ID)&&(n.id=r.id),n.index=i,n.period=e,u(r,o.Z.MUXED)?n.type=o.Z.MUXED:u(r,o.Z.AUDIO)?n.type=o.Z.AUDIO:h(r)?n.type=o.Z.VIDEO:p(r)?n.type=o.Z.TEXT:f(r)?n.type=o.Z.IMAGE:t.warn("Unknown Adaptation stream type"),c.push(n);return c},getRegularPeriods:function(e){var r,i,s=!!e&&v(e.manifest),l=[],u=null,c=null,d=null,h=null;for(i=0,r=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;i<r;i++)(c=e.manifest.Period_asArray[i]).hasOwnProperty(a.Z.START)?(h=new me).start=c.start:null!==u&&u.hasOwnProperty(a.Z.DURATION)&&null!==d?(h=new me).start=parseFloat((d.start+d.duration).toFixed(5)):0!==i||s||((h=new me).start=0),null!==d&&isNaN(d.duration)&&(null!==h?d.duration=parseFloat((h.start-d.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==h&&(h.id=E(c,i),h.index=i,h.mpd=e,c.hasOwnProperty(a.Z.DURATION)&&(h.duration=c.duration),d&&(d.nextPeriodId=h.id),l.push(h),u=c,d=h),c=null,h=null;return 0===l.length||null!==d&&isNaN(d.duration)&&(d.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error(o.Z.MISSING_CONFIG_ERROR)}();var t,r=v(e.mpd.manifest);return e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:r?t=Number.POSITIVE_INFINITY:n.error(new w.Z(x.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),t}(d)-d.start).toFixed(5))),l},getMpd:function(e){var t=new ge;return e&&(t.manifest=e,e.hasOwnProperty(a.Z.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(a.Z.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(a.Z.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(a.Z.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(a.Z.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(a.Z.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(a.Z.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(a.Z.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t},getEventsForPeriod:function(e){var t,n,i=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,s=i?i.Period_asArray:null,u=s&&e&&l(e.index)?s[e.index].EventStream_asArray:null,c=[];if(u)for(t=0;t<u.length;t++){var d=new Ee;if(d.period=e,d.timescale=1,!u[t].hasOwnProperty(o.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(d.schemeIdUri=u[t][o.Z.SCHEME_ID_URI],u[t].hasOwnProperty(a.Z.TIMESCALE)&&(d.timescale=u[t][a.Z.TIMESCALE]),u[t].hasOwnProperty(a.Z.VALUE)&&(d.value=u[t][a.Z.VALUE]),u[t].hasOwnProperty(a.Z.PRESENTATION_TIME_OFFSET)&&(d.presentationTimeOffset=u[t][a.Z.PRESENTATION_TIME_OFFSET]),n=0;u[t].Event_asArray&&n<u[t].Event_asArray.length;n++){var h=u[t].Event_asArray[n],p=new ve;p.presentationTime=0,p.eventStream=d,h.hasOwnProperty(a.Z.PRESENTATION_TIME)&&(p.presentationTime=h.presentationTime);var f=d.presentationTimeOffset?d.presentationTimeOffset/d.timescale:0;p.calculatedPresentationTime=p.presentationTime/d.timescale+e.start-f,h.hasOwnProperty(a.Z.DURATION)&&(p.duration=h.duration/d.timescale),h.hasOwnProperty(a.Z.ID)?p.id=h.id:p.id=null,h.Signal&&h.Signal.Binary?p.messageData=r.decodeArray(h.Signal.Binary.toString()):p.messageData=h.messageData||h.__cdata||h.__text,c.push(p)}}return c},getEssentialPropertiesForRepresentation:b,getEventStreamForAdaptationSet:function(e,t,n){var r,i,o;return e&&e.Period_asArray&&t&&t.period&&l(t.period.index)&&(i=e.Period_asArray[t.period.index])&&i.AdaptationSet_asArray&&l(t.index)&&(o=i.AdaptationSet_asArray[t.index])&&(r=o.InbandEventStream_asArray),T(r,null,n)},getEventStreamForRepresentation:function(e,t,n){var r,i,o,a;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&l(t.adaptation.period.index)&&(i=e.Period_asArray[t.adaptation.period.index])&&i.AdaptationSet_asArray&&l(t.adaptation.index)&&(o=i.AdaptationSet_asArray[t.adaptation.index])&&o.Representation_asArray&&l(t.index)&&(a=o.Representation_asArray[t.index])&&(r=a.InbandEventStream_asArray),T(r,t,n)},getUTCTimingSources:function(e){var t=v(e),n=!!e&&e.hasOwnProperty(a.Z.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,i=[];return(t||n)&&r&&r.forEach((function(e){var t=new ye.Z;e.hasOwnProperty(o.Z.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(a.Z.VALUE)&&(t.value=e.value.toString(),i.push(t)))})),i},getBaseURLsFromElement:A,getRepresentationSortFunction:function(){return function(e,t){return e.bandwidth-t.bandwidth}},getContentSteering:function(e){if(e&&e.hasOwnProperty(a.Z.CONTENT_STEERING_AS_ARRAY))return S(e[a.Z.CONTENT_STEERING_AS_ARRAY][0])},getLocation:function(e){return e&&e.hasOwnProperty(a.Z.LOCATION_AS_ARRAY)?e[a.Z.LOCATION_AS_ARRAY].map((function(e){var t=e.__text||e,n=e.hasOwnProperty(a.Z.SERVICE_LOCATION)?e[a.Z.SERVICE_LOCATION]:null;return new Me(t,n)})):[]},getPatchLocation:function(e){return e&&e.hasOwnProperty(a.Z.PATCH_LOCATION_AS_ARRAY)?e[a.Z.PATCH_LOCATION_AS_ARRAY].map((function(e){var t=e.__text||e,n=e.hasOwnProperty(a.Z.SERVICE_LOCATION)?e[a.Z.SERVICE_LOCATION]:null,r=e.hasOwnProperty(a.Z.TTL)?1e3*parseFloat(e[a.Z.TTL]):NaN;return new Le(t,n,r)})):[]},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(a.Z.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(a.Z.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(a.Z.SERVICE_DESCRIPTION)){var n,r=Pe(e.ServiceDescription_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=null,s=null,l=null,u=null,c=null,d=null,h=null;for(var p in i)i.hasOwnProperty(p)&&(p===a.Z.ID?o=i[p]:p===a.Z.SERVICE_DESCRIPTION_SCOPE?s=i[p].schemeIdUri:p===a.Z.SERVICE_DESCRIPTION_LATENCY?l={target:parseInt(i[p].target),max:parseInt(i[p].max),min:parseInt(i[p].min),referenceId:parseInt(i[p].referenceId)}:p===a.Z.SERVICE_DESCRIPTION_PLAYBACK_RATE?u={max:parseFloat(i[p].max),min:parseFloat(i[p].min)}:p===a.Z.SERVICE_DESCRIPTION_OPERATING_QUALITY?c={mediaType:i[p].mediaType,max:parseInt(i[p].max),min:parseInt(i[p].min),target:parseInt(i[p].target),type:i[p].type,maxQualityDifference:parseInt(i[p].maxQualityDifference)}:p===a.Z.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH?d={mediaType:i[p].mediaType,max:parseInt(i[p].max),min:parseInt(i[p].min),target:parseInt(i[p].target)}:p===a.Z.CONTENT_STEERING&&(h=S(i[p])));t.push({id:o,schemeIdUri:s,latency:l,playbackRate:u,operatingQuality:c,operatingBandwidth:d,contentSteering:h})}}catch(e){r.e(e)}finally{r.f()}}return t},getSegmentAlignment:function(e){return!(!e||!e.hasOwnProperty(a.Z.SEGMENT_ALIGNMENT))&&"true"===e[a.Z.SEGMENT_ALIGNMENT]},getSubSegmentAlignment:function(e){return!(!e||!e.hasOwnProperty(a.Z.SUB_SEGMENT_ALIGNMENT))&&"true"===e[a.Z.SUB_SEGMENT_ALIGNMENT]},getSupplementalPropertiesForAdaptation:function(e){var t={};if(e&&e.hasOwnProperty(a.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var n,r=Pe(e.SupplementalProperty_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hasOwnProperty(o.Z.SCHEME_ID_URI)&&i.hasOwnProperty(a.Z.VALUE)&&(t[i[o.Z.SCHEME_ID_URI]]=i[a.Z.VALUE])}}catch(e){r.e(e)}finally{r.f()}}return t},getSupplementalPropertiesAsArrayForAdaptation:function(e){return e&&e.hasOwnProperty(a.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map((function(e){return(new Ae).init(e)})):[]},getSupplementalPropertiesForRepresentation:function(e){var t={};if(e&&e.hasOwnProperty(a.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var n,r=Pe(e.SupplementalProperty_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hasOwnProperty(o.Z.SCHEME_ID_URI)&&i.hasOwnProperty(a.Z.VALUE)&&(t[i[o.Z.SCHEME_ID_URI]]=i[a.Z.VALUE])}}catch(e){r.e(e)}finally{r.f()}}return t},getSupplementalPropertiesAsArrayForRepresentation:function(e){return e&&e.hasOwnProperty(a.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map((function(e){return(new Ae).init(e)})):[]},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(r=e.BASE64))}},t=(0,d.Z)(i).getInstance().getLogger(e),e}Ne.__dashjs_factory_name="DashManifestModel";const ke=c.Z.getSingletonFactory(Ne);var Fe=n(703);function Be(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ue(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ze(){var e,t,n,r,i,a,s,u,c,d,p=this.context,f=(0,l.Z)(p).getInstance(),m=(0,I.Z)(p).getInstance();function g(){n={pr:1,nor:null,st:null,sf:null,sid:"".concat(Fe.Z.generateUuid()),cid:null},c={},u={},d={},v()}function y(){v()}function v(){if(a){var e=a.getStreamController();if(e&&"function"==typeof e.getActiveStream){var t=e.getActiveStream();t&&(s=t.getProcessors())}}}function b(e,t){var n,r={},i=Be(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;e[o]&&(r[o]=e[o])}}catch(e){i.e(e)}finally{i.f()}return r}function _(e){var t=m.get().streaming.cmcd.enabledKeys;return e.filter((function(e){return t.includes(e)}))}function E(e){try{return e.type===R.w.MPD_TYPE?((l=w()).ot="m",l):e.type===R.w.MEDIA_SEGMENT_TYPE?(t=e.mediaType,d.hasOwnProperty(t)||(d[t]=!1),u.hasOwnProperty(t)||(u[t]=!1),c.hasOwnProperty(t)||(c[t]=!1),function(e){var t,l=w(),h=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),p=function(e){try{return isNaN(e.duration)?NaN:Math.round(1e3*e.duration)}catch(e){return null}}(e),f=function(e){try{return 100*parseInt(r.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(e){return null}}(e.mediaType),g=function(e){try{var t=n.pr,r=i.getCurrentBufferLevel(e);return isNaN(t)||isNaN(r)?null:100*parseInt(r/t*10)}catch(e){return null}}(e.mediaType),y=T(e.mediaType),v=function(e){try{var t=r.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(e){return null}}(e.mediaType),b=n.pr,_=function(e){if(s&&0!==s.length){var t,n=Be(s);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.getType()===e)return r.probeNextRequest()}}catch(e){n.e(e)}finally{n.f()}}}(e.mediaType);e.mediaType===o.Z.VIDEO&&(t="v"),e.mediaType===o.Z.AUDIO&&(t="a"),e.mediaType===o.Z.TEXT&&(t="application/mp4"===e.mediaInfo.mimeType?"tt":"c");var E=m.get().streaming.cmcd.rtp;return E||(E=function(e){try{var t=a.getPlaybackRate();t||(t=1);var n=e.quality,r=e.mediaType,i=e.mediaInfo,o=e.duration;if(!i)return NaN;var s=T(r);0===s&&(s=500);var l=i.bitrateList[n].bandwidth*o/1e3/(s/t/1e3),u=m.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(m.get().streaming.cmcd.rtpSafetyFactor)?m.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(l*u/100)+1)}catch(e){return NaN}}(e)),isNaN(E)||(l.rtp=E),_&&(e.url!==_.url?l.nor=encodeURIComponent(Fe.Z.getRelativeUrl(e.url,_.url)):_.range&&(l.nrr=_.range)),h&&(l.br=h),t&&(l.ot=t),isNaN(p)||(l.d=p),isNaN(f)||(l.mtp=f),isNaN(g)||(l.dl=g),isNaN(y)||(l.bl=y),isNaN(v)||(l.tb=v),isNaN(b)||1===b||(l.pr=b),c[e.mediaType]&&(l.bs=!0,c[e.mediaType]=!1),!u[e.mediaType]&&d[e.mediaType]||(l.su=!0,u[e.mediaType]=!1,d[e.mediaType]=!0),l}(e)):e.type===R.w.INIT_SEGMENT_TYPE?function(){var e=w();return e.ot="i",e.su=!0,e}():e.type===R.w.OTHER_TYPE||e.type===R.w.XLINK_EXPANSION_TYPE?function(){var e=w();return e.ot="o",e}():e.type===R.w.LICENSE?function(e){var t=w();return t.ot="k",t}():null}catch(e){return null}var t,l}function w(){var e={},t=m.get().streaming.cmcd.cid?m.get().streaming.cmcd.cid:n.cid;return e.v=1,e.sid=m.get().streaming.cmcd.sid?m.get().streaming.cmcd.sid:n.sid,e.sid="".concat(e.sid),t&&(e.cid="".concat(t)),isNaN(n.pr)||1===n.pr||null===n.pr||(e.pr=n.pr),n.st&&(e.st=n.st),n.sf&&(e.sf=n.sf),e}function T(e){try{var t=i.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(e){return null}}function A(e){try{n.pr=e.playbackRate}catch(e){}}function S(t){try{var r=e.getIsDynamic(t.data)?"l":"v",i=t.protocol&&"MSS"===t.protocol?"s":"d";n.st="".concat(r),n.sf="".concat(i)}catch(e){}}function x(e){try{e.state&&e.mediaType&&e.state===h.Z.BUFFER_EMPTY&&(c[e.mediaType]||(c[e.mediaType]=!0),u[e.mediaType]||(u[e.mediaType]=!0))}catch(e){}}function C(){for(var e in c)c.hasOwnProperty(e)&&(c[e]=!0);for(var t in u)u.hasOwnProperty(t)&&(u[t]=!0)}function M(e){try{if(!e)return null;var t=Object.keys(e).sort((function(e,t){return e.localeCompare(t)})),n=t.length,r=t.reduce((function(t,r,i){return"v"===r&&1===e[r]||("string"==typeof e[r]&&"ot"!==r&&"sf"!==r&&"st"!==r?t+="".concat(r,"=").concat(JSON.stringify(e[r])):t+="".concat(r,"=").concat(e[r]),i<n-1&&(t+=",")),t}),"");return(r=r.replace(/=true/g,"")).replace(/,\s*$/,"")}catch(e){return null}}return t={getQueryParameter:function(e){try{if(m.get().streaming.cmcd&&m.get().streaming.cmcd.enabled){var t=E(e),n=function(e){try{var t=m.get().streaming.cmcd.enabledKeys;return Object.keys(e).filter((function(e){return t.includes(e)})).reduce((function(t,n){return t[n]=e[n],t}),{})}catch(t){return e}}(t),r=M(n);return f.trigger(de.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:r}),{key:"CMCD",value:r}}return null}catch(e){return null}},getHeaderParameters:function(e){try{if(m.get().streaming.cmcd&&m.get().streaming.cmcd.enabled){var t=E(e),n=b(t,_(["br","d","ot","tb"])),r=b(t,_(["bl","dl","mtp","nor","nrr","su"])),i=b(t,_(["bs","rtp"])),o=b(t,_(["cid","pr","sf","sid","st","v"])),a={"CMCD-Object":M(n),"CMCD-Request":M(r),"CMCD-Status":M(i),"CMCD-Session":M(o)};return f.trigger(de.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,headers:a}),a}return null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(r=e.abrController),e.dashMetrics&&(i=e.dashMetrics),e.playbackController&&(a=e.playbackController))},reset:function(){f.off(h.Z.PLAYBACK_RATE_CHANGED,A,this),f.off(h.Z.MANIFEST_LOADED,S,this),f.off(h.Z.BUFFER_LEVEL_STATE_CHANGED,x,t),f.off(h.Z.PLAYBACK_SEEKED,C,t),g()},initialize:function(){f.on(h.Z.PLAYBACK_RATE_CHANGED,A,t),f.on(h.Z.MANIFEST_LOADED,S,t),f.on(h.Z.BUFFER_LEVEL_STATE_CHANGED,x,t),f.on(h.Z.PLAYBACK_SEEKED,C,t),f.on(h.Z.PERIOD_SWITCH_COMPLETED,y,t)}},e=ke(p).getInstance(),g(),t}ze.__dashjs_factory_name="CmcdModel";const Ge=c.Z.getSingletonFactory(ze);function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function je(e,t){je=function(e,t){return new o(e,void 0,t)};var n=He(RegExp),r=RegExp.prototype,i=new WeakMap;function o(e,t,r){var o=n.call(this,e,t);return i.set(o,r||i.get(e)),o}function a(e,t){var n=i.get(t);return Object.keys(n).reduce((function(t,r){return t[r]=e[n[r]],t}),Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(o,n),o.prototype.exec=function(e){var t=r.exec.call(this,e);return t&&(t.groups=a(t,this)),t},o.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=i.get(this);return r[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+n[t]})))}if("function"==typeof t){var o=this;return r[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!==Ve(e[e.length-1])&&e.push(a(e,o)),t.apply(this,e)}))}return r[Symbol.replace].call(this,e,t)},je.apply(this,arguments)}function He(e){var t="function"==typeof Map?new Map:void 0;return He=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Ze(e,arguments,We(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),qe(r,e)},He(e)}function Ze(e,t,n){return Ze=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&qe(i,n.prototype),i},Ze.apply(null,arguments)}function qe(e,t){return qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qe(e,t)}function We(e){return We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},We(e)}var Ye="static",Ke="dynamic",$e="cmsd-",Xe=$e+Ye,Qe=$e+Ke,Je="stream",et=["mb","st","sf","v"],tt={video:"v",audio:"a",text:"tt",stream:Je},nt=/^[-0-9]/;function rt(){var e,t,n,r,i=this.context,o=(0,l.Z)(i).getInstance();function a(){n={},r={}}function s(e){e&&Object.keys(e).forEach((function(t){et.includes(t)||delete e[t]}))}function c(e){return!e||"false"!==e.toLowerCase()&&(nt.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}function h(e){try{for(var n={},r=e.split(","),i=0;i<r.length;i++){var o=r[i].split("="),a=o[0],s=c(o[1]);n[a]=s}return n}catch(e){t.error("Failed to parse CMSD-Static response header value:",e)}}function p(e){try{for(var n={},r=e.split(","),i=r[r.length-1].split(";"),o=1;o<i.length;o++){var a=i[o].split("="),s=a[0],l=c(a[1]);n[s]=l}return n}catch(e){return t.error("Failed to parse CMSD-Dynamic response header value:",e),[]}}function f(e){return tt[e]||"o"}function m(e,t,i){var o=e===Ye?n:r,a=o[t]||{},s=o[Je]||{};return a[i]||s[i]}return e={setConfig:function(){},initialize:function(){},reset:function(){a()},parseResponseHeaders:function(e,t){for(var i=null,a=null,l=e.split("\r\n"),c=l.length-1;c>=0;c--){var d=l[c].match(je(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(d&&d.groups){var m=d.groups.key.toLowerCase(),g=d.groups.value;switch(m){case Xe:i=h(g),o.trigger(u.Z.CMSD_STATIC_HEADER,i);break;case Qe:a||(a=p(g))}}}var y=Je;return i&&i.ot?y=i.ot:t&&(y=f(t)),s(n[y]),s(r[y]),i&&(n[y]=Object.assign(n[y]||{},i)),a&&(r[y]=Object.assign(r[y]||{},a)),{static:i,dynamic:a}},getMaxBitrate:function(e){var t=f(e);return m(Ke,t,"mb")||-1},getEstimatedThroughput:function(e){var t=f(e);return m(Ke,t,"etp")||null},getResponseDelay:function(e){var t=f(e);return m(Ke,t,"rd")||null},getRoundTripTime:function(e){var t=f(e);return m(Ke,t,"rtt")||null}},t=(0,d.Z)(i).getInstance().getLogger(e),a(),e}rt.__dashjs_factory_name="CmsdModel";const it=c.Z.getSingletonFactory(rt);function ot(){var e,t,n=this.context,r={};function i(){t=(0,d.Z)(n).getInstance().getLogger(e)}function o(e){for(var t={},n=0,r=0,i=0,o=0,a=e.length,s=0;s<a;++s)n+=e[s].chunkDownloadTimeRelativeMS,r+=e[s].bufferLevel,i+=e[s].chunkDownloadTimeRelativeMS*e[s].bufferLevel,o+=e[s].chunkDownloadTimeRelativeMS*e[s].chunkDownloadTimeRelativeMS;return t.m=(i-n*r/a)/(o-n*n/a),t.b=r/a-t.m*n/a,function(e){return t.m*e+t.b}}function a(e){var t,n=!0,r=e.reduce((function(e,t){return e+t.bufferLevelAtSegmentEnd}),0)/e.length;return e.forEach((function(e){Math.abs(e.bufferLevelAtSegmentEnd/e.bufferLevelAtSegmentStart)<.95&&(n=!1),e.bufferLevelAtSegmentEnd/r<.8&&(n=!1),t?t>e.bitrate&&(n=!1):t=e.bitrate})),n}return e={setup:i,addMeasurement:function(e,t,n,i,a){e&&e.mediaType&&!r[e.mediaType]&&(r[e.mediaType]=[]);var s=e.mediaInfo.bitrateList.find((function(t){return t.id===e.representationId}));r[e.mediaType].push({index:e.index,repId:e.representationId,mediaType:e.mediaType,requestTimeMS:i,adjustedAvailabilityStartTimeMS:e.availabilityStartTime.getTime(),segDurationMS:1e3*e.duration,chunksDurationMS:n.reduce((function(e,t){return e+t.chunkDownloadDurationMS}),0),segmentBytes:n.reduce((function(e,t){return e+t.chunkBytes}),0),bitrate:s&&s.bandwidth,bitrateList:e.mediaInfo.bitrateList,chunkMeasurements:n,fetchDownloadDurationMS:t,throughputCapacityDelayMS:a,getEstimatedBufferLevel:o(n.slice(1))}),r[e.mediaType].length>10&&r[e.mediaType].shift()},getThroughputCapacityDelayMS:function(e,t){var n=r[e.mediaType]&&r[e.mediaType].slice(-3);return!n||n.length<3?0:a(n)?t/4>250?250:t/4:0},getEstimatedDownloadDurationMS:function(e){var n=r[e.mediaType].slice(-1).pop(),i=r[e.mediaType].slice(-3),o=n.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;n.bufferLevelAtSegmentStart=n.getEstimatedBufferLevel(o/2),n.bufferLevelAtSegmentEnd=n.getEstimatedBufferLevel(o);var s=a(i),l=s?.6:.8;if(n.isBufferStable&&1.05*n.segDurationMS<n.fetchDownloadDurationMS)return n.fetchDownloadDurationMS;if(!s||n.segDurationMS<n.fetchDownloadDurationMS)return.8*n.fetchDownloadDurationMS;if(n.adjustedAvailabilityStartTimeMS<=n.requestTimeMS+n.throughputCapacityDelayMS-n.segDurationMS)return.8*n.fetchDownloadDurationMS;for(var u=n.requestTimeMS+n.throughputCapacityDelayMS-n.adjustedAvailabilityStartTimeMS,c=0,d=0,h=0,p=0;p<n.chunkMeasurements.length;p++){var f=n.chunkMeasurements[p];if(u<d+f.chunkDownloadDurationMS)break;d+=f.chunkDownloadDurationMS,c+=f.chunkBytes,h++}if(u<0&&t.warn("request time was before adjusted availibitly start time"),c&&d&&h>.2*n.chunkMeasurements.length){var m=c/d,g=n.segmentBytes/m;return n.fetchDownloadDurationMS<g?n.fetchDownloadDurationMS*l:g*l}var y=n.bitrate;return n.bitrateList.some((function(e){if(e.bandwidth>n.bitrate)return y=e.bandwidth,!0})),y===n.bitrate?n.fetchDownloadDurationMS*l:l*n.segmentBytes*8*1e3/y}},i(),e}ot.__dashjs_factory_name="LowLatencyThroughputModel";const at=c.Z.getSingletonFactory(ot);var st=n(5717);function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ut(e){e=e||{};var t,n,r,i,a,s,c,h,p,f,m,g=this.context,y=e.errHandler,v=e.dashMetrics,b=e.mediaPlayerModel,_=e.requestModifier,E=e.boxParser,T=e.errors,A=e.requestTimeout||0,S=(0,l.Z)(g).getInstance(),x=(0,I.Z)(g).getInstance();function C(e,t){var l,d=e.request,m=[],T=!0,I=!0,M=new Date,L=M,P=0,D=null,O=null;if(!_||!v||!y)throw new Error("config object is not correct or missing");var N,k=function(e){d.requestStartDate=M,d.requestEndDate=new Date,d.firstByteDate=d.firstByteDate||M,d.fileLoaderType=O;var t=l.response?l.response.responseURL:null,n=l.response?l.response.status:null,r=l.response&&l.response.getAllResponseHeaders?l.response.getAllResponseHeaders():l.response?l.response.responseHeaders:null,i=r&&x.get().streaming.cmsd&&x.get().streaming.cmsd.enabled?c.parseResponseHeaders(r,d.mediaType):null;v.addHttpRequest(d,t,n,r,e?m:null,i)},F=function(e){I=!1,k(e),d.type===R.w.MPD_TYPE&&(v.addManifestUpdate(d),S.trigger(u.Z.MANIFEST_LOADING_FINISHED,{request:d}))},B=function(){if(D&&(clearTimeout(D),D=null),-1!==n.indexOf(l)&&(n.splice(n.indexOf(l),1),I))if(F(!1),t>0){try{x.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&d.type===R.w.MEDIA_SEGMENT_TYPE&&b.getRetryAttemptsForType(R.w.MEDIA_SEGMENT_TYPE)===t&&S.trigger(u.Z.ATTEMPT_BACKGROUND_SYNC)}catch(e){}t--;var r={config:e};i.push(r),r.timeout=setTimeout((function(){-1!==i.indexOf(r)&&(i.splice(i.indexOf(r),1),C(e,t))}),b.getRetryIntervalsForType(d.type))}else{if(d.type===R.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;y.error(new w.Z(a[d.type],d.url+" is not available",{request:d,response:l.response})),e.error&&e.error(d,"error",l.response.statusText,l.response),e.complete&&e.complete(d,l.response.statusText)}};d.hasOwnProperty("availabilityTimeComplete")&&!1===d.availabilityTimeComplete&&window.fetch&&"arraybuffer"===d.responseType&&d.type===R.w.MEDIA_SEGMENT_TYPE?((N=ce(g).create({requestModifier:_,lowLatencyThroughputModel:p,boxParser:E})).setup({dashMetrics:v}),O=o.Z.FILE_LOADER_TYPES.FETCH):(N=(0,ae.Z)(g).create({requestModifier:_}),O=o.Z.FILE_LOADER_TYPES.XHR);var U=null,z=_.modifyRequestURL?_.modifyRequestURL(d.url):d.url;if(x.get().streaming.cmcd&&x.get().streaming.cmcd.enabled){var G=x.get().streaming.cmcd.mode;if(G===o.Z.CMCD_MODE_QUERY){var V=function(e){try{var t=[],n=s.getQueryParameter(e);return n&&t.push(n),t}catch(e){return[]}}(d);z=Fe.Z.addAditionalQueryParameterToUrl(z,V)}else G===o.Z.CMCD_MODE_HEADER&&(U=s.getHeaderParameters(d))}var j=h.getXHRWithCredentialsForType(d.type);if(d.queryParams){var H=Object.keys(d.queryParams).map((function(e){return{key:e,value:d.queryParams[e]}}));z=Fe.Z.addAditionalQueryParameterToUrl(z,H)}d.url=z,l={url:z,method:R.w.GET,withCredentials:j,request:d,onload:function(){l.response.status>=200&&l.response.status<=299&&(F(!0),e.success&&e.success(l.response.response,l.response.statusText,l.response.responseURL),e.complete&&e.complete(d,l.response.statusText))},onend:B,onerror:B,progress:function(t){var n=new Date;T&&(T=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(d.firstByteDate=n)),t.lengthComputable&&(d.bytesLoaded=t.loaded,d.bytesTotal=t.total),t.noTrace||(m.push({s:L,d:t.time?t.time:n.getTime()-L.getTime(),b:[t.loaded?t.loaded-P:0]}),L=n,P=t.loaded),D&&(clearTimeout(D),D=null),x.get().streaming.fragmentRequestProgressTimeout>0&&(D=setTimeout((function(){f.warn("Abort request "+l.url+" due to progress timeout"),l.response.onabort=null,l.loader.abort(l),B()}),x.get().streaming.fragmentRequestProgressTimeout)),e.progress&&t&&e.progress(t)},onabort:function(){k(!0),D&&(clearTimeout(D),D=null),e.abort&&e.abort(d)},ontimeout:function(e){var t;if(e.lengthComputable){var n=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+n.toFixed(3)+"% Completed"}else t="Request timeout: non-computable download size";f.warn(t)},loader:N,timeout:A,headers:U};var Z=(new Date).getTime();if(isNaN(d.delayLoadingTime)||Z>=d.delayLoadingTime)n.push(l),N.load(l);else{var q={httpRequest:l};r.push(q),q.delayTimeout=setTimeout((function(){if(-1!==r.indexOf(q)){r.splice(r.indexOf(q),1);try{M=new Date,L=M,n.push(q.httpRequest),N.load(q.httpRequest)}catch(e){q.httpRequest.onerror()}}}),d.delayLoadingTime-Z)}}return t={load:function(e){e.request?C(e,b.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){i.forEach((function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)})),i=[],r.forEach((function(e){return clearTimeout(e.delayTimeout)})),r=[],n.forEach((function(e){e.request.type!==R.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e))})),n=[]}},f=(0,d.Z)(g).getInstance().getLogger(t),n=[],r=[],i=[],s=Ge(g).getInstance(),c=it(g).getInstance(),p=at(g).getInstance(),h=(0,st.Z)(g).getInstance(),lt(m={},R.w.MPD_TYPE,T.DOWNLOAD_ERROR_ID_MANIFEST_CODE),lt(m,R.w.XLINK_EXPANSION_TYPE,T.DOWNLOAD_ERROR_ID_XLINK_CODE),lt(m,R.w.INIT_SEGMENT_TYPE,T.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),lt(m,R.w.MEDIA_SEGMENT_TYPE,T.DOWNLOAD_ERROR_ID_CONTENT_CODE),lt(m,R.w.INDEX_SEGMENT_TYPE,T.DOWNLOAD_ERROR_ID_CONTENT_CODE),lt(m,R.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,T.DOWNLOAD_ERROR_ID_CONTENT_CODE),lt(m,R.w.OTHER_TYPE,T.DOWNLOAD_ERROR_ID_CONTENT_CODE),a=m,t}ut.__dashjs_factory_name="HTTPLoader";const ct=c.Z.getClassFactory(ut);function dt(){var e;function t(){e={}}function n(){t()}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return ct},registerLoader:function(t,n){e[t]=n},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:n}}dt.__dashjs_factory_name="SchemeLoaderFactory";const ht=c.Z.getSingletonFactory(dt);function pt(e){e=e||{};var t,n,r=this.context;return t=ht(r).getInstance(),{load:function(i){if(!n){var o=t.getLoader(i&&i.request?i.request.url:null);n=o(r).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,requestTimeout:isNaN(e.requestTimeout)?0:e.requestTimeout,errors:e.errors})}n.load(i)},abort:function(){n&&n.abort()}}}pt.__dashjs_factory_name="URLLoader";const ft=c.Z.getClassFactory(pt);function mt(e){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(e)}function gt(e,t){return gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gt(e,t)}function yt(e){return yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yt(e)}const vt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=yt(t);if(n){var i=yt(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this,e)).checkForExistenceOnly=!0,t}return i}(m.Z);function bt(e){e=e||{};var t,n,r=this.context,i=e.eventBus,a=e.events,s=e.urlUtils,l=e.errors,u=e.streamId;return t={checkForExistence:function(e){var t=function(t){i.trigger(a.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var r=new vt(e.url);n.load({request:r,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var r=function(n,r){i.trigger(a.LOADING_COMPLETED,{request:e,response:n||null,error:r||null,sender:t})};e?n.load({request:e,progress:function(n){i.trigger(a.LOADING_PROGRESS,{request:e,stream:n.stream,streamId:u}),n.data&&i.trigger(a.LOADING_DATA_PROGRESS,{request:e,response:n.data||null,error:null,sender:t})},success:function(e){r(e)},error:function(e,t,n){r(void 0,new w.Z(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,n,t))},abort:function(e){e&&i.trigger(a.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:t})}}):r(void 0,new w.Z(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){n&&n.abort()},reset:function(){n&&(n.abort(),n=null)}},n=ft(r).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:s,constants:o.Z,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),t}bt.__dashjs_factory_name="FragmentLoader";const _t=c.Z.getClassFactory(bt);function Et(){return{modifyResponseAsync:function(e){return Promise.resolve(e)}}}Et.__dashjs_factory_name="SegmentResponseModifier";const wt=c.Z.getSingletonFactory(Et);function Tt(e){e=e||{};var t,n,r,i=this.context,a=(0,l.Z)(i).getInstance(),s=e.errHandler,c=e.mediaPlayerModel,p=e.dashMetrics,f=(0,d.Z)(i).getInstance(),m=wt(i).getInstance(),g=e.streamInfo;function y(){return g.id}function v(){for(var e in r)r[e].reset();r={}}function b(e){if(e.sender){var t=e.request,r=e.response,i=t.isInitializationRequest(),s=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType===o.Z.AUDIO||t.mediaType===o.Z.VIDEO||t.mediaType===o.Z.TEXT&&t.mediaInfo.isFragmented)&&a.trigger(u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD,{entry:e.request.serviceLocation}),r&&s){var l=function(e,t,n,r){var i=new oe;return i.streamId=n,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=r,i}(r,t,g.id,e.type!==u.Z.FRAGMENT_LOADING_PROGRESS);m.modifyResponseAsync(l).then((function(e){a.trigger(i?u.Z.INIT_FRAGMENT_LOADED:u.Z.MEDIA_FRAGMENT_LOADED,{chunk:e,request:t},{streamId:s.id,mediaType:t.mediaType})})).catch((function(e){n.error(e),a.trigger(i?u.Z.INIT_FRAGMENT_LOADED:u.Z.MEDIA_FRAGMENT_LOADED,{chunk:l,request:t},{streamId:s.id,mediaType:t.mediaType})}))}else n.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return t={getStreamId:y,getModel:function(t){var n=r[t];return n||(n=E(i).create({streamInfo:g,type:t,dashMetrics:p,fragmentLoader:_t(i).create({dashMetrics:p,mediaPlayerModel:c,errHandler:s,requestModifier:(0,K.Z)(i).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:a,events:u.Z,errors:x,dashConstants:e.dashConstants,urlUtils:e.urlUtils,streamId:y()}),debug:f,eventBus:a,events:u.Z}),r[t]=n),n},reset:function(){a.off(h.Z.FRAGMENT_LOADING_COMPLETED,b,this),a.off(h.Z.FRAGMENT_LOADING_PROGRESS,b,this),v()}},n=f.getLogger(t),v(),a.on(h.Z.FRAGMENT_LOADING_COMPLETED,b,t),a.on(h.Z.FRAGMENT_LOADING_PROGRESS,b,t),t}Tt.__dashjs_factory_name="FragmentController";const At=c.Z.getClassFactory(Tt),St=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null},xt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};function It(e){var t,n,r=this.context,i=e.streamInfo;function a(e){n.setTrackByIndex(e)}function s(){n&&n.reset()}return t={getStreamId:function(){return i.id},initialize:function(){n.addTracks();var e=n.getTracks();e&&e.length>0&&a(0)},provide:function(e,t){if("function"==typeof t){var r,i,o=n.getCurrentTrack();if(!o||o.segmentDuration<=0||null==e)t(null);else{(i=n.getThumbnailRequestForTime(e))&&(o.segmentDuration=i.duration),r=e%o.segmentDuration;var a=Math.floor(r*o.tilesHor*o.tilesVert/o.segmentDuration),s=new St;if(s.width=Math.floor(o.widthPerTile),s.height=Math.floor(o.heightPerTile),s.x=Math.floor(a%o.tilesHor)*o.widthPerTile,s.y=Math.floor(a/o.tilesHor)*o.heightPerTile,"readThumbnail"in o)return o.readThumbnail(e,(function(e){s.url=e,t(s)}));if(i)s.url=i.url,o.segmentDuration=NaN;else{var l=Math.floor(e/o.segmentDuration);s.url=function(e,t){var n=t+e.startNumber,r=(0,H.vi)(e.templateUrl,"Number",n);return r=(0,H.vi)(r,"Time",(n-1)*e.segmentDuration*e.timescale),r=(0,H.vi)(r,"Bandwidth",e.bandwidth),(0,H.eR)(r)}(o,l)}t(s)}}},setTrackByIndex:a,getCurrentTrackIndex:function(){return n.getCurrentTrackIndex()},getBitrateList:function(){var e=n.getTracks(),t=0;return e.map((function(e){var n=new xt;return n.mediaType=o.Z.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n}))},reset:s},s(),n=(0,Ce.Z)(r).create({streamInfo:i,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController}),t}It.__dashjs_factory_name="ThumbnailController";const Rt=c.Z.getClassFactory(It);var Ct=n(7417);function Mt(e){var t;e=e||{};var n=[],r=(0,l.Z)(this.context).getInstance(),i=e.updateEventName,o=e.addBlacklistEventName;function a(e){-1===n.indexOf(e)&&(n.push(e),r.trigger(i,{entry:e}))}return t={add:a,contains:function(e){return!!(n.length&&e&&e.length)&&-1!==n.indexOf(e)},reset:function(){n=[]}},o&&r.on(o,(function(e){a(e.entry)}),t),t}Mt.__dashjs_factory_name="BlackListController";const Lt=c.Z.getClassFactory(Mt);var Pt=[o.Z.VIDEO,o.Z.AUDIO,o.Z.TEXT,o.Z.MUXED,o.Z.IMAGE];function Dt(e){e=e||{};var t,n,r,i,s,c,h,p,f,m,g,y,v,b,_,E,T,A,S=this.context,I=(0,l.Z)(S).getInstance(),R=(0,$.Z)(S).getInstance(),C=e.manifestModel,M=e.mediaPlayerModel,L=e.dashMetrics,P=e.manifestUpdater,D=e.adapter,O=e.timelineConverter,N=e.capabilities,k=e.errHandler,F=e.abrController,B=e.playbackController,U=e.eventController,z=e.mediaController,G=e.protectionController,V=e.textController,j=e.videoModel,H=e.streamInfo,Z=e.settings;function q(e,t){return new Promise((function(i,a){ne(),m=!0,oe();var s=j.getElement(),l=[];Pt.forEach((function(t){(t!==o.Z.TEXT||e)&&(t!==o.Z.VIDEO||!s||s&&/^VIDEO$/i.test(s.nodeName))&&l.push(W(t,e))})),Promise.all(l).then((function(){return e=t,new Promise((function(t){var n={},i=r.map((function(t){return t.createBufferSinks(e)}));Promise.all(i).then((function(e){e.forEach((function(e){e&&(n[e.getType()]=e)})),t(n)})).catch((function(){t(n)}))}));var e})).then((function(t){if(m=!1,0===r.length){var o="No streams to play.";k.error(new w.Z(x.MANIFEST_ERROR_ID_NOSTREAMS_CODE,o,C.getValue())),n.fatal(o)}else ae();e&&V.createTracks(H),i(t)})).catch((function(e){a(e)}))}))}function W(t,i){var s,l=D.getAllMediaInfoForType(H,t),c=[],d=null;if(!l||0===l.length)return n.info("No "+t+" data."),Promise.resolve();t===o.Z.VIDEO&&(h=!0),t===o.Z.AUDIO&&(p=!0);for(var f=0,m=l.length;f<m;f++)d=l[f],t===o.Z.TEXT&&d.isEmbedded&&(V.addEmbeddedTrack(H,d),c.push(d)),Y(d)&&z.addTrack(d);if(c.length>0&&(z.setInitialMediaSettingsForType(t,H),V.addMediaInfosToBuffer(H,t,c)),l=l.filter((function(e){return!e.isEmbedded})),0===l.length)return Promise.resolve();if(t===o.Z.IMAGE)return(y=Rt(S).create({streamInfo:H,adapter:D,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:E,eventBus:I,events:u.Z,dashConstants:a.Z,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController})).initialize(),Promise.resolve();I.trigger(u.Z.STREAM_INITIALIZING,{streamInfo:H,mediaInfo:d}),z.setInitialMediaSettingsForType(t,H);var b=function(t,n){var i=t&&t.length>0?t[0]:null,a=g.getModel(i?i.type:null),s=i?i.type:null,l=i?i.mimeType:null,u=i?i.isFragmented:null,c=ie(S).create({streamInfo:H,type:s,mimeType:l,timelineConverter:O,adapter:D,manifestModel:C,mediaPlayerModel:M,fragmentModel:a,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,segmentBaseController:e.segmentBaseController,abrController:F,playbackController:B,mediaController:z,textController:V,errHandler:k,settings:Z,boxParser:_,segmentBlacklistController:v});c.initialize(n,h,u),r.push(c);for(var d=0;d<t.length;d++)c.addMediaInfo(t[d]);return s===o.Z.TEXT&&V.addMediaInfosToBuffer(H,s,t,a),c}(l,i);return(s=z.getCurrentTrackFor(t,H.id))?(F.updateTopQualityIndex(s),b.selectMediaInfo(t===o.Z.TEXT&&s.isEmbedded?l[0]:s)):Promise.resolve()}function Y(e){var t,r=e?e.type:null;return r===o.Z.MUXED?(t="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",n.fatal(t),k.error(new w.Z(x.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,t,C.getValue())),!1):!(r!==o.Z.TEXT&&r!==o.Z.IMAGE&&e.contentProtection&&!N.supportsEncryptedMedia()&&(k.error(new w.Z(x.CAPABILITY_MEDIAKEYS_ERROR_CODE,x.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),1))}function K(e){for(var t=r?r.length:0,n=0;n<t;n++){var i=r[n].getFragmentModel();i.abortRequests(),i.resetInitialSettings(),r[n].reset(!1,e)}V&&V.deactivateStream(H),r=[],s=!1,c=!1,ge(!1),Q(!1),I.trigger(u.Z.STREAM_DEACTIVATED,{streamInfo:H})}function X(e){K(e),i=!1,h=!1,p=!1,f={},m=!1,T=!1,A=[]}function Q(e){T=e}function J(){return H?H.start:NaN}function ee(){return H?H.id:null}function te(){return H}function ne(){if(!j||!F)throw new Error(o.Z.MISSING_CONFIG_ERROR)}function re(e){e.error&&(k.error(e.error),n.fatal(e.error.message))}function oe(){if(U){var e=D.getEventsFor(H);e&&e.length>0&&U.addInlineEvents(e,H.id)}}function ae(){for(var e=r.length,t=f.audio||f.video?new w.Z(x.DATA_UPDATE_FAILED_ERROR_CODE,x.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,n=0;n<e;n++)if(r[n].isUpdating()||m)return;if(G){G.clearMediaInfoArray();for(var a=0;a<e&&r[a];a++){var s=r[a].getType(),l=r[a].getMediaInfo();if(s===o.Z.AUDIO||s===o.Z.VIDEO||s===o.Z.TEXT&&l.isFragmented){var c=r[a].getMediaInfo();c&&G.initializeForMedia(c)}}G.handleKeySystemFromManifest()}t?k.error(t):i||(i=!0,j.waitForReadyState(o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,(function(){I.trigger(u.Z.STREAM_INITIALIZED,{streamInfo:H})})))}function se(){var e=he(),t=e.length;if(0!==t){for(var r=0;r<t;r++)if(!e[r].isBufferingCompleted()&&(e[r].getType()===o.Z.AUDIO||e[r].getType()===o.Z.VIDEO))return void n.debug("onBufferingCompleted - One streamProcessor has finished but",e[r].getType(),"one is not buffering completed");n.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),c=!0,I.trigger(u.Z.STREAM_BUFFERING_COMPLETED,{streamInfo:H},{streamInfo:H})}else n.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function le(e){f[e.mediaType]=e.error,ae()}function ue(e){U&&U.addInbandEvents(e.events,H.id)}function ce(e){return e&&e.type?de(e.type):null}function de(e){return e?he().filter((function(t){return t.getType()===e}))[0]:null}function he(){for(var e,t,n=[],i=0;i<r.length;i++)(e=(t=r[i]).getType())!==o.Z.AUDIO&&e!==o.Z.VIDEO&&e!==o.Z.TEXT||n.push(t);return n}function pe(e,t){var n=te(),r=t.getStreamInfo();if(!r||!n)return!0;var i=D.getAdaptationForType(r.index,e,r),o=D.getAdaptationForType(n.index,e,n);return i&&o?!(!fe(o)&&fe(i)):!i&&!o}function fe(e){return!!e&&!!(e.ContentProtection||e.Representation_asArray&&e.Representation_asArray.length>0&&e.Representation_asArray[0].ContentProtection)}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var r=e.getStreamInfo(),i=n?n.getStreamInfo():te();if(!r||!i)return!1;var o=D.getAdaptationForType(r.index,t,r),a=D.getAdaptationForType(i.index,t,i);if(!o||!a)return!o&&!a;var s=o&&a&&o.mimeType===a.mimeType,l=a.Representation_asArray.map((function(e){return e.codecs})),u=o.Representation_asArray.map((function(e){return e.codecs})),c=u.some((function(e){return l.indexOf(e)>-1})),d=u.some((function(e){return l.some((function(t){return N.codecRootCompatibleWithCodec(t,e)}))}));return c||d&&s}function ge(e){b=e}function ye(){return b}return t={initialize:function(){I.on(u.Z.BUFFERING_COMPLETED,se,t),I.on(u.Z.DATA_UPDATE_COMPLETED,le,t),I.on(u.Z.INBAND_EVENTS,ue,t),G&&(I.on(u.Z.KEY_ERROR,re,t),I.on(u.Z.SERVER_CERTIFICATE_UPDATED,re,t),I.on(u.Z.LICENSE_REQUEST_COMPLETE,re,t),I.on(u.Z.KEY_SYSTEM_SELECTED,re,t),I.on(u.Z.KEY_SESSION_CREATED,re,t),I.on(u.Z.KEY_STATUSES_CHANGED,re,t)),V.initializeForStream(H),I.trigger(u.Z.STREAM_UPDATED,{streamInfo:H})},getStreamId:function(){return H?H.id:null},activate:function(e,t){return new Promise((function(n,r){if(!s)return ye()?(s=!0,I.trigger(u.Z.STREAM_ACTIVATED,{streamInfo:H}),void n(t)):void function(e,t){return q(e,t)}(e,t).then((function(e){s=!0,I.trigger(u.Z.STREAM_ACTIVATED,{streamInfo:H}),n(e)})).catch((function(e){r(e)}));n(t)}))},deactivate:K,getIsActive:function(){return s},getDuration:function(){return H?H.duration:NaN},getStartTime:J,getId:ee,getStreamInfo:te,getHasAudioTrack:function(){return p},getHasVideoTrack:function(){return h},startPreloading:function(e,t){return new Promise((function(i,o){ye()?o():(n.info("[startPreloading] Preloading next stream with id ".concat(ee())),ge(!0),q(e,t).then((function(){for(var e=0;e<r.length&&r[e];e++)r[e].setExplicitBufferingTime(J()),r[e].getScheduleController().startScheduleTimer();i()})).catch((function(){ge(!1),o()})))}))},initializeForTextWithMediaSource:function(e){return new Promise((function(t,n){W(o.Z.TEXT,e).then((function(){return(e=de(o.Z.TEXT))?e.createBufferSinks():Promise.resolve();var e})).then((function(){V.createTracks(H),t()})).catch((function(e){n(e)}))}))},getThumbnailController:function(){return y},getBitrateListFor:function(e){if(ne(),e===o.Z.IMAGE)return y?y.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<r.length;n++)if((t=r[n]).getType()===e)return t.getMediaInfo();return null}(e);return F.getBitrateList(t)},updateData:function(e){return new Promise((function(t){m=!0,H=e,U&&oe();for(var n=[],i=0,o=r.length;i<o;i++){var a=r[i],s=a.getMediaInfo();n.push(a.updateStreamInfo(H));var l=D.getAllMediaInfoForType(H,a.getType());if(l=l.filter((function(e){return!e.isEmbedded}))){a.clearMediaInfoArray();for(var c=0;c<l.length;c++){var d=l[c];a.addMediaInfo(l[c]),D.areMediaInfosEqual(s,d)&&(F.updateTopQualityIndex(d),n.push(a.selectMediaInfo(d)))}}}Promise.all(n).then((function(){for(n=[];A.length>0;){var e=A.pop(),t=e.newMediaInfo,r=ce(e.oldMediaInfo);if(!r)return;n.push(r.prepareTrackSwitch()),n.push(r.selectMediaInfo(t))}return Promise.all(n)})).then((function(){m=!1,ae(),I.trigger(u.Z.STREAM_UPDATED,{streamInfo:H}),t()}))}))},reset:function(e){g&&(g.reset(),g=null),F&&H&&F.clearDataForStream(H.id),v&&(v.reset(),v=null),X(e),H=null,I.off(u.Z.DATA_UPDATE_COMPLETED,le,t),I.off(u.Z.BUFFERING_COMPLETED,se,t),I.off(u.Z.INBAND_EVENTS,ue,t),G&&(I.off(u.Z.KEY_ERROR,re,t),I.off(u.Z.SERVER_CERTIFICATE_UPDATED,re,t),I.off(u.Z.LICENSE_REQUEST_COMPLETE,re,t),I.off(u.Z.KEY_SYSTEM_SELECTED,re,t),I.off(u.Z.KEY_SESSION_CREATED,re,t),I.off(u.Z.KEY_STATUSES_CHANGED,re,t))},getProcessors:he,setMediaSource:function(e){return new Promise((function(t,i){for(var o=[],a=0;a<r.length;)Y(r[a].getMediaInfo())?(o.push(r[a].setMediaSource(e)),a++):(r[a].reset(),r.splice(a,1));Promise.all(o).then((function(){for(var e=0;e<r.length;e++)r[e].dischargePreBuffer();if(0===r.length){var i="No streams to play.";k.error(new w.Z(x.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i+"nostreams",C.getValue())),n.fatal(i)}t()})).catch((function(e){n.error(e),i(e)}))}))},isMediaCodecCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return me(e,o.Z.VIDEO,t)&&me(e,o.Z.AUDIO,t)},isProtectionCompatible:function(e){return!e||pe(o.Z.VIDEO,e)&&pe(o.Z.AUDIO,e)},getPreloaded:ye,getIsEndedEventSignaled:function(){return T},setIsEndedEventSignaled:Q,getAdapter:function(){return D},getHasFinishedBuffering:function(){return c},setPreloaded:ge,startScheduleControllers:function(){for(var e=r.length,t=0;t<e&&r[t];t++)r[t].getScheduleController().startScheduleTimer()},prepareTrackChange:function(e){if(s&&H){c=!1;var t=e.newMediaInfo,r=C.getValue();D.setCurrentMediaInfo(H.id,t.type,t);var i=ce(t);if(i){var a=B.getTime();n.info("Stream -  Process track changed at current time "+a),r.refreshManifestOnSwitchTrack?(A.push(e),P.getIsUpdating()||(n.debug("Stream -  Refreshing manifest for switch track"),P.refreshManifest())):i.selectMediaInfo(t).then((function(){t.type!==o.Z.VIDEO&&t.type!==o.Z.AUDIO||F.updateTopQualityIndex(t),i.prepareTrackSwitch()}))}}},prepareQualityChange:function(e){var t=de(e.mediaType);t&&t.prepareQualityChange(e)}},function(){try{E=(0,d.Z)(S).getInstance(),n=E.getLogger(t),X(),_=(0,Ct.Z)(S).getInstance(),v=Lt(S).create({updateEventName:u.Z.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SEGMENT_LOCATION_BLACKLIST_ADD}),g=At(S).create({streamInfo:H,mediaPlayerModel:M,dashMetrics:L,errHandler:k,settings:Z,boxParser:_,dashConstants:a.Z,urlUtils:R})}catch(e){throw e}}(),t}Dt.__dashjs_factory_name="Stream";const Ot=c.Z.getClassFactory(Dt),Nt=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||null,this.type=R.w.CONTENT_STEERING_TYPE,this.responseType="json"},kt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.version=null,this.ttl=300,this.reloadUri=null,this.pathwayPriority=[],this.pathwayClones=[]};function Ft(){var e,t,n,r,i,o,s,l,u,c,p,f,m,g,y,v=this.context,b=(0,$.Z)(v).getInstance();function _(e){S(e,"baseUrl")}function E(e){S(e,"location")}function w(e){if(e&&e.request&&e.request.serviceLocation&&e.request.requestStartDate&&e.request.requestEndDate&&!isNaN(e.request.bytesTotal)){var t=e.request.serviceLocation,n=e.request.requestEndDate.getTime()-e.request.requestStartDate.getTime();A(t,parseInt(8*e.request.bytesTotal/n*1e3))}}function T(e){e&&e.httpRequest&&e.httpRequest._serviceLocation&&!isNaN(e.throughput)&&A(e.httpRequest._serviceLocation,1e3*e.throughput)}function A(e,t){i[e]||(i[e]=[]),i[e].push(t),i[e].length>4&&i[e].shift()}function S(e,t){if(e&&e.request&&e.request.serviceLocation){var n=e.request.serviceLocation;-1===r[t].all.indexOf(n)&&r[t].all.push(n),r[t].current=n}}function I(){var e=p.getValue(),t=y.getContentSteering(e);return t||(t=m.getServiceDescriptionSettings().contentSteering),t}function R(){return new Promise((function(e){try{var o=I();if(!o||!o.serverUrl)return void e();var l=function(e){var t=e.serverUrl;n&&n.reloadUri&&(t=b.isRelative(n.reloadUri)?b.resolve(n.reloadUri,e.serverUrl):n.reloadUri);var o=[],a=r.baseUrl.all.concat(r.location.all);if(a.length>0){var s=a.map((function(e){var t=function(e){if(!e||!i[e]||0===i[e].length)return-1;var t=i[e].reduce((function(e,t){return e+t}))/i[e].length;return parseInt(t)}(e);return{serviceLocation:e,throughput:t}}));s.sort((function(e,t){return t.throughput-e.throughput}));var l="",u="";s.forEach((function(e,t){0!==t&&(l="".concat(l,","),e.throughput>-1&&(u="".concat(u,","))),l="".concat(l).concat(e.serviceLocation),e.throughput>-1&&(u="".concat(u).concat(e.throughput))})),o.push({key:"_DASH_pathway",value:'"'.concat(l,'"')}),o.push({key:"_DASH_throughput",value:u})}return Fe.Z.addAditionalQueryParameterToUrl(t,o)}(o),u=new Nt(l);s.load({request:u,success:function(t){!function(e){e&&e[a.Z.CONTENT_STEERING_RESPONSE.VERSION]&&1===parseInt(e[a.Z.CONTENT_STEERING_RESPONSE.VERSION])&&((n=new kt).version=e[a.Z.CONTENT_STEERING_RESPONSE.VERSION],e[a.Z.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(e[a.Z.CONTENT_STEERING_RESPONSE.TTL])&&(n.ttl=e[a.Z.CONTENT_STEERING_RESPONSE.TTL]),e[a.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(n.reloadUri=e[a.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]),e[a.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]&&(n.pathwayPriority=e[a.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]),e[a.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES]&&(n.pathwayClones=e[a.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES],n.pathwayClones=n.pathwayClones.filter((function(e){return function(e){return e[a.Z.CONTENT_STEERING_RESPONSE.BASE_ID]&&e[a.Z.CONTENT_STEERING_RESPONSE.ID]&&e[a.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT]&&e[a.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][a.Z.CONTENT_STEERING_RESPONSE.HOST]}(e)}))),L())}(t),g.trigger(h.Z.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:n,url:l}),e()},error:function(r,i,o,a){!function(e,r){try{switch(t.warn("Error fetching data from content steering server",e),r.status){case 410:break;case 429:var i=r&&r.getResponseHeader?r.getResponseHeader("retry-after"):null;null!==i&&(n||(n={}),n.ttl=parseInt(i)),L();break;default:L()}}catch(e){t.error(e)}}(r,a),e(r)},complete:function(){r.baseUrl.all=C(r.baseUrl),r.location.all=C(r.location)}})}catch(t){e(t)}}))}function C(e){return e.all&&0!==e.all.length&&e.current?e.all.filter((function(t){return t===e.current})):[]}function M(e){try{var r=[];return e&&0!==e.length&&n&&n.pathwayClones&&0!==n.pathwayClones.length?(n.pathwayClones.forEach((function(t){var n=e.filter((function(e){return t[a.Z.CONTENT_STEERING_RESPONSE.BASE_ID]===e.serviceLocation})),i=null;if(n&&n.length>0&&(i=n[0]),i){var o=new URL(i.url),s=t[a.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][a.Z.CONTENT_STEERING_RESPONSE.HOST];s=Fe.Z.stringHasProtocol(s)?s:"".concat(o.protocol,"//").concat(s);var l={synthesizedUrl:"".concat(s).concat(o.pathname),serviceLocation:t[a.Z.CONTENT_STEERING_RESPONSE.ID],queryParams:t[a.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][a.Z.CONTENT_STEERING_RESPONSE.PARAMS],reference:i};r.push(l)}})),r):r}catch(e){return t.error(e),[]}}function L(){n&&n.ttl&&!isNaN(n.ttl)&&(o&&clearTimeout(o),o=setTimeout((function(){R()}),1e3*n.ttl))}function P(){o&&clearTimeout(o),o=null}function D(){n=null,i={},r={baseUrl:{current:null,all:[]},location:{current:null,all:[]}},P()}return e={reset:function(){D(),g.off(h.Z.FRAGMENT_LOADING_STARTED,_,e),g.off(h.Z.MANIFEST_LOADING_STARTED,E,e),g.off(h.Z.MANIFEST_LOADING_FINISHED,w,e),g.off(h.Z.THROUGHPUT_MEASUREMENT_STORED,T,e)},setConfig:function(e){e&&(e.adapter&&(y=e.adapter),e.errHandler&&(l=e.errHandler),e.dashMetrics&&(u=e.dashMetrics),e.mediaPlayerModel&&(c=e.mediaPlayerModel),e.requestModifier&&(f=e.requestModifier),e.manifestModel&&(p=e.manifestModel),e.serviceDescriptionController&&(m=e.serviceDescriptionController),e.eventBus&&(g=e.eventBus))},loadSteeringData:R,getCurrentSteeringResponseData:function(){return n},shouldQueryBeforeStart:function(){var e=I();return!!e&&e.queryBeforeStart},getSteeringDataFromManifest:I,stopSteeringRequestTimer:P,getSynthesizedBaseUrlElements:function(e){try{return M(e).map((function(e){var t=new _e(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t.dvb_priority=e.reference.dvb_priority,t.dvb_weight=e.reference.dvb_weight,t.availabilityTimeOffset=e.reference.availabilityTimeOffset,t.availabilityTimeComplete=e.reference.availabilityTimeComplete,t}))}catch(e){return t.error(e),[]}},getSynthesizedLocationElements:function(e){try{return M(e).map((function(e){var t=new Me(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t}))}catch(e){return t.error(e),[]}},initialize:function(){s=ft(v).create({errHandler:l,dashMetrics:u,mediaPlayerModel:c,requestModifier:f,errors:x}),g.on(h.Z.FRAGMENT_LOADING_STARTED,_,e),g.on(h.Z.MANIFEST_LOADING_STARTED,E,e),g.on(h.Z.MANIFEST_LOADING_FINISHED,w,e),g.on(h.Z.THROUGHPUT_MEASUREMENT_STORED,T,e)}},t=(0,d.Z)(v).getInstance().getLogger(e),D(),e}Ft.__dashjs_factory_name="ContentSteeringController";const Bt=c.Z.getSingletonFactory(Ft);function Ut(){var e,t,n,r=this.context,i=(0,I.Z)(r).getInstance();return e={select:function(e){if(!e||0===e.length)return null;var r=null;return i.get().streaming.applyContentSteering&&(r=function(e){var r=n.getCurrentSteeringResponseData();return r&&r.pathwayPriority&&r.pathwayPriority.length>0?function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0,i=null,o=function(){var o=e[r],a=n.findIndex((function(e){return e.serviceLocation&&e.serviceLocation===o}));if(-1!==a&&!t.contains(n[a].serviceLocation))return i=n[a],"break";r+=1};r<e.length&&"break"!==o(););return i}(r.pathwayPriority,e):null}(e)),r||(r=function(e){return e[0]}(e)),r},setConfig:function(e){e.blacklistController&&(t=e.blacklistController),e.contentSteeringController&&(n=e.contentSteeringController)},reset:function(){t.reset()}},t=Lt(r).create({updateEventName:u.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD}),n=Bt(r).getInstance(),e}Ut.__dashjs_factory_name="LocationSelector";const zt=c.Z.getClassFactory(Ut);function Gt(){var e,t,n,r,i,o,s,c,p,f,m,g,y,v,b=this.context,_=(0,l.Z)(b).getInstance(),E=(0,$.Z)(b).getInstance();function w(){n=NaN,s=!1,i=!0,o=!1,T()}function T(){null!==r&&(clearTimeout(r),r=null)}function A(e){T(),o||(isNaN(e)&&!isNaN(n)&&(e=1e3*n),isNaN(e)||(t.debug("Refresh manifest in "+e+" milliseconds."),r=setTimeout(R,e)))}function S(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s=!0;var t=p.getValue(),n=t.url,r=null,i=m.getPatchLocation(t),o=f.select(i),a=null;if(o&&!e)n=o.url,r=o.serviceLocation,a=o.queryParams;else{var l=function(e){var t=m.getLocation(e),n=y.getSynthesizedLocationElements(t);return t.concat(n)}(t),u=f.select(l);u&&(n=u.url,r=u.serviceLocation,a=u.queryParams)}E.isRelative(n)&&(n=E.resolve(n,t.url)),c.load(n,r,a)}function I(e){if(e){if(m.getIsPatch(e)){var r=e;e=p.getValue();var l=m.isPatchValid(e,r),c=l;if(l){var d=m.getPublishTime(e);c=m.applyPatchToManifest(e,r);var h=m.getPublishTime(e);c=d.getTime()!=h.getTime()}if(!c)return t.debug("Patch provided is invalid, performing full manifest refresh"),void S(!0);e.loadedTime=new Date}}else(e=p.getValue()).loadedTime=new Date;if(p.getValue()&&p.getValue().type===a.Z.DYNAMIC&&e.type===a.Z.STATIC)return _.trigger(u.Z.DYNAMIC_TO_STATIC),s=!1,void(o=!0);p.setValue(e);var f=new Date,g=(f.getTime()-e.loadedTime.getTime())/1e3;1e3*(n=m.getManifestUpdatePeriod(e,g))>2147483647&&(n=2147483.647),_.trigger(u.Z.MANIFEST_UPDATED,{manifest:e}),t.info("Manifest has been refreshed at "+f+"["+f.getTime()/1e3+"] "),i||A()}function R(){i||(s?A(v.get().streaming.manifestUpdateRetryInterval):S())}function C(e){e.error?e.error.code===x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&g.error(e.error):I(e.manifest)}function M(){i=!1,A()}function L(){(i=!v.get().streaming.scheduling.scheduleWhilePaused)&&T()}function P(){s=!1}return e={initialize:function(){w(),_.on(u.Z.STREAMS_COMPOSED,P,this),_.on(h.Z.PLAYBACK_STARTED,M,this),_.on(h.Z.PLAYBACK_PAUSED,L,this),_.on(u.Z.INTERNAL_MANIFEST_LOADED,C,this)},setManifest:function(e){I(e)},refreshManifest:S,getIsUpdating:function(){return s},setConfig:function(e){e&&(e.manifestModel&&(p=e.manifestModel),e.adapter&&(m=e.adapter),e.manifestLoader&&(c=e.manifestLoader),e.errHandler&&(g=e.errHandler),e.locationSelector&&(f=e.locationSelector),e.settings&&(v=e.settings),e.contentSteeringController&&(y=e.contentSteeringController))},reset:function(){_.off(h.Z.PLAYBACK_STARTED,M,this),_.off(h.Z.PLAYBACK_PAUSED,L,this),_.off(u.Z.STREAMS_COMPOSED,P,this),_.off(u.Z.INTERNAL_MANIFEST_LOADED,C,this),w()}},t=(0,d.Z)(b).getInstance().getLogger(e),f=zt(b).create(),e}Gt.__dashjs_factory_name="ManifestUpdater";const Vt=c.Z.getClassFactory(Gt);function jt(){var e,t,n,r,i,o,a,s,c,h,p,f,m,g,y,v,b=this.context,_=(0,l.Z)(b).getInstance(),E=(0,$.Z)(b).getInstance();function T(){s=[],c=[],h=null,p=null,m=null,f=NaN,n=!1,r=!1,g=i.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function A(){i.get().streaming.utcSynchronization.enabled&&!n&&!r&&m&&m.value&&m.schemeIdUri&&!isNaN(f)&&!isNaN(i.get().streaming.utcSynchronization.backgroundAttempts)&&(p&&(Date.now()-p)/1e3<30||(s=[],r=!0,S(isNaN(i.get().streaming.utcSynchronization.backgroundAttempts)?2:i.get().streaming.utcSynchronization.backgroundAttempts)))}function S(e){try{if(e<=0)return void U();var t=Date.now();o[m.schemeIdUri](m.value,(function(n){var r=Date.now(),i=C(t,r,n);s.push(i),S(e-1)}),(function(){U()}))}catch(e){U()}}function I(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||0;if(!c||0===c.length||e>=c.length)M();else{var t=c[e];if(t)if(o.hasOwnProperty(t.schemeIdUri)){var n=(new Date).getTime();o[t.schemeIdUri](t.value,(function(e){var r=(new Date).getTime(),i=C(n,r,e);m=t,M(i)}),(function(){I(e+1)}))}else I(e+1);else M()}}function C(e,t,n){return n-(t-(t-e)/2)}function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,t=isNaN(e);t&&i.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?function(){var e=a.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?B(!0):B(!1,t-Date.now())}():B(t,e)}function L(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t,n,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function P(e){return Date.parse(e)}function D(e){return Date.parse(e)}function O(e,t,n){n()}function N(e,t,n){var r=L(e);isNaN(r)?n():t(r)}function k(e,t,n,r,i){var o,a,s=!1,l=new XMLHttpRequest,u=i?R.w.HEAD:R.w.GET,c=t.match(/\S+/g);if(t=c.shift(),o=function(){s||(s=!0,c.length?k(e,c.join(" "),n,r,i):r())},a=function(){var t,r;200===l.status&&(t=i?l.getResponseHeader("Date"):l.response,r=e(t),isNaN(r)||(n(r),s=!0))},E.isRelative(t)){var d=v.resolve();d&&(t=E.resolve(t,d.url))}l.open(u,t),l.timeout=5e3,l.onload=a,l.onloadend=o,l.send()}function F(e,t,n){k(D,e,t,n,!0)}function B(e,r){if(isNaN(f)||isNaN(r)||e||function(e){try{var n,r=z(e),o=isNaN(g)?30:g,a=isNaN(i.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:i.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,s=isNaN(i.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:i.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,l=isNaN(i.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:i.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;r?(n=Math.min(o*a,s),t.debug("Increasing timeBetweenSyncAttempts to ".concat(n))):(n=Math.max(o/a,l),t.debug("Decreasing timeBetweenSyncAttempts to ".concat(n))),g=n}catch(e){}}(r),!e&&!isNaN(r)){h=Date.now(),n=!1;var o=isNaN(f);f=r,o&&A(),t.debug("Completed UTC sync. Setting client - server offset to ".concat(r))}e&&(m=null,n=!1,y.error(new w.Z(x.TIME_SYNC_FAILED_ERROR_CODE,x.TIME_SYNC_FAILED_ERROR_MESSAGE))),_.trigger(u.Z.UPDATE_TIME_SYNC_OFFSET,{offset:r}),_.trigger(u.Z.TIME_SYNCHRONIZATION_COMPLETED)}function U(){if(s&&0!==s.length){var e=s.reduce((function(e,t){return e+t}),0)/s.length;z(e)?t.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(t.debug("Completed background UTC sync. Setting client - server offset to ".concat(e)),f=e,_.trigger(u.Z.UPDATE_TIME_SYNC_OFFSET,{offset:f})),r=!1,p=Date.now()}}function z(e){try{if(isNaN(f))return!0;var t=i.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(i.get().streaming.utcSynchronization.maximumAllowedDrift)?i.get().streaming.utcSynchronization.maximumAllowedDrift:100;return e>=f-t&&e<=f+t}catch(e){return!0}}return e={initialize:function(){T(),o={"urn:mpeg:dash:utc:http-head:2014":F,"urn:mpeg:dash:utc:http-xsdate:2014":k.bind(null,L),"urn:mpeg:dash:utc:http-iso:2014":k.bind(null,P),"urn:mpeg:dash:utc:direct:2014":N,"urn:mpeg:dash:utc:http-head:2012":F,"urn:mpeg:dash:utc:http-xsdate:2012":k.bind(null,L),"urn:mpeg:dash:utc:http-iso:2012":k.bind(null,P),"urn:mpeg:dash:utc:direct:2012":N,"urn:mpeg:dash:utc:http-ntp:2014":O,"urn:mpeg:dash:utc:ntp:2014":O,"urn:mpeg:dash:utc:sntp:2014":O}},attemptSync:function(e,t){c=e,n||(function(e){try{if(!e||!i.get().streaming.utcSynchronization.enabled)return!1;var t=isNaN(g)?30:g;return!(h&&t&&!isNaN(t))||(Date.now()-h)/1e3>=t}catch(e){return!0}}(t)?(n=!0,I()):_.trigger(u.Z.TIME_SYNCHRONIZATION_COMPLETED))},setConfig:function(e){e&&(e.dashMetrics&&(a=e.dashMetrics),e.baseURLController&&(v=e.baseURLController),e.errHandler&&(y=e.errHandler),e.settings&&(i=e.settings))},reset:function(){T(),_.off(u.Z.ATTEMPT_BACKGROUND_SYNC,A,e)}},t=(0,d.Z)(b).getInstance().getLogger(e),_.on(u.Z.ATTEMPT_BACKGROUND_SYNC,A,e),e}jt.__dashjs_factory_name="TimeSyncController";var Ht=c.Z.getSingletonFactory(jt);Ht.HTTP_TIMEOUT_MS=5e3,c.Z.updateSingletonFactory(jt.__dashjs_factory_name,Ht);const Zt=Ht;function qt(){var e,t,n,r=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?t=new MediaSource:e&&(t=new WebKitMediaSource),t},attachMediaSource:function(e){var n=window.URL.createObjectURL(t);return e.setSource(n),n},detachMediaSource:function(e){e.setSource(null)},setDuration:function e(r){t&&"open"===t.readyState&&(null===r&&isNaN(r)||t.duration!==r&&(function(e){for(var t=e.sourceBuffers,n=0;n<t.length;n++)if(t[n].updating)return!0;return!1}(t)?setTimeout(e.bind(null,r),50):(n.info("Set MediaSource duration:"+r),t.duration=r)))},setSeekable:function(e,n){t&&"function"==typeof t.setLiveSeekableRange&&"function"==typeof t.clearLiveSeekableRange&&"open"===t.readyState&&e>=0&&e<n&&(t.clearLiveSeekableRange(),t.setLiveSeekableRange(e,n))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,r=0;r<t.length;r++){if(t[r].updating)return;if(0===t[r].buffered.length)return}n.info("call to mediaSource endOfStream"),e.endOfStream()}}},n=(0,d.Z)(r).getInstance().getLogger(e),e}qt.__dashjs_factory_name="MediaSourceController";const Wt=c.Z.getSingletonFactory(qt);function Yt(){var e,t,n,r,i,o,a,s,u,c,p,f="urn:mpeg:dash:event:2012",m="updated",g="added",y=this.context,v=(0,l.Z)(y).getInstance();function b(){if(!a||!s)throw new Error("setConfig function has to be called previously")}function _(){p=!1,n={},r={},i=null,c=!1,o=Date.now()/1e3}function E(){try{if(!c){c=!0;var e=s.getTime(),i=e-o;i=o>0?Math.max(0,i):0,w(r,i,e),w(n,i,e),T(r),T(n),o=e,c=!1}}catch(e){c=!1,t.error(e)}}function w(e,n,r){try{I(e,(function(i){if(void 0!==i){var o=isNaN(i.duration)?0:i.duration;i.calculatedPresentationTime<=r&&i.calculatedPresentationTime+n+o>=r?C(i,h.Z.EVENT_MODE_ON_START):(R(r,o+n,i.calculatedPresentationTime)||function(e){try{var n=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>n}catch(e){return t.error(e),!1}}(i))&&(t.debug("Removing event ".concat(i.id," from period ").concat(i.eventStream.period.id," as it is expired or invalid")),function(e,n){try{var r=n.eventStream.schemeIdUri,i=n.eventStream.period.id,o=n.eventStream.value,a=n.id;e[i][r]=e[i][r].filter((function(e){return o&&e.eventStream.value&&e.eventStream.value!==o||e.id!==a})),0===e[i][r].length&&delete e[i][r]}catch(e){t.error(e)}}(e,i))}}))}catch(e){t.error(e)}}function T(e){try{for(var n in e)e.hasOwnProperty(n)&&0===Object.keys(e[n]).length&&delete e[n]}catch(e){t.error(e)}}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.eventStream.schemeIdUri,i=e.eventStream.value,o=e.id,a="discarded";t[r]||(t[r]=[]);var s=t[r].findIndex((function(e){return(!i||e.eventStream.value&&e.eventStream.value===i)&&e.id===o}));if(-1===s)t[r].push(e),e.triggeredReceivedEvent=!1,e.triggeredStartEvent=!1,a=g;else if(n){var l=t[r][s];e.triggeredReceivedEvent=l.triggeredReceivedEvent,e.triggeredStartEvent=l.triggeredStartEvent,t[r][s]=e,a=m}return a}function S(e){try{if(1==e.eventStream.value){var n,r=e.calculatedPresentationTime;n=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,v.trigger(h.Z.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:n,newManifestValidAfter:NaN},{mode:h.Z.EVENT_MODE_ON_START})}}catch(e){t.error(e)}}function x(e){try{var n=s.getTime();I(e,(function(e){var t=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.duration)?e.eventStream.period.duration:NaN,r=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.start)?e.eventStream.period.start:NaN;if(!isNaN(t)&&!isNaN(r)){var i=e.calculatedPresentationTime;Math.abs(i-n)<300&&C(e,h.Z.EVENT_MODE_ON_START)}}))}catch(e){t.error(e)}}function I(e,n){try{if(e)for(var r=Object.keys(e),i=0;i<r.length;i++)for(var o=e[r[i]],a=Object.keys(o),s=0;s<a.length;s++)o[a[s]].forEach((function(e){void 0!==e&&n(e)}))}catch(e){t.error(e)}}function R(e,n,r){try{return e-n>r}catch(e){return t.error(e),!1}}function C(e,n){try{var r=s.getTime(),i=e.id;if(n===h.Z.EVENT_MODE_ON_RECEIVE&&!e.triggeredReceivedEvent)return t.debug("Received event ".concat(i)),e.triggeredReceivedEvent=!0,void v.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n});e.triggeredStartEvent||(e.eventStream.schemeIdUri===f&&1==e.eventStream.value?0===e.duration&&0===e.presentationTimeDelta||(t.debug("Starting manifest refresh event ".concat(i," at ").concat(r)),function(){try{b(),a.refreshManifest()}catch(e){t.error(e)}}()):"urn:mpeg:dash:event:callback:2015"===e.eventStream.schemeIdUri&&1==e.eventStream.value?(t.debug("Starting callback event ".concat(i," at ").concat(r)),function(e){try{(0,ae.Z)(y).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){t.error(e)}}(e.messageData)):(t.debug("Starting event ".concat(i," from period ").concat(e.eventStream.period.id," at ").concat(r)),v.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n})),e.triggeredStartEvent=!0)}catch(e){t.error(e)}}return e={addInlineEvents:function(e,r){try{if(b(),n[r]||(n[r]={}),e)for(var i=0;i<e.length;i++){var o=e[i];if(!R(s.getTime(),isNaN(o.duration)?0:o.duration,o.calculatedPresentationTime)){var a=A(o,n[r],!0);a===g?(t.debug("Added inline event with id ".concat(o.id," from period ").concat(r)),C(o,h.Z.EVENT_MODE_ON_RECEIVE)):a===m&&t.debug("Updated inline event with id ".concat(o.id," from period ").concat(r))}}}catch(e){throw e}},addInbandEvents:function(e,n){try{b(),r[n]||(r[n]={});for(var i=0;i<e.length;i++){var o=e[i];R(s.getTime(),isNaN(o.duration)?0:o.duration,o.calculatedPresentationTime)||(A(o,r[n],!1)===g?(o.eventStream.schemeIdUri===f&&S(o),t.debug("Added inband event with id ".concat(o.id," from period ").concat(n)),C(o,h.Z.EVENT_MODE_ON_RECEIVE)):t.debug("Inband event with scheme_id_uri ".concat(o.eventStream.schemeIdUri,", value ").concat(o.eventStream.value,", period id ").concat(n," and event id ").concat(o.id," was ignored because it has been added before.")))}E()}catch(e){throw e}},getInbandEvents:function(){return r},getInlineEvents:function(){return n},start:function(){try{b(),t.debug("Start Event Controller");var e=u.get().streaming.eventControllerRefreshDelay;p||isNaN(e)||(p=!0,i=setInterval(E,e))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(a=e.manifestUpdater),e.playbackController&&(s=e.playbackController),e.settings&&(u=e.settings)}catch(e){throw e}},reset:function(){(function(){try{null!==i&&p&&(clearInterval(i),i=null,p=!1,function(){try{x(r),x(n)}catch(e){t.error(e)}}())}catch(e){throw e}})(),_()}},t=(0,d.Z)(y).getInstance().getLogger(e),_(),e}Yt.__dashjs_factory_name="EventController";const Kt=c.Z.getSingletonFactory(Yt),$t={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}};function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qt(){var e,t,n,r,i,a,c,p,f,m,g,y,v,b,_,E,T,A,S,I,R,C,M,L,P,D,N,k,F,B,U,z,G,V,j,H,Z,q,W,Y,K,$,X,ee,te,ne,re,ie,oe=this.context,ae=(0,l.Z)(oe).getInstance();function se(){if(!(a&&a.hasOwnProperty("load")&&R&&R.hasOwnProperty("initialize")&&R.hasOwnProperty("reset")&&R.hasOwnProperty("getClientTimeOffset")&&c&&I&&f&&G))throw new Error(o.Z.MISSING_CONFIG_ERROR)}function le(){!function(){try{var e=p.getStreamsInfo();if(!M&&0===e.length)throw new Error("There are no periods in the MPD");M&&e.length>0&&f.updateManifestUpdateInfo({currentTime:G.getTime(),buffered:z.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:R.getClientTimeOffset()}),C.length>0&&function(e){0!==e.length?C=C.filter((function(n){var r=e.filter((function(e){return e.id===n.getId()})).length>0||n.getId()===M.getId();return r||(t.debug("Removing stream ".concat(n.getId())),n.reset(!0)),r})):t.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.")}(e);for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];n.push(ce(o)),f.addManifestUpdateStreamInfo(o)}Promise.all(n).then((function(){return new Promise((function(t,n){M?t():de(e,t,n)}))})).then((function(){ae.trigger(u.Z.STREAMS_COMPOSED),Le()})).catch((function(e){throw e}))}catch(e){I.error(new w.Z(x.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+" nostreamscomposed",c.getValue())),B=!0,$e()}}()}function ue(){te=!0}function ce(e){var t=We(e.id);return t?t.updateData(e):(t=Ot(oe).create({manifestModel:c,mediaPlayerModel:j,dashMetrics:f,manifestUpdater:i,adapter:p,timelineConverter:R,capabilities:n,capabilitiesFilter:r,errHandler:I,baseURLController:v,segmentBaseController:b,textController:P,abrController:E,playbackController:G,eventController:A,mediaController:T,protectionController:L,videoModel:z,streamInfo:e,settings:ee}),C.push(t),t.initialize(),Promise.resolve())}function de(e,n,r){try{Te();var i=f.getCurrentDVRInfo().range;if(i.end<i.start){ne&&clearTimeout(ne);var o=Math.min(1e3*(-1*(i.end-i.start)+2),2147483647);return t.debug("Waiting for ".concat(o," ms before playback can start")),ae.trigger(u.Z.AST_IN_FUTURE,{delay:o}),void(ne=setTimeout((function(){de(e,n,r)}),o))}ee.get().streaming.applyProducerReferenceTime&&V.calculateProducerReferenceTimeOffsets(e);var a=e[0].manifestInfo;if(ee.get().streaming.applyServiceDescription&&V.applyServiceDescription(a),p.getIsDynamic()){var s=Ue(e,a);G.computeAndSetLiveDelay(s,a)}(ee.get().streaming.applyContentSteering&&y.shouldQueryBeforeStart()?y.loadSteeringData():Promise.resolve()).then((function(){var e=c.getValue();e&&v.update(e),he(),n()})).catch((function(e){t.error(e),he(),n()}))}catch(e){r(e)}}function he(){var e=function(){var e;if(p.getIsDynamic()){var n=f.getCurrentDVRInfo();e=(n&&n.range?n.range.end:0)-G.getOriginalLiveDelay();var r=n?n.range:null;if(r){if(isNaN(re)&&-1===re.toString().indexOf("posix:")){var i=ke(!0);isNaN(i)||(t.info("Start time from URI parameters: ".concat(i)),e=Math.min(e,i))}else{t.info("Start time provided by the app: ".concat(re));var o=Fe(!0,re);isNaN(o)||(e=Math.min(e,o))}var a=ee.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;e=Math.max(e,r.start+a)}}else if(e=Qe()[0].getStreamInfo().start,isNaN(re)){var s=ke(!1);isNaN(s)||(t.info("Start time from URI parameters: ".concat(s)),e=Math.max(e,s))}else{t.info("Start time provided by the app: ".concat(re));var l=Fe(!1,re);isNaN(l)||(e=Math.max(e,l))}return e}(),n=we(e),r=null!==n?n:C[0];ae.trigger(u.Z.INITIAL_STREAM_SWITCH,{startTime:e}),pe(r,null,e),Y||(Y=setInterval((function(){!k&&G.getTimeToStreamEnd()<=0&&!G.isSeeking()&&ae.trigger(u.Z.PLAYBACK_ENDED,{isLast:qe().isLast})}),200))}function pe(e,n,r){try{if(k||!e||n===e&&e.getIsActive())return;k=!0,ae.trigger(u.Z.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var i=!1;M=e,n&&(i=_e(e,n),n.deactivate(i)),r=isNaN(r)?!i&&n?e.getStreamInfo().start:NaN:r,t.info("Switch to stream ".concat(e.getId(),". Seektime is ").concat(r,", current playback time is ").concat(G.getTime(),". Seamless period switch is set to ").concat(i)),$=$.filter((function(e){return e.getId()!==M.getId()})),G.initialize(qe(),!!n),z.getElement()?fe(r,i,!1):me(r,i)}catch(e){k=!1}}function fe(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];function o(){if(U&&"open"===U.readyState){t.debug("MediaSource is open!"),window.URL.revokeObjectURL(r),U.removeEventListener("sourceopen",o),U.removeEventListener("webkitsourceopen",o),Ne();var a=f.getCurrentDVRInfo();m.setSeekable(a.range.start,a.range.end),i?(isNaN(e)||G.seek(e,!0,!0),M.setMediaSource(U).then((function(){M.initializeForTextWithMediaSource(U)}))):me(e,n)}}function a(){U.addEventListener("sourceopen",o,!1),U.addEventListener("webkitsourceopen",o,!1),r=m.attachMediaSource(z),t.debug("MediaSource attached to element.  Waiting on open...")}U?n?me(e,n):(m.detachMediaSource(z),a()):(U=m.createMediaSource(),a())}function me(e,t){M.activate(U,t?K:void 0,e).then((function(t){if(t){var n=Object.keys(t);n.length>0&&t[n[0]].getBuffer().changeType&&(X=!0),K=t}isNaN(e)||(ae.trigger(u.Z.SEEK_TARGET,{time:e},{streamId:M.getId()}),G.seek(e,!1,!0),M.startScheduleControllers()),k=!1,ae.trigger(u.Z.PERIOD_SWITCH_COMPLETED,{toStreamInfo:qe()})}))}function ge(e){var t=we(e.seekTime);t&&t!==M?t&&t!==M&&(ye(),function(e,t){var n=e&&!isNaN(e.seekTime)?e.seekTime:NaN,r=M.getProcessors().map((function(t){return t.prepareOuterPeriodPlaybackSeeking(e)}));Promise.all(r).then((function(){pe(t,M,n)})).catch((function(e){I.error(e)}))}(e,t)):(ye(),function(e){M.getProcessors().forEach((function(t){return t.prepareInnerPeriodPlaybackSeeking(e)})),je(J.USER_REQUEST_STOP_REASON)}(e)),He(Q.SEEK_START_REASON)}function ye(){ve()}function ve(){$&&$.length>0&&($.forEach((function(e){e.deactivate(!0)})),$=[])}function be(e){e.newMediaInfo.streamInfo.id===M.getId()&&(ve(),M.prepareTrackChange(e))}function _e(e,t){try{return ee.get().streaming.buffer.reuseExistingSourceBuffers&&(t.isProtectionCompatible(e)||te)&&(X&&ee.get().streaming.buffer.useChangeTypeForTrackSwitch||t.isMediaCodecCompatible(e,t))}catch(e){return!1}}function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;U&&!e.getPreloaded()&&_e(e,t)&&e.startPreloading(U,K).then((function(){$.push(e)}))}function we(e){if(isNaN(e))return null;for(var t=C.length,n=0;n<t;n++){var r=C[n];if(e<parseFloat((r.getStartTime()+r.getDuration()).toFixed(5)))return r}return null}function Te(){try{var e=p.getIsDynamic(),t=p.getStreamsInfo()[0].manifestInfo,n=G.getTime(),r=R.calcTimeShiftBufferWindow(C,e),i=De();if(void 0===r.start||void 0===r.end)return;i&&0!==i.length?i.forEach((function(e){f.addDVRInfo(e.getType(),n,t,r)})):f.addDVRInfo(o.Z.VIDEO,n,t,r)}catch(e){}}function Ae(e){if(q&&N){var t=j.getInitialBufferLevel(),n=[o.Z.TEXT];(isNaN(t)||t<=G.getBufferLevel(n)||p.getIsDynamic()&&t>G.getLiveDelay())&&(q=!1,He(Q.INITIAL_PLAYOUT_START_REASON),G.play())}e&&e.mediaType&&f.addBufferLevel(e.mediaType,new Date,1e3*e.bufferLevel)}function Se(e){e.streamInfo.id===M.getId()&&e.reason&&e.reason.forceReplace&&ve(),We(e.streamInfo.id).prepareQualityChange(e)}function xe(){if(p.getIsDynamic()&&0!==G.getOriginalLiveDelay()&&M){var e=p.getStreamsInfo();if(e.length>0){var t=e[0].manifestInfo,n=Ue(e,t);G.computeAndSetLiveDelay(n,t)}}}function Ie(){if(Ge()){var e=z.getPlaybackQuality();e&&f.addDroppedFrames(e)}}function Re(){t.debug("[onPlaybackStarted]"),!q&&Z&&He(Q.RESUME_FROM_PAUSE_START_REASON),q&&(q=!1),W&&(W=!1,ee.get().streaming.applyContentSteering&&!y.shouldQueryBeforeStart()&&y.loadSteeringData()),Z=!1}function Ce(e){t.debug("[onPlaybackPaused]"),e.ended||(Z=!0,je(J.USER_REQUEST_STOP_REASON))}function Me(e){t.debug("Stream with id ".concat(e.streamInfo.id," finished buffering"));var n=e.streamInfo.isLast;U&&n?(t.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),m.signalEndOfStream(U)):Le()}function Le(){if(M&&M.getHasFinishedBuffering())for(var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=e||M||null;if(t){var n=t.getStreamInfo();return C.filter((function(e){var t=e.getStreamInfo();return t.start>n.start&&n.id!==t.id}))}}catch(e){return[]}}(M),t=0;t<e.length;){var n=e[t],r=0===t?M:e[t-1];!n.getPreloaded()&&r.getHasFinishedBuffering()&&U&&Ee(n,r),t+=1}}function Pe(){Y&&(clearInterval(Y),Y=null)}function De(){return M?M.getProcessors():[]}function Oe(e){if(M&&!M.getIsEndedEventSignaled()){M.setIsEndedEventSignaled(!0);var n=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||M||null;if(!e)return null;for(var t=e.getStreamInfo(),n=t.start,r=0,i=-1,o=NaN;r<C.length;){var a=C[r].getStreamInfo(),s=a.start-n;s>0&&(isNaN(o)||s<o)&&t.id!==a.id&&(o=s,i=r),r+=1}return i>=0?C[i]:null}();n?(t.debug("StreamController onEnded, found next stream with id ".concat(n.getStreamInfo().id,". Switching from ").concat(M.getStreamInfo().id," to ").concat(n.getStreamInfo().id)),pe(n,M,NaN)):(t.debug("StreamController no next stream found"),M.setIsEndedEventSignaled(!1)),je(n?J.END_OF_PERIOD_STOP_REASON:J.END_OF_CONTENT_STOP_REASON)}e&&e.isLast&&(Pe(),y.stopSteeringRequestTimer())}function Ne(e){var t=e||qe().manifestInfo.duration;m.setDuration(t)}function ke(e){var t=_.getURIFragmentData();if(!t||!t.t)return NaN;var n=Qe()[0].getStreamInfo().start;return t.t=t.t.split(",")[0],Be(e,t.t,n)}function Fe(e,t){var n=0;return e||(n=Qe()[0].getStreamInfo().start),Be(e,t,n)}function Be(e,t,n){var r=p.getRegularPeriods()[0],i=t.toString(),o=-1!==i.indexOf("posix:")?"now"===i.substring(6)?Date.now()/1e3:parseFloat(i.substring(6)):NaN;return e&&!isNaN(o)?R.calcPresentationTimeFromWallTime(new Date(1e3*o),r):parseFloat(i)+n}function Ue(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var r=e[0],i=[o.Z.VIDEO,o.Z.AUDIO,o.Z.TEXT].reduce((function(e,t){var n=p.getMediaInfoForType(r,t);return n&&!1!==n.isFragmented&&e.push(n),e}),[]).reduce((function(e,t){var n=p.getVoRepresentations(t);return n&&n.length>0&&n.forEach((function(t){t&&e.push(t)})),e}),[]).reduce((function(e,t){var n=p.convertRepresentationToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e}),[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e))return Xt(e)}(a=i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(a)||function(e,t){if(e){if("string"==typeof e)return Xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(e,t):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return isFinite(n)?n:NaN}catch(e){return NaN}var a}function ze(e){if(e.error)B=!0,$e();else{t.info("Manifest updated... updating data system wide.");var n=e.manifest;p.updatePeriods(n);var i=p.getUTCTimingSources();!p.getIsDynamic()||i&&0!==i.length||ae.trigger(h.Z.CONFORMANCE_VIOLATION,{level:$t.LEVELS.WARNING,event:$t.EVENTS.NO_UTC_TIMING_ELEMENT});var o=p.getIsDynamic()?i.concat(H.getUTCTimingSources()):i;r.filterUnsupportedFeatures(n).then((function(){v.initialize(n),g.attemptSync(o,p.getIsDynamic())}))}}function Ge(){return!!M&&M.getHasVideoTrack()}function Ve(){return!!M&&M.getHasAudioTrack()}function je(e,t){t=t||new Date,De().forEach((function(n){n.finalisePlayList(t,e)})),f.addPlayList()}function He(e){f.createPlaylistMetrics(1e3*G.getTime(),e)}function Ze(e){if(e.error){var n="";switch(e.error.code){case 1:n="MEDIA_ERR_ABORTED";break;case 2:n="MEDIA_ERR_NETWORK";break;case 3:n="MEDIA_ERR_DECODE",ie.counts.mediaErrorDecode+=1;break;case 4:n="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:n="MEDIA_ERR_ENCRYPTED";break;default:n="UNKNOWN"}"MEDIA_ERR_DECODE"===n&&ee.get().errors.recoverAttempts.mediaErrorDecode>=ie.counts.mediaErrorDecode?function(){t.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var e=G.getTime();M.deactivate(!1),t.warn("MediaSource has been resetted. Resuming playback from time ".concat(e)),fe(e,!1,!1)}():(F=!0,e.error.message&&(n+=" ("+e.error.message+")"),e.error.msExtendedCode&&(n+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),t.fatal("Video Element Error: "+n),e.error&&t.fatal(e.error),I.error(new w.Z(e.error.code,n)),$e())}}function qe(){return M?M.getStreamInfo():null}function We(e){for(var t=0,n=C.length;t<n;t++)if(C[t].getId()===e)return C[t];return null}function Ye(e){isNaN(e.newDuration)||Ne(e.newDuration)}function Ke(){C=[],re=NaN,L=null,k=!1,M=null,F=!1,B=!1,q=!0,W=!0,Z=!1,N=!0,Y=null,te=!1,X=!1,$=[],ne=null,ie={counts:{mediaErrorDecode:0}}}function $e(){se(),g.reset(),je(F||B?J.FAILURE_STOP_REASON:J.USER_REQUEST_STOP_REASON);for(var t=0,n=C?C.length:0;t<n;t++)C[t].reset(F);ae.off(h.Z.PLAYBACK_TIME_UPDATED,Ie,e),ae.off(h.Z.PLAYBACK_SEEKING,ge,e),ae.off(h.Z.PLAYBACK_ERROR,Ze,e),ae.off(h.Z.PLAYBACK_STARTED,Re,e),ae.off(h.Z.PLAYBACK_PAUSED,Ce,e),ae.off(h.Z.PLAYBACK_ENDED,Oe,e),ae.off(h.Z.METRIC_ADDED,Xe,e),ae.off(h.Z.MANIFEST_VALIDITY_CHANGED,Ye,e),ae.off(h.Z.BUFFER_LEVEL_UPDATED,Ae,e),ae.off(h.Z.QUALITY_CHANGE_REQUESTED,Se,e),u.Z.KEY_SESSION_UPDATED&&ae.off(u.Z.KEY_SESSION_UPDATED,ue,e),ae.off(u.Z.MANIFEST_UPDATED,ze,e),ae.off(u.Z.STREAM_BUFFERING_COMPLETED,Me,e),ae.off(u.Z.TIME_SYNCHRONIZATION_COMPLETED,le,e),ae.off(u.Z.CURRENT_TRACK_CHANGED,be,e),ae.off(u.Z.SETTING_UPDATED_LIVE_DELAY,xe,e),ae.off(u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,xe,e),v.reset(),i.reset(),A.reset(),f.clearAllCurrentMetrics(),c.setValue(null),a.reset(),R.reset(),S.reset(),U&&(m.detachMediaSource(z),U=null),z=null,L&&(L=null,D=null,c.getValue()&&ae.trigger(u.Z.PROTECTION_DESTROYED,{data:c.getValue().url})),Pe(),ae.trigger(u.Z.STREAM_TEARDOWN_COMPLETE),Ke()}function Xe(e){if(e.metric===s.Z.DVR_INFO){var t=Ve()?o.Z.AUDIO:o.Z.VIDEO;e.mediaType===t&&m.setSeekable(e.value.range.start,e.value.range.end)}}function Qe(){return C}return e={initialize:function(t,n){se(),N=t,D=n,R.initialize(),(i=Vt(oe).create()).setConfig({manifestModel:c,adapter:p,manifestLoader:a,errHandler:I,settings:ee,contentSteeringController:y}),i.initialize(),(A=Kt(oe).getInstance()).setConfig({manifestUpdater:i,playbackController:G,settings:ee}),A.start(),g.setConfig({dashMetrics:f,baseURLController:v,errHandler:I,settings:ee}),g.initialize(),L&&(ae.trigger(u.Z.PROTECTION_CREATED,{controller:L}),L.setMediaElement(z.getElement()),D&&L.setProtectionData(D)),ae.on(h.Z.PLAYBACK_TIME_UPDATED,Ie,e),ae.on(h.Z.PLAYBACK_SEEKING,ge,e),ae.on(h.Z.PLAYBACK_ERROR,Ze,e),ae.on(h.Z.PLAYBACK_STARTED,Re,e),ae.on(h.Z.PLAYBACK_PAUSED,Ce,e),ae.on(h.Z.PLAYBACK_ENDED,Oe,e),ae.on(h.Z.METRIC_ADDED,Xe,e),ae.on(h.Z.MANIFEST_VALIDITY_CHANGED,Ye,e),ae.on(h.Z.BUFFER_LEVEL_UPDATED,Ae,e),ae.on(h.Z.QUALITY_CHANGE_REQUESTED,Se,e),u.Z.KEY_SESSION_UPDATED&&ae.on(u.Z.KEY_SESSION_UPDATED,ue,e),ae.on(u.Z.MANIFEST_UPDATED,ze,e),ae.on(u.Z.STREAM_BUFFERING_COMPLETED,Me,e),ae.on(u.Z.TIME_SYNCHRONIZATION_COMPLETED,le,e),ae.on(u.Z.CURRENT_TRACK_CHANGED,be,e),ae.on(u.Z.SETTING_UPDATED_LIVE_DELAY,xe,e),ae.on(u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,xe,e)},getActiveStreamInfo:qe,addDVRMetric:Te,hasVideoTrack:Ge,hasAudioTrack:Ve,getStreamById:We,getStreamForTime:we,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,o=null,a=0;a<C.length;a++){if(i=(n=C[a]).getStartTime(),o=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(o)&&(r+=o)}return null},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;se(),re=t,a.load(e)},loadWithManifest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;(function(){if(!i||!i.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")})(),re=t,i.setManifest(e)},getActiveStreamProcessors:De,setConfig:function(e){e&&(e.capabilities&&(n=e.capabilities),e.capabilitiesFilter&&(r=e.capabilitiesFilter),e.manifestLoader&&(a=e.manifestLoader),e.manifestModel&&(c=e.manifestModel),e.mediaPlayerModel&&(j=e.mediaPlayerModel),e.customParametersModel&&(H=e.customParametersModel),e.protectionController&&(L=e.protectionController),e.adapter&&(p=e.adapter),e.dashMetrics&&(f=e.dashMetrics),e.errHandler&&(I=e.errHandler),e.timelineConverter&&(R=e.timelineConverter),e.videoModel&&(z=e.videoModel),e.playbackController&&(G=e.playbackController),e.serviceDescriptionController&&(V=e.serviceDescriptionController),e.contentSteeringController&&(y=e.contentSteeringController),e.textController&&(P=e.textController),e.abrController&&(E=e.abrController),e.mediaController&&(T=e.mediaController),e.settings&&(ee=e.settings),e.baseURLController&&(v=e.baseURLController),e.uriFragmentModel&&(_=e.uriFragmentModel),e.segmentBaseController&&(b=e.segmentBaseController))},setProtectionData:function(e){D=e,L&&L.setProtectionData(D)},getIsStreamSwitchInProgress:function(){return k},switchToVideoElement:function(e){M&&(G.initialize(qe()),fe(e,!1,!0))},getHasMediaOrInitialisationError:function(){return F||B},getStreams:Qe,getActiveStream:function(){return M},getInitialPlayback:function(){return q},getAutoPlay:function(){return N},reset:$e},t=(0,d.Z)(oe).getInstance().getLogger(e),g=Zt(oe).getInstance(),m=Wt(oe).getInstance(),S=O(oe).getInstance(),Ke(),e}Qt.__dashjs_factory_name="StreamController";const Jt=c.Z.getSingletonFactory(Qt);function en(){var e,t,n,r,i,a,s,c,h,p,f,m,g=this.context,y=(0,l.Z)(g).getInstance();function v(){m.debug("Stopping the gap controller"),i&&(clearInterval(i),i=null),function(){y.off(u.Z.WALLCLOCK_TIME_UPDATED,T,this),y.off(u.Z.INITIAL_STREAM_SWITCH,w,this),y.off(u.Z.PLAYBACK_SEEKING,b,this),y.off(u.Z.BUFFER_REPLACEMENT_STARTED,_,e),y.off(u.Z.TRACK_CHANGE_RENDERED,E,e)}(),i=null,a=NaN,r=0,p=null,f={}}function b(){p&&(clearTimeout(p),p=null)}function _(e){try{if(e.streamId!==c.getActiveStreamInfo().id||e.mediaType!==o.Z.VIDEO&&e.mediaType!==o.Z.AUDIO)return;e.streamId===c.getActiveStreamInfo().id&&(f[e.mediaType]=!0)}catch(e){m.error(e)}}function E(e){e&&e.mediaType&&(f[e.mediaType]=!1)}function w(){i||function(){try{i||(m.debug("Starting the gap controller"),i=setInterval((function(){A()&&S(s.getTime())}),100))}catch(e){}}()}function T(){if(A(n.get().streaming.gaps.enableSeekFix)&&++r>=10){var e=s.getTime();t===e?S(e,!0):(t=e,a=NaN),r=0}}function A(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!c.getActiveStream())return!1;var t=Object.keys(f).some((function(e){return f[e]})),r=!!e&&function(){var e=c.getActiveStream(),t=parseFloat((e.getStartTime()+e.getDuration()).toFixed(5));return s.getTime()+n.get().streaming.gaps.threshold>=t}();return!t&&n.get().streaming.gaps.jumpGaps&&c.getActiveStreamProcessors().length>0&&(!s.isSeeking()||r)&&!s.isPaused()&&!c.getIsStreamSwitchInProgress()&&!c.getHasMediaOrInitialisationError()}function S(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n.get().streaming.gaps.enableStallFix,o=n.get().streaming.gaps.stallSeek,l=n.get().streaming.gaps.smallGapLimit,u=n.get().streaming.gaps.jumpLargeGaps,d=h.getBufferRange(),f=NaN,g=!1;if(t=function(e,t){try{if(!e||e.length<=1&&t>0)return NaN;for(var r=NaN,i=0;isNaN(r)&&i<e.length;){var o=i>0?e.end(i-1):0;t<e.start(i)&&o-t<n.get().streaming.gaps.threshold&&(r=i),i+=1}return r}catch(e){return null}}(d,e),!isNaN(t)){var y=d.start(t),v=y-e;v>0&&(v<=l||u)&&(f=y)}var b=s.getTimeToStreamEnd();if(isNaN(f)&&r&&isFinite(b)&&!isNaN(b)&&b<l&&(f=parseFloat(s.getStreamEndTime().toFixed(5)),g=!0),i&&isNaN(f)&&r&&isNaN(t)&&function(e,t){for(var n=0,r=e.length;n<r;n++)if(t>=e.start(n)&&t<=e.end(n))return!0;return!1}(d,e)&&(0===o?(m.warn("Toggle play pause to break stall"),h.pause(),h.play()):(m.warn("Jumping ".concat(o,"s to break stall")),f=e+o)),f>0&&a!==f&&f>e&&!p){var _=f-e;if(g){var E=c.getStreamForTime(f),w=E&&!!E.getPreloaded();m.warn("Jumping to end of stream because of gap from ".concat(e," to ").concat(f,". Gap duration: ").concat(_)),s.seek(f,!0,w)}else{var T=s.getIsDynamic(),A=t>0?d.end(t-1):e,S=T?1e3*Math.max(0,_-.1):0;p=window.setTimeout((function(){s.seek(f,!0,!0),m.warn("Jumping gap occuring in period ".concat(c.getActiveStream().getStreamId()," starting at ").concat(A," and ending at ").concat(f,". Jumping by: ").concat(f-A)),p=null}),S)}a=f}}return e={reset:v,setConfig:function(e){e&&(e.settings&&(n=e.settings),e.playbackController&&(s=e.playbackController),e.streamController&&(c=e.streamController),e.videoModel&&(h=e.videoModel))},initialize:function(){!function(){y.on(u.Z.WALLCLOCK_TIME_UPDATED,T,this),y.on(u.Z.INITIAL_STREAM_SWITCH,w,this),y.on(u.Z.PLAYBACK_SEEKING,b,this),y.on(u.Z.BUFFER_REPLACEMENT_STARTED,_,e),y.on(u.Z.TRACK_CHANGE_RENDERED,E,e)}()}},m=(0,d.Z)(g).getInstance().getLogger(e),v(),e}en.__dashjs_factory_name="GapController";const tn=c.Z.getSingletonFactory(en);function nn(){var e,t,n,r,i,a,c,p,f,m,g=this.context,y=(0,l.Z)(g).getInstance();function v(){t=!1;var e=Fe.Z.parseUserAgent();n=e&&e.browser&&e.browser.name&&"safari"===e.browser.name.toLowerCase()}function b(){t=!1}function _(e){if(e.streamId===a.getActiveStreamInfo().id&&f){var t=c.getLiveDelay();c.getBufferLevel()>t/2&&(f=!1)}}function E(e){e.streamId===a.getActiveStreamInfo().id&&(f=e.state===s.Z.BUFFER_EMPTY)}function w(){p.getCatchupModeEnabled()||r.setPlaybackRate(1)}function T(){c.getIsDynamic()&&p.getCatchupModeEnabled()&&(p.getCatchupPlaybackRates().max>0||p.getCatchupPlaybackRates().min<0)&&!c.isPaused()&&!c.isSeeking()&&function(){try{return!(!c.getTime()>0||t)&&(S()===o.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t){try{return Math.abs(A())>0||e<t}catch(e){return!1}}(c.getBufferLevel(),i.get().streaming.liveCatchup.playbackBufferMin):function(){try{return Math.abs(A())>0}catch(e){return!1}}())}catch(e){return!1}}()&&function(){if(!t&&r){var e,a=r.getPlaybackRate(),s=p.getCatchupPlaybackRates(),l=c.getBufferLevel(),u=A(),d=p.getCatchupMaxDrift();if(!isNaN(d)&&d>0&&u>d)m.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),t=!0,c.seekToCurrentLive(!0,!1);else{var h=c.getCurrentLiveLatency(),g=c.getLiveDelay();e=S()===o.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t,n,r,i){var o;if(i<r){var a=Math.abs(e.min),s=5*(i-r);o=1-a+2*a/(1+Math.pow(Math.E,-s)),m.debug("[LoL+ playback control_buffer-based] bufferLevel: "+i+", newRate: "+o)}else{var l=e.max;if(Math.abs(t-n)<=.02*n)o=1;else{var u=5*(t-n);o=1-l+2*l/(1+Math.pow(Math.E,-u))}m.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+o)}return o}(s,h,g,i.get().streaming.liveCatchup.playbackBufferMin,l):function(e,t,n,r){if(f)return 1;var i=t-n,o=i<0?Math.abs(e.min):e.max,a=5*i,s=1-o+2*o/(1+Math.pow(Math.E,-a));return c.getPlaybackStalled()&&r<=n/2&&i>0&&(s=1),s}(s,h,g,l);var y=n?.25:.02/(.5/s.max);e&&Math.abs(a-e)>=y&&(m.debug("[CatchupController]: Setting playback rate to ".concat(e)),r.setPlaybackRate(e))}}}()}function A(){return c.getCurrentLiveLatency()-c.getLiveDelay()}function S(){var e=i.get().streaming.liveCatchup.playbackBufferMin;return i.get().streaming.liveCatchup.mode!==o.Z.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?o.Z.LIVE_CATCHUP_MODE_DEFAULT:o.Z.LIVE_CATCHUP_MODE_LOLP}function x(){p.getCatchupPlaybackRates(!0)}return e={reset:function(){y.off(h.Z.BUFFER_LEVEL_UPDATED,_,e),y.off(h.Z.BUFFER_LEVEL_STATE_CHANGED,E,e),y.off(h.Z.PLAYBACK_PROGRESS,T,e),y.off(h.Z.PLAYBACK_TIME_UPDATED,T,e),y.off(h.Z.PLAYBACK_SEEKED,b,e),y.off(u.Z.SETTING_UPDATED_CATCHUP_ENABLED,w,e),y.off(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,x,e),y.off(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,x,e),y.off(h.Z.STREAM_INITIALIZED,x,e),v(),r.setPlaybackRate(1,!0)},setConfig:function(e){e&&(e.settings&&(i=e.settings),e.videoModel&&(r=e.videoModel),e.streamController&&(a=e.streamController),e.playbackController&&(c=e.playbackController),e.mediaPlayerModel&&(p=e.mediaPlayerModel))},initialize:function(){y.on(h.Z.BUFFER_LEVEL_UPDATED,_,e),y.on(h.Z.BUFFER_LEVEL_STATE_CHANGED,E,e),y.on(h.Z.PLAYBACK_PROGRESS,T,e),y.on(h.Z.PLAYBACK_TIME_UPDATED,T,e),y.on(h.Z.PLAYBACK_SEEKED,b,e),y.on(u.Z.SETTING_UPDATED_CATCHUP_ENABLED,w,e),y.on(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,x,e),y.on(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,x,e),y.on(h.Z.STREAM_INITIALIZED,x,e),x()}},m=(0,d.Z)(g).getInstance().getLogger(e),v(),e}nn.__dashjs_factory_name="CatchupController";const rn=c.Z.getSingletonFactory(nn);var on=[o.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME],an="video",sn="audio";function ln(){var e,t,n,r,i,s=this.context;function l(){t={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{},contentSteering:null},n=[]}function u(e,n,i){try{t[e][n]=i/1e3}catch(e){r.error(e)}}return e={getServiceDescriptionSettings:function(){return t},getProducerReferenceTimeOffsets:function(){return n},calculateProducerReferenceTimeOffsets:function(e){try{var t=[];if(e&&e.length>0){var s=[o.Z.VIDEO,o.Z.AUDIO,o.Z.TEXT],l=i.getAvailabilityStartTime()/1e3;e.forEach((function(e){var n=s.reduce((function(t,n){return t.concat(i.getAllMediaInfoForType(e,n))}),[]).reduce((function(t,n){return i.getProducerReferenceTimes(e,n).forEach((function(r){var o=i.getVoRepresentations(n);if(o&&o.length>0&&o[0].adaptation&&o[0].segmentInfoType===a.Z.SEGMENT_TEMPLATE){var s=o[0],u=new Date(r[a.Z.WALL_CLOCK_TIME]).getTime()/1e3-(r[a.Z.PRESENTATION_TIME]/s[a.Z.TIMESCALE]-s[a.Z.PRESENTATION_TIME_OFFSET]+e.start),c=l-u;t.push({id:r[a.Z.ID],to:c})}})),t}),[]);t=t.concat(n)}))}n=t}catch(e){r.error(e),n=[]}},applyServiceDescription:function(e){if(e&&e.serviceDescriptions){var i=e.serviceDescriptions.filter((function(e){return on.includes(e.schemeIdUri)})),a=e.serviceDescriptions.filter((function(e){return null==e.schemeIdUri})),s=i.length>0?i[i.length-1]:a[a.length-1];s&&(s.latency&&s.latency.target>0&&function(e){var i;if(e.schemeIdUri,o.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME,i=function(e){return{liveDelay:e.latency.target/1e3,maxDrift:!isNaN(e.latency.max)&&e.latency.max>e.latency.target?(e.latency.max-e.latency.target+500)/1e3:NaN,referenceId:e.latency.referenceId||NaN}}(e),n.length>0){var a=function(e){var t,r=0,i=n.filter((function(t){return t.id===e.referenceId}));return 0===i.length?(r=n.length>0?n[0].to:0,t=n[0].id||NaN):(r=i[0].to||0,t=i[0].id||NaN),{to:r,id:t}}(i),s=a.to,l=a.id;t.liveDelay=i.liveDelay-s,t.liveCatchup.maxDrift=i.maxDrift,r.debug("\n                Found latency properties coming from service description. Applied time offset of ".concat(s," from ProducerReferenceTime element with id ").concat(l,".\n                Live Delay: ").concat(i.liveDelay-s,", Live catchup max drift: ").concat(i.maxDrift,"\n            "))}else t.liveDelay=i.liveDelay,t.liveCatchup.maxDrift=i.maxDrift,r.debug("Found latency properties coming from service description: Live Delay: ".concat(i.liveDelay,", Live catchup max drift: ").concat(i.maxDrift))}(s),s.playbackRate&&function(e){var n=e.playbackRate.min?Math.round(1e3*(e.playbackRate.min-1))/1e3:NaN,i=e.playbackRate.max?Math.round(1e3*(e.playbackRate.max-1))/1e3:NaN;t.liveCatchup.playbackRate.min=n,t.liveCatchup.playbackRate.max=i,r.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(n)),r.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(i))}(s),s.operatingQuality,s.operatingBandwidth&&function(e){if(e&&e.operatingBandwidth&&e.operatingBandwidth.mediaType&&"all"!==e.operatingBandwidth.mediaType){var t={};t.minBandwidth=e.operatingBandwidth.min,t.maxBandwidth=e.operatingBandwidth.max,t.targetBandwidth=e.operatingBandwidth.target;var n=[];e.operatingBandwidth.mediaType===an||e.operatingBandwidth.mediaType===sn?n.push(e.operatingBandwidth.mediaType):"any"===e.operatingBandwidth.mediaType&&(n.push(sn),n.push(an)),n.forEach((function(e){isNaN(t.minBandwidth)||u("minBitrate",e,t.minBandwidth),isNaN(t.maxBandwidth)||u("maxBitrate",e,t.maxBandwidth),isNaN(t.targetBandwidth)||u("initialBitrate",e,t.targetBandwidth)}))}}(s),s.contentSteering&&function(e){t.contentSteering=e.contentSteering}(s))}},reset:function(){l()},setConfig:function(e){e&&e.adapter&&(i=e.adapter)}},r=(0,d.Z)(s).getInstance().getLogger(e),l(),e}ln.__dashjs_factory_name="ServiceDescriptionController";const un=c.Z.getSingletonFactory(ln);var cn=n(3973),dn=n.n(cn),hn=n(3039);function pn(){var e,t,n,r,i,a,s,c,h=this.context,p=(0,l.Z)(h).getInstance();function f(e,t){return e&&n[t]&&n[t][e]?n[t][e].list:[]}function m(e,t){return e&&n[t]&&n[t][e]?n[t][e].current:null}function g(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.streamInfo){var i=e.type,s=e.streamInfo.id,l=m(i,s);if(n[s]&&n[s][i]&&(n[s][i].current=e,n[s][i].current&&(i!==o.Z.TEXT&&!b(e,l)||i===o.Z.TEXT&&e.isFragmented)&&p.trigger(u.Z.CURRENT_TRACK_CHANGED,{oldMediaInfo:l,newMediaInfo:e,switchMode:r.get().streaming.trackSwitchMode[i]},{streamId:s}),!t)){var d=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);if(!d||!n[s][i].storeLastSettings)return;d.roles&&(d.role=d.roles[0],delete d.roles),d.accessibility&&(d.accessibility=d.accessibility[0]),d.audioChannelConfiguration&&(d.audioChannelConfiguration=d.audioChannelConfiguration[0]),a[i]=d,c.setSavedMediaSettings(i,d)}}}function y(e,t){e&&t&&(i[e]=t)}function v(e){return e?i[e]:null}function b(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),o=e.lang===t.lang,a=e.codec===t.codec,s=e.roles.toString()===t.roles.toString(),l=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),u=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),d=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),h=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return n&&a&&r&&i&&o&&s&&l&&u&&c&&d&&h}function _(){n={},a={},i={audio:null,video:null,text:null}}function E(e,t,n){var r=[];return e.forEach((function(e){t(n,e)&&r.push(e)})),0!==r.length?r:e}function w(e,t){return!e.lang||e.lang instanceof RegExp?t.lang.match(e.lang):""!==t.lang&&(0,hn.extendedFilter)(t.lang,dn()(e.lang)).length>0}function T(e,t){return void 0===e.index||null===e.index||t.index===e.index}function A(e,t){return!e.viewpoint||e.viewpoint===t.viewpoint}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!e.role||!!t.roles.filter((function(t){return t===e.role}))[0]||t.type===o.Z.AUDIO&&n}function x(e,t){return e.accessibility?!!t.accessibility.filter((function(t){return t===e.accessibility}))[0]:!t.accessibility.length}function I(e,t){return!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0]}function R(e){var t,n=0,r=[];return e.forEach((function(e){(t=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>n?(n=t,r=[e]):t===n&&r.push(e)})),r}function C(e){var t,n=1/0,r=[];return e.forEach((function(e){var i=e.bitrateList.reduce((function(e,t){var n=Math.max(1,t.width*t.height);return e+t.bandwidth/n}),0);(t=i/e.bitrateList.length)<n?(n=t,r=[e]):t===n&&r.push(e)})),r}function M(e){var t,n=0,r=[];return e.forEach((function(e){(t=e.representationCount)>n?(n=t,r=[e]):t===n&&r.push(e)})),r}function L(e,n){if(e===o.Z.TEXT)return n[0];var i,a=r.get().streaming.selectionModeForInitialTrack,l=s.getCustomInitialTrackSelectionFunction();if(l&&"function"==typeof l)i=l(n);else switch(a){case o.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:i=function(e){var t,n,r=(t=0,n=[],e.forEach((function(e){isNaN(e.selectionPriority)||(e.selectionPriority>t?(t=e.selectionPriority,n=[e]):e.selectionPriority===t&&n.push(e))})),n);return r.length>1&&(r=R(r)),r.length>1&&(r=M(r)),r}(n);break;case o.Z.TRACK_SELECTION_MODE_HIGHEST_BITRATE:i=function(e){var t=R(e);return t.length>1&&(t=M(t)),t}(n);break;case o.Z.TRACK_SELECTION_MODE_FIRST_TRACK:i=P(n);break;case o.Z.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:i=function(e){var t=C(e);return t.length>1&&(t=R(t)),t}(n);break;case o.Z.TRACK_SELECTION_MODE_WIDEST_RANGE:i=function(e){var t=M(e);return t.length>1&&(t=R(e)),t}(n);break;default:t.warn("Track selection mode ".concat(a," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),i=P(n)}return i.length>0?i[0]:n[0]}function P(e){return e[0]}return e={setInitialMediaSettingsForType:function(e,t){var n=a[e]||v(e),r=f(e,t.id),i=[];n||y(e,n=c.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&(i=E(i=Array.from(r),w,n),i=E(i,T,n),i=E(i,A,n),e===o.Z.AUDIO&&a[e]||(i=E(i,S,n)),i=E(i,x,n),i=E(i,I,n)),0===i.length?g(L(e,r),!0):i.length>1?g(L(e,i,a[e])):g(i[0]))},addTrack:function(e){if(e){var t=e.type;if((r=t)===o.Z.AUDIO||r===o.Z.VIDEO||r===o.Z.TEXT||r===o.Z.IMAGE){var r,i=e.streamInfo.id;n[i]||(n[i]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var a=n[i][t].list,s=0,l=a.length;s<l;++s)if(b(a[s],e))return;a.push(e)}}},getTracksFor:f,getCurrentTrackFor:m,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,r=e.streamInfo.id;return n[r]&&n[r][t]&&b(n[r][t].current,e)},setTrack:g,selectInitialTrack:L,setInitialSettings:y,getInitialSettings:v,getTracksWithHighestBitrate:R,getTracksWithHighestEfficiency:C,getTracksWithWidestRange:M,isTracksEqual:b,matchSettings:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var r=!1;if(e.lang){if(e.lang instanceof RegExp)r=t.lang.match(e.lang);else if(""!==t.lang){var i=dn()(e.lang);i&&(r=(0,hn.extendedFilter)(t.lang,i).length>0)}}else r=!0;var a=void 0===e.index||null===e.index||t.index===e.index,s=!e.viewpoint||e.viewpoint===t.viewpoint,l=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],u=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],c=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return r&&a&&s&&(l||t.type===o.Z.AUDIO&&n)&&u&&c}catch(e){return!1}},matchSettingsLang:w,matchSettingsIndex:T,matchSettingsViewPoint:A,matchSettingsRole:S,matchSettingsAccessibility:x,matchSettingsAudioChannelConfig:I,saveTextSettingsDisabled:function(){c.setSavedMediaSettings(o.Z.TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(c=e.domStorage),e.settings&&(r=e.settings),e.customParametersModel&&(s=e.customParametersModel))},reset:_},t=(0,d.Z)(h).getInstance().getLogger(e),_(),e}pn.__dashjs_factory_name="MediaController";var fn=c.Z.getSingletonFactory(pn);c.Z.updateSingletonFactory(pn.__dashjs_factory_name,fn);const mn=fn;var gn=NaN,yn=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||gn},this.children=[]};function vn(){var e,t,n,r,i=this.context,o=Re(i).getInstance();function a(e,t,n){var r=s(n);e[t]?o.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=gn):e[t]=new yn(r)}function s(e){var t=n.getBaseURLsFromElement(e),i=r.getSynthesizedBaseUrlElements(t);return i&&i.length>0&&(t=t.concat(i)),t}function l(e,n){var r=n||t;e(r.data),r.children&&r.children.forEach((function(t){return l(e,t)}))}function u(){t=new yn}return e={reset:u,update:function(e){!function(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var r=s(e);o.areEqual(r,t.data.baseUrls)||(t.data.baseUrls=r,t.data.selectedIdx=gn),e&&e.Period_asArray&&e.Period_asArray.forEach((function(e,r){a(t.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,i){a(t.children[r].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach((function(e,n){a(t.children[r].children[i].children,n,e)}))}))}))}(e)},getForPath:function(e){var n=t,r=[n.data];return e&&e.forEach((function(e){(n=n.children[e])&&r.push(n.data)})),r.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){l((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=gn)}))},setConfig:function(e){e.adapter&&(n=e.adapter),e.contentSteeringController&&(r=e.contentSteeringController)},getBaseUrls:function(e){return s(e)}},u(),e}vn.__dashjs_factory_name="BaseURLTreeModel";const bn=c.Z.getClassFactory(vn);function _n(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t,n,r=0,i=[],o=0;if((n=e.sort((function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n})).filter((function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority}))).length)return n.length>1&&(n.forEach((function(e){r+=e.dvb_weight,i.push(r)})),t=Math.floor(Math.random()*(r-1)),i.every((function(e,n){return o=n,!(t<e)}))),n[o]}((n=[],e.filter((function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)})).filter((function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)}))));var n}}}_n.__dashjs_factory_name="DVBSelector";const En=c.Z.getClassFactory(_n);function wn(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n,r=0;return e&&e.some((function(e,n){return r=n,!t.contains(e.serviceLocation)}))&&(n=e[r]),n}}}wn.__dashjs_factory_name="BasicSelector";const Tn=c.Z.getClassFactory(wn);function An(){var e,t,n,r=this.context;function i(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0,i=NaN,o=function(){var o=e[r],a=t.findIndex((function(e){return e.serviceLocation&&e.serviceLocation===o}));if(-1!==a&&!n.contains(t[a].serviceLocation))return i=a,"break";r+=1};r<e.length&&"break"!==o(););return i}return e={selectBaseUrlIndex:function(e){var n=NaN;if(isNaN(e.selectedIdx)){var r=t.getSteeringDataFromManifest();r&&r.defaultServiceLocationArray.length>0&&(n=i(r.defaultServiceLocationArray,e.baseUrls))}var o=t.getCurrentSteeringResponseData();return e.baseUrls&&e.baseUrls.length&&o&&o.pathwayPriority&&o.pathwayPriority.length&&(n=i(o.pathwayPriority,e.baseUrls)),n},setConfig:function(e){e.blacklistController&&(n=e.blacklistController),e.contentSteeringController&&(t=e.contentSteeringController)}},t=Bt(r).getInstance(),e}An.__dashjs_factory_name="ContentSteeringSelector";const Sn=c.Z.getClassFactory(An);function xn(){var e,t,n,r,i,o,a=this.context,s=(0,l.Z)(a).getInstance(),c=(0,I.Z)(a).getInstance();function d(){t.reset()}return e={chooseSelector:function(e){(0,W.PS)(e,"boolean"),o=e?r:n},select:function(e){if(e){if(c.get().streaming.applyContentSteering){var t=i.selectBaseUrlIndex(e);isNaN(t)||-1===t||(e.selectedIdx=t)}if(!isNaN(e.selectedIdx))return e.baseUrls[e.selectedIdx];var r=o.select(e.baseUrls);return r?(e.selectedIdx=e.baseUrls.indexOf(r),r):(s.trigger(u.Z.URL_RESOLUTION_FAILED,{error:new w.Z(x.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,x.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(o===n&&d()))}},reset:d,setConfig:function(e){e.selector&&(o=e.selector),e.contentSteeringSelector&&(i=e.contentSteeringSelector)}},t=Lt(a).create({updateEventName:u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD}),n=Tn(a).create({blacklistController:t}),r=En(a).create({blacklistController:t}),(i=Sn(a).create()).setConfig({blacklistController:t}),o=n,e}xn.__dashjs_factory_name="BaseURLSelector";const In=c.Z.getClassFactory(xn);function Rn(){var e,t,n,r,i,o=this.context,a=(0,l.Z)(o).getInstance(),s=(0,$.Z)(o).getInstance();function c(e){n.update(e),r.chooseSelector(t.getIsDVB(e)),a.trigger(h.Z.BASE_URLS_UPDATED,{baseUrls:d(e)})}function d(e){return n.getBaseUrls(e)}return e={reset:function(){n.reset(),r.reset()},initialize:function(e){n.setConfig({adapter:t,contentSteeringController:i}),c(e)},resolve:function(e){var t=n.getForPath(e).reduce((function(e,t){var n=r.select(t);return n?(s.isRelative(n.url)?e.url=s.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e.queryParams=n.queryParams,e):new _e}),new _e);if(!s.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(n=e.baseURLTreeModel),e.baseURLSelector&&(r=e.baseURLSelector),e.adapter&&(t=e.adapter),e.contentSteeringController&&(i=e.contentSteeringController)},getBaseUrls:d,update:c},n=bn(o).create(),r=In(o).create(),a.on(u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,(function(e){n.invalidateSelectedIndexes(e.entry)}),e),e}Rn.__dashjs_factory_name="BaseURLController";const Cn=c.Z.getClassFactory(Rn);function Mn(e){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mn(e)}function Ln(e,t){return Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ln(e,t)}function Pn(e){return Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pn(e)}const Dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Pn(t);if(n){var i=Pn(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==Mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this)).url=e||null,n.type=t||null,n.mediaType=o.Z.STREAM,n.responseType="",n}return i}(m.Z);function On(e){e=e||{};var t=this.context,n=(0,l.Z)(t).getInstance(),r=ft(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,errors:x});return{load:function(e,t,i){var o=function(r,o){t.resolved=!0,t.resolvedContent=r||null,n.trigger(u.Z.XLINK_ELEMENT_LOADED,{element:t,resolveObject:i,error:r||o?null:new w.Z(x.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,x.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)o(null,!0);else{var a=new Dn(e,R.w.XLINK_EXPANSION_TYPE);r.load({request:a,success:function(e){o(e)},error:function(){o(null)}})}},reset:function(){r&&(r.abort(),r=null)}}}On.__dashjs_factory_name="XlinkLoader";const Nn=c.Z.getClassFactory(On),kn=function(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function n(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function r(e,t,n,r){for(var i=0;i<e.length;i++){var o=e[i];if("string"==typeof o){if(o==r)break}else if(o instanceof RegExp){if(o.test(r))break}else if("function"==typeof o&&o(t,n,r))break}return i!=e.length}function i(t,n,i){"property"===e.arrayAccessForm&&(t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]),!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&r(e.arrayAccessFormPaths,t,n,i)&&(t[n]=[t[n]])}function o(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function a(t,n,i,o){return!(1==n&&e.xmlElementsFilter.length>0)||r(e.xmlElementsFilter,t,i,o)}function s(n,l){if(9==n.nodeType){for(var u=new Object,c=n.childNodes,d=0;d<c.length;d++)1==(p=c[d]).nodeType&&(e.ignoreRoot?u=s(p):(u={})[f=t(p)]=s(p));return u}if(1==n.nodeType){(u=new Object).__cnt=0;var h=[];for(c=n.childNodes,d=0;d<c.length;d++){var p,f=t(p=c[d]);if(8!=p.nodeType){var m=l+"."+f;if(a(u,p.nodeType,f,m))if(u.__cnt++,null==u[f]){var g=s(p,m);("#text"!=f||/[^\s]/.test(g))&&((y={})[f]=g,h.push(y)),u[f]=g,i(u,f,m)}else{var y;null!=u[f]&&(u[f]instanceof Array||(u[f]=[u[f]],i(u,f,m))),g=s(p,m),("#text"!=f||/[^\s]/.test(g))&&((y={})[f]=g,h.push(y)),u[f][u[f].length]=g}}}u.__children=h;for(var v=t(n),b=0;b<n.attributes.length;b++){var _=n.attributes[b];u.__cnt++;for(var E=_.value,w=0,T=e.matchers.length;w<T;w++){var A=e.matchers[w];A.test(_,v)&&(E=A.converter(_.value))}u[e.attributePrefix+_.name]=E}var S=function(e){return e.prefix}(n);return null!=S&&""!=S&&(u.__cnt++,u.__prefix=S),null!=u["#text"]&&(u.__text=u["#text"],u.__text instanceof Array&&(u.__text=u.__text.join("\n")),e.stripWhitespaces&&(u.__text=u.__text.trim()),delete u["#text"],"property"==e.arrayAccessForm&&delete u["#text_asArray"],u.__text=function(t,n,i){if(e.datetimeAccessFormPaths.length>0){var a=i.split(".#")[0];return r(e.datetimeAccessFormPaths,t,n,a)?o(t):t}return t}(u.__text,f,l+"."+f)),null!=u["#cdata-section"]&&(u.__cdata=u["#cdata-section"],delete u["#cdata-section"],"property"==e.arrayAccessForm&&delete u["#cdata-section_asArray"]),0==u.__cnt&&"text"==e.emptyNodeForm?u="":1==u.__cnt&&null!=u.__text?u=u.__text:1!=u.__cnt||null==u.__cdata||e.keepCData?u.__cnt>1&&null!=u.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==u.__text||""==u.__text.trim())&&delete u.__text:u=u.__cdata,delete u.__cnt,!e.enableToStringFunc||null==u.__text&&null==u.__cdata||(u.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),u}if(3==n.nodeType||4==n.nodeType)return n.nodeValue}function l(t,r,i,o){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+r;if(null!=i)for(var s=0;s<i.length;s++){var l=i[s],u=t[l];e.escapeMode&&(u=n(u)),a+=" "+l.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?a+='"'+u+'"':a+="'"+u+"'"}return a+(o?"/>":">")}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(t,n){return"property"==e.arrayAccessForm&&("_asArray",-1!==(r=n.toString()).indexOf("_asArray",r.length-8))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r}function d(e){var t=0;if(e instanceof Object)for(var n in e)c(e,n)||t++;return t}function h(t,n,i){return 0==e.jsonPropertiesFilter.length||""==i||r(e.jsonPropertiesFilter,t,n,i)}function p(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function f(t){var r="";return t instanceof Object?r+=function(t){var r="";return null!=t.__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?r+=n(t.__text):r+=t.__text),r}(t):null!=t&&(e.escapeMode?r+=n(t):r+=t),r}function m(e,t){return""===e?t:e+"."+t}function g(e,t,n,r){var i="";if(0==e.length)i+=l(e,t,n,!0);else for(var o=0;o<e.length;o++)i+=l(e[o],t,p(e[o]),!1),i+=y(e[o],m(r,t)),i+=u(e[o],t);return i}function y(e,t){var n="";if(d(e)>0)for(var r in e)if(!c(e,r)&&(""==t||h(e,r,m(t,r)))){var i=e[r],o=p(i);null==i||null==i?n+=l(i,r,o,!0):i instanceof Object?i instanceof Array?n+=g(i,r,o,t):i instanceof Date?(n+=l(i,r,o,!1),n+=i.toISOString(),n+=u(i,r)):d(i)>0||null!=i.__text||null!=i.__cdata?(n+=l(i,r,o,!1),n+=y(i,m(t,r)),n+=u(i,r)):n+=l(i,r,o,!0):(n+=l(i,r,o,!1),n+=f(i),n+=u(i,r))}return n+f(e)}void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1),this.parseXmlString=function(e){var t;if(window.ActiveXObject||window,void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?o(e):e},this.xml2json=function(e){return s(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return y(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}};var Fn="onLoad";function Bn(e){e=e||{};var t,n,r,i,o,s,c=this.context,d=(0,l.Z)(c).getInstance(),h=(0,$.Z)(c).getInstance();function p(e,t,n){var r,i,o={};o.elements=e,o.type=t,o.resolveType=n,0===o.elements.length&&m(o);for(var a=0;a<o.elements.length;a++)r=o.elements[a],i=h.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,s.load(i,r,o)}function f(e){var t,n,r="";if(t=e.element,n=e.resolveObject,t.resolvedContent){var i=0;0===t.resolvedContent.indexOf("<?xml")&&(i=t.resolvedContent.indexOf("?>")+2),r=t.resolvedContent.substr(0,i)+"<response>"+t.resolvedContent.substr(i)+"</response>",t.resolvedContent=o.xml_str2json(r)}(function(e){var t;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(n)&&m(n)}function m(e){var t,n,o=[];if(function(e){var t,n,o,a,s,l,u=[];for(a=e.elements.length-1;a>=0;a--){if(n=(t=e.elements[a]).type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(s=0;s<t.resolvedContent[n].length;s++)o=t.resolvedContent[n][s],u.push(o)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],u.push(t.originalContent);for(t.parentElement[n].splice(t.index,1),l=0;l<u.length;l++)t.parentElement[n].splice(t.index+l,0,u[l]);u=[]}e.elements.length>0&&r.run(i)}(e),"onActuate"===e.resolveType&&d.trigger(u.Z.XLINK_READY,{manifest:i}),e.resolveType===Fn)switch(e.type){case a.Z.PERIOD:for(t=0;t<i[a.Z.PERIOD+"_asArray"].length;t++)(n=i[a.Z.PERIOD+"_asArray"][t]).hasOwnProperty(a.Z.ADAPTATION_SET+"_asArray")&&(o=o.concat(g(n[a.Z.ADAPTATION_SET+"_asArray"],n,a.Z.ADAPTATION_SET,Fn))),n.hasOwnProperty(a.Z.EVENT_STREAM+"_asArray")&&(o=o.concat(g(n[a.Z.EVENT_STREAM+"_asArray"],n,a.Z.EVENT_STREAM,Fn)));p(o,a.Z.ADAPTATION_SET,Fn);break;case a.Z.ADAPTATION_SET:d.trigger(u.Z.XLINK_READY,{manifest:i})}}function g(e,t,n,r){var i,o,a,s=[];for(o=e.length-1;o>=0;o--)(i=e[o]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===i["xlink:href"]&&e.splice(o,1);for(o=0;o<e.length;o++)(i=e[o]).hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===r&&(a=y(i["xlink:href"],t,n,o,r,i),s.push(a));return s}function y(e,t,n,r,i,o){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:o,resolvedContent:null,resolved:!1}}return t={resolveManifestOnLoad:function(e){o=new kn({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:n}),(i=e).Period_asArray?p(g(i.Period_asArray,i,a.Z.PERIOD,Fn),a.Z.PERIOD,Fn):d.trigger(u.Z.XLINK_READY,{manifest:i})},setMatchers:function(e){e&&(n=e)},setIron:function(e){e&&(r=e)},reset:function(){d.off(u.Z.XLINK_ELEMENT_LOADED,f,t),s&&(s.reset(),s=null)}},d.on(u.Z.XLINK_ELEMENT_LOADED,f,t),s=Nn(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),t}Bn.__dashjs_factory_name="XlinkController";const Un=c.Z.getClassFactory(Bn);function zn(e){return zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zn(e)}function Gn(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,r){for(var i=0,o=e.length;i<o;++i){var a=e[i];if(n[a.name])if(r[a.name]){if(a.merge){var s=n[a.name],l=r[a.name];"object"===zn(s)&&"object"===zn(l)?t(s,l):r[a.name]=s+l}}else r[a.name]=n[a.name]}}function r(e,t){for(var i=0,o=e.children.length;i<o;++i){var a=e.children[i],s=t[a.name+"_asArray"];if(s)for(var l=0,u=s.length;l<u;++l){var c=s[l];n(e.properties,t,c),r(a,c)}}}return{run:function(t){if(null===t||"object"!==zn(t))return t;if(t.Period_asArray&&"period"in e)for(var n=e.period,i=t.Period_asArray,o=0,a=i.length;o<a;++o){var s=i[o];if(r(n,s),"adaptationset"in e){var l=s.AdaptationSet_asArray;if(l)for(var u=e.adaptationset,c=0,d=l.length;c<d;++c)r(u,l[c])}}return t}}}Gn.__dashjs_factory_name="ObjectIron";const Vn=c.Z.getClassFactory(Gn),jn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}var t;return(t=[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function Hn(e){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hn(e)}function Zn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qn(e,t){return qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qn(e,t)}function Wn(e){return Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wn(e)}const Yn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qn(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Wn(t);if(n){var i=Wn(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==Hn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,(function(e,t){var n,r=(Zn(n={},a.Z.MPD,[a.Z.ID,a.Z.PROFILES]),Zn(n,a.Z.PERIOD,[a.Z.ID]),Zn(n,a.Z.BASE_URL,[a.Z.SERVICE_LOCATION,a.Z.BYTE_RANGE]),Zn(n,a.Z.SEGMENT_BASE,[a.Z.INDEX_RANGE]),Zn(n,a.Z.INITIALIZATION,[a.Z.RANGE]),Zn(n,a.Z.REPRESENTATION_INDEX,[a.Z.RANGE]),Zn(n,a.Z.SEGMENT_LIST,[a.Z.INDEX_RANGE]),Zn(n,a.Z.BITSTREAM_SWITCHING,[a.Z.RANGE]),Zn(n,a.Z.SEGMENT_URL,[a.Z.MEDIA_RANGE,a.Z.INDEX_RANGE]),Zn(n,a.Z.SEGMENT_TEMPLATE,[a.Z.INDEX_RANGE,a.Z.MEDIA,a.Z.INDEX,a.Z.INITIALIZATION_MINUS,a.Z.BITSTREAM_SWITCHING_MINUS]),Zn(n,a.Z.ASSET_IDENTIFIER,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.EVENT_STREAM,[a.Z.VALUE]),Zn(n,a.Z.ADAPTATION_SET,[a.Z.PROFILES,a.Z.MIME_TYPE,a.Z.SEGMENT_PROFILES,a.Z.CODECS,a.Z.CONTENT_TYPE]),Zn(n,a.Z.FRAME_PACKING,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.AUDIO_CHANNEL_CONFIGURATION,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.CONTENT_PROTECTION,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.ESSENTIAL_PROPERTY,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.SUPPLEMENTAL_PROPERTY,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.INBAND_EVENT_STREAM,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.ACCESSIBILITY,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.ROLE,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.RATING,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.VIEWPOINT,[a.Z.VALUE,a.Z.ID]),Zn(n,a.Z.CONTENT_COMPONENT,[a.Z.CONTENT_TYPE]),Zn(n,a.Z.REPRESENTATION,[a.Z.ID,a.Z.DEPENDENCY_ID,a.Z.MEDIA_STREAM_STRUCTURE_ID]),Zn(n,a.Z.SUBSET,[a.Z.ID]),Zn(n,a.Z.METRICS,[a.Z.METRICS_MINUS]),Zn(n,a.Z.REPORTING,[a.Z.VALUE,a.Z.ID]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1}),(function(e){return String(e)}))}return i}(jn);function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn(e)}function $n(e,t){return $n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$n(e,t)}function Xn(e){return Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xn(e)}var Qn=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/;const Jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$n(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Xn(t);if(n){var i=Xn(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==Kn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,(function(e){for(var t=[a.Z.MIN_BUFFER_TIME,a.Z.MEDIA_PRESENTATION_DURATION,a.Z.MINIMUM_UPDATE_PERIOD,a.Z.TIMESHIFT_BUFFER_DEPTH,a.Z.MAX_SEGMENT_DURATION,a.Z.MAX_SUBSEGMENT_DURATION,a.Z.SUGGESTED_PRESENTATION_DELAY,a.Z.START,o.Z.START_TIME,a.Z.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return Qn.test(e.value);return!1}),(function(e){var t=Qn.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n}))}return i}(jn);function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}function tr(e,t){return tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tr(e,t)}function nr(e){return nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nr(e)}var rr=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/;const ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=nr(t);if(n){var i=nr(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,(function(e){return rr.test(e.value)}),(function(e){var t,n=rr.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var r=60*parseInt(n[9],10)+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*r*60*1e3}return new Date(t)}))}return i}(jn);function or(e){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},or(e)}function ar(e,t){return ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ar(e,t)}function sr(e){return sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sr(e)}var lr=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/;const ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ar(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=sr(t);if(n){var i=sr(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==or(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,(function(e){return lr.test(e.value)}),(function(e){return parseFloat(e)}))}return i}(jn);function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hr(e,t){return hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hr(e,t)}function pr(e){return pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pr(e)}const fr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hr(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=pr(t);if(n){var i=pr(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==cr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,(function(e,t){var n,r=(dr(n={},a.Z.ADAPTATION_SET,[a.Z.LANG]),dr(n,a.Z.REPRESENTATION,[a.Z.LANG]),dr(n,a.Z.CONTENT_COMPONENT,[a.Z.LANG]),dr(n,a.Z.LABEL,[a.Z.LANG]),dr(n,a.Z.GROUP_LABEL,[a.Z.LANG]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1}),(function(e){var t=dn()(e);return void 0!==t?t:String(e)}))}return i}(jn),mr=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}var t;return(t=[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),gr=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach((function(e){i._properties.push(new mr(e))}))}var t;return(t=[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function vr(e,t){return vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},vr(e,t)}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},br(e)}const _r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vr(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=br(t);if(n){var i=br(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==yr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=[a.Z.PROFILES,a.Z.WIDTH,a.Z.HEIGHT,a.Z.SAR,a.Z.FRAMERATE,a.Z.AUDIO_SAMPLING_RATE,a.Z.MIME_TYPE,a.Z.SEGMENT_PROFILES,a.Z.CODECS,a.Z.MAXIMUM_SAP_PERIOD,a.Z.START_WITH_SAP,a.Z.MAX_PLAYOUT_RATE,a.Z.CODING_DEPENDENCY,a.Z.SCAN_TYPE,a.Z.FRAME_PACKING,a.Z.AUDIO_CHANNEL_CONFIGURATION,a.Z.CONTENT_PROTECTION,a.Z.ESSENTIAL_PROPERTY,a.Z.ESSENTIAL_PROPERTY+"_asArray",a.Z.SUPPLEMENTAL_PROPERTY,a.Z.INBAND_EVENT_STREAM];return r.call(this,a.Z.ADAPTATION_SET,e,[new gr(a.Z.REPRESENTATION,e,[new gr(a.Z.SUB_REPRESENTATION,e)])])}return i}(gr);function Er(e){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Er(e)}function wr(e,t){return wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wr(e,t)}function Tr(e){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tr(e)}const Ar=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wr(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=Tr(t);if(n){var i=Tr(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==Er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=[a.Z.SEGMENT_BASE,a.Z.SEGMENT_TEMPLATE,a.Z.SEGMENT_LIST];return r.call(this,a.Z.PERIOD,e,[new gr(a.Z.ADAPTATION_SET,e,[new gr(a.Z.REPRESENTATION,e)])])}return i}(gr);function Sr(e){e=e||{};var t,n,r,i,o,a=this.context,s=e.debug;return t={parse:function(e){var t,r=window.performance.now();if(!(t=i.xml_str2json(e)))throw new Error("parsing the manifest failed");var a=window.performance.now();t.Patch?((t=t.Patch).add_asArray&&t.add_asArray.forEach((function(e){return o.run(e)})),t.replace_asArray&&t.replace_asArray.forEach((function(e){return o.run(e)}))):(t=t.MPD,o.run(t));var s=window.performance.now();return n.info("Parsing complete: ( xml2json: "+(a-r).toPrecision(3)+"ms, objectiron: "+(s-a).toPrecision(3)+"ms, total: "+((s-r)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return r},getIron:function(){return o}},n=s.getLogger(t),r=[new Jn,new ir,new ur,new fr,new Yn],i=new kn({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:r}),o=Vn(a).create({adaptationset:new _r,period:new Ar}),t}Sr.__dashjs_factory_name="DashParser";const xr=c.Z.getClassFactory(Sr);function Ir(e){e=e||{};var t,n,r,i,s,c=this.context,d=e.debug,h=e.settings,p=(0,l.Z)(c).getInstance(),f=(0,$.Z)(c).getInstance(),m=e.mssHandler,g=e.errHandler;function y(e){p.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function v(e){var t=null;return e.indexOf("SmoothStreamingMedia")>-1?(m&&(t=m.createMssParser(),m.createMssFragmentProcessor(),m.registerEvents()),t):e.indexOf("MPD")>-1||e.indexOf("Patch")>-1?xr(c).create({debug:d}):t}return t={load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=new Date,l=new Dn(e,R.w.MPD_TYPE);t&&(l.serviceLocation=t),o&&(l.queryParams=o),l.requestStartDate||(l.requestStartDate=a),p.trigger(u.Z.MANIFEST_LOADING_STARTED,{request:l}),r.load({request:l,success:function(t,r,o){var a,l,c;if(i)if(o&&o!==e?(l=f.parseBaseUrl(o),a=o):(f.isRelative(e)&&(e=f.resolve(e,window.location.href)),l=f.parseBaseUrl(e)),"No Content"!=r)if(null===s&&(s=v(t)),null!==s){i.setMatchers(s.getMatchers()),i.setIron(s.getIron());try{c=s.parse(t)}catch(t){return void p.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new w.Z(x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}if(c){if(c.url=a||e,c.originalUrl||(c.originalUrl=c.url),h&&h.get().streaming.enableManifestDurationMismatchFix&&c.mediaPresentationDuration&&c.Period_asArray.length>1){var d=c.Period_asArray.reduce((function(e,t){return e+t.duration}),0);!isNaN(d)&&c.mediaPresentationDuration>d&&(n.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),c.mediaPresentationDuration=d)}c.baseUri=l,c.loadedTime=new Date,i.resolveManifestOnLoad(c),p.trigger(u.Z.ORIGINAL_MANIFEST_LOADED,{originalManifest:t})}else p.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new w.Z(x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}else p.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new w.Z(x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});else p.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null})},error:function(t,n,r){p.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new w.Z(x.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,x.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(e,", ").concat(r))})}})},reset:function(){p.off(u.Z.XLINK_READY,y,t),m&&m.reset(),i&&(i.reset(),i=null),r&&(r.abort(),r=null)}},n=d.getLogger(t),p.on(u.Z.XLINK_READY,y,t),r=ft(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:f,constants:o.Z,dashConstants:a.Z,errors:x,requestTimeout:e.settings.get().streaming.manifestRequestTimeout}),i=Un(c).create({errHandler:g,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),s=null,t}Ir.__dashjs_factory_name="ManifestLoader";const Rr=c.Z.getClassFactory(Ir);function Cr(){var e=this.context,t=(0,l.Z)(e).getInstance();return{error:function(e){t.trigger(u.Z.ERROR,{error:e})}}}Cr.__dashjs_factory_name="ErrorHandler";const Mr=c.Z.getSingletonFactory(Cr);var Lr=n(1715);function Pr(){var e,t,n,r,i,a,s=this.context,c=(0,l.Z)(s).getInstance();function h(e,r){if(!r||!r.Period_asArray||0===r.Period_asArray.length)return Promise.resolve();var i=[];return r.Period_asArray.forEach((function(r){i.push(function(e,r){return new Promise((function(i){if(e&&e.AdaptationSet_asArray&&0!==e.AdaptationSet_asArray.length){var s=[];e.AdaptationSet_asArray.forEach((function(e){t.getIsTypeOf(e,r)&&s.push(function(e,r){return new Promise((function(i){if(e.Representation_asArray&&0!==e.Representation_asArray.length){var s=[],l=[];e.Representation_asArray.forEach((function(i,a){var u=t.getCodec(e,a,!1),c=function(e,t,n){switch(e){case o.Z.VIDEO:return function(e,t){return{codec:t,width:e.width||null,height:e.height||null,framerate:e.frameRate||null,bitrate:e.bandwidth||null}}(t,n);case o.Z.AUDIO:return function(e,t){var n=e.audioSamplingRate||null;return{codec:t,bitrate:e.bandwidth||null,samplerate:n}}(t,n);default:return null}}(r,i,u);l.push(c),s.push(n.supportsCodec(c,r))})),Promise.all(s).then((function(t){e.Representation_asArray=e.Representation_asArray.filter((function(e,n){return t[n]||a.debug("[Stream] Codec ".concat(l[n].codec," not supported ")),t[n]})),i()})).catch((function(){i()}))}else i()}))}(e,r))})),Promise.all(s).then((function(){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter((function(e){var t=e.Representation_asArray&&e.Representation_asArray.length>0;return t||(c.trigger(u.Z.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:e}),a.warn("AdaptationSet has been removed because of no supported Representation")),t})),i()})).catch((function(){i()}))}else i()}))}(r,e))})),Promise.all(i)}return e={setConfig:function(e){e&&(e.adapter&&(t=e.adapter),e.capabilities&&(n=e.capabilities),e.settings&&(r=e.settings),e.customParametersModel&&(i=e.customParametersModel))},filterUnsupportedFeatures:function(e){return new Promise((function(s){var l=[];l.push(h(o.Z.VIDEO,e)),l.push(h(o.Z.AUDIO,e)),Promise.all(l).then((function(){r.get().streaming.capabilities.filterUnsupportedEssentialProperties&&function(e){e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach((function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter((function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter((function(e){var r=t.getEssentialPropertiesForRepresentation(e);if(r&&r.length>0)for(var i=0;i<r.length;){if(!n.supportsEssentialProperty(r[i]))return a.debug("[Stream] EssentialProperty not supported: "+r[i].schemeIdUri),!1;i+=1}return!0})),e.Representation_asArray&&e.Representation_asArray.length>0)}))}))}(e),function(e){var t=i.getCustomCapabilitiesFilters();t&&0!==t.length&&e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach((function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter((function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter((function(e){return!t.some((function(t){return!t(e)}))})),e.Representation_asArray&&e.Representation_asArray.length>0)}))}))}(e),s()})).catch((function(){s()}))}))}},a=(0,d.Z)(s).getInstance().getLogger(e),e}Pr.__dashjs_factory_name="CapabilitiesFilter";const Dr=c.Z.getSingletonFactory(Pr),Or=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};function Nr(){var e;return{initialize:function(t){if(e=new Or,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var r=t.substr(n+1).split("&"),i=0,o=r.length;i<o;++i){var a=r[i],s=a.indexOf("=");if(-1!==s){var l=a.substring(0,s);e.hasOwnProperty(l)&&(e[l]=a.substr(s+1))}}},getURIFragmentData:function(){return e}}}Nr.__dashjs_factory_name="URIFragmentModel";const kr=c.Z.getSingletonFactory(Nr);function Fr(){var e,t=this.context,n=(0,l.Z)(t).getInstance();return{getValue:function(){return e},setValue:function(t){e=t,t&&n.trigger(u.Z.MANIFEST_LOADED,{data:t})}}}Fr.__dashjs_factory_name="ManifestModel";const Br=c.Z.getSingletonFactory(Fr);var Ur=-.5;function zr(){var e,t,n,r,i=this.context,o=(0,I.Z)(i).getInstance();function a(e,n){return isNaN(e)?0:e>0?(n&&t.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e<Ur?(n&&t.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(Ur,": ").concat(-50,"% playback speed.")),Ur):e}function s(e,n){return isNaN(e)?0:e<0?(n&&t.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e>1?(n&&t.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(1,": ").concat(200,"% playback speed.")),1):e}function l(){var e=o.get().streaming.buffer.stableBufferTime>0?o.get().streaming.buffer.stableBufferTime:o.get().streaming.buffer.fastSwitchEnabled?20:12,t=n.getLiveDelay();return!isNaN(t)&&t>0?Math.min(e,t):e}return e={getCatchupMaxDrift:function(){if(!isNaN(o.get().streaming.liveCatchup.maxDrift)&&o.get().streaming.liveCatchup.maxDrift>0)return o.get().streaming.liveCatchup.maxDrift;var e=r.getServiceDescriptionSettings();return e&&e.liveCatchup&&!isNaN(e.liveCatchup.maxDrift)&&e.liveCatchup.maxDrift>0?e.liveCatchup.maxDrift:12},getCatchupModeEnabled:function(){return null!==o.get().streaming.liveCatchup.enabled?o.get().streaming.liveCatchup.enabled:n.getInitialCatchupModeActivated()},getStableBufferTime:l,getInitialBufferLevel:function(){var e=o.get().streaming.buffer.initialBufferLevel;return isNaN(e)||e<0?0:Math.min(l(),e)},getRetryAttemptsForType:function(e){var t=isNaN(o.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:o.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return n.getLowLatencyModeEnabled()?o.get().streaming.retryAttempts[e]*t:o.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(o.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:o.get().streaming.retryIntervals.lowLatencyReductionFactor;return n.getLowLatencyModeEnabled()?o.get().streaming.retryIntervals[e]/t:o.get().streaming.retryIntervals[e]},getCatchupPlaybackRates:function(e){var t=o.get().streaming.liveCatchup.playbackRate;if(!isNaN(t.min)||!isNaN(t.max))return{min:a(t.min,e),max:s(t.max,e)};var n=r.getServiceDescriptionSettings();if(n&&n.liveCatchup&&(!isNaN(n.liveCatchup.playbackRate.min)||!isNaN(n.liveCatchup.playbackRate.max))){var i=n.liveCatchup.playbackRate;return{min:a(i.min,e),max:s(i.max,e)}}return{min:-.5,max:.5}},getAbrBitrateParameter:function(e,t){try{var n=o.get().streaming.abr[e][t];if(!isNaN(n)&&-1!==n)return n;var i=r.getServiceDescriptionSettings();return i&&i[e]&&!isNaN(i[e][t])?i[e][t]:-1}catch(e){return-1}},setConfig:function(e){e.playbackController&&(n=e.playbackController),e.serviceDescriptionController&&(r=e.serviceDescriptionController)},reset:function(){}},t=(0,d.Z)(i).getInstance().getLogger(e),e}zr.__dashjs_factory_name="MediaPlayerModel";const Gr=c.Z.getSingletonFactory(zr);var Vr=n(1767);function jr(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,o=e.useBufferOccupancyABR,a=e.useL2AABR,s=e.useLoLPABR,l=e.streamProcessor?e.streamProcessor.getScheduleController():null,u=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel?e.videoModel:null;function d(){return u?u.mediaInfo:null}return{getMediaType:function(){var e=d();return e?e.type:null},getMediaInfo:d,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=d();return e?e.streamInfo:null},getScheduleController:function(){return l},getAbrController:function(){return t},getRepresentationInfo:function(){return u},useBufferOccupancyABR:function(){return o},useL2AABR:function(){return a},useLoLPABR:function(){return s},getVideoModel:function(){return c}}}jr.__dashjs_factory_name="RulesContext";const Hr=c.Z.getClassFactory(jr);var Zr=n(2068);function qr(){var e=[],t=[];return{push:function(n){n.newValue===Zr.Z.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var r=n.newValue-n.oldValue,i=r<0?1:0,o=i?-r:0,a=i?0:1;if(e[n.oldValue].drops+=i,e[n.oldValue].dropSize+=o,e[n.oldValue].noDrops+=a,t.push({idx:n.oldValue,noDrop:a,drop:i,dropSize:o}),t.length>8){var s=t.shift();e[s.idx].drops-=s.drop,e[s.idx].dropSize-=s.dropSize,e[s.idx].noDrops-=s.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}qr.__dashjs_factory_name="SwitchRequestHistory";const Wr=c.Z.getClassFactory(qr);function Yr(){var e={},t={},n={};return{push:function(r,i,o){if(i){e[r]||(e[r]=[],t[r]=0,n[r]=0);var a=o&&o.droppedVideoFrames?o.droppedVideoFrames:0,s=o&&o.totalVideoFrames?o.totalVideoFrames:0,l=a-t[r];t[r]=a;var u=s-n[r];n[r]=s;var c=e[r];isNaN(i)||(c[i]?(c[i].droppedVideoFrames+=l,c[i].totalVideoFrames+=u):c[i]={droppedVideoFrames:l,totalVideoFrames:u})}},getFrameHistory:function(t){return e[t]},clearForStream:function(r){try{delete e[r],delete t[r],delete n[r]}catch(e){}},reset:function(){e={},t={},n={}}}}Yr.__dashjs_factory_name="DroppedFramesHistory";const Kr=c.Z.getClassFactory(Yr);function $r(e){var t,n,r,i,a,s=this.context,u=(e=e||{}).settings,c=(0,l.Z)(s).getInstance();function d(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var o=Math.pow(.5,n/r.slow);e.slowEstimate=(1-o)*t+o*e.slowEstimate,e.totalWeight+=n}function p(e,s,l){return u.get().streaming.abr.movingAverageMethod!==o.Z.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?a.throughputHalfLife:a.latencyHalfLife,o=e?r[t]:i[t];if(!o||o.totalWeight<=0)return NaN;var s=o.fastEstimate/(1-Math.pow(.5,o.totalWeight/n.fast)),l=o.slowEstimate/(1-Math.pow(.5,o.totalWeight/n.slow));return e?Math.min(s,l):Math.max(s,l)}(e,s):function(e,r,i){var o=function(e,r,i){var o,a;if(e?(o=t[r],a=i?3:4):(o=n[r],a=4),o){if(a>=o.length)a=o.length;else if(e)for(var s=1;s<a;++s){var l=o[o.length-s]/o[o.length-s-1];if((l>=1.3||l<=1/1.3)&&(a+=1)===o.length)break}}else a=0;return a}(e,r,i),a=(e?t:n)[r];return 0!==o&&a&&0!==a.length?(a=a.slice(-o)).reduce((function(e,t){return e+t}))/a.length:NaN}(e,s,l)}function f(e,t){return p(!0,e,t)}function m(e){t[e]=t[e]||[],n[e]=n[e]||[],r[e]=r[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},i[e]=i[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function g(){t={},n={},r={},i={}}var y={push:function(e,s,l){if(s.trace&&s.trace.length){var p,f=s.tresponse.getTime()-s.trequest.getTime()||1,g=s._tfinish.getTime()-s.tresponse.getTime()||1,y=s.trace.reduce((function(e,t){return e+t.b[0]}),0),v=0;if(0!==(p=s._fileLoaderType&&s._fileLoaderType===o.Z.FILE_LOADER_TYPES.FETCH?s.trace.reduce((function(e,t){return e+t.d}),0):l?g:f+g)&&(v=Math.round(8*y/p)),s.cmsd){var b=s.cmsd.dynamic&&s.cmsd.dynamic.etp?s.cmsd.dynamic.etp:null;if(b){var _=u.get().streaming.cmsd.abr.etpWeightRatio;_>0&&_<=1&&(v=v*(1-_)+b*_)}}if(m(e),function(e,t,n){return e===o.Z.VIDEO?n<u.get().streaming.cacheLoadThresholds[o.Z.VIDEO]:e===o.Z.AUDIO?n<u.get().streaming.cacheLoadThresholds[o.Z.AUDIO]:void 0}(e,0,g)){if(t[e].length>0&&!t[e].hasCachedEntries)return;t[e].hasCachedEntries=!0}else t[e]&&t[e].hasCachedEntries&&function(e){delete t[e],delete n[e],delete r[e],delete i[e],m(e)}(e);t[e].push(v),c.trigger(h.Z.THROUGHPUT_MEASUREMENT_STORED,{throughput:v,mediaType:e,httpRequest:s}),t[e].length>20&&t[e].shift(),n[e].push(f),n[e].length>20&&n[e].shift(),d(r[e],v,.001*g,a.throughputHalfLife),d(i[e],f,1,a.latencyHalfLife)}},getAverageThroughput:f,getSafeAverageThroughput:function(e,t){var n=f(e,t);return isNaN(n)||(n*=u.get().streaming.abr.bandwidthSafetyFactor),n},getAverageLatency:function(e){return p(!1,e)},reset:g};return a={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},g(),y}$r.__dashjs_factory_name="ThroughputHistory";const Xr=c.Z.getClassFactory($r);function Qr(){var e,t,n,r,i,a,c,p,f,m,g,y,v,b,_,w,T,A,S,x,I,C,M,L,P,D,O,N=this.context,k=(0,d.Z)(N).getInstance(),F=(0,l.Z)(N).getInstance();function B(){i={},a={},p={},c={},x={},M={},L={},P={},void 0===m&&(m=!1),I&&I.reset(),S=void 0,I=void 0,C=void 0,clearTimeout(f),f=null}function U(t){var i=t.request.mediaType,o=t.streamId;if(i&&o&&c[o]&&O.get().streaming.abr.autoSwitchBitrate[i]){var a=c[o][i];if(a){var l=Hr(N).create({abrController:e,streamProcessor:a,currentRequest:t.request,useBufferOccupancyABR:M[i],useL2AABR:L[i],useLoLPABR:P[i],videoModel:b}),u=n.shouldAbandonFragment(l,o);u.quality>Zr.Z.NO_CHANGE&&a.getFragmentModel().getRequests({state:E.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(p[o][i].state=s.Z.ABANDON_LOAD,x[o][i].reset(),x[o][i].push({oldValue:H(i,o),newValue:u.quality,confidence:1,reason:u.reason}),Z(i,r.getActiveStreamInfo(),u.quality,u.reason),clearTimeout(f),f=setTimeout((function(){p[o][i].state=s.Z.ALLOW_LOAD,f=null}),O.get().streaming.abandonLoadTimeout))}}}function z(e){e.mediaType===o.Z.VIDEO&&(void 0!==S&&I.push(e.streamId,S,b.getPlaybackQuality()),S=e.newQuality)}function G(e){var n,r;e.metric!==s.Z.HTTP_REQUEST||!e.value||e.value.type!==R.w.MEDIA_SEGMENT_TYPE||e.mediaType!==o.Z.AUDIO&&e.mediaType!==o.Z.VIDEO||C.push(e.mediaType,e.value,O.get().streaming.abr.useDeadTimeLatency),e.metric!==s.Z.BUFFER_LEVEL||e.mediaType!==o.Z.AUDIO&&e.mediaType!==o.Z.VIDEO||(n=e.mediaType,r=.001*e.value.level,O.get().streaming.abr.ABRStrategy===o.Z.ABR_STRATEGY_DYNAMIC&&function(e,n){try{var r=_.getStableBufferTime(),i=r,o=.5*r,a=M[e],s=n>(a?o:i);M[e]=s,s!==a&&(s?t.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+n.toFixed(3)+")."):t.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+n.toFixed(3)+")."))}catch(e){t.error(e)}}(n,r))}function V(e,n){try{var r;return i[n]=i[n]||{},i[n].hasOwnProperty(e)||(i[n][e]=0),r=function(e,t){var n=i[t][e],r=n;if(!c[t]||!c[t][e])return r;var o=j(e,t);void 0!==o&&(r=Math.max(n,o));var a=function(e,t){try{var n=_.getAbrBitrateParameter("maxBitrate",e);return n>-1?K(c[t][e].getMediaInfo(),n,t):void 0}catch(e){return}}(e,t);return void 0!==a&&(r=Math.min(r,a)),r}(e,n),r=function(e,t,n){var r=i[n][t],o=O.get().streaming.abr.maxRepresentationRatio[t];return isNaN(o)||o>=1||o<0?e:Math.min(e,Math.round(r*o))}(r,e,n),r=function(e,t,n){if(t!==o.Z.VIDEO||!O.get().streaming.abr.limitBitrateByPortal||!c[n]||!c[n][t])return e;m||X();var r=c[n][t].getStreamInfo(),i=v.getAdaptationForType(r.index,t,r).Representation_asArray,a=e;if(g>0&&y>0){for(;a>0&&i[a]&&g<i[a].width&&g-i[a-1].width<i[a].width-g;)a-=1;for(;a<i.length-1&&i[a].width===i[a+1].width;)a+=1}return a}(r,e,n),O.get().streaming.cmsd.enabled&&O.get().streaming.cmsd.abr.applyMb&&(r=function(e,n,r){if("video"!==n)return e;var i=T.getMaxBitrate(n);if(i<0)return e;var o=Y(r,"audio",H("audio",r));i-=o?o.bitrate/1e3:0;var a=K(c[r][n].getMediaInfo(),i,r);return t.debug("Stream ID: "+r+" ["+n+"] Apply max bit rate from CMSD: "+i),Math.min(e,a)}(r,e,n)),r}catch(e){return}}function j(e,t){try{return function(e,t){try{var n=_.getAbrBitrateParameter("minBitrate",e);if(n>-1){var r=c[t][e].getMediaInfo(),i=$(r),o=K(r,n,t);return i[o]&&o<i.length-1&&i[o].bitrate<1e3*n&&o++,o}return}catch(e){return}}(e,t)}catch(e){return}}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return t||(t=r.getActiveStreamInfo().id),e&&c[t]&&c[t][e]&&t?(a[t]=a[t]||{},a[t].hasOwnProperty(e)||(a[t][e]=0),a[t][e]):0}catch(e){return 0}}function Z(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t&&t.id&&e){var i=t.id,o=H(e,i);(0,W.SE)(n);var a=V(e,i);n!==o&&n>=0&&n<=a&&q(e,o,n,a,r,i)}}function q(e,n,r,i,o,s){if(e&&c[s]&&c[s][e]){var l=c[s][e].getStreamInfo(),d=l&&l.manifestInfo&&l.manifestInfo.isDynamic,h=D.getCurrentBufferLevel(e);t.info("Stream ID: "+s+" ["+e+"] switch from "+n+" to "+r+"/"+i+" (buffer: "+h+") "+(o?JSON.stringify(o):".")),a[s]=a[s]||{},a[s][e]=r;var p=Y(s,e,r);F.trigger(u.Z.QUALITY_CHANGE_REQUESTED,{oldQuality:n,newQuality:r,reason:o,streamInfo:l,bitrateInfo:p,maxIdx:i,mediaType:e},{streamId:l.id,mediaType:e});var f=C.getAverageThroughput(e,d);isNaN(f)||A.setSavedBitrateSettings(e,f)}}function Y(e,t,n){if(t&&c&&c[e]&&c[e][t]){var r=$(c[e][t].getMediaInfo());return r[n]?r[n]:null}return null}function K(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e&&e.type?c[n][e.type].getRepresentationInfo():null;if(O.get().streaming.abr.useDeadTimeLatency&&r&&i&&i.fragmentDuration){r/=1e3;var o=i.fragmentDuration;if(r>o)return 0;t*=1-r/o}for(var a=$(e),s=a.length-1;s>=0;s--)if(1e3*t>=a[s].bitrate)return s;return 0}function $(e){var t=[];if(!e||!e.bitrateList)return t;for(var n,r=e.bitrateList,i=e.type,o=0,a=r.length;o<a;o++)(n=new xt).mediaType=i,n.qualityIndex=o,n.bitrate=r[o].bandwidth,n.width=r[o].width,n.height=r[o].height,n.scanType=r[o].scanType,t.push(n);return t}function X(){if(b){var e=O.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;g=b.getClientWidth()*e,y=b.getClientHeight()*e}}return e={initialize:function(){I=Kr(N).create(),C=Xr(N).create({settings:O}),(n=(0,Vr.Z)(N).create({dashMetrics:D,customParametersModel:w,mediaPlayerModel:_,settings:O})).initialize(),F.on(h.Z.QUALITY_CHANGE_RENDERED,z,e),F.on(h.Z.METRIC_ADDED,G,e),F.on(u.Z.LOADING_PROGRESS,U,e)},isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=H(o.Z.AUDIO,t),r=H(o.Z.VIDEO,t);return n===V(o.Z.AUDIO,t)&&r===V(o.Z.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return i[n]=i[n]||{},i[n][t]=r,r},clearDataForStream:function(e){I&&I.clearForStream(e),c[e]&&delete c[e],x[e]&&delete x[e],p[e]&&delete p[e]},getThroughputHistory:function(){return C},getBitrateList:$,getQualityForBitrate:K,getTopBitrateInfoFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||(t=r.getActiveStreamInfo().id),e&&c&&c[t]&&c[t][e]){var n=V(e,t),i=$(c[t][e].getMediaInfo());return i[n]?i[n]:null}return null},getMinAllowedIndexFor:j,getMaxAllowedIndexFor:V,getInitialBitrateFor:function(e,t){if(function(){if(!A||!A.hasOwnProperty("getSavedBitrateSettings"))throw new Error(o.Z.MISSING_CONFIG_ERROR)}(),e===o.Z.TEXT)return NaN;var n=A.getSavedBitrateSettings(e),r=_.getAbrBitrateParameter("initialBitrate",e),i=O.get().streaming.abr.initialRepresentationRatio[e];if(-1===r)if(i>-1){var a=c[t][e].getStreamInfo(),s=v.getAdaptationForType(a.index,e,a).Representation_asArray;r=Array.isArray(s)?s[Math.max(Math.round(s.length*i)-1,0)].bandwidth/1e3:0}else r=isNaN(n)?e===o.Z.VIDEO?1e3:100:n;return r},getQualityFor:H,getAbandonmentStateFor:function(e,t){return p[e]&&p[e][t]?p[e][t].state:null},setPlaybackQuality:Z,checkPlaybackQuality:function(t,r){try{if(!(t&&c&&c[r]&&c[r][t]))return!1;if(I){var i=b.getPlaybackQuality();i&&I.push(r,S,i)}if(!O.get().streaming.abr.autoSwitchBitrate[t])return!1;var o=H(t,r),a=Hr(N).create({abrController:e,switchHistory:x[r][t],droppedFramesHistory:I,streamProcessor:c[r][t],currentValue:o,useBufferOccupancyABR:M[t],useL2AABR:L[t],useLoLPABR:P[t],videoModel:b}),l=j(t,r),u=V(t,r),d=n.getMaxQuality(a),h=d.quality;return void 0!==l&&(h>Zr.Z.NO_CHANGE?h:o)<l&&(h=l),h>u&&(h=u),x[r][t].push({oldValue:o,newValue:h}),h>Zr.Z.NO_CHANGE&&h!==o&&(p[r][t].state===s.Z.ALLOW_LOAD||h<o)&&(q(t,o,h,u,d.reason,r),!0)}catch(e){return!1}},setElementSize:X,setWindowResizeEventCalled:function(e){m=e},registerStreamType:function(e,t){var n=t.getStreamInfo().id;c[n]||(c[n]={}),x[n]||(x[n]={}),p[n]||(p[n]={}),x[n][e]=Wr(N).create(),c[n][e]=t,p[n][e]={},p[n][e].state=s.Z.ALLOW_LOAD,function(e){var t=O.get().streaming.abr.ABRStrategy;t===o.Z.ABR_STRATEGY_L2A?(M[e]=!1,P[e]=!1,L[e]=!0):t===o.Z.ABR_STRATEGY_LoLP?(M[e]=!1,P[e]=!0,L[e]=!1):t===o.Z.ABR_STRATEGY_BOLA?(M[e]=!0,P[e]=!1,L[e]=!1):t===o.Z.ABR_STRATEGY_THROUGHPUT?(M[e]=!1,P[e]=!1,L[e]=!1):t===o.Z.ABR_STRATEGY_DYNAMIC&&(M[e]=!(!M||!M[e])&&M[e],P[e]=!1,L[e]=!1)}(e),e===o.Z.VIDEO&&X()},unRegisterStreamType:function(e,t){try{c[e]&&c[e][t]&&delete c[e][t],x[e]&&x[e][t]&&delete x[e][t],p[e]&&p[e][t]&&delete p[e][t]}catch(e){}},setConfig:function(e){e&&(e.streamController&&(r=e.streamController),e.domStorage&&(A=e.domStorage),e.mediaPlayerModel&&(_=e.mediaPlayerModel),e.customParametersModel&&(w=e.customParametersModel),e.cmsdModel&&(T=e.cmsdModel),e.dashMetrics&&(D=e.dashMetrics),e.adapter&&(v=e.adapter),e.videoModel&&(b=e.videoModel),e.settings&&(O=e.settings))},reset:function(){B(),F.off(u.Z.LOADING_PROGRESS,U,e),F.off(h.Z.QUALITY_CHANGE_RENDERED,z,e),F.off(h.Z.METRIC_ADDED,G,e),n&&n.reset()}},t=k.getLogger(e),B(),e}Qr.__dashjs_factory_name="AbrController";var Jr=c.Z.getSingletonFactory(Qr);Jr.QUALITY_DEFAULT=0,c.Z.updateSingletonFactory(Qr.__dashjs_factory_name,Jr);const ei=Jr;var ti=new Map([[o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function ni(){var e,t,n,r,i,a,s=this.context,c=(0,l.Z)(s).getInstance(),h=[];function p(){n&&(n.playbackRate=1,n.removeEventListener("canplay",p))}function f(){return h.length>0}function m(){if(n&&f()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function g(e,t){n&&n.addEventListener(e,t)}function y(e,t){n&&n.removeEventListener(e,t)}function v(){return n?n.readyState:NaN}function b(){return n?n.buffered:null}function _(e,t,r,i,o){if(n)for(var a=0;a<n.textTracks.length;a++)if(n.textTracks[a].kind===e&&(!t||n.textTracks[a].label==t)&&n.textTracks[a].language===r&&n.textTracks[a].isTTML===i&&n.textTracks[a].isEmbedded===o)return n.textTracks[a];return null}function E(e,t){e===o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||v()>=e?t():function(e,t){g(e,(function n(){y(e,n),t(e)}))}(ti.get(e),t)}return e={initialize:function(){c.on(u.Z.PLAYBACK_PLAYING,m,this)},setCurrentTime:function(e,t){n&&(r=e,E(o.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,(function(){if(n.currentTime!==r)try{r=t?function(e){var t=b(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var o=t.start(i),a=t.end(i),s=Math.abs(o-e),l=Math.abs(a-e);if(e>=o&&e<=a)return e;s<r&&(r=s,n=o),l<r&&(r=l,n=a)}return n}(r):r,n.currentTime=r,r=NaN}catch(e){0===n.readyState&&e.code===e.INVALID_STATE_ERR&&setTimeout((function(){n.currentTime=r,r=NaN}),400)}else r=NaN})))},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch((function(e){"NotAllowedError"===e.name&&c.trigger(u.Z.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing (".concat(e,")"))}))}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isStalled:f,isSeeking:function(){return n?n.seeking||!isNaN(r):null},getTime:function(){return n?isNaN(r)?n.currentTime:r:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:function(e){n&&(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&n.readyState<=2&&e>0?n.addEventListener("canplay",p):n.playbackRate=e)},getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){null!==e&&n&&!n.seeking&&-1===h.indexOf(e)&&h.push(e)}(e):function(e){var t=h.indexOf(e);null!==e&&-1!==t&&h.splice(t,1)}(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return i},setTTMLRenderingDiv:function(e){(i=e).style.position="absolute",i.style.display="flex",i.style.overflow="hidden",i.style.pointerEvents="none",i.style.top=0,i.style.left=0},getVttRenderingDiv:function(){return a},setVttRenderingDiv:function(e){a=e},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:g,removeEventListener:y,getReadyState:v,getBufferRange:b,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:_,addTextTrack:function(e,t,r,i,o){if(!n)return null;var a=_(e,t,r,i,o);return a||((a=n.addTextTrack(e,t,r)).isEmbedded=o,a.isTTML=i),a},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){if(n){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN}return NaN},getVideoRelativeOffsetLeft:function(){if(n){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN}return NaN},waitForReadyState:E,reset:function(){c.off(u.Z.PLAYBACK_PLAYING,m,this)}},t=(0,d.Z)(s).getInstance().getLogger(e),r=NaN,e}ni.__dashjs_factory_name="VideoModel";const ri=c.Z.getSingletonFactory(ni);var ii=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],oi="dashjs_?_bitrate",ai="dashjs_?_settings",si="localStorage",li="lastBitrate",ui="lastMediaSettings";function ci(e){e=e||{};var t,n,r,i=this.context,a=e.settings;function s(e){if(void 0!==r)return r;var t;r=!1;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return n.warn("DOMStorage access denied: "+e.message),r}if(!t||e!==si&&"sessionStorage"!==e)return r;try{t.setItem("1","1"),t.removeItem("1"),r=!0}catch(e){n.warn("DOMStorage is supported, but cannot be used: "+e.message)}return r}function l(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function u(e,t){return s(e)&&a.get().streaming[t+"CachingInfo"].enabled}function c(){if(!a)throw new Error(o.Z.MISSING_CONFIG_ERROR)}return t={getSavedBitrateSettings:function(e){if(c(),!a.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var t=NaN;if(u(si,li)){var r=oi.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},o=(new Date).getTime()-parseInt(i.timestamp,10)>=a.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(i.bitrate);isNaN(s)||o?o&&localStorage.removeItem(r):(t=s,n.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(u(si,li)&&t){var r=oi.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({bitrate:t.toFixed(3),timestamp:l()}))}catch(e){n.error(e.message)}}},getSavedMediaSettings:function(e){if(c(),!a.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var t=null;if(u(si,ui)){var n=ai.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},i=(new Date).getTime()-parseInt(r.timestamp,10)>=a.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=r.settings,i&&(localStorage.removeItem(n),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(u(si,ui)){var r=ai.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({settings:t,timestamp:l()}))}catch(e){n.error(e.message)}}}},n=(0,d.Z)(i).getInstance().getLogger(t),s(si)&&ii.forEach((function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){n.error(e.message)}}})),t}ci.__dashjs_factory_name="DOMStorage";const di=c.Z.getSingletonFactory(ci);var hi=n(2032),pi=n(2011);function fi(){var e,t,n,r,i,o,a,s,l,u,c,d,h,p=this.context;function f(e,n,i,o){var a=null,l=e?h.resolve(e.path):null,u=o||{init:!0,url:l?l.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n};t.debug("Start searching for initialization.");var c=v(u);s.load({request:c,success:function(t){if(u.bytesLoaded=u.range.end,!(a=r.findInitRange(t)))return u.range.end=u.bytesLoaded+u.bytesToLoad,f(e,n,i,u);e.range=a,i(e)},error:function(){i(e)}}),t.debug("Perform init search: "+u.url)}function g(e,n,i,o,a,l){if(i&&(void 0===i.start||void 0===i.end)){var u=i?i.toString().split("-"):null;i=u?{start:parseFloat(u[0]),end:parseFloat(u[1])}:null}a=a||y;var c=null,d=null,p=!!i,f=e?h.resolve(e.path):null,m={init:!1,url:f?f.url:void 0,range:p?i:{start:0,end:1500},searching:!p,bytesLoaded:l?l.bytesLoaded:0,bytesToLoad:1500,mediaType:n},b=v(m);s.load({request:b,success:function(i){var s=m.bytesToLoad,l=i.byteLength;if(m.bytesLoaded=m.range.end-m.range.start,c=r.parse(i),(d=c.getBox("sidx"))&&d.isComplete){var u,h,p=d.references;if(null!=p&&p.length>0&&(u=1===p[0].reference_type),u){var f,y,v,b;t.debug("Initiate multiple SIDX load."),m.range.end=m.range.start+d.size;var _=[],E=0,w=(d.offset||m.range.start)+d.size,T=function(t){t?(_=_.concat(t),++E>=y&&(_.sort((function(e,t){return e.startTime-t.startTime<0?-1:0})),a(_,e,o))):a(null,e,o)};for(f=0,y=p.length;f<y;f++)v=w,b=w+p[f].referenced_size-1,w+=p[f].referenced_size,g(e,n,{start:v,end:b},o,T,m)}else t.debug("Parsing segments from SIDX. representation "+n+" - id: "+e.id+" for range : "+m.range.start+" - "+m.range.end),h=function(e,t){for(var n,r,i,o,a=e.references,s=a.length,l=e.timescale,u=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,d=[],h=0;h<s;h++)i=a[h].subsegment_duration,o=a[h].referenced_size,(n=new pi.Z).duration=i,n.startTime=u,n.timescale=l,r=c+o-1,n.mediaRange=c+"-"+r,d.push(n),u+=i,c+=o;return d}(d,m),a(h,e,o)}else{if(d)m.range.start=d.offset||m.range.start,m.range.end=m.range.start+(d.size||s);else{if(l<m.bytesLoaded)return void a(null,e,o);var A=c.getLastBox();A&&A.size?(m.range.start=A.offset+A.size,m.range.end=m.range.start+s):m.range.end+=s}g(e,n,m.range,o,null,m)}},error:function(){a(null,e,o)}}),t.debug("Perform SIDX load for type ".concat(n," : ").concat(m.url," with range ").concat(m.range.start," - ").concat(m.range.end))}function y(e,t,n){n({segments:e,representation:t,error:e?void 0:new w.Z(l.SEGMENT_BASE_LOADER_ERROR_CODE,l.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function v(e){if(e.url){var t=new m.Z;return t.setInfo(e),t}}return e={setConfig:function(s){s.baseURLController&&(h=s.baseURLController),s.dashMetrics&&(o=s.dashMetrics),s.mediaPlayerModel&&(a=s.mediaPlayerModel),s.errHandler&&(n=s.errHandler),s.boxParser&&(r=s.boxParser),s.debug&&(t=s.debug.getLogger(e)),s.requestModifier&&(i=s.requestModifier),s.errors&&(l=s.errors),s.urlUtils&&(d=s.urlUtils),s.constants&&(u=s.constants),s.dashConstants&&(c=s.dashConstants)},initialize:function(){s=ft(p).create({errHandler:n,dashMetrics:o,mediaPlayerModel:a,requestModifier:i,boxParser:r,errors:l,urlUtils:d,constants:u,dashConstants:c})},loadInitialization:function(e,t){return new Promise((function(n){f(e,t,n)}))},loadSegments:function(e,t,n){return new Promise((function(r){g(e,t,n,r)}))},reset:function(){s&&(s.abort(),s=null)}}}fi.__dashjs_factory_name="SegmentBaseLoader";const mi=c.Z.getSingletonFactory(fi);function gi(e){var t;e=e||{};var n=new DataView(e.data),r=0;function i(e,t){var i=!0,o=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(r)!==e.tag&&(i=!1),o=4):e.tag>65535?(256*n.getUint16(r)+n.getUint8(r+2)!==e.tag&&(i=!1),o=3):e.tag>255?(n.getUint16(r)!==e.tag&&(i=!1),o=2):(n.getUint8(r)!==e.tag&&(i=!1),o=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(r+=o),i}function o(e){var t=1,i=128,o=-1,a=0,s=n.getUint8(r),l=0;for(l=0;l<8;l+=1){if((s&i)===i){a=void 0===e?s&~i:s,o=l;break}i>>=1}for(l=0;l<o;l+=1,t+=1)a=a<<8|255&n.getUint8(r+t);return r+=t,a}return t={getPos:function(){return r},setPos:function(e){r=e},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&o(),n},parseTag:function(e){var n;return i(e),n=o(),t[e.parse](n)},skipOverElement:function(e,t){var n,a=i(e,t);return a&&(n=o(),r+=n),a},getMatroskaCodedNum:o,getMatroskaFloat:function(e){var t;switch(e){case 4:t=n.getFloat32(r),r+=4;break;case 8:t=n.getFloat64(r),r+=8}return t},getMatroskaUint:function(e){if(e>4)return function(e){for(var t=Math.floor(Number.MAX_SAFE_INTEGER/256),i=0,o=0;o<e;o+=1){if(i>t)throw new Error("Value exceeds safe integer limit");i*=256;var a=n.getUint8(r+o);if(i>Number.MAX_SAFE_INTEGER-a)throw new Error("Value exceeds safe integer limit");i+=a}return r+=e,i}(e);for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&n.getUint8(r+i);return r+=e,t>>>0},moreData:function(){return r<n.byteLength}}}gi.__dashjs_factory_name="EBMLParser";const yi=c.Z.getClassFactory(gi);function vi(){var e,t,n,r,i,a,s,l,u,c,d=this.context;function h(e){var t=new m.Z;return t.setInfo(e),t}return e={setConfig:function(n){if(!(n.baseURLController&&n.dashMetrics&&n.mediaPlayerModel&&n.errHandler))throw new Error(o.Z.MISSING_CONFIG_ERROR);c=n.baseURLController,a=n.dashMetrics,s=n.mediaPlayerModel,r=n.errHandler,u=n.errors,t=n.debug.getLogger(e),i=n.requestModifier},initialize:function(){l=ft(d).create({errHandler:r,dashMetrics:a,mediaPlayerModel:s,requestModifier:i,errors:u})},loadInitialization:function(e,n){return new Promise((function(r){var i=null,o=e?c.resolve(e.path):null,a=e?e.range.split("-"):null,s={range:{start:a?parseFloat(a[0]):null,end:a?parseFloat(a[1]):null},request:i,url:o?o.url:void 0,init:!0,mediaType:n};t.info("Start loading initialization."),i=h(s),l.load({request:i,success:function(){r(e)},error:function(){r(e)}}),t.debug("Perform init load: "+s.url)}))},loadSegments:function(e,r,i){return new Promise((function(o){var a=null,s=e?c.resolve(e.path):null,p=s?s.url:void 0;a=h({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:a,url:p,init:!1,mediaType:r}),t.debug("Parsing ebml header"),l.load({request:a,success:function(r){!function(e,r,i,o){if(e&&0!==e.byteLength){var a,s,u,c,p=yi(d).create({data:e}),f=i?i.split("-"):null,m=null,g={url:r,range:{start:f?parseFloat(f[0]):null,end:f?parseFloat(f[1]):null},request:m};for(t.debug("Parse EBML header: "+g.url),p.skipOverElement(n.EBML),p.consumeTag(n.Segment),u=p.getMatroskaCodedNum(),u+=p.getPos(),c=p.getPos();p.moreData()&&!p.consumeTagAndSize(n.Segment.Info,!0);)if(!(p.skipOverElement(n.Segment.SeekHead,!0)||p.skipOverElement(n.Segment.Tracks,!0)||p.skipOverElement(n.Segment.Cues,!0)||p.skipOverElement(n.Void,!0)))throw new Error("no valid top level element found");for(;void 0===a;){var y=p.getMatroskaCodedNum(!0),v=p.getMatroskaCodedNum();y===n.Segment.Info.Duration.tag?a=p[n.Segment.Info.Duration.parse](v):p.setPos(p.getPos()+v)}m=h(g),l.load({request:m,success:function(e){s=function(e,r,i,o){var a,s,l,u,c,h,p,f;for(l=[],c=0,h=(s=function(e){var t,r,i=[],o=yi(d).create({data:e});for(o.consumeTagAndSize(n.Segment.Cues);o.moreData()&&o.consumeTagAndSize(n.Segment.Cues.CuePoint,!0);){for((t={}).CueTime=o.parseTag(n.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];o.moreData()&&o.consumeTag(n.Segment.Cues.CuePoint.CueTrackPositions,!0);){var a=o.getMatroskaCodedNum(),s=o.getPos();if((r={}).Track=o.parseTag(n.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===r.Track)throw new Error("Cue track cannot be 0");r.ClusterPosition=o.parseTag(n.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(r),o.setPos(s+a)}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");i.push(t)}if(0===i.length)throw new Error("mandatory cuepoint not found");return i}(e)).length;c<h;c+=1)u=new pi.Z,a=c<s.length-1?s[c+1].CueTime-s[c].CueTime:o-s[c].CueTime,u.duration=a,u.startTime=s[c].CueTime,u.timescale=1e3,p=s[c].CueTracks[0].ClusterPosition+r,f=c<s.length-1?s[c+1].CueTracks[0].ClusterPosition+r-1:i-1,u.mediaRange=p+"-"+f,l.push(u);return t.debug("Parsed cues: "+l.length+" cues."),l}(e,c,u,a),o(s)},error:function(){t.error("Download Error: Cues "+g.url),o(null)}}),t.debug("Perform cues load: "+g.url+" bytes="+g.range.start+"-"+g.range.end)}else o(null)}(r,p,i,(function(t){o({segments:t,representation:e,error:t?void 0:new w.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}))},error:function(){o({representation:e,error:new w.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}})}))},reset:function(){l&&(l.abort(),l=null)}},n={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},e}vi.__dashjs_factory_name="WebmSegmentBaseLoader";const bi=c.Z.getSingletonFactory(vi);function _i(e){e=e||{};var t,n,r,i=this.context,o=e.eventBus,a=e.events,s=e.dashMetrics,l=e.mediaPlayerModel,u=e.errHandler,c=e.baseURLController,d=e.debug,h=e.boxParser,p=e.requestModifier,f=e.errors;function m(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}return t={initialize:function(){n.initialize(),r.initialize()},getSegmentBaseInitSegment:function(e){return m(e.representation.mimeType)?r.loadInitialization(e.representation,e.mediaType):n.loadInitialization(e.representation,e.mediaType)},getSegmentList:function(e){return m(e.mimeType)?r.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null):n.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null)},reset:function(){n.reset(),r.reset()}},n=mi(i).getInstance(),r=bi(i).getInstance(),n.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:o,events:a,errors:f,debug:d,boxParser:h,requestModifier:p}),r.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:o,events:a,errors:f,debug:d,requestModifier:p}),t}_i.__dashjs_factory_name="SegmentBaseController";const Ei=c.Z.getSingletonFactory(_i),wi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},Ti=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.viewpointsWithSchemeIdUri=null,this.accessibility=null,this.accessibilitiesWithSchemeIdUri=null,this.audioChannelConfiguration=null,this.audioChannelConfigurationsWithSchemeIdUri=null,this.roles=null,this.rolesWithSchemeIdUri=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={},this.supplementalPropertiesAsArray=[],this.segmentAlignment=!1,this.subSegmentAlignment=!1},Ai=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},Si=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null,this.serviceDescriptions=[],this.protocol=null},xi=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valid="/"==t[0],this.path=t.split("/").filter((function(e){return 0!==e.length})).map((function(e){var t={name:e},r=e.indexOf("[");if(-1!=r){t.name=e.substring(0,r);var i=e.substring(r+1,e.length-1);n.valid=n.valid&&-1==i.indexOf("[");var o=i.indexOf("=");-1!=o?(t.attribute={name:i.substring(1,o),value:i.substring(o+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(i,10)-1}return t}))}var t;return(t=[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(e,t){for(var n=null,r=e,i=1,o="MPD";i<this.path.length&&null!==r;){n=r;var a=this.path[i];if(o=a.name,i!==this.path.length-1||!o.startsWith("@")){var s=n[o+"_asArray"]||[];0===s.length&&n[o]&&s.push(n[o]),a.position?r=s[a.position]||null:a.attribute?function(){var e=a.attribute;r=s.filter((function(t){return t[e.name]==e.value}))[0]||null}():r=s[0]||null}i++}return null===r?null:o.startsWith("@")?{name:o.substring(1),leaf:r,target:r}:{name:o,leaf:r,target:t?n:r}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),Ii=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=t,this.xpath=n,this.value=r,this.position=null}var t;return(t=[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t)}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();function Ri(){var e,t,n=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(a.Z.ORIGINAL_MPD_ID)||!1},getPublishTime:function(e){return e&&e.hasOwnProperty(a.Z.PUBLISH_TIME)?new Date(e[a.Z.PUBLISH_TIME]):null},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(a.Z.ORIGINAL_PUBLISH_TIME)?new Date(e[a.Z.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(e){return e&&e[a.Z.ORIGINAL_MPD_ID]||null},getPatchOperations:function(e){return e?(e.__children||[]).map((function(e){var n=Object.keys(e)[0];if("add"!==n&&"remove"!==n&&"replace"!==n)return t.warn("Ignoring node of invalid action: ".concat(n)),null;var r=e[n],i=r.sel;if("add"===n&&r.type){if(!r.type.startsWith("@"))return t.warn("Ignoring add action for prefixed namespace declaration: ".concat(r.type,"=").concat(r.__text)),null;i="".concat(i,"/").concat(r.type)}var o=new xi(i);if(!o.isValid())return t.warn("Ignoring action with invalid selector: ".concat(n," - ").concat(i)),null;var a=null;o.findsAttribute()?a=r.__text||"":"remove"!==n&&(a=r.__children.reduce((function(e,t){var n=Object.keys(t)[0];return"#text"!==n&&(e[n]=e[n]||[],e[n].push(t[n])),e}),{}));var s=new Ii(n,o,a);return"add"===n&&(s.position=r.pos),s})).filter((function(e){return!!e})):[]}},t=(0,d.Z)(n).getInstance().getLogger(e),e}Ri.__dashjs_factory_name="PatchManifestModel";const Ci=c.Z.getSingletonFactory(Ri);function Mi(){var e,t,n,r,i,o,s,l=this.context;function u(e,n,o){var s,l=t.getAdaptationsForType(r[0].mpd.manifest,e,n);if(!l||0===l.length)return null;if(l.length>1&&o){var u=h(o,n);if(i[o.id]&&i[o.id][n])for(var d=0,p=l.length;d<p;d++)if(c(i[o.id][n],u[d]))return l[d];for(var f=0,m=l.length;f<m;f++)if(s=l[f],t.getRolesForAdaptation(s).filter((function(e){return e.value===a.Z.MAIN}))[0])return l[f]}return l[0]}function c(e,t){if(!e||!t)return!1;var n=e.id===t.id,r=e.codec===t.codec,i=e.viewpoint===t.viewpoint,o=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),a=e.lang===t.lang,s=e.roles.toString()===t.roles.toString(),l=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),u=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),d=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),h=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return n&&r&&i&&o&&a&&s&&l&&u&&c&&d&&h}function d(e,n,r,i,a,s){var l,u,c,d,h,p,f=[];if(!i||0===i.length)return[];var m=t.getAdaptationsForPeriod(n);for(d=0,p=i.length;d<p;d++)if(l=i[d],u=b(m[c=t.getIndexForAdaptation(l,e,r.index)]),s){var g=u.accessibility.length;for(h=0;h<g;h++)if(u){var y=u.accessibility[h];if(0===y.indexOf("cea-608:")){var v=y.substring(8).split(";");if("CC"===v[0].substring(0,2))for(h=0;h<v.length;h++)u||(u=b.call(this,m[c])),_(u,v[h].substring(0,3),v[h].substring(4)),f.push(u),u=null;else for(h=0;h<v.length;h++)u||(u=b.call(this,m[c])),_(u,"CC"+(h+1),v[h]),f.push(u),u=null}else 0===y.indexOf("cea-608")&&(_(u,o.CC1,"eng"),f.push(u),u=null)}}else a===o.IMAGE?(u.type=o.IMAGE,f.push(u),u=null):u&&f.push(u);return f}function h(e,n,i){var a=r,s=i,l=[];if(s)w(),a=p(s);else{if(!(r.length>0))return l;s=r[0].mpd.manifest}var u=v(e,a),c=t.getAdaptationsForType(s,e?e.index:null,n);return l=d(s,u,e,c,n),n===o.TEXT&&(c=t.getAdaptationsForType(s,e?e.index:null,o.VIDEO),l=l.concat(d(s,u,e,c,n,!0))),l}function p(e){var n=f(e);return t.getRegularPeriods(n)}function f(e){var n=g(e);return t.getMpd(n)}function m(){r=[],i={}}function g(e){return e||(r.length>0?r[0].mpd.manifest:null)}function y(e){try{var n=v(e.streamInfo,r),i=t.getAdaptationsForPeriod(n);return e&&e.streamInfo&&void 0!==e.streamInfo.id&&i?i[e.index]:null}catch(e){return null}}function v(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i}return null}function b(e){if(!e)return null;var n,r,i,o,a,l=new Ti,u=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];if(l.id=e.id,l.index=e.index,l.type=e.type,l.streamInfo=E(e.period),l.representationCount=t.getRepresentationCount(u),l.labels=t.getLabelsForAdaptation(u),l.lang=t.getLanguageForAdaptation(u),l.segmentAlignment=t.getSegmentAlignment(u),l.subSegmentAlignment=t.getSubSegmentAlignment(u),n=t.getViewpointForAdaptation(u),l.viewpoint=n.length?n[0].value:void 0,l.viewpointsWithSchemeIdUri=n,a=t.getAccessibilityForAdaptation(u),l.accessibility=a.map((function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==s&&(n=t?"cea-608:"+t:"cea-608",l.embeddedCaptions=!0),n})),l.accessibilitiesWithSchemeIdUri=a,r=t.getAudioChannelConfigurationForAdaptation(u),l.audioChannelConfiguration=r.map((function(e){return e.value})),l.audioChannelConfigurationsWithSchemeIdUri=r,0===l.audioChannelConfiguration.length&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0&&(i=t.getAudioChannelConfigurationForRepresentation(u.Representation_asArray[0]),l.audioChannelConfiguration=i.map((function(e){return e.value})),l.audioChannelConfigurationsWithSchemeIdUri=i),o=t.getRolesForAdaptation(u),l.roles=o.map((function(e){return e.value})),l.rolesWithSchemeIdUri=o,l.codec=t.getCodec(u),l.mimeType=t.getMimeType(u),l.contentProtection=t.getContentProtectionData(u),l.bitrateList=t.getBitrateListForAdaptation(u),l.selectionPriority=t.getSelectionPriority(u),l.contentProtection){var c=l.contentProtection.map((function(e){return t.getKID(e)})).filter((function(e){return null!==e}));if(c.length){var d=c[0];l.contentProtection.forEach((function(e){e.keyId=d}))}}if(l.isText=t.getIsText(u),l.supplementalProperties=t.getSupplementalPropertiesForAdaptation(u),(!l.supplementalProperties||0===Object.keys(l.supplementalProperties).length)&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0){var h=u.Representation_asArray.map((function(e){return t.getSupplementalPropertiesForRepresentation(e)}));h.every((function(e){return JSON.stringify(e)===JSON.stringify(h[0])}))&&(l.supplementalProperties=h[0])}if(l.supplementalPropertiesAsArray=t.getSupplementalPropertiesAsArrayForAdaptation(u),(!l.supplementalPropertiesAsArray||0===l.supplementalPropertiesAsArray.length)&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0){var p=u.Representation_asArray.map((function(e){return t.getSupplementalPropertiesAsArrayForRepresentation(e)}));p.every((function(e){return JSON.stringify(e)===JSON.stringify(p[0])}))&&(l.supplementalPropertiesAsArray=p[0])}return l.isFragmented=t.getIsFragmented(u),l.isEmbedded=!1,l}function _(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=o.TEXT,e.codec="cea-608-in-SEI",e.isEmbedded=!0,e.isFragmented=!1,e.lang=dn()(n),e.roles=["caption"],e.rolesWithSchemeIdUri=[{schemeIdUri:"urn:mpeg:dash:role:2011",value:"caption"}]}function E(e){var n,r,i=new Ai;return i.id=e.id,i.index=e.index,i.start=e.start,i.duration=e.duration,i.manifestInfo=(n=e.mpd,(r=new Si).dvrWindowSize=n.timeShiftBufferDepth,r.loadedTime=n.manifest.loadedTime,r.availableFrom=n.availabilityStartTime,r.minBufferTime=n.manifest.minBufferTime,r.maxFragmentDuration=n.maxSegmentDuration,r.duration=t.getDuration(n.manifest),r.isDynamic=t.getIsDynamic(n.manifest),r.serviceDescriptions=t.getServiceDescriptions(n.manifest),r.protocol=n.manifest.protocol,r),i.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(i.start+i.duration-i.manifestInfo.duration)<1,i}function w(){if(!o)throw new Error("setConfig function has to be called previously")}function T(e){return r.length>0?r[0].mpd.manifest.Period_asArray[e]:null}function A(e,t,n){var r,i,o,a,s;if(e)for(r=e.AdaptationSet_asArray,a=0;a<r.length;a+=1)for(o=r[a].Representation_asArray,s=0;s<o.length;s+=1)if(t===(i=o[s]).id)return n?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=A(T(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=A(e,t,!0);return null!==n?n:-1}(T(t),e)},getMaxIndexForBufferType:function(e,n){return function(e,n){var r,i,o,a;if(!e||!n)return-1;for(i=e.AdaptationSet_asArray,a=0;a<i.length;a+=1)if(o=(r=i[a]).Representation_asArray,t.getIsTypeOf(r,n))return o.length;return-1}(T(n),e)},convertRepresentationToRepresentationInfo:function(e){if(e){var n=new wi,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],i=t.getRepresentationFor(e.index,r);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(i),n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.mediaInfo=b(e.adaptation),n}return null},getStreamsInfo:function(e,t){var n=[],i=r;if(e&&(w(),i=p(e)),i.length>0){(!t||t>i.length)&&(t=i.length);for(var o=0;o<t;o++)n.push(E(i[o]))}return n},getMediaInfoForType:function(e,n){if(0===r.length||!e)return null;var i=v(e,r);if(!i)return null;var o=t.getAdaptationsForPeriod(i),a=u(e.index,n,e);return a?b(o[t.getIndexForAdaptation(a,r[0].mpd.manifest,e.index)]):null},getAllMediaInfoForType:h,getAdaptationForType:u,getRealAdaptation:function(e,n){var i,o,a=v(e,r);return i=n?n.id:null,r.length>0&&a&&(o=i?t.getAdaptationForId(i,r[0].mpd.manifest,a.index):t.getAdaptationForIndex(n?n.index:null,r[0].mpd.manifest,a.index)),o},getProducerReferenceTimes:function(e,n){var i,o,a=v(e,r);return i=n?n.id:null,r.length>0&&a&&(o=i?t.getAdaptationForId(i,r[0].mpd.manifest,a.index):t.getAdaptationForIndex(n?n.index:null,r[0].mpd.manifest,a.index)),o?t.getProducerReferenceTimesForAdaptation(o):[]},getRealPeriodByIndex:function(e){return t.getRealPeriodForIndex(e,r[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(e){try{return t.getEssentialPropertiesForRepresentation(e)}catch(e){return[]}},getVoRepresentations:function(e){var n=y(e);return t.getRepresentationsForAdaptation(n)},getEventsFor:function(e,n,i){var o=[];if(r.length>0){var a=r[0].mpd.manifest;if(e instanceof Ai){var s=v(e,r);o=t.getEventsForPeriod(s)}else if(e instanceof Ti){var l=v(i,r);o=t.getEventStreamForAdaptationSet(a,y(e),l)}else if(e instanceof wi){var u=v(i,r);o=t.getEventStreamForRepresentation(a,n,u)}}return o},getEvent:function(e,t,n,r){try{if(!e||!t||isNaN(n)||!r)return null;var i=e.scheme_id_uri,o=e.value;if(!t[i+"/"+o])return null;var a,s=new ve,l=e.timescale||1,u=r.adaptation.period.start,c=t[i+"/"+o],d=isNaN(r.presentationTimeOffset)?isNaN(c.presentationTimeOffset)?0:c.presentationTimeOffset:r.presentationTimeOffset,h=e.presentation_time_delta/l;a=0===e.version?u+n-d+h:u-d+h;var p=e.event_duration/l,f=e.id,m=e.message_data;return s.eventStream=c,s.eventStream.value=o,s.eventStream.timescale=l,s.duration=p,s.id=f,s.calculatedPresentationTime=a,s.messageData=m,s.presentationTimeDelta=h,s}catch(e){return null}},getMpd:f,setConfig:function(e){e&&(e.constants&&(o=e.constants),e.cea608parser&&(s=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;w(),r=p(e)},getIsTextTrack:function(e){return t.getIsText(e)},getUTCTimingSources:function(){var e=g();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=r.length>0?r[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var n=f(e);return t.getAvailabilityStartTime(n)},getIsTypeOf:function(e,n){return t.getIsTypeOf(e,n)},getIsDynamic:function(e){var n=g(e);return t.getIsDynamic(n)},getDuration:function(e){var n=g(e);return t.getDuration(n)},getRegularPeriods:p,getContentSteering:function(e){return t.getContentSteering(e)},getLocation:function(e){return t.getLocation(e)},getPatchLocation:function(e){var n=t.getPatchLocation(e),r=t.getPublishTime(e);return n&&0!==n.length&&r?n.filter((function(e){return isNaN(e.ttl)||r.getTime()+e.ttl>(new Date).getTime()})):[]},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n)},getPublishTime:function(e){return t.getPublishTime(e)},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(e){return n.getIsPatch(e)},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,n,r){return t.getCodec(e,n,r)},getPeriodById:function(e){if(!e||0===r.length)return null;var t=r.filter((function(t){return t.id===e}));return t&&t.length>0?t[0]:null},setCurrentMediaInfo:function(e,t,n){i[e]=i[e]||{},i[e][t]=i[e][t]||{},i[e][t]=n},isPatchValid:function(e,r){var i=t.getId(e),o=n.getMpdId(r),a=t.getPublishTime(e),s=n.getPublishTime(r),l=n.getOriginalPublishTime(r);return!!(i&&o&&i==o&&a&&l&&a.getTime()==l.getTime()&&s&&a.getTime()<s.getTime())},applyPatchToManifest:function(e,t){n.getPatchOperations(t).forEach((function(t){var n=t.getMpdTarget(e);if(null!==n){var r=n.name,i=n.target,o=n.leaf;if(t.xpath.findsAttribute())switch(t.action){case"add":case"replace":i[r]=t.value;break;case"remove":delete i[r]}else{var a=(i[r+"_asArray"]||[]).indexOf(o),s="prepend"===t.position||"before"===t.position;if(("remove"===t.action||"replace"===t.action)&&(delete i[r],-1!=a)){var l=i[r+"_asArray"];l.splice(a,1),l.length>1?i[r]=l:1==l.length?i[r]=l[0]:delete i[r+"_asArray"]}"add"!==t.action&&"replace"!==t.action||Object.keys(t.value).forEach((function(e){var n=t.value[e],o=i[e+"_asArray"]||[];if(0===o.length&&i[e]&&o.push(i[e]),0===o.length)o=n;else{var l=o.length;l=e==r&&-1!=a?a+(s?0:1)+("replace"==t.action?-1:0):s?0:o.length,o.splice.apply(o,[l,0].concat(n))}i[e+"_asArray"]=o,i[e]=1==o.length?o[0]:o}))}}}))},areMediaInfosEqual:c,reset:m},t=ke(l).getInstance(),n=Ci(l).getInstance(),m(),e}Mi.__dashjs_factory_name="DashAdapter";const Li=c.Z.getSingletonFactory(Mi);var Pi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"round10",value:function(e,t){return function(e,t,n){return void 0===n||0==+n?Math[e](t):(n=+n,null===(t=+t)||isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}("round",e,t)}}],t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e,t),e}();const Di=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]},Oi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null},Ni=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null},ki=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=s.Z.BUFFER_EMPTY},Fi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null},Bi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null};function Ui(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var zi=function e(){Ui(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},Gi=function e(){Ui(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},Vi=function e(){Ui(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};const ji=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},Hi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]};function Zi(e){var t,n,r=(e=e||{}).settings,i=this.context,a=(0,l.Z)(i).getInstance();function c(){a.trigger(u.Z.METRICS_CHANGED)}function d(e){a.trigger(u.Z.METRIC_CHANGED,{mediaType:e}),c()}function h(e,t,n){a.trigger(u.Z.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),d(e)}function p(e,t,n){a.trigger(u.Z.METRIC_ADDED,{mediaType:e,metric:t,value:n}),d(e)}function f(e,t){var r=null;return e?(n.hasOwnProperty(e)?r=n[e]:t||(r=new Di,n[e]=r),r):r}function m(e,t,n){var i=f(e);null!==i&&(i[t].push(n),i[t].length>r.get().streaming.metrics.maxListDepth&&i[t].shift())}function g(e,t,n){m(e,t,n),p(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete n[e],d(e)},clearAllCurrentMetrics:function(){n={},c()},getMetricsFor:f,addHttpRequest:function e(t,n,r,i,o,a,l,u,c,d,h,p,f,m,y,v,b){var _=new R.w;a&&a!==i&&(e(t,null,r,i,o,null,null,u,c,null,null,null,f,null,null,v,b),_.actualurl=a),_.tcpid=n,_.type=r,_.url=i,_.range=u,_.trequest=c,_.tresponse=d,_.responsecode=p,_.cmsd=b,_._tfinish=h,_._stream=t,_._mediaduration=f,_._quality=o,_._responseHeaders=m,_._serviceLocation=l,_._fileLoaderType=v,y?y.forEach((function(e){!function(e,t,n,r){var i=new R.O;i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n}(_,e.s,e.d,e.b)})):(delete _.interval,delete _.trace),g(t,s.Z.HTTP_REQUEST,_)},addRepresentationSwitch:function(e,t,n,r,i){var o=new Oi;o.t=t,o.mt=n,o.to=r,i?o.lto=i:delete o.lto,g(e,s.Z.TRACK_SWITCH,o)},addBufferLevel:function(e,t,n){var r=new Ni;r.t=t,r.level=n,g(e,s.Z.BUFFER_LEVEL,r)},addBufferState:function(e,t,n){var r=new ki;r.target=n,r.state=t,g(e,s.Z.BUFFER_STATE,r)},addDVRInfo:function(e,t,n,r){var i=new Fi;i.time=t,i.range=r,i.manifestInfo=n,g(e,s.Z.DVR_INFO,i)},addDroppedFrames:function(e,t){var n=new Bi,r=f(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n||g(e,s.Z.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,r,i,o,a,l,u){var c=new ji;c.mediaType=e,c.t=t,c.type=n,c.startTime=r,c.availabilityStartTime=i,c.duration=o,c.quality=a,c.range=l,c.state=u,g(e,s.Z.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var r=new Hi;r.loadingRequests=t,r.executedRequests=n,f(e).RequestsQueue=r,p(e,s.Z.REQUESTS_QUEUE,r)},addManifestUpdate:function(e,t,n,r,i,a,l,u,c,d){var h=new zi;h.mediaType=e,h.type=t,h.requestTime=n,h.fetchTime=r,h.availabilityStartTime=i,h.presentationStartTime=a,h.clientTimeOffset=l,h.currentTime=u,h.buffered=c,h.latency=d,m(o.Z.STREAM,s.Z.MANIFEST_UPDATE,h),p(e,s.Z.MANIFEST_UPDATE,h)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];h(e.mediaType,s.Z.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,r,i){if(e){var o=new Gi;o.id=t,o.index=n,o.start=r,o.duration=i,e.streamInfo.push(o),h(e.mediaType,s.Z.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,r,i,o,a,l){if(e&&e.representationInfo){var u=new Vi;u.id=t,u.index=n,u.streamIndex=r,u.mediaType=i,u.startNumber=a,u.fragmentInfoType=l,u.presentationTimeOffset=o,e.representationInfo.push(u),h(e.mediaType,s.Z.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach((function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel})):delete e.trace,g(o.Z.STREAM,s.Z.PLAY_LIST,e)},addDVBErrors:function(e){g(o.Z.STREAM,s.Z.DVB_ERRORS,e)}},n={},t}Zi.__dashjs_factory_name="MetricsModel";const qi=c.Z.getSingletonFactory(Zi);function Wi(e){e=e||{};var t,n,r,i,a=this.context,l=e.metricsModel;function u(e){var t=l.getMetricsFor(e,!0);if(!t)return null;var n,r=t.HttpList,i=null;if(!r||r.length<=0)return null;for(n=r.length-1;n>=0;){if(r[n].responsecode){i=r[n];break}n--}return i}function c(e){var t=l.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function d(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}return t={getCurrentRepresentationSwitch:function(e){return d(l.getMetricsFor(e,!0),s.Z.TRACK_SWITCH)},getCurrentBufferState:function(e){return d(l.getMetricsFor(e,!0),s.Z.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=d(l.getMetricsFor(e,!0),s.Z.BUFFER_LEVEL);return t?Pi.round10(t.level/1e3,-3):0},getCurrentHttpRequest:u,getHttpRequests:c,getCurrentDroppedFrames:function(){return d(l.getMetricsFor(o.Z.VIDEO,!0),s.Z.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return d(l.getMetricsFor(e,!0),s.Z.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return d(e?l.getMetricsFor(e,!0):l.getMetricsFor(o.Z.VIDEO,!0)||l.getMetricsFor(o.Z.AUDIO,!0),s.Z.DVR_INFO)},getCurrentManifestUpdate:function(){return d(l.getMetricsFor(o.Z.STREAM),s.Z.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){if(!t)return null;var n={},r=u(e);r&&(n=Fe.Z.parseHttpHeaders(r._responseHeaders));var i=n[t.toLowerCase()];return void 0===i?null:i},getLatestMPDRequestHeaderValueByID:function(e){if(!e)return null;var t,n,r,i={};for(r=(t=c(o.Z.STREAM)).length-1;r>=0;r--)if((n=t[r]).type===R.w.MPD_TYPE){i=Fe.Z.parseHttpHeaders(n._responseHeaders);break}var a=i[e.toLowerCase()];return void 0===a?null:a},addRepresentationSwitch:function(e,t,n,r,i){l.addRepresentationSwitch(e,t,n,r,i)},addDVRInfo:function(e,t,n,r){l.addDVRInfo(e,t,n,r)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();l.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();l.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();l.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){l.addManifestUpdate(o.Z.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,r,i,o){l.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i,e.fileLoaderType,o)},addSchedulingInfo:function(e,t){l.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){l.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){l.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){l.addBufferState(e,t,n)},addDroppedFrames:function(e){l.addDroppedFrames(o.Z.VIDEO,e)},addPlayList:function(){i&&(l.addPlayList(i),i=null)},addDVBErrors:function(e){l.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(i=new Q).start=new Date,i.mstart=e,i.starttype=t},createPlaylistTraceMetrics:function(e,t,i){!0===n&&(n=!1,(r=new J).representationid=e,r.start=new Date,r.mstart=t,r.playbackspeed=null!==i?i.toString():null)},updatePlayListTraceMetrics:function(e){if(r)for(var t in r)r[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===n&&i&&r&&r.start){var o=r.start,a=e.getTime()-o.getTime();r.duration=a,r.stopreason=t,i.trace.push(r),n=!0}},clearAllCurrentMetrics:function(){l.clearAllCurrentMetrics()}},l=l||qi(a).getInstance({settings:e.settings}),n=!0,r=null,i=null,t}Wi.__dashjs_factory_name="DashMetrics";const Yi=c.Z.getSingletonFactory(Wi);function Ki(){var e,t,n,r,i=this.context,s=(0,l.Z)(i).getInstance(),c=(0,I.Z)(i).getInstance();function d(e){r=e}function p(e,t,n,r){var i,o=t.adaptation.period.mpd,a=o.availabilityStartTime;if(r)i=n&&o.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(a.getTime()+1e3*(e+o.timeShiftBufferDepth)):o.availabilityEndTime;else if(n){var s=t.availabilityTimeOffset;i=new Date(a.getTime()+1e3*(e-s))}else i=a;return i}function f(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*r)/1e3}function m(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function g(e){var n={start:NaN,end:NaN},r=e[0].getAdapter().getRegularPeriods()[0],i=f(new Date,r);if(!e||0===e.length)return{range:n,now:i};e.forEach((function(e){var r=e.getAdapter(),s=r.getMediaInfoForType(e.getStreamInfo(),o.Z.VIDEO)||r.getMediaInfoForType(e.getStreamInfo(),o.Z.AUDIO),l=r.getVoRepresentations(s)[0],u={start:NaN,end:NaN};if(l)if(l.segmentInfoType===a.Z.SEGMENT_TIMELINE)u=function(e){var n,r,i,o,a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],s=t.getRepresentationFor(e.index,a),l=s.SegmentTemplate||s.SegmentList,u=l.SegmentTimeline,c=l.timescale,d=u.S_asArray,h={start:0,end:0},p=d[0].t,f=!isNaN(p),g=f?p:0,y=0;for(f&&(h.start=m(g/c,e)),i=0,o=d.length;i<o;i++)r=0,(n=d[i]).hasOwnProperty("r")&&(r=n.r),y+=n.d*(1+r);return h.end=m((g+y)/c,e),h}(l);else{var c=l.adaptation.period;u.start=c.start,u.end=Math.max(i,c.start+c.duration)}!isNaN(u.start)&&(isNaN(n.start)||n.start>u.start)&&(n.start=u.start),!isNaN(u.end)&&(isNaN(n.end)||n.end<u.end)&&(n.end=u.end)})),n.end=Math.min(i,n.end);var s=v(e,n.end,!0);return n.end=isNaN(s)?n.end:s,n.start=r&&r.mpd&&r.mpd.timeShiftBufferDepth&&!isNaN(r.mpd.timeShiftBufferDepth)&&!isNaN(n.end)?Math.max(n.end-r.mpd.timeShiftBufferDepth,n.start):n.start,n.start=v(e,n.start),{range:n,now:i}}function y(e,t){n=e-t.end}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{for(var r=0,i=!1,o=NaN;!i&&r<e.length;){var a=e[r].getStreamInfo();a.start<=t&&(!isFinite(a.duration)||a.start+a.duration>=t)?(o=t,i=!0):!n&&a.start>t&&(isNaN(o)||a.start<o)?o=a.start:n&&a.start+a.duration<t&&(isNaN(o)||a.start+a.duration>o)&&(o=a.start+a.duration),r+=1}return o}catch(e){return t}}function b(e){void 0===e.offset||isNaN(e.offset)||d(e.offset/1e3)}function _(){r=0,n=0}function E(){s.off(u.Z.UPDATE_TIME_SYNC_OFFSET,b,this),_()}return e={initialize:function(){_(),s.on(u.Z.UPDATE_TIME_SYNC_OFFSET,b,this)},getClientTimeOffset:function(){return r},setClientTimeOffset:d,getClientReferenceTime:function(){return Date.now()-1e3*n+1e3*r},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return p(e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return p(e,t,n,!0)},calcPresentationTimeFromWallTime:f,calcPresentationTimeFromMediaTime:m,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcWallTimeForSegment:function(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},calcTimeShiftBufferWindow:function(e,t){if(!t)return function(e){var t={start:NaN,end:NaN},n=0,r=NaN;return e.forEach((function(e){var t=e.getStreamInfo();n+=t.duration,(isNaN(r)||t.start<r)&&(r=t.start)})),t.start=r,t.end=r+n,t}(e);if(c.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var n=g(e);return y(n.now,n.range),n.range}return function(e){var t={start:NaN,end:NaN};if(!e||0===e.length)return t;var n=e[0].getAdapter().getRegularPeriods()[0],r=f(new Date,n),i=n.mpd.timeShiftBufferDepth,o=isNaN(i)?0:r-i;if(t.start=v(e,o),t.end=!isNaN(t.start)&&r<t.start?r:v(e,r,!0),!isNaN(i)&&t.end<r-i&&(t.end=NaN),c.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var a=g(e);if(a.range.end<t.start)return s.trigger(h.Z.CONFORMANCE_VIOLATION,{level:$t.LEVELS.WARNING,event:$t.EVENTS.INVALID_DVR_WINDOW}),y(a.now,a.range),a.range}return t}(e)},reset:E},t=ke(i).getInstance(),E(),e}Ki.__dashjs_factory_name="TimelineConverter";const $i=c.Z.getSingletonFactory(Ki);var Xi=n(4593),Qi=n(6934);function Ji(e){return Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ji(e)}function eo(e,t){return eo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},eo(e,t)}function to(e){return to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},to(e)}const no=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eo(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=to(t);if(n){var i=to(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==Ji(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=r.call(this)).captionData=null,e.label=null,e.defaultTrack=!1,e.kind=null,e.isFragmented=!1,e.isEmbedded=!1,e.isTTML=null,e}return i}(Ti);var ro=n(2295);function io(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n)t+=e[n].uchar;return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function i(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function o(e){return e.replace(/^\s+/g,"")}function a(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(r,s,l,u){var c,d,h=null,p=!1,f=-1,m={start:s,end:l,spans:[]},g="style_cea608_white_black",y={},v={},b=[];for(c=0;c<15;++c){var _=u.rows[c],E="",w=null;if(!1===_.isEmpty()){var T=t(_.chars);null===h&&(h={x:T,y1:c,y2:c+1,p:[]}),T!==f&&p&&(h.p.push(m),m={start:s,end:l,spans:[]},h.y2=c,h.name="region_"+h.x+"_"+h.y1+"_"+h.y2,!1===y.hasOwnProperty(h.name)?(b.push(h),y[h.name]=h):y[h.name].p.contat(h.p),h={x:T,y1:c,y2:c+1,p:[]});for(var A=0;A<_.chars.length;++A){var S=_.chars[A],x=S.penState;if(null===w||!x.equals(w)){E.trim().length>0&&(m.spans.push({name:g,line:E,row:c}),E="");var I="style_cea608_"+x.foreground+"_"+x.background;x.underline&&(I+="_underline"),x.italics&&(I+="_italics"),v.hasOwnProperty(I)||(v[I]=JSON.parse(JSON.stringify(x))),w=x,g=I}E+=S.uchar}E.trim().length>0&&m.spans.push({name:g,line:E,row:c}),p=!0,f=T}else p=!1,f=-1,h&&(h.p.push(m),m={start:s,end:l,spans:[]},h.y2=c,h.name="region_"+h.x+"_"+h.y1+"_"+h.y2,!1===y.hasOwnProperty(h.name)?(b.push(h),y[h.name]=h):y[h.name].p.contat(h.p),h=null)}h&&(h.p.push(m),h.y2=c+1,h.name="region_"+h.x+"_"+h.y1+"_"+h.y2,!1===y.hasOwnProperty(h.name)?(b.push(h),y[h.name]=h):y[h.name].p.contat(h.p),h=null);var R=[];for(c=0;c<b.length;++c){var C=b[c],M="sub_cea608_"+e++,L=document.createElement("div");L.id=M;var P=n(C);L.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+P;var D=document.createElement("div");D.className="paragraph bodyStyle",D.style.cssText=i(r);var O=document.createElement("div");O.className="cueUniWrapper",O.style.cssText="unicode-bidi: normal; direction: ltr;";for(var N=0;N<C.p.length;++N){var k=C.p[N],F=0;for(d=0;d<k.spans.length;++d){var B=k.spans[d];if(B.line.length>0){if(0!==d&&F!=B.row){var U=document.createElement("br");U.className="lineBreak",O.appendChild(U)}var z=!1;F===B.row&&(z=!0),F=B.row;var G=v[B.name],V=document.createElement("span");V.className="spanPadding "+B.name+" customSpanColor",V.style.cssText=i(r,G),0!==d&&z?d===k.spans.length-1?V.textContent=a(B.line):V.textContent=B.line:k.spans.length>1&&d<k.spans.length-1&&B.row===k.spans[d+1].row?V.textContent=o(B.line):V.textContent=B.line.trim(),O.appendChild(V)}}}D.appendChild(O),L.appendChild(D);var j={bodyStyle:["%",90]};for(var H in v)v.hasOwnProperty(H)&&(j[H]=["%",90]);R.push({type:"html",start:s,end:l,cueHTMLElement:L,cueID:M,cellResolution:[32,15],isFromCEA608:!0,fontSize:j,lineHeight:{},linePadding:{}})}return R}}}io.__dashjs_factory_name="EmbeddedTextHtmlRender";const oo=c.Z.getSingletonFactory(io);function ao(e){var t,n,r,a,s,c,h,p,f,m,g,y,v,b,_,E,T=e.errHandler,A=e.manifestModel,S=e.mediaController,I=e.videoModel,C=e.textTracks,M=e.vttParser,L=e.vttCustomRenderingParser,P=e.ttmlParser,D=e.streamInfo,O=e.settings,N=this.context,k=(0,l.Z)(N).getInstance(),F=!1;function B(){c=null,p=NaN,f=[],m=null,h=!1,s=[],a=null}function U(e){var t=new no;for(var n in e)t[n]=e[n];t.labels=e.labels,t.defaultTrack=function(e){var t=!1;return y.length>1&&e.isEmbedded?t=e.id&&e.id===o.Z.CC1:1===y.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===y.length&&(t=e.index===s[0].index),t}(e),t.isFragmented=e.isFragmented,t.isEmbedded=!!e.isEmbedded,t.isTTML=function(e){return e.codec&&e.codec.search(o.Z.STPP)>=0||e.mimeType&&e.mimeType.search(o.Z.TTML)>=0}(e),t.kind=function(e,t){var n=e.roles&&e.roles.length>0?t[e.roles[0]]:t.caption;return n===t.caption||n===t.subtitle?n:t.caption}(e,{subtitle:"subtitles",caption:"captions"}),C.addTextTrack(t)}function z(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&V(t.bytes,t)}function G(e){g=e}function V(e,s){var l=s.mediaInfo,u=l.type,d=l.mimeType,f=l.codec||d;f?-1!==l.codec.indexOf("application/mp4")?function(e,i,s){var l;if("InitializationSegment"===i.segmentType)h=!0,p=r.getMediaTimescaleFromMoov(e);else{if(!h)return;(l=r.getSamplesInfo(e).sampleList).length>0&&(m=l[0].cts-i.start*p),s.search(o.Z.STPP)>=0?function(e,r,i){var s,l;for(a=null!==a?a:Z(i),s=0;s<r.length;s++){var u=r[s],d=u.cts,h=H(),f=h+d/p,m=f+u.duration/p;t.buffered.add(f,m);var y=new DataView(e,u.offset,u.subSizes[0]),v=Qi.Utils.dataViewToString(y,o.Z.UTF8),b=[],_=u.offset+u.subSizes[0];for(l=1;l<u.subSizes.length;l++){var E=new Uint8Array(e,_,u.subSizes[l]),w=String.fromCharCode.apply(null,E);b.push(w),_+=u.subSizes[l]}try{var T=A.getValue().ttmlTimeIsRelative?d/p:0,S=a.parse(v,T,d/p,(d+u.duration)/p,b);C.addCaptions(g,h,S)}catch(e){c.removeExecutedRequestsBeforeTime(),this.remove(),n.error("TTML parser error: "+e.message)}}}(e,l,s):function(e,r){var i,o,a,s=[];for(i=0;i<r.length;i++){var l=r[i];l.cts-=m;var u=H()+l.cts/p,c=u+l.duration/p;t.buffered.add(u,c);var d=e.slice(l.offset,l.offset+l.size),h=Qi.parseBuffer(d);for(o=0;o<h.boxes.length;o++){var f=h.boxes[o];if(n.debug("VTT box1: "+f.type),"vtte"!==f.type&&"vttc"===f.type){n.debug("VTT vttc boxes.length = "+f.boxes.length);var y={styles:{}};for(a=0;a<f.boxes.length;a++){var v=f.boxes[a];if(n.debug("VTT box2: "+v.type),"payl"===v.type)y.start=l.cts/p,y.end=(l.cts+l.duration)/p,y.data=v.cue_text;else if("sttg"===v.type&&v.settings&&""!==v.settings)try{var b=v.settings.split(" ");y.styles=M.getCaptionStyles(b)}catch(e){}}y&&y.data&&(s.push(y),n.debug("VTT  ".concat(y.start," - ").concat(y.end," :  ").concat(y.data)))}}}s.length>0&&C.addCaptions(g,0,s)}(e,l)}}(e,s,f):u===o.Z.VIDEO?function(e,t){var o,a;if(t.segmentType===R.w.INIT_SEGMENT_TYPE)0===v&&(v=r.getMediaTimescaleFromMoov(e));else if(t.segmentType===R.w.MEDIA_SEGMENT_TYPE){if(0===v)return void n.warn("CEA-608: No timescale for embeddedTextTrack yet");var s=(a=r.getSamplesInfo(e)).lastSequenceNumber;if(_[0]||_[1]||function(){for(var e,t=0;t<y.length;t++){if(-1===(e=C.getTrackIdxForId(y[t].id)))return void n.warn("CEA-608: data before track is ready.");var r=j(e);_[t]=new(i().Cea608Parser)(t+1,{newCue:r},null)}}(),v){if(null!==b&&s!==b+a.numSequences)for(o=0;o<_.length;o++)_[o]&&_[o].reset();for(var l=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),o=0;o<t.length;o++)for(var a=t[o],s=i().findCea608Nalus(r,a.offset,a.size),l=null,u=0,c=0;c<s.length;c++)for(var d=i().extractCea608DataFromRange(r,s[c]),h=0;h<2;h++)if(d[h].length>0){a.cts!==l?u=0:u+=1;var p=H();n.fields[h].push([a.cts+p*v,d[h],u]),l=a.cts}return n.fields.forEach((function(e){e.sort((function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]}))})),n}(e,a.sampleList),u=0;u<_.length;u++){var c=l.fields[u],d=_[u];if(d)for(o=0;o<c.length;o++)d.addData(c[o][0]/v,c[o][1])}b=s}}}(e,s):function(e,n,r){var i,a,s=new DataView(e,0,e.byteLength);a=Qi.Utils.dataViewToString(s,o.Z.UTF8);try{i=Z(r).parse(a,0),C.addCaptions(C.getCurrentTrackIdx(),0,i),t.buffered&&t.buffered.add(n.start,n.end)}catch(e){T.error(new w.Z(x.TIMED_TEXT_ERROR_ID_PARSE_CODE,x.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,a))}}(e,s,f):n.error("No text type defined")}function j(e){return function(t,n,r){var i;(i=I.getTTMLRenderingDiv()?E.createHTMLCaptionsFromScreen(I.getElement(),t,n,r):[{start:t,end:n,data:r.getDisplayText(),styles:{}}])&&C.addCaptions(e,0,i)}}function H(){return isNaN(t.timestampOffset)?0:t.timestampOffset}function Z(e){var t;return e.search(o.Z.VTT)>=0?t=O.get().streaming.text.webvtt.customRenderingEnabled&&L?L:M:(e.search(o.Z.TTML)>=0||e.search(o.Z.STPP)>=0)&&(t=P),t}function q(e){y.forEach((function(t){var n=C.getTrackIdxForId(t.id);n>=0&&C.deleteCuesFromTrackIdx(n,e.from,e.to)}))}return t={initialize:function(){F||(y=[],g=null,v=0,_=[],b=null,F=!0,E=oo(N).getInstance(),k.on(u.Z.VIDEO_CHUNK_RECEIVED,z,t),k.on(u.Z.BUFFER_CLEARED,q,t))},addMediaInfos:function(e,n,r){if(s=s.concat(n),e===o.Z.TEXT&&n[0].isFragmented&&!n[0].isEmbedded){c=r,t.buffered=(0,ro.Z)(N).create(),f=S.getTracksFor(o.Z.TEXT,D.id).filter((function(e){return e.isFragmented}));for(var i=S.getCurrentTrackFor(o.Z.TEXT,D.id),a=0;a<f.length;a++)if(f[a]===i){G(a);break}}for(var l=0;l<n.length;l++)U(n[l])},resetMediaInfos:function(){s=[]},getStreamId:function(){return D.id},append:V,abort:function(){},addEmbeddedTrack:function(e){if(F&&e)if(e.id===o.Z.CC1||e.id===o.Z.CC3){for(var t=0;t<y.length;t++)if(y[t].id===e.id)return;y.push(e)}else n.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){k.off(u.Z.VIDEO_CHUNK_RECEIVED,z,t),k.off(u.Z.BUFFER_CLEARED,q,t),C&&C.deleteAllTextTracks(),F=!1,y=[],_=[null,null],b=null},getConfig:function(){return{fragmentModel:c,fragmentedTracks:f,videoModel:I}},setCurrentFragmentedTrackIdx:G,remove:function(e,n){void 0===e&&e===n&&(e=t.buffered.start(0),n=t.buffered.end(t.buffered.length-1)),t.buffered.remove(e,n),C.deleteCuesFromTrackIdx(g,e,n)},reset:function(){B(),s=[],r=null}},n=(0,d.Z)(N).getInstance().getLogger(t),r=(0,Ct.Z)(N).getInstance(),B(),t}ao.__dashjs_factory_name="TextSourceBuffer";const so=c.Z.getClassFactory(ao);var lo=n(4403);function uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var co=["text","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function ho(e){var t,n,r,i,a,s,c,p,f,m,g,y,v,b,_,E,w,T,A=this.context,S=(0,l.Z)(A).getInstance(),x=e.videoModel,I=e.streamInfo,R=e.settings;function C(e,t,n,r,i,o){var a=0,s=0;e/t>n/r?a=(s=t)/r*n:s=(a=e)/n*r;var l,u,c=0,d=0;return a/s>i?(d=s,c=s*i):(c=a,d=a/i),l=(e-c)/2,u=(t-d)/2,o?{x:l+.1*c,y:u+.1*d,w:.8*c,h:.8*d}:{x:l,y:u,w:c,h:d}}function M(e,t){var n=x.getClientWidth(),r=x.getClientHeight(),i=x.getVideoWidth(),o=x.getVideoHeight(),a=x.getVideoRelativeOffsetTop(),s=x.getVideoRelativeOffsetLeft();if(0!==i&&0!==o){var l=i/o,u=!1;e.isFromCEA608&&(l=3.5/3,u=!0);var d=C.call(this,n,r,i,o,l,u),y=d.w,v=d.h,E=d.x,T=d.y;if(y!=f||v!=m||E!=c||T!=p||t){if(c=E+s,p=T+a,f=y,m=v,g){var A=g.style;A&&(A.left=c+"px",A.top=p+"px",A.width=f+"px",A.height=m+"px",A.zIndex=b&&document[b]||_?w:null,S.trigger(h.Z.CAPTION_CONTAINER_RESIZE))}var I=e.activeCues;if(I)for(var R=I.length,M=0;M<R;++M){var L=I[M];L.scaleCue(L)}}}}function L(e){var t,n,r,i,o,a=f,s=m;if(e.cellResolution){var l=[a/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){n=(e.linePadding[t]*l[0]).toString();for(var u=document.getElementsByClassName("spanPadding"),c=0;c<u.length;c++)u[c].style.cssText=u[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),u[c].style.cssText=u[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),n=(r*l[1]).toString(),o="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var d=0;d<o.length;d++)o[d].style.cssText=o[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),n=(i*l[1]).toString(),o=document.getElementsByClassName(t);for(var h=0;h<o.length;h++)o[h].style.cssText=o[h].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}}}if(e.isd){var p=document.getElementById(e.cueID);p&&g.removeChild(p),D(e)}}function P(e,t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),o=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[o])}if(r.test(t)){var a=r.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[a]}return t}function D(e){if(g){var t=document.createElement("div");g.appendChild(t),E=(0,lo.renderHTML)(e.isd,t,(function(t){return P(e,t)}),g.clientHeight,g.clientWidth,!1,(function(e){n.info("renderCaption :",e)}),E,!0),t.id=e.cueID,S.trigger(h.Z.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:s})}}function O(e,t){if(!R.get().streaming.text.extendSegmentedCues)return!1;if(!t.cues||0===t.cues.length)return!1;var n=t.cues[t.cues.length-1];return!(n.endTime<e.startTime||!function(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if(JSON.stringify(e[i])!==JSON.stringify(t[i]))return!1}return!0}(n,e,co)||(n.endTime=Math.max(n.endTime,e.endTime),0))}function N(e,t){t&&t.forEach((function(t){t.kind&&"image"===t.kind&&(t.src=P(e,t.src)),N(e,t.contents)}))}function k(e,t,r){var i=z(e);if(i&&Array.isArray(r)&&0!==r.length)for(var o=0;o<r.length;o++){var a=void 0,s=r[o];i.cellResolution=s.cellResolution,i.isFromCEA608=s.isFromCEA608,isNaN(s.start)||isNaN(s.end)||(a="html"===s.type&&g?F(s,t,i):s.data?B(s,t,i):null);try{a?j(i,a)||(R.get().streaming.text.webvtt.customRenderingEnabled?(i.manualCueList||(i.manualCueList=[]),i.manualCueList.push(a)):O(a,i)||i.addCue(a)):n.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(e){throw Z(i),i.addCue(a),e}}}function F(e,t,i){var a=this,l=new r(e.start+t,e.end+t,"");return l.cueHTMLElement=e.cueHTMLElement,l.isd=e.isd,l.images=e.images,l.embeddedImages=e.embeddedImages,l.cueID=e.cueID,l.scaleCue=L.bind(a),l.cellResolution=e.cellResolution,l.lineHeight=e.lineHeight,l.linePadding=e.linePadding,l.fontSize=e.fontSize,g.style.left=c+"px",g.style.top=p+"px",g.style.width=f+"px",g.style.height=m+"px",l.isd&&N(l,l.isd.contents),l.onenter=function(){i.mode===o.Z.TEXT_SHOWING&&(this.isd?(D(this),n.debug("Cue enter id:"+this.cueID)):(g.appendChild(this.cueHTMLElement),L.call(a,this),S.trigger(h.Z.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:s})))},l.onexit=function(){if(g)for(var e=g.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(n.debug("Cue exit id:"+e[t].id),g.removeChild(e[t]),--t)},l}function B(e,t,i){var a=new r(e.start-t,e.end-t,e.data);if(a.cueID="".concat(a.startTime,"_").concat(a.endTime),a.isActive=!1,e.styles)try{void 0!==e.styles.align&&"align"in a&&(a.align=e.styles.align),void 0!==e.styles.line&&"line"in a&&(a.line=e.styles.line),void 0!==e.styles.snapToLines&&"snapToLines"in a&&(a.snapToLines=e.styles.snapToLines),void 0!==e.styles.position&&"position"in a&&(a.position=e.styles.position),void 0!==e.styles.size&&"size"in a&&(a.size=e.styles.size)}catch(e){n.error(e)}return a.onenter=function(){i.mode===o.Z.TEXT_SHOWING&&S.trigger(h.Z.CAPTION_RENDERED,{currentTrackIdx:s})},a}function U(){var e,t=[],n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uo(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(x.getTextTracks());try{for(n.s();!(e=n.n()).done;){var r=e.value;r.manualMode===o.Z.TEXT_SHOWING&&t.push(r)}}catch(e){n.e(e)}finally{n.f()}return t}function z(e){return e>=0&&i[e]?x.getTextTrack(i[e].kind,i[e].id,i[e].lang,i[e].isTTML,i[e].isEmbedded):null}function G(e){var t=this;if(e!==s){var n=z(s=e);V.call(this,n),v&&(clearInterval(v),v=null),n&&"html"===n.renderingType&&(M.call(this,n,!0),window.ResizeObserver?(T=new window.ResizeObserver((function(){M.call(t,n,!0)}))).observe(x.getElement()):v=setInterval(M.bind(this,n),500))}}function V(e){Y.call(this),e&&"html"===e.renderingType?q.call(this):W.call(this)}function j(e,t){if(!e.cues)return!1;for(var n=0;n<e.cues.length;n++)if(e.cues[n].startTime===t.startTime&&e.cues[n].endTime===t.endTime)return!0;return!1}function H(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(isNaN(t)||(r?e.startTime:e.endTime)>=t)&&(isNaN(n)||(r?e.endTime:e.startTime)<=n)}function Z(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.cues)for(var i=e.cues,o=i.length-1;o>=0;o--)H(i[o],t,n,r)&&(i[o].onexit&&i[o].onexit(),e.removeCue(i[o]))}function q(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,r=x.getElement();try{r&&(r.id?t.insertRule("#"+r.id+"::cue {background: transparent}",0):0!==r.classList.length?t.insertRule("."+r.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){n.info(""+e.message)}}}function W(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function Y(){if(g)for(;g.firstChild;)g.removeChild(g.firstChild)}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(r=window.VTTCue||window.TextTrackCue,i=[],a=[],s=-1,c=0,p=0,f=0,m=0,g=null,y=null,v=null,_=!1,w=2147483647,E=null,void 0!==document.fullscreenElement?b="fullscreenElement":void 0!==document.webkitIsFullScreen?b="webkitIsFullScreen":document.msFullscreenElement?b="msFullscreenElement":document.mozFullScreen&&(b="mozFullScreen"))},getStreamId:function(){return I.id},addTextTrack:function(e){i.push(e)},addCaptions:k,createTracks:function(){i.sort((function(e,t){return e.index-t.index})),g=x.getTTMLRenderingDiv(),y=x.getVttRenderingDiv();for(var e,t,n,r,l,c,d=-1,p=0;p<i.length;p++){var f=(t=(e=i[p]).kind,n=void 0!==e.id?e.id:e.lang,r=e.lang,l=e.isTTML,c=e.isEmbedded,x.addTextTrack(t,n,r,l,c));a.push(f),i[p].defaultTrack&&(f.default=!0,d=p);var m=z(p);m&&(m.mode=o.Z.TEXT_SHOWING,g&&(i[p].isTTML||i[p].isEmbedded)?m.renderingType="html":m.renderingType="default"),k(p,0,i[p].captionData),S.trigger(h.Z.TEXT_TRACK_ADDED)}if(G.call(this,d),d>=0){S.on(h.Z.PLAYBACK_METADATA_LOADED,(function e(){var t=z(d);t&&"html"===t.renderingType&&M.call(this,t,!0),S.off(h.Z.PLAYBACK_METADATA_LOADED,e,this)}),this);for(var v=0;v<i.length;v++){var b=z(v);b&&(b.mode=v===d?o.Z.TEXT_SHOWING:o.Z.TEXT_HIDDEN,b.manualMode=v===d?o.Z.TEXT_SHOWING:o.Z.TEXT_HIDDEN)}}S.trigger(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,{index:s,tracks:i,streamId:I.id})},getCurrentTrackIdx:function(){return s},setCurrentTrackIdx:G,getTrackIdxForId:function(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return i[s]},setModeForTrackIdx:function(e,t){var n=z(e);n&&n.mode!==t&&(n.mode=t),n&&n.manualMode!==t&&(n.manualMode=t)},deleteCuesFromTrackIdx:function(e,t,n){var r=z(e);r&&Z(r,t,n)},deleteAllTextTracks:function(){for(var e=a?a.length:0,t=0;t<e;t++){var n=z(t);n&&Z.call(this,n,I.start,I.start+I.duration,!1)}a=[],i=[],v&&(clearInterval(v),v=null),T&&x&&(T.unobserve(x.getElement()),T=null),s=-1,Y.call(this)},deleteTextTrack:function(e){x.removeChild(a[e]),a.splice(e,1)},manualCueProcessing:function(e){var t=U();if(t&&t.length>0){var n=t[0].manualCueList;n&&n.length>0&&n.forEach((function(t){if(t.startTime<=e&&t.endTime>=e&&!t.isActive)t.isActive=!0,WebVTT.processCues(window,[t],y,t.cueID);else if(t.isActive&&(t.startTime>e||t.endTime<e)&&(t.isActive=!1,y))for(var n=y.childNodes,r=0;r<n.length;++r)n[r].id===t.cueID&&(y.removeChild(n[r]),--r)}))}},disableManualTracks:function(){var e=U();if(e&&e.length>0){var t=e[0].manualCueList;t&&t.length>0&&t.forEach((function(e){if(e.isActive&&(e.isActive=!1,y))for(var t=y.childNodes,n=0;n<t.length;++n)t[n].id===e.cueID&&(y.removeChild(t[n]),--n)}))}}},n=(0,d.Z)(A).getInstance().getLogger(t),t}ho.__dashjs_factory_name="TextTracks";const po=c.Z.getClassFactory(ho);function fo(){var e,t,n,r,i,o,a=this.context;function s(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(r),n=t[1].split(o);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:u(n)}}function u(e){var t={};return e.forEach((function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1],r=!1;n&&-1!=n.search(/%/)&&(r=!0,n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line="auto"===n?n:parseInt(n,10),r&&(t.snapToLines=!1)),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}})),t}function c(e,t){for(var n,i=t,o="",a="";""!==e[i]&&i<e.length;)i++;if((n=i-t)>1)for(var s=0;s<n;s++){if((a=e[t+s]).match(r)){o="";break}o+=a,s!==n-1&&(o+="\n")}else(a=e[t]).match(r)||(o=a);return o}return e={parse:function(e){var o,a,u=[];if(!e)return u;o=(e=e.split(n)).length,a=-1;for(var d=0;d<o;d++){var h=e[d];if(h.length>0&&"WEBVTT"!==h&&h.match(r)){var p=l(h),f=p.cuePoints,m=p.styles,g=c(e,d+1),y=s(f[0].replace(i,"")),v=s(f[1].replace(i,""));!isNaN(y)&&!isNaN(v)&&y>=a&&v>y?""!==g?(a=y,u.push({start:y,end:v,data:g,styles:m})):t.error("Skipping cue due to empty/malformed cue text"):t.error("Skipping cue due to incorrect cue timing")}}return u},getCaptionStyles:u},t=(0,d.Z)(a).getInstance().getLogger(e),n=/(?:\r\n|\r|\n)/gm,r=/-->/,i=/(^[\s]+|[\s]+$)/g,o=/\s\b/g,e}fo.__dashjs_factory_name="VTTParser";const mo=c.Z.getSingletonFactory(fo);function go(){var e,t;return e={parse:function(e){var n=[];return t.oncue=function(e){e.start=e.startTime,e.end=e.endTime,e.data=e.text,e.styles={align:e.align,line:e.line,position:e.position,size:e.size},n.push(e)},t.parse(e),n}},function(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(t=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch(e){}}(),e}go.__dashjs_factory_name="VttCustomRenderingParser";const yo=c.Z.getSingletonFactory(go);function vo(){var e,t,n=this.context,r=(0,l.Z)(n).getInstance(),i=0;return e={parse:function(e,n,o,a,s){var l,c,d,p="",f=[],m={},g={},y="",v="",b={onOpenTag:function(e,n,i){if(i[" imagetype"]&&!i[" imageType"]&&(r.trigger(h.Z.CONFORMANCE_VIOLATION,{level:$t.LEVELS.ERROR,event:$t.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),i[" imageType"]=i[" imagetype"]),"image"===n&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!i[" imageType"]||"PNG"!==i[" imageType"].value)return void t.warn("smpte-tt imageType != PNG. Discarded");y=i["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){y&&(g[y]=v.trim()),v="",y=""},onText:function(e){y&&(v+=e)}};if(!e)throw p="no ttml data to parse",new Error(p);m.data=e,r.trigger(u.Z.TTML_TO_PARSE,m);var _=(0,lo.fromXML)(m.data,(function(e){p=e}),b);r.trigger(u.Z.TTML_PARSED,{ttmlString:m.data,ttmlDoc:_});var E,w=_.getMediaTimeEvents();for(d=0;d<w.length;d++){var T=(0,lo.generateISD)(_,w[d],(function(e){p=e}));T.contents.some((function(e){return e.contents.length}))&&(l=w[d]+n)<(c=w[d+1]+n)&&f.push({start:l,end:c,type:"html",cueID:(E="cue_TTML_"+i,i++,E),isd:T,images:s,embeddedImages:g})}if(""!==p)throw t.error(p),new Error(p);return f}},t=(0,d.Z)(n).getInstance().getLogger(e),e}vo.__dashjs_factory_name="TTMLParser";const bo=c.Z.getSingletonFactory(vo);function _o(e){var t,n,r,i,a,s,c,d,p,f,m,g,y=this.context,v=e.adapter,b=e.errHandler,_=e.manifestModel,E=e.mediaController,w=e.videoModel,T=e.settings;function A(e){var t=e.tracks,r=e.index,i=e.streamId;if(!1===T.get().streaming.text.defaultEnabled&&!I()||g)R(i,-1);else{var a=E.getCurrentTrackFor(o.Z.TEXT,i);if(a){var s={lang:a.lang,role:a.roles[0],index:a.index,codec:a.codec,accessibility:a.accessibility[0]};t.some((function(e,t){if(E.matchSettings(s,e))return R(i,t),r=t,!0}))}p=!1}n[i].lastEnabledIndex=r,d.trigger(h.Z.TEXT_TRACKS_ADDED,{enabled:I(),index:r,tracks:t,streamId:i}),m=!0}function S(e){try{var t=e.streamId;if(!i[t]||isNaN(e.time))return;i[t].manualCueProcessing(e.time)}catch(e){}}function x(e){try{var t=e.streamId;if(!i[t])return;i[t].disableManualTracks()}catch(e){}}function I(){var e=!0;return p&&!f&&(e=!1),e}function R(e,t){(p=-1===t)&&E&&E.saveTextSettingsDisabled();var n=C(e);if(n!==t&&i[e]){i[e].disableManualTracks(),i[e].setModeForTrackIdx(n,o.Z.TEXT_HIDDEN),i[e].setCurrentTrackIdx(t),i[e].setModeForTrackIdx(t,o.Z.TEXT_SHOWING);var a=i[e].getCurrentTrackInfo();a&&a.isFragmented&&!a.isEmbedded?function(e,t,n){if(r[e])for(var a=r[e].getConfig().fragmentedTracks,s=0;s<a.length;s++){var l=a[s];if(t.lang===l.lang&&(l.id?t.id===l.id:t.index===l.index)){var c=E.getCurrentTrackFor(o.Z.TEXT,e);(l.id?c.id!==l.id:c.index!==l.index)?(i[e].deleteCuesFromTrackIdx(n),r[e].setCurrentFragmentedTrackIdx(s)):-1===n&&d.trigger(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:e,mediaType:o.Z.TEXT})}}}(e,a,n):a&&!a.isFragmented&&function(e,t){d.trigger(u.Z.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:t},{streamId:e,mediaType:o.Z.TEXT})}(e,a),E.setTrack(a)}}function C(e){return i[e].getCurrentTrackIdx()}function M(){r={},i={},n={},p=!0,m=!1,g=!1}return t={deactivateStream:function(e){if(e){var t=e.id;r[t]&&r[t].resetMediaInfos(),i[t]&&i[t].deleteAllTextTracks()}},initialize:function(){d.on(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,A,t),T.get().streaming.text.webvtt.customRenderingEnabled&&(d.on(u.Z.PLAYBACK_TIME_UPDATED,S,t),d.on(u.Z.PLAYBACK_SEEKING,x,t))},initializeForStream:function(e){var t=e.id,o=po(y).create({videoModel:w,settings:T,streamInfo:e});o.initialize(),i[t]=o;var l=so(y).create({errHandler:b,adapter:v,manifestModel:_,mediaController:E,videoModel:w,textTracks:o,vttParser:a,vttCustomRenderingParser:s,ttmlParser:c,streamInfo:e,settings:T});l.initialize(),r[t]=l,n[t]={},n[t].lastEnabledIndex=-1},createTracks:function(e){var t=e.id;i[t]&&i[t].createTracks()},getTextSourceBuffer:function(e){var t=e.id;if(r&&r[t])return r[t]},getAllTracksAreDisabled:function(){return p},addEmbeddedTrack:function(e,t){var n=e.id;r[n]&&r[n].addEmbeddedTrack(t)},enableText:function(e,t){return(0,W.PS)(t,"boolean"),I()!==t&&(t&&R(e,n[e].lastEnabledIndex),t||(n[e].lastEnabledIndex=C(e),m?R(e,-1):g=!0)),!0},isTextEnabled:I,setTextTrack:R,getCurrentTrackIdx:C,enableForcedTextStreaming:function(e){return(0,W.PS)(e,"boolean"),f=e,!0},addMediaInfosToBuffer:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.id;r[o]&&r[o].addMediaInfos(t,n,i)},reset:function(){M(),d.off(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,A,t),T.get().streaming.text.webvtt.customRenderingEnabled&&(d.off(u.Z.PLAYBACK_TIME_UPDATED,S,t),d.off(u.Z.PLAYBACK_SEEKING,x,t)),Object.keys(r).forEach((function(e){r[e].resetEmbedded(),r[e].reset()}))}},f=!1,m=!1,g=!1,a=mo(y).getInstance(),s=yo(y).getInstance(),c=bo(y).getInstance(),d=(0,l.Z)(y).getInstance(),M(),t}_o.__dashjs_factory_name="TextController";const Eo=c.Z.getClassFactory(_o);function wo(){var e,t,n,r,p,m,g,y,v,b,_,E,T,A,S,C,M,L,P,D,O,N,k,F,B,U,z,G,V,j,H,Z,q,Y,X,Q,J,ee,te,ne="You must first call initialize() and set a source before calling this method",re="You must first call initialize() and set a valid source and view before calling this method",ie="You must first call attachView() to set the video element before calling this method",oe="You must first call attachSource() with a valid source before calling this method",ae="MediaPlayer not initialized!",se=this.context,le=(0,l.Z)(se).getInstance(),ue=(0,I.Z)(se).getInstance(),ce=(0,d.Z)(se).getInstance({settings:ue});function de(){Se(null),Te(null),r=null,A&&(A.reset(),A=null),S&&(S.reset(),S=null),D&&D.reset(),ue.reset(),M&&(M.reset(),M=null)}function he(){return!!n&&!!Q.getElement()}function pe(){return(0,hi.e)()}function fe(){if(!g)throw re;return G.isPaused()}function me(){if(!g)throw re;return G.getIsDynamic()}function ge(e){var t=B&&B.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO,n=Z.getCurrentDVRInfo(t);if(!n)return 0;var r=G.getOriginalLiveDelay(),i=n.range.start+e;return i>n.range.end-r&&(i=n.range.end-r),i}function ye(e){if(!g)throw re;var t=we().currentTime;if(void 0!==e)t=B.getTimeRelativeToStreamId(t,e);else if(G.getIsDynamic()){var n=B&&B.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO,r=Z.getCurrentDVRInfo(n);t=null===r||0===t?0:Math.max(0,t-r.range.start)}return t}function ve(){if(!g)throw re;var e=we().duration;if(G.getIsDynamic()){var t=B&&B.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO,n=Z.getCurrentDVRInfo(t);e=n?n.range.end-n.range.start:0}return e}function be(e){(0,W.PS)(e,"boolean"),y=e}function _e(){D.restoreDefaultUTCTimingSources()}function Ee(){return Z}function we(){if(!Q.getElement())throw ie;return Q.getElement()}function Te(e){if(!p)throw ae;Q.setElement(e),e&&(Ce(),function(){if(!S){var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(se).create();S=t.createMetricsReporting({debug:ce,eventBus:le,mediaElement:we(),adapter:L,dashMetrics:Z,mediaPlayerModel:P,events:u.Z,constants:o.Z,metricsConstants:s.Z})}}}(),function(){if(!C){var e=dashjs.MssHandler;"function"==typeof e&&(x.extend(e.errors),C=e(se).create({eventBus:le,mediaPlayerModel:P,dashMetrics:Z,manifestModel:q,playbackController:G,streamController:B,protectionController:A,baseURLController:N,errHandler:O,events:u.Z,constants:o.Z,debug:ce,initSegmentType:R.w.INIT_SEGMENT_TYPE,BASE64:Xi,ISOBoxer:Qi,settings:ue}))}}(),B&&B.switchToVideoElement(v)),g&&Ie(),Pe(v)}function Ae(e){if(!m)throw ne;var t=B.getActiveStreamInfo();return t?T.getTracksFor(e,t.id):[]}function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;if(!p)throw ae;"string"==typeof e&&J.initialize(e),null==t&&(t=NaN),isNaN(t)||(t=Math.max(0,t)),v=t,n=e,(m||g)&&Ie(),he()&&Pe(v)}function xe(){if(!m)throw ne;var e=B.getActiveStreamInfo();return e?B.getStreamById(e.id):null}function Ie(){g=!1,m=!1,L.reset(),B.reset(),z.reset(),H.reset(),G.reset(),V.reset(),j.reset(),b.reset(),T.reset(),te.reset(),A&&(ue.get().streaming.protection.keepProtectionMediaKeys?A.stop():(A.reset(),A=null,Ce())),U.reset(),Y.reset(),X.reset()}function Re(){return Rr(se).create({debug:ce,errHandler:O,dashMetrics:Z,mediaPlayerModel:P,requestModifier:(0,K.Z)(se).getInstance(),mssHandler:C,settings:ue})}function Ce(){if(A)return A;var e=dashjs.Protection;if("function"==typeof e){var t=e(se).create();return u.Z.extend(e.events),h.Z.extend(e.events,{publicOnly:!0}),x.extend(e.errors),k||(k=(0,Lr.Z)(se).getInstance()),A=t.createProtectionSystem({debug:ce,errHandler:O,videoModel:Q,customParametersModel:D,capabilities:k,eventBus:le,events:u.Z,BASE64:Xi,constants:o.Z,cmcdModel:Y,settings:ue})}return null}function Me(){if(!p)throw ae;if(M)return M;var e=dashjs.OfflineController;if("function"==typeof e){u.Z.extend(e.events),h.Z.extend(e.events,{publicOnly:!0}),x.extend(e.errors);var t=Re(),n=Vt(se).create();return n.setConfig({manifestModel:q,adapter:L,manifestLoader:t,errHandler:O,contentSteeringController:j}),M=e(se).create({debug:ce,manifestUpdater:n,baseURLController:N,manifestLoader:t,manifestModel:q,mediaPlayerModel:P,abrController:b,playbackController:G,adapter:L,errHandler:O,dashMetrics:Z,timelineConverter:E,segmentBaseController:te,schemeLoaderFactory:_,eventBus:le,events:u.Z,errors:x,constants:o.Z,settings:ue,dashConstants:a.Z,urlUtils:(0,$.Z)(se).getInstance()})}return null}function Le(e){var t=B&&B.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO,n=Z.getCurrentDVRInfo(t);return n?e+(n.manifestInfo.availableFrom.getTime()/1e3+n.range.start):0}function Pe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN;M&&M.resetRecords(),!m&&n&&(m=!0,t.info("Streaming Initialized"),function(){var e=Re();B||(B=Jt(se).getInstance()),U||(U=Eo(se).create({errHandler:O,manifestModel:q,adapter:L,mediaController:T,videoModel:Q,settings:ue})),F.setConfig({capabilities:k,customParametersModel:D,adapter:L,settings:ue,manifestModel:q,errHandler:O}),B.setConfig({capabilities:k,capabilitiesFilter:F,manifestLoader:e,manifestModel:q,mediaPlayerModel:P,customParametersModel:D,protectionController:A,textController:U,adapter:L,dashMetrics:Z,errHandler:O,timelineConverter:E,videoModel:Q,playbackController:G,serviceDescriptionController:V,contentSteeringController:j,abrController:b,mediaController:T,settings:ue,baseURLController:N,uriFragmentModel:J,segmentBaseController:te}),z.setConfig({settings:ue,playbackController:G,streamController:B,videoModel:Q,timelineConverter:E,adapter:L}),G.setConfig({streamController:B,serviceDescriptionController:V,dashMetrics:Z,adapter:L,videoModel:Q,timelineConverter:E,settings:ue}),H.setConfig({streamController:B,playbackController:G,mediaPlayerModel:P,videoModel:Q,settings:ue}),b.setConfig({streamController:B,domStorage:ee,mediaPlayerModel:P,customParametersModel:D,cmsdModel:X,dashMetrics:Z,adapter:L,videoModel:Q,settings:ue}),Y.setConfig({abrController:b,dashMetrics:Z,playbackController:G}),X.setConfig({}),b.initialize(),B.initialize(y,r),U.initialize(),z.initialize(),H.initialize(),Y.initialize(),X.initialize(),j.initialize(),te.initialize()}(),"string"==typeof n?B.load(n,e):B.loadWithManifest(n,e)),!g&&he()&&(g=!0,t.info("Playback Initialized"))}return e={initialize:function(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NaN;k||(k=(0,Lr.Z)(se).getInstance()).setConfig({settings:ue}),O||(O=Mr(se).getInstance()),k.supportsMediaSource()?(p||(p=!0,E=$i(se).getInstance(),b||(b=ei(se).getInstance()).setConfig({settings:ue}),_||(_=ht(se).getInstance()),G||(G=f(se).getInstance()),T||(T=mn(se).getInstance()),B||(B=Jt(se).getInstance()),z||(z=tn(se).getInstance()),H||(H=rn(se).getInstance()),V||(V=un(se).getInstance()),j||(j=Bt(se).getInstance()),F||(F=Dr(se).getInstance()),L=Li(se).getInstance(),q=Br(se).getInstance(),Y=Ge(se).getInstance(),X=it(se).getInstance(),Z=Yi(se).getInstance({settings:ue}),ee=di(se).getInstance({settings:ue}),L.setConfig({constants:o.Z,cea608parser:i(),errHandler:O,BASE64:Xi}),N||(N=Cn(se).create()),N.setConfig({adapter:L,contentSteeringController:j}),V.setConfig({adapter:L}),te||(te=Ei(se).getInstance({dashMetrics:Z,mediaPlayerModel:P,errHandler:O,baseURLController:N,events:u.Z,eventBus:le,debug:ce,boxParser:(0,Ct.Z)(se).getInstance(),requestModifier:(0,K.Z)(se).getInstance(),errors:x})),T.setConfig({domStorage:ee,settings:ue,customParametersModel:D}),P.setConfig({playbackController:G,serviceDescriptionController:V}),j.setConfig({adapter:L,errHandler:O,dashMetrics:Z,mediaPlayerModel:P,manifestModel:q,serviceDescriptionController:V,eventBus:le,requestModifier:(0,K.Z)(se).getInstance()}),_e(),be(void 0===r||r),Me()),e&&Te(e),n&&Se(n,a),t.info("[dash.js "+pe()+"] MediaPlayer has been initialized")):O.error(new w.Z(x.CAPABILITY_MEDIASOURCE_ERROR_CODE,x.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(k=e.capabilities),e.capabilitiesFilter&&(F=e.capabilitiesFilter),e.streamController&&(B=e.streamController),e.textController&&(U=e.textController),e.gapController&&(z=e.gapController),e.playbackController&&(G=e.playbackController),e.serviceDescriptionController&&(V=e.serviceDescriptionController),e.contentSteeringController&&(j=e.contentSteeringController),e.catchupController&&(H=e.catchupController),e.mediaPlayerModel&&(P=e.mediaPlayerModel),e.customParametersModel&&(D=e.customParametersModel),e.abrController&&(b=e.abrController),e.schemeLoaderFactory&&(_=e.schemeLoaderFactory),e.mediaController&&(T=e.mediaController),e.settings&&(ue=e.settings))},on:function(e,t,n,r){le.on(e,t,n,r)},off:function(e,t,n){le.off(e,t,n)},extend:function(e,t,n){c.Z.extend(e,t,n,se)},attachView:Te,attachSource:Se,isReady:he,preload:function(){if(!Q.getElement()&&!m){if(!n)throw oe;Pe(v)}},play:function(){if(!g)throw re;(!y||fe()&&g)&&G.play(!0)},isPaused:fe,pause:function(){if(!g)throw re;G.pause()},isSeeking:function(){if(!g)throw re;return G.isSeeking()},isDynamic:me,getLowLatencyModeEnabled:function(){if(!g)throw re;return G.getLowLatencyModeEnabled()},seek:function(e){if(!g)throw re;if((0,W.PS)(e,"number"),isNaN(e))throw o.Z.BAD_ARGUMENT_ERROR;e<0&&(e=0);var t=G.getIsDynamic()?ge(e):e,n=we();!G.getIsDynamic()&&n.duration&&(t=Math.min(n.duration,t)),G.seek(t,!1,!1,!0)},seekToOriginalLive:function(){g&&me()&&G.seekToOriginalLive()},setPlaybackRate:function(e){we().playbackRate=e},getPlaybackRate:function(){return we().playbackRate},setMute:function(e){(0,W.PS)(e,"boolean"),we().muted=e},isMuted:function(){return we().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw o.Z.BAD_ARGUMENT_ERROR;we().volume=e},getVolume:function(){return we().volume},time:ye,duration:ve,timeAsUTC:function(){if(!g)throw re;return ye()<0?NaN:Le(ye())},durationAsUTC:function(){if(!g)throw re;return Le(ve())},getActiveStream:xe,getDVRWindowSize:function(){var e=B&&B.hasVideoTrack()?o.Z.VIDEO:o.Z.AUDIO,t=Z.getCurrentDVRInfo(e);return t?t.manifestInfo.dvrWindowSize:0},getDVRSeekOffset:ge,getAvailableBaseUrls:function(){var e=q.getValue();return e?N.getBaseUrls(e):[]},getAvailableLocations:function(){var e=q.getValue();if(!e)return[];var t=L.getLocation(e),n=j.getSynthesizedLocationElements(t);return t.concat(n)},getTargetLiveDelay:function(){if(!g)throw re;return G.getOriginalLiveDelay()},convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),o=i.toLocaleDateString(t),a=i.toLocaleTimeString(t,{hour12:n});return r?a+" "+o:a},getVersion:pe,getDebug:function(){return ce},getBufferLength:function(e){var n=[o.Z.VIDEO,o.Z.AUDIO,o.Z.TEXT];if(e)return-1!==n.indexOf(e)?Ee().getCurrentBufferLevel(e)||NaN:(t.warn("getBufferLength requested for invalid type"),NaN);var r=n.map((function(e){return Ae(e).length>0?Ee().getCurrentBufferLevel(e):Number.MAX_VALUE})).reduce((function(e,t){return Math.min(e,t)}));return r===Number.MAX_VALUE?NaN:r},getTTMLRenderingDiv:function(){return Q?Q.getTTMLRenderingDiv():null},getVideoElement:we,getSource:function(){if(!n)throw oe;return n},updateSource:function(e){n=e,B.load(n)},getCurrentLiveLatency:function(){if(!p)throw ae;return g?G.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!m)throw ne;return b.getTopBitrateInfoFor(e)},setAutoPlay:be,getAutoPlay:function(){return y},getDashMetrics:Ee,getQualityFor:function(e){if(!m)throw ne;if(e===o.Z.IMAGE){var t=xe();if(!t)return-1;var n=t.getThumbnailController();return n?n.getCurrentTrackIndex():-1}return b.getQualityFor(e)},setQualityFor:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!m)throw ne;if(e===o.Z.IMAGE){var r=xe();if(!r)return;var i=r.getThumbnailController();i&&i.setTrackByIndex(t)}b.setPlaybackQuality(e,B.getActiveStreamInfo(),t,{forceReplace:n})},updatePortalSize:function(){b.setElementSize(),b.setWindowResizeEventCalled(!0)},enableText:function(e){var t=B.getActiveStreamInfo();return!(!t||!U)&&U.enableText(t.id,e)},enableForcedTextStreaming:function(e){return!(!B.getActiveStreamInfo()||!U)&&U.enableForcedTextStreaming(e)},isTextEnabled:function(){var e=B.getActiveStreamInfo();return!(!e||!U)&&U.isTextEnabled(e)},setTextTrack:function(e){if(!g)throw re;var t=B.getActiveStreamInfo();t&&U&&U.setTextTrack(t.id,e)},getBitrateInfoListFor:function(e){if(!m)throw ne;var t=xe();return t?t.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!m)throw ne;return L.getStreamsInfo(e)},getTracksFor:Ae,getTracksForTypeFromManifest:function(e,t,n){if(!m)throw ne;return(n=n||L.getStreamsInfo(t,1)[0])?L.getAllMediaInfoForType(n,e,t):[]},getCurrentTrackFor:function(e){if(!m)throw ne;var t=B.getActiveStreamInfo();return T.getCurrentTrackFor(e,t.id)},setInitialMediaSettingsFor:function(e,t){if(!p)throw ae;T.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!p)throw ae;return T.getInitialSettings(e)},setCurrentTrack:function(e){if(!m)throw ne;T.setTrack(e)},addABRCustomRule:function(e,t,n){D.addAbrCustomRule(e,t,n)},removeABRCustomRule:function(e){D.removeAbrCustomRule(e)},removeAllABRCustomRule:function(){D.removeAllAbrCustomRule()},getABRCustomRules:function(){return D.getAbrCustomRules()},getAverageThroughput:function(e){var t=b.getThroughputHistory(),n=G.getIsDynamic();return t?t.getAverageThroughput(e,n):0},retrieveManifest:function(e,t){var n=Re(),r=this;le.on(u.Z.INTERNAL_MANIFEST_LOADED,(function e(i){i.error?t(null,i.error):t(i.manifest),le.off(u.Z.INTERNAL_MANIFEST_LOADED,e,r),n.reset()}),r),J.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){D.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){D.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){D.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:_e,setXHRWithCredentialsForType:function(e,t){D.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return D.getXHRWithCredentialsForType(e)},getProtectionController:function(){return Ce()},attachProtectionController:function(e){A=e},setProtectionData:function(e){r=e,B&&B.setProtectionData(r)},registerLicenseRequestFilter:function(e){D.registerLicenseRequestFilter(e)},registerLicenseResponseFilter:function(e){D.registerLicenseResponseFilter(e)},unregisterLicenseRequestFilter:function(e){D.unregisterLicenseRequestFilter(e)},unregisterLicenseResponseFilter:function(e){D.unregisterLicenseResponseFilter(e)},registerCustomCapabilitiesFilter:function(e){D.registerCustomCapabilitiesFilter(e)},unregisterCustomCapabilitiesFilter:function(e){D.unregisterCustomCapabilitiesFilter(e)},setCustomInitialTrackSelectionFunction:function(e){D.setCustomInitialTrackSelectionFunction(e)},resetCustomInitialTrackSelectionFunction:function(){D.resetCustomInitialTrackSelectionFunction(null)},attachTTMLRenderingDiv:function(e){if(!Q.getElement())throw ie;Q.setTTMLRenderingDiv(e)},attachVttRenderingDiv:function(e){if(!Q.getElement())throw ie;Q.setVttRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=B.getActiveStreamInfo();if(e&&U)return U.getCurrentTrackIdx(e.id)},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var n=G.getIsDynamic()?ge(e):e,r=B.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i)return i.provide(n,t);t(null)}else t(null)}},getDashAdapter:function(){return L},getOfflineController:function(){return Me()},triggerSteeringRequest:function(){if(j)return j.loadSteeringData()},getCurrentSteeringResponseData:function(){if(j)return j.getCurrentSteeringResponseData()},getSettings:function(){return ue.get()},updateSettings:function(e){ue.update(e)},resetSettings:function(){ue.reset()},reset:de,destroy:function(){de(),c.Z.deleteSingletonInstances(se)}},t=ce.getLogger(e),p=!1,g=!1,m=!1,y=!0,v=NaN,A=null,M=null,r=null,L=null,te=null,u.Z.extend(h.Z),P=Gr(se).getInstance(),D=(0,st.Z)(se).getInstance(),Q=ri(se).getInstance(),J=kr(se).getInstance(),e}wo.__dashjs_factory_name="MediaPlayer";var To=c.Z.getClassFactory(wo);To.events=h.Z,To.errors=x,c.Z.updateClassFactory(wo.__dashjs_factory_name,To);const Ao=To},8825:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}n.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=a(t);if(n){var i=a(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return o(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=r.call(this)).AST_IN_FUTURE="astInFuture",e.BASE_URLS_UPDATED="baseUrlsUpdated",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADING_STARTED="manifestLoadingStarted",e.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_ACTIVATED="streamActivated",e.STREAM_DEACTIVATED="streamDeactivated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.CAN_PLAY_THROUGH="canPlayThrough",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_LOADED_DATA="playbackLoadedData",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e.REPRESENTATION_SWITCH="representationSwitch",e.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",e.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",e.INBAND_PRFT="inbandPrft",e}return s}(n(8342).Z))},3393:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}())},3860:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}())},8080:(e,t,n)=>{"use strict";n.d(t,{default:()=>q});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00";const i=r;var o=n(1180);function a(e){var t,n,r=(e=e||{}).eventBus,a=e.dashMetrics,s=e.metricsConstants,l=e.events;function u(e){var t=new i;if(n){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),a.addDVBErrors(t)}}function c(e){e.error||(n=e.manifest)}function d(e){u({errorcode:i.BASE_URL_CHANGED,servicelocation:e.entry})}function h(){u({errorcode:i.BECAME_REPORTER})}function p(e){var t;e.metric===s.HTTP_REQUEST&&(0===(t=e.value).responsecode||null==t.responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&u({errorcode:t.responsecode||i.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}function f(e){var t;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=i.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=i.CORRUPT_MEDIA_OTHER;break;default:return}u({errorcode:t})}return t={initialize:function(){r.on(l.MANIFEST_UPDATED,c,t),r.on(l.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,d,t),r.on(l.METRIC_ADDED,p,t),r.on(l.METRIC_UPDATED,p,t),r.on(l.PLAYBACK_ERROR,f,t),r.on(o.Z.BECAME_REPORTING_PLAYER,h,t)},reset:function(){r.off(l.MANIFEST_UPDATED,c,t),r.off(l.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,d,t),r.off(l.METRIC_ADDED,p,t),r.off(l.METRIC_UPDATED,p,t),r.off(l.PLAYBACK_ERROR,f,t),r.off(o.Z.BECAME_REPORTING_PLAYER,h,t)}}}a.__dashjs_factory_name="DVBErrorsTranslator";const s=dashjs.FactoryMaker.getSingletonFactory(a);var l=n(2295);function u(e){e=e||{};var t,n,r=!1,i=this.context,o=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach((function(e){var t=e.starttime,r=t+e.duration;n.add(t,r)})),r=!!e[0]._useWallClockTime)},reset:function(){n.clear()},isEnabled:function(){var e,t=n.length;if(!t)return!0;e=r?(new Date).getTime()/1e3:o.currentTime;for(var i=0;i<t;i+=1){var a=n.start(i),s=n.end(i);if(a<=e&&e<s)return!0}return!1}},n=(0,l.Z)(i).create(),t}u.__dashjs_factory_name="RangeController";const c=dashjs.FactoryMaker.getClassFactory(u);function d(){return{serialise:function e(t){var n,r,i=[],o=[];for(n in t)if(t.hasOwnProperty(n)&&0!==n.indexOf("_")){if(null==(r=t[n])&&(r=""),Array.isArray(r)){if(!r.length)continue;o=[],r.forEach((function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);o.push(n?t:e(t))})),r=o.map(encodeURIComponent).join(",")}else"string"==typeof r?r=encodeURIComponent(r):r instanceof Date?r=r.toISOString():"number"==typeof r&&(r=Math.round(r));i.push(n+"="+r)}return i.join("&")}}}d.__dashjs_factory_name="MetricSerialiser";const h=dashjs.FactoryMaker.getSingletonFactory(d);function p(){var e,t,n,r=window.crypto||window.msCrypto,i=Uint32Array,o=Math.pow(2,8*i.BYTES_PER_ELEMENT)-1;function a(){r&&(e||(e=new i(10)),r.getRandomValues(e),t=0)}return n={random:function(n,i){var s;return n||(n=0),i||(i=1),r?(t===e.length&&a(),s=e[t]/o,t+=1):s=Math.random(),s*(i-n)+n}},a(),n}p.__dashjs_factory_name="RNG";const f=dashjs.FactoryMaker.getSingletonFactory(p);var m=n(5717);function g(e){var t;e=e||{};var n,r,i,o,a,s,l,u=this.context,c=[],d=e.metricsConstants;function p(){o=!1,a=!1,s=null,l=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),a&&l.isEnabled()&&t.forEach((function(t){var i=n.serialise(t);e!==d.DVB_ERRORS&&(i="metricname=".concat(e,"&").concat(i)),function(e,t,n){var i=new XMLHttpRequest;i.withCredentials=r.getXHRWithCredentialsForType(d.HTTP_REQUEST_DVB_REPORTING_TYPE);var o=function(){var e=c.indexOf(i);-1!==e&&(c.splice(e,1),!(i.status>=200&&i.status<300)&&n&&n())};c.push(i);try{i.open("GET",e),i.onloadend=o,i.onerror=o,i.send()}catch(e){i.onerror()}}(i="".concat(s,"?").concat(i),0,(function(){a=!1}))}))},initialize:function(e,t){var n;if(l=t,!(s=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");o||((n=e.dvb_probability)&&(1e3===n||n/1e3>=i.random())&&(a=!0),o=!0)},reset:function(){p()}},n=h(u).getInstance(),i=f(u).getInstance(),r=(0,m.Z)(u).getInstance(),p(),t}g.__dashjs_factory_name="DVBReporting";const y=dashjs.FactoryMaker.getClassFactory(g);function v(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":y},n=this.context,r=e.debug?e.debug.getLogger(void 0):{},i=e.metricsConstants,o=e.mediaPlayerModel||{};return{create:function(e,a){var s;try{(s=t[e.schemeIdUri](n).create({metricsConstants:i,mediaPlayerModel:o})).initialize(e,a)}catch(a){s=null,r.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(e.schemeIdUri," (").concat(a.message,")"))}return s},register:function(e,n){t[e]=n},unregister:function(e){delete t[e]}}}v.__dashjs_factory_name="ReportingFactory";const b=dashjs.FactoryMaker.getSingletonFactory(v);function _(e){var t=[],n=b(this.context).getInstance(e);return{initialize:function(e,r){e.some((function(e){var i=n.create(e,r);if(i)return t.push(i),!0}))},reset:function(){t.forEach((function(e){return e.reset()})),t=[]},report:function(e,n){t.forEach((function(t){return t.report(e,n)}))}}}_.__dashjs_factory_name="ReportingController";const E=dashjs.FactoryMaker.getClassFactory(_);function w(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}w.__dashjs_factory_name="HandlerHelpers";const T=dashjs.FactoryMaker.getSingletonFactory(w);function A(e){var t,n,r,i,o;e=e||{};var a=this.context,s=T(a).getInstance(),l=[],u=e.metricsConstants;function c(){var e=function(){try{return Object.keys(l).map((function(e){return l[e]})).reduce((function(e,t){return e.level<t.level?e:t}))}catch(e){return}}();e&&o!==e.t&&(o=e.t,t.report(r,e))}return{initialize:function(e,o,a){o&&(n=s.validateN(a),t=o,r=s.reconstructFullMetricName(e,a),i=setInterval(c,n))},reset:function(){clearInterval(i),i=null,n=0,t=null,o=null},handleNewMetric:function(e,t,n){e===u.BUFFER_LEVEL&&(l[n]=t)}}}A.__dashjs_factory_name="BufferLevelHandler";const S=dashjs.FactoryMaker.getClassFactory(A),x=dashjs.FactoryMaker.getClassFactory((function(e){var t,n=(e=e||{}).eventBus,r=e.metricsConstants;function i(){n.off(o.Z.METRICS_INITIALISATION_COMPLETE,i,this),n.trigger(o.Z.BECAME_REPORTING_PLAYER)}return{initialize:function(e,r){r&&(t=r,n.on(o.Z.METRICS_INITIALISATION_COMPLETE,i,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===r.DVB_ERRORS&&t&&t.report(e,n)}}}));function I(e){var t,n,r,i,o;e=e||{};var a=[],s=T(this.context).getInstance(),l=e.metricsConstants;function u(){var e=a;e.length&&t&&t.report(i,e),a=[]}return{initialize:function(e,a,l,c){a&&(n=s.validateN(l),t=a,c&&c.length&&(r=c),i=s.reconstructFullMetricName(e,l,c),o=setInterval(u,n))},reset:function(){clearInterval(o),o=null,n=null,r=null,a=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(r&&r!==t.type||a.push(t))}}}I.__dashjs_factory_name="HttpListHandler";const R=dashjs.FactoryMaker.getClassFactory(I);function C(){var e,t;return{initialize:function(n,r){e=n,t=r},reset:function(){t=null,e=void 0},handleNewMetric:function(n,r){n===e&&t&&t.report(e,r)}}}C.__dashjs_factory_name="GenericMetricHandler";const M=dashjs.FactoryMaker.getClassFactory(C);function L(e){var t=(e=e||{}).debug?e.debug.getLogger(void 0):{},n=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,r=this.context,i={BufferLevel:S,DVBErrors:x,HttpList:R,PlayList:M,RepSwitchList:M,TcpList:M};return{create:function(o,a){var s,l=o.match(n);if(l){try{(s=i[l[1]](r).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(l[1],a,l[3],l[5])}catch(e){s=null,t.error("MetricsHandlerFactory: Could not create handler for type ".concat(l[1]," with args ").concat(l[3],", ").concat(l[5]," (").concat(e.message,")"))}return s}},register:function(e,t){i[e]=t},unregister:function(e){delete i[e]}}}L.__dashjs_factory_name="MetricsHandlerFactory";const P=dashjs.FactoryMaker.getSingletonFactory(L);function D(e){e=e||{};var t,n=[],r=this.context,i=e.eventBus,o=e.events,a=P(r).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function s(e){n.forEach((function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)}))}return t={initialize:function(e,r){e.split(",").forEach((function(e,t,i){var o;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var s=i[t+1];s&&-1===s.indexOf("(")&&-1!==s.indexOf(")")&&(e+=","+s,delete i[t+1])}(o=a.create(e,r))&&n.push(o)})),i.on(o.METRIC_ADDED,s,t),i.on(o.METRIC_UPDATED,s,t)},reset:function(){i.off(o.METRIC_ADDED,s,t),i.off(o.METRIC_UPDATED,s,t),n.forEach((function(e){return e.reset()})),n=[]}}}D.__dashjs_factory_name="MetricsHandlersController";const O=dashjs.FactoryMaker.getClassFactory(D);function N(e){var t,n,r;e=e||{};var i=this.context;function o(){t&&t.reset(),n&&n.reset(),r&&r.reset()}return{initialize:function(a){try{(r=c(i).create({mediaElement:e.mediaElement})).initialize(a.Range),(n=E(i).create({debug:e.debug,metricsConstants:e.metricsConstants,mediaPlayerModel:e.mediaPlayerModel})).initialize(a.Reporting,r),(t=O(i).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(a.metrics,n)}catch(e){throw o(),e}},reset:o}}N.__dashjs_factory_name="MetricsController";const k=dashjs.FactoryMaker.getClassFactory(N),F=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]},B=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1},U=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3};function z(e){var t=(e=e||{}).adapter,n=e.constants;return{getMetrics:function(e){var r=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach((function(i){var o=new F,a=t.getIsDynamic(e);i.hasOwnProperty("metrics")&&(o.metrics=i.metrics,i.Range_asArray&&i.Range_asArray.forEach((function(r){var i=new B;i.starttime=function(e,r,i){var o,a,s=0;return r?s=t.getAvailabilityStartTime(e)/1e3:(o=t.getRegularPeriods(e)).length&&(s=o[0].start),a=s,i&&i.hasOwnProperty(n.START_TIME)&&(a+=i.starttime),a}(e,a,r),r.hasOwnProperty("duration")?i.duration=r.duration:i.duration=t.getDuration(e),i._useWallClockTime=a,o.Range.push(i)})),i.Reporting_asArray&&(i.Reporting_asArray.forEach((function(e){var t=new U;e.hasOwnProperty(n.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(n.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[n.DVB_REPORTING_URL]),e.hasOwnProperty(n.DVB_PROBABILITY)&&(t.dvb_probability=e[n.DVB_PROBABILITY]),o.Reporting.push(t))})),r.push(o)))})),r}}}z.__dashjs_factory_name="ManifestParsing";const G=dashjs.FactoryMaker.getSingletonFactory(z);function V(e){var t;e=e||{};var n={},r=this.context,i=e.eventBus,a=e.events;function s(t){if(!t.error){var a=Object.keys(n);G(r).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(t.manifest).forEach((function(t){var i=JSON.stringify(t);if(n.hasOwnProperty(i))a.splice(i,1);else try{var o=k(r).create(e);o.initialize(t),n[i]=o}catch(e){}})),a.forEach((function(e){n[e].reset(),delete n[e]})),i.trigger(o.Z.METRICS_INITIALISATION_COMPLETE)}}function l(){Object.keys(n).forEach((function(e){n[e].reset()})),n={}}return t={reset:function(){i.off(a.MANIFEST_UPDATED,s,t),i.off(a.STREAM_TEARDOWN_COMPLETE,l,t)}},i.on(a.MANIFEST_UPDATED,s,t),i.on(a.STREAM_TEARDOWN_COMPLETE,l,t),t}V.__dashjs_factory_name="MetricsCollectionController";const j=dashjs.FactoryMaker.getClassFactory(V);function H(){var e=this.context;return{createMetricsReporting:function(t){return s(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}).initialize(),j(e).create(t)},getReportingFactory:function(){return b(e).getInstance()},getMetricsHandlerFactory:function(){return P(e).getInstance()}}}H.__dashjs_factory_name="MetricsReporting";var Z=dashjs.FactoryMaker.getClassFactory(H);Z.events=o.Z,dashjs.FactoryMaker.updateClassFactory(H.__dashjs_factory_name,Z);const q=Z},1180:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}n.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=a(t);if(n){var i=a(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return o(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=r.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return s}(n(8342).Z))},5717:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(2610),i=n(5448),o=n(1264),a=n(3106),s=n(1767),l=n(3393);function u(){var e,t,n,i,u,c,d,h,p=this.context,f=(0,o.Z)(p).getInstance();function m(){i=[],u=[],c=[],h=[],d=null,t=[]}function g(e,t){var n=-1;e.some((function(e,r){if(e===t)return n=r,!0})),n<0||e.splice(n,1)}function y(e){var t;for(t=0;t<h.length;t++)if(h[t].rulename===e)return t;return-1}function v(e,n){b(e,n);var i=new r.Z;i.schemeIdUri=e,i.value=n,t.push(i)}function b(e,n){(0,a.PS)(e,"string"),(0,a.PS)(n,"string"),t.forEach((function(r,i){r.schemeIdUri===e&&r.value===n&&t.splice(i,1)}))}return e={getCustomInitialTrackSelectionFunction:function(){return d},setCustomInitialTrackSelectionFunction:function(e){d=e},resetCustomInitialTrackSelectionFunction:function(){d=null},getLicenseResponseFilters:function(){return u},getLicenseRequestFilters:function(){return i},getCustomCapabilitiesFilters:function(){return c},registerCustomCapabilitiesFilter:function(e){c.push(e)},registerLicenseResponseFilter:function(e){u.push(e)},registerLicenseRequestFilter:function(e){i.push(e)},unregisterCustomCapabilitiesFilter:function(e){g(c,e)},unregisterLicenseResponseFilter:function(e){g(u,e)},unregisterLicenseRequestFilter:function(e){g(i,e)},addAbrCustomRule:function(e,t,n){if("string"!=typeof e||e!==s.Z.ABANDON_FRAGMENT_RULES&&e!==s.Z.QUALITY_SWITCH_RULES||"string"!=typeof t)throw l.Z.BAD_ARGUMENT_ERROR;var r=y(t);-1===r?h.push({type:e,rulename:t,rule:n}):(h[r].type=e,h[r].rule=n)},removeAllAbrCustomRule:function(){h=[]},removeAbrCustomRule:function(e){if(e){var t=y(e);-1!==t&&h.splice(t,1)}else h=[]},getAbrCustomRules:function(){return h},addUTCTimingSource:v,removeUTCTimingSource:b,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){var e=f.get().streaming.utcSynchronization.defaultTimingSource;v(e.scheme,e.value)},setXHRWithCredentialsForType:function e(t,r){t?n[t]=!!r:Object.keys(n).forEach((function(t){e(t,r)}))},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t},setConfig:function(){},reset:function(){m()}},n={default:!1},m(),e}u.__dashjs_factory_name="CustomParametersModel";const c=i.Z.getSingletonFactory(u)},9032:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5448),i=n(7473);function o(e){var t=(e=e||{}).requestModifier;function n(e){var n=new Date,r=e.request,i=new XMLHttpRequest;if(i.open(e.method,e.url,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=n),t&&t.modifyRequestHeader&&(i=t.modifyRequestHeader(i,{url:e.url})),e.headers)for(var o in e.headers){var a=e.headers[o];a&&i.setRequestHeader(o,a)}i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.ontimeout=e.ontimeout,i.timeout=e.timeout,i.send(),e.response=i}return{load:function(e){t&&t.modifyRequest?(0,i.k)(e,t).then((function(){return n(e)})):n(e)},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}o.__dashjs_factory_name="XHRLoader";const a=r.Z.getClassFactory(o)},1737:(e,t,n)=>{"use strict";n.d(t,{default:()=>ve});var r={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};const i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"!==r.schemeIdUri.toLowerCase()||"cenc"!==r.value.toLowerCase()&&"cbcs"!==r.value.toLowerCase()||(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return t&&r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,o,a=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(o=t.getUint8(r))||1===o){r++,r+=3,a="";var l=void 0,u=void 0;for(l=0;l<4;l++)a+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=4,a+="-",l=0;l<2;l++)a+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=2,a+="-",l=0;l<2;l++)a+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=2,a+="-",l=0;l<2;l++)a+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=2,a+="-",l=0;l<6;l++)a+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;r+=6,r+=4,n[a=a.toLowerCase()]=t.buffer.slice(s,i),r=i}else r=i;else r=i}return n}},{key:"getLicenseServerUrlFromMediaInfo",value:function(e,t){try{if(!e||0===e.length)return null;for(var n=0,i=null;n<e.length&&!i;){var o=e[n];if(o&&o.contentProtection&&o.contentProtection.length>0){var a=o.contentProtection.filter((function(e){return e.schemeIdUri&&e.schemeIdUri===t}));if(a&&a.length>0)for(var s=0;s<a.length&&!i;){for(var l=a[s],u=0;u<r.attributes.length&&!i;){for(var c=0,d=r.attributes[u];c<r.prefixes.length&&!i;){var h=r.prefixes[c];l[d]&&l[d].__prefix&&l[d].__prefix===h&&l[d].__text&&(i=l[d].__text),c+=1}u+=1}s+=1}}n+=1}return i}catch(e){return null}}}],t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e,t),e}(),o=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n},a=function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=o};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}const c=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=u(t);if(n){var i=u(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=r.call(this)).MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return i}(n(2230).Z));var d=n(5459);const h=function e(t,n,r,i,o,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.method=n,this.responseType=r,this.headers=i,this.withCredentials=o,this.messageType=a,this.sessionId=s,this.data=l},p=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.headers=n,this.data=r};var f=n(7855),m=n(703),g=n(3393),y=n(5448);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e){var t,n,r,s,l,u,y,b,_,E,w,T=(e=e||{}).protectionKeyController,A=e.protectionModel,S=e.eventBus,x=e.events,I=e.debug,R=e.BASE64,C=e.constants,M=[],L=e.cmcdModel,P=e.settings,D=e.customParametersModel;function O(){if(!(S&&S.hasOwnProperty("on")&&T&&T.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function N(e,t){b||_?b&&k():function(e,t){if(!_){_=!0;var r,i=[];e=e.sort((function(t,n){return(l&&l[t.ks.systemString]&&l[t.ks.systemString].priority>=0?l[t.ks.systemString].priority:e.length)-(l&&l[n.ks.systemString]&&l[n.ks.systemString].priority>=0?l[n.ks.systemString].priority:e.length)}));for(var o=0;o<e.length;o++){var a=j(e[o]);i.push({ks:e[o].ks,configs:[a],protData:e[o].protData})}A.requestKeySystemAccess(i).then((function(e){var t=(r=e.data).mksa&&r.mksa.selectedSystemString?r.mksa.selectedSystemString:r.keySystem.systemString;return n.info("DRM: KeySystem Access Granted for system string ("+t+")!  Selecting key system..."),A.selectKeySystem(r)})).then((function(e){if(b=e,_=!1,A){S.trigger(x.KEY_SYSTEM_SELECTED,{data:r});var t=z(b);t&&t.serverCertificate&&t.serverCertificate.length>0&&A.setServerCertificate(R.decodeArray(t.serverCertificate).buffer),k()}})).catch((function(e){b=null,_=!1,t||S.trigger(x.KEY_SYSTEM_SELECTED,{data:null,error:new d.Z(c.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,c.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+e.error)})}))}}(e,t)}function k(){for(var e,t=0;t<r.length;t++)for(e=0;e<r[t].length;e++)if(b===r[t][e].ks){F(r[t][e]);break}r=[]}function F(e){if(T.isClearKey(b)&&e.protData&&e.protData.hasOwnProperty("clearkeys")&&0!==Object.keys(e.protData.clearkeys).length){var t={kids:Object.keys(e.protData.clearkeys)};e.initData=(new TextEncoder).encode(JSON.stringify(t))}e.sessionId?B(e):null!==e.initData&&U(e)}function B(e){O(),A.loadKeySession(e)}function U(e){var t=i.getPSSHForKeySystem(b,e?e.initData:null);if(t){if(function(e){if(!e)return!1;try{for(var t=A.getSessions(),n=0;n<t.length;n++)if(t[n].getKeyId()===e)return!0;return!1}catch(e){return!1}}(e.keyId))return;if(G(t))return;try{e.initData=t,A.createKeySession(e)}catch(e){S.trigger(x.KEY_SESSION_CREATED,{data:null,error:new d.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e&&e.initData?A.createKeySession(e):S.trigger(x.KEY_SESSION_CREATED,{data:null,error:new d.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(b?b.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function z(e){if(e){var t=e.systemString;if(l)return t in l?l[t]:null}return null}function G(e){if(!e)return!1;try{for(var t=A.getAllInitData(),r=0;r<t.length;r++)if(T.initDataEquals(e,t[r]))return n.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch(e){return!1}}function V(e){O(),e?(A.setMediaElement(e),S.on(x.NEED_KEY,Q,t)):null===e&&(A.setMediaElement(e),S.off(x.NEED_KEY,Q,t))}function j(e){var t=e.protData,n=[],r=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:y,l=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:y,u=e.sessionType,c=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",d=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return s.forEach((function(e){e.type===C.AUDIO?n.push(new o(e.codec,i)):e.type===C.VIDEO&&r.push(new o(e.codec,l))})),new a(n,r,c,d,[u])}function H(e){e.error?S.trigger(x.KEY_STATUSES_CHANGED,{data:null,error:e.error}):n.debug("DRM: key status = "+e.status)}function Z(e){n.debug("DRM: onKeyMessage");var t=e.data;S.trigger(x.KEY_MESSAGE,{data:t});var r=t.messageType?t.messageType:"license-request",o=t.message,a=t.sessionToken,l=z(b),u=T.getLicenseServerModelInstance(b,l,r),g={sessionToken:a,messageType:r};if(o&&0!==o.byteLength){if(!u)return n.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+a.getSessionId()),void q(g);if(T.isClearKey(b)){var y=T.processClearKeyLicenseRequest(b,l,o);if(y&&y.keyPairs&&y.keyPairs.length>0)return n.debug("DRM: ClearKey license request handled by application!"),q(g),void A.updateKeySession(a,y)}!function(e,t,n){var r=e.sessionToken,o=e.messageType?e.messageType:"license-request",a={sessionToken:r,messageType:o},l=b?b.systemString:null,u=function(e,t,n,r,o){var a=null,l=r.message;if(e&&e.serverURL){var u=e.serverURL;"string"==typeof u&&""!==u?a=u:"object"===v(u)&&u.hasOwnProperty(t)&&(a=u[t])}else if(e&&e.laURL&&""!==e.laURL)a=e.laURL;else if(!(a=i.getLicenseServerUrlFromMediaInfo(s,b.schemeIdURI))&&!T.isClearKey(b)){var c=i.getPSSHData(n.initData);(a=b.getLicenseServerURLFromInitData(c))||(a=r.laURL)}return o.getServerURLFromMessage(a,l,t)}(n,o,r,e,t);if(u){var g={},y=!1;n&&K(g,n.httpRequestHeaders);var _=e.message;K(g,b.getRequestHeadersFromMessage(_)),Object.keys(g).forEach((function(e){"authorization"===e.toLowerCase()&&(y=!0)})),n&&"boolean"==typeof n.withCredentials&&(y=n.withCredentials);var E=function(e){if(A)if(e.status>=200&&e.status<=299){var n=m.Z.parseHttpHeaders(e.getAllResponseHeaders?e.getAllResponseHeaders():null),i=new p(e.responseURL,n,e.response);X(D.getLicenseResponseFilters(),i).then((function(){var n=t.getLicenseMessage(i.data,l,o);null!==n?(q(a),A.updateKeySession(r,n)):$(e,a,l,o,t)}))}else $(e,a,l,o,t)},w=function(e){q(a,new d.Z(c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+l+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},S=function(e){q(a,new d.Z(c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+l+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},x=b.getLicenseRequestFromMessage(_),I=t.getHTTPMethod(o),R=t.getResponseType(l,o),C=n&&!isNaN(n.httpTimeout)?n.httpTimeout:8e3,M=r.getSessionId()||null,L=new h(u,I,R,g,y,o,M,x),O=isNaN(P.get().streaming.retryAttempts[f.w.LICENSE])?3:P.get().streaming.retryAttempts[f.w.LICENSE];X(D.getLicenseRequestFilters(),L).then((function(){W(L,O,C,E,w,S)}))}else q(a,new d.Z(c.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,c.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}(t,u,l)}else q(g,new d.Z(c.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,c.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function q(e,t){S.trigger(x.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function W(e,t,r,i,o,a){var s=new XMLHttpRequest;if(P.get().streaming.cmcd&&P.get().streaming.cmcd.enabled&&P.get().streaming.cmcd.mode===g.Z.CMCD_MODE_QUERY){var l=L.getQueryParameter({url:e.url,type:f.w.LICENSE});l&&(e.url=m.Z.addAditionalQueryParameterToUrl(e.url,[l]))}for(var u in s.open(e.method,e.url,!0),s.responseType=e.responseType,s.withCredentials=e.withCredentials,r>0&&(s.timeout=r),e.headers)s.setRequestHeader(u,e.headers[u]);if(P.get().streaming.cmcd&&P.get().streaming.cmcd.enabled&&P.get().streaming.cmcd.mode===g.Z.CMCD_MODE_HEADER){var c=L.getHeaderParameters({url:e.url,type:f.w.LICENSE});if(c)for(var d in c){var h=c[d];h&&s.setRequestHeader(d,h)}}var p=function(){t--;var n=isNaN(P.get().streaming.retryIntervals[f.w.LICENSE])?1e3:P.get().streaming.retryIntervals[f.w.LICENSE];w=setTimeout((function(){W(e,t,r,i,o,a)}),n)};s.onload=function(){E=null,this.status>=200&&this.status<=299||t<=0?i(this):(n.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+t),p())},s.ontimeout=s.onerror=function(){E=null,t<=0?a(this):(n.warn("License request network request failed . Retrying it... Pending retries: "+t),p())},s.onabort=function(){o(this)},S.trigger(x.LICENSE_REQUEST_SENDING,{url:e.url,headers:e.headers,payload:e.data,sessionId:e.sessionId}),E=s,s.send(e.data)}function Y(){E&&(E.onloadend=E.onerror=E.onprogress=void 0,E.abort(),E=null),w&&(clearTimeout(w),w=null)}function K(e,t){if(t)for(var n in t)e[n]=t[n]}function $(e,t,n,r,i){var o="NONE",a=null;e.response&&(o=i.getErrorResponse(e.response,n,r),a={serverResponse:e.response||null,responseCode:e.status||null,responseText:e.statusText||null}),q(t,new d.Z(c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+o,a))}function X(e,t){return e?e.reduce((function(e,n){return e.then((function(){return n(t)}))}),Promise.resolve()):Promise.resolve()}function Q(e,t){if(!P.get().streaming.protection.ignoreEmeEncryptedEvent){if(n.debug("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void n.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);if(0===s.length&&(n.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))return void M.push(setTimeout((function(){Q(e,t)}),500));var o=e.key.initData;if(ArrayBuffer.isView(o)&&(o=o.buffer),b){var a=i.getPSSHForKeySystem(b,o);if(a&&G(a))return}n.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(o)));var c=T.getSupportedKeySystemsFromSegmentPssh(o,l,u);if(0===c.length)return void n.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");!function(e){r.push(e),N(e,!1)}(c)}}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");O(),s.push(e)},clearMediaInfoArray:function(){s=[]},handleKeySystemFromManifest:function(){if(s&&0!==s.length){var e=[];s.forEach((function(t){var n=T.getSupportedKeySystemsFromContentProtection(t.contentProtection,l,u);n.length>0&&(0===e.length&&(e=n),r.push(n))})),e&&e.length>0&&N(e,!0)}},createKeySession:U,loadKeySession:B,removeKeySession:function(e){O(),A.removeKeySession(e)},closeKeySession:function(e){O(),A.closeKeySession(e)},setServerCertificate:function(e){O(),A.setServerCertificate(e)},setMediaElement:V,setSessionType:function(e){u=e},setRobustnessLevel:function(e){y=e},setProtectionData:function(e){l=e,T.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return O(),T.getSupportedKeySystemsFromContentProtection(e,l,u)},getKeySystems:function(){return T?T.getKeySystems():[]},setKeySystems:function(e){T&&T.setKeySystems(e)},stop:function(){Y(),A&&A.stop()},reset:function(){S.off(x.INTERNAL_KEY_MESSAGE,Z,t),S.off(x.INTERNAL_KEY_STATUS_CHANGED,H,t),O(),Y(),V(null),b=null,_=!1,A&&(A.reset(),A=null),M.forEach((function(e){return clearTimeout(e)})),M=[],s=[],r=[]}},n=I.getLogger(t),r=[],s=[],u="temporary",y="",E=null,w=null,S.on(x.INTERNAL_KEY_MESSAGE,Z,t),S.on(x.INTERNAL_KEY_STATUS_CHANGED,H,t),t}b.__dashjs_factory_name="ProtectionController";const _=y.Z.getClassFactory(b),E=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n},w=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}var t;return(t=[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),o=i.length,a=new ArrayBuffer(o),s=new Uint8Array(a);for(e=0;e<o;e++)s[e]=i.charCodeAt(e);return a}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),T=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}());var A="e2719d58-a985-b3c9-781a-b030af78d30e",S=T.CLEARKEY_KEYSTEM_STRING,x="urn:uuid:"+A;function I(e){var t=(e=e||{}).BASE64;return{uuid:A,schemeIdURI:x,systemString:S,getInitData:function(e,n){try{var r=i.parseInitDataFromContentProtection(e,t);if(!r&&n){var o={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map((function(e){return String.fromCharCode(parseInt(e,16))})).join(""))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch(e){return null}}(n["cenc:default_KID"])]};r=(new TextEncoder).encode(JSON.stringify(o))}return r}catch(e){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e))))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],o=0;o<r.kids.length;o++){var a=r.kids[o],s=e.clearkeys&&e.clearkeys.hasOwnProperty(a)?e.clearkeys[a]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+a+") is not known!");i.push(new E(a,s))}n=new w(i)}return n}}}I.__dashjs_factory_name="KeySystemClearKey";const R=dashjs.FactoryMaker.getSingletonFactory(I);var C="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",M=T.CLEARKEY_KEYSTEM_STRING,L="urn:uuid:"+C;function P(e){var t=e.BASE64,n=e.debug.getLogger(void 0);return{uuid:C,schemeIdURI:L,systemString:M,getInitData:function(e){return i.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var r=null;if(e){for(var i=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],a=0;a<i.kids.length;a++){var s=i.kids[a],l=e.clearkeys&&e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");o.push(new E(s,l))}r=new w(o),n.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return r}}}P.__dashjs_factory_name="KeySystemW3CClearKey";const D=dashjs.FactoryMaker.getSingletonFactory(P);var O="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",N=T.WIDEVINE_KEYSTEM_STRING,k="urn:uuid:"+O;function F(e){var t=(e=e||{}).BASE64;return{uuid:O,schemeIdURI:k,systemString:N,getInitData:function(e){return i.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}}F.__dashjs_factory_name="KeySystemWidevine";const B=dashjs.FactoryMaker.getSingletonFactory(F);var U="9a04f079-9840-4286-ab92-e65be0885f95",z=T.PLAYREADY_KEYSTEM_STRING,G="urn:uuid:"+U;function V(e){var t="utf-16",n=(e=e||{}).BASE64,r=e.settings;function o(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:U,schemeIdURI:G,systemString:z,getInitData:function(e){var t,r,a,s,l,u=new Uint8Array([112,115,115,104,0,0,0,0]),c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),d=0,h=null;if(o(),!e)return null;if("pssh"in e)return i.parseInitDataFromContentProtection(e,n);if("pro"in e)h=n.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;h=n.decodeArray(e.prheader.__text)}return t=h.length,r=4+u.length+c.length+4+t,a=new ArrayBuffer(r),s=new Uint8Array(a),(l=new DataView(a)).setUint32(d,r),d+=4,s.set(u,d),d+=u.length,s.set(c,d),d+=c.length,l.setUint32(d,t),d+=4,s.set(h,d),d+=t,s.buffer},getRequestHeadersFromMessage:function(e){var n,i,o={},a=new DOMParser;if(r&&r.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return o["Content-Type"]="text/xml; charset=utf-8",o;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,s);for(var l=(i=a.parseFromString(n,"application/xml")).getElementsByTagName("name"),u=i.getElementsByTagName("value"),c=0;c<l.length;c++)o[l[c].childNodes[0].nodeValue]=u[c].childNodes[0].nodeValue;return o.hasOwnProperty("Content")&&(o["Content-Type"]=o.Content,delete o.Content),o.hasOwnProperty("Content-Type")||(o["Content-Type"]="text/xml; charset=utf-8"),o},getLicenseRequestFromMessage:function(e){var i=null,a=new DOMParser;if(r&&r.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return e;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);o();var l=String.fromCharCode.apply(null,s),u=a.parseFromString(l,"application/xml");if(!u.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var c=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return c&&(i=n.decode(c)),i},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,o=0;o<n;o++){var a=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===a){var l=e.slice(r,r+s),u=String.fromCharCode.apply(null,new Uint16Array(l)),c=i.parseFromString(u,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var d=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(c.getElementsByTagName("LUI_URL")[0]){var h=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(h)return h}}else r+=s}return null},getCDMData:function(e){var t,r,i,a;if(o(),!e)return null;for(t=[],a=0;a<e.length;++a)t.push(e.charCodeAt(a)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=n.encode(t),r='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),i=[],a=0;a<r.length;++a)i.push(r.charCodeAt(a)),i.push(0);return new Uint8Array(i).buffer},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e}}}V.__dashjs_factory_name="KeySystemPlayReady";const j=dashjs.FactoryMaker.getSingletonFactory(V);function H(e){var t=(e=e||{}).BASE64,n={};return n[T.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[T.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,r){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[r].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}H.__dashjs_factory_name="DRMToday";const Z=dashjs.FactoryMaker.getSingletonFactory(H);function q(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function n(n){if(window.DOMParser){var r=t(n),i=(new window.DOMParser).parseFromString(r,"text/xml"),o=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,a=o?o.getElementsByTagNameNS(e,"Body")[0]:null;if(a&&a.getElementsByTagNameNS(e,"Fault")[0])return null}return n}function r(n){var r="",i="",o="",a=-1,s=-1;if(window.DOMParser){var l=t(n),u=(new window.DOMParser).parseFromString(l,"text/xml"),c=u?u.getElementsByTagNameNS(e,"Envelope")[0]:null,d=c?c.getElementsByTagNameNS(e,"Body")[0]:null,h=d?d.getElementsByTagNameNS(e,"Fault")[0]:null,p=h?h.getElementsByTagName("detail")[0]:null,f=p?p.getElementsByTagName("Exception")[0]:null,m=null;if(null===h)return l;r=(m=h.getElementsByTagName("faultstring")[0].firstChild)?m.nodeValue:null,null!==f&&(i=(m=f.getElementsByTagName("StatusCode")[0])?m.firstChild.nodeValue:null,a=(o=(m=f.getElementsByTagName("Message")[0])?m.firstChild.nodeValue:null)?o.lastIndexOf("[")+1:-1,s=o?o.indexOf("]"):-1,o=o?o.substring(a,s):"")}var g="code: ".concat(i,", name: ").concat(r);return o&&(g+=", message: ".concat(o)),g}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return n.call(this,e)},getErrorResponse:function(e){return r.call(this,e)}}}q.__dashjs_factory_name="PlayReady";const W=y.Z.getSingletonFactory(q);function Y(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Y.__dashjs_factory_name="Widevine";const K=dashjs.FactoryMaker.getSingletonFactory(Y);function $(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],i=r.kid.replace(/=/g,""),o=r.k.replace(/=/g,"");t.push(new E(i,o))}return new w(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}$.__dashjs_factory_name="ClearKey";const X=dashjs.FactoryMaker.getSingletonFactory($);function Q(){var e,t,n,r,o,a,s,l,u=this.context;function c(e,t){return t&&e in t?t[e]:null}function d(e,t){return e&&e.sessionId?e.sessionId:t&&t.sessionId?t.sessionId:null}function h(e,t){return e&&e.sessionType?e.sessionType:t}return e={initialize:function(){var e;r=[],e=j(u).getInstance({BASE64:o,settings:a}),r.push(e),e=B(u).getInstance({BASE64:o}),r.push(e),e=R(u).getInstance({BASE64:o}),r.push(e),s=e,e=D(u).getInstance({BASE64:o,debug:t}),r.push(e),l=e},setProtectionData:function(e){for(var t,n,i=0;i<r.length;i++){var o=r[i];o.hasOwnProperty("init")&&o.init((t=o.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===s||e===l},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1},getKeySystems:function(){return r},setKeySystems:function(e){r=e},getKeySystemBySystemString:function(e){for(var t=0;t<r.length;t++)if(r[t].systemString===e)return r[t];return null},getSupportedKeySystemsFromContentProtection:function(e,t,n){var o,a,s,l,u=[];if(e){var p=i.findCencContentProtection(e);for(s=0;s<r.length;++s){var f=c((a=r[s]).systemString,t);for(l=0;l<e.length;++l)if((o=e[l]).schemeIdUri.toLowerCase()===a.schemeIdURI){var m=a.getInitData(o,p);u.push({ks:r[s],keyId:o.keyId,initData:m,protData:f,cdmData:a.getCDMData(f?f.cdmData:null),sessionId:d(f,o),sessionType:h(f,n)})}}}return u},getSupportedKeySystemsFromSegmentPssh:function(e,t,n){for(var o,a=[],s=i.parsePSSHList(e),l=0;l<r.length;++l){var u=c((o=r[l]).systemString,t);o.uuid in s&&a.push({ks:o,initData:s[o.uuid],protData:u,cdmData:o.getCDMData(u?u.cdmData:null),sessionId:d(u),sessionType:h(u,n)})}return a},getLicenseServerModelInstance:function(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=Z(u).getInstance({BASE64:o}):e.systemString===T.WIDEVINE_KEYSTEM_STRING?r=K(u).getInstance():e.systemString===T.PLAYREADY_KEYSTEM_STRING?r=W(u).getInstance():e.systemString===T.CLEARKEY_KEYSTEM_STRING&&(r=X(u).getInstance()),r},processClearKeyLicenseRequest:function(e,t,r){try{return e.getClearKeysFromProtectionData(t,r)}catch(e){return n.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(r){r&&(r.debug&&(t=r.debug,n=t.getLogger(e)),r.BASE64&&(o=r.BASE64),r.settings&&(a=r.settings))}},e}Q.__dashjs_factory_name="ProtectionKeyController";const J=dashjs.FactoryMaker.getSingletonFactory(Q);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){return te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},te(e,t)}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}const re=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=ne(t);if(n){var i=ne(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return function(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=r.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e.KEY_SESSION_UPDATED="public_keySessionUpdated",e}return i}(n(8342).Z)),ie=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n},oe=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"},ae=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n};var se={};function le(e){e=e||{};var t,n,r,i,o,a,s,l,u=this.context,h=e.eventBus,p=e.events,f=e.debug;function m(e,t,n,r){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess){var i="Insecure origins are not allowed";return h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:i}),void r({error:i})}var o=e[t].protData&&e[t].protData.systemStringPriority?e[t].protData.systemStringPriority:null,a=e[t].configs,s=e[t].ks,l=s.systemString;(function(e,t){return new Promise((function(n,r){g(e,t,0,n,r)}))})(o||(se[l]?se[l]:[l]),a).then((function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new ae(s,t);r.mksa=e,h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{data:r}),n({data:r})})).catch((function(i){if(t+1<e.length)m(e,t+1,n,r);else{var o="Key system access denied! ";h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:o+i.message}),r({error:o+i.message})}}))}function g(e,t,r,i,o){var a=e[r];n.debug("Requesting key system access for system string ".concat(a)),navigator.requestMediaKeySystemAccess(a,t).then((function(e){e.selectedSystemString=a,i(e)})).catch((function(n){r+1<e.length?g(e,t,r+1,i,o):o(n)}))}function y(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function v(e){for(var t=0;t<a.length;t++)if(a[t]===e){a.splice(t,1);break}}function b(e){var t,n;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function _(e,t){var r={session:e,keyId:t.keyId,initData:t.initData,sessionId:t.sessionId,sessionType:t.sessionType,handleEvent:function(e){switch(e.type){case"keystatuseschange":h.trigger(p.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach((function(){var e=b(arguments);"expired"===e.status?h.trigger(p.INTERNAL_KEY_STATUS_CHANGED,{error:new d.Z(c.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,c.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)}):h.trigger(p.INTERNAL_KEY_STATUS_CHANGED,e)}));break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;h.trigger(p.INTERNAL_KEY_MESSAGE,{data:new oe(this,t,void 0,e.messageType)})}},getKeyId:function(){return this.keyId},getSessionId:function(){return e.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach((function(){"usable"===b(arguments).status&&(t=!0)})),t}};return e.addEventListener("keystatuseschange",r),e.addEventListener("message",r),e.closed.then((function(){v(r),n.debug("DRM: Session closed.  SessionID = "+r.getSessionId()),h.trigger(p.KEY_SESSION_CLOSED,{data:r.getSessionId()})})),a.push(r),r}return t={getAllInitData:function(){for(var e=[],t=0;t<a.length;t++)a[t].initData&&e.push(a[t].initData);return e},getSessions:function(){return a},requestKeySystemAccess:function(e){return new Promise((function(t,n){m(e,0,t,n)}))},selectKeySystem:function(e){return new Promise((function(t,n){e.mksa.createMediaKeys().then((function(t){return r=e.keySystem,o=t,i?i.setMediaKeys(o):Promise.resolve()})).then((function(){t(r)})).catch((function(){n({error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))}))},setMediaElement:function(e){i!==e&&(i&&(i.removeEventListener("encrypted",s),i.setMediaKeys&&i.setMediaKeys(null)),(i=e)&&(i.addEventListener("encrypted",s),i.setMediaKeys&&o&&i.setMediaKeys(o)))},setServerCertificate:function(e){if(!r||!o)throw new Error("Can not set server certificate until you have selected a key system");o.setServerCertificate(e).then((function(){n.info("DRM: License server certificate successfully updated."),h.trigger(p.SERVER_CERTIFICATE_UPDATED)})).catch((function(e){h.trigger(p.SERVER_CERTIFICATE_UPDATED,{error:new d.Z(c.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,c.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})}))},createKeySession:function(e){if(!r||!o)throw new Error("Can not create sessions until you have selected a key system");var t=o.createSession(e.sessionType),i=_(t,e),a=r.systemString===T.CLEARKEY_KEYSTEM_STRING&&(e.initData||e.protData&&e.protData.clearkeys)?T.INITIALIZATION_DATA_TYPE_KEYIDS:T.INITIALIZATION_DATA_TYPE_CENC;t.generateRequest(a,e.initData).then((function(){n.debug("DRM: Session created.  SessionID = "+i.getSessionId()),h.trigger(p.KEY_SESSION_CREATED,{data:i})})).catch((function(e){v(i),h.trigger(p.KEY_SESSION_CREATED,{data:null,error:new d.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})}))},updateKeySession:function(e,t){var n=e.session;l.isClearKey(r)&&(t=t.toJWK()),n.update(t).then((function(){h.trigger(p.KEY_SESSION_UPDATED)})).catch((function(t){h.trigger(p.KEY_ERROR,{error:new d.Z(c.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})}))},loadKeySession:function(e){if(!r||!o)throw new Error("Can not load sessions until you have selected a key system");for(var t=e.sessionId,i=0;i<a.length;i++)if(t===a[i].sessionId)return void n.warn("DRM: Ignoring session ID because we have already seen it!");var s=o.createSession(e.sessionType),l=_(s,e);s.load(t).then((function(e){e?(n.debug("DRM: Session loaded.  SessionID = "+l.getSessionId()),h.trigger(p.KEY_SESSION_CREATED,{data:l})):(v(l),h.trigger(p.KEY_SESSION_CREATED,{data:null,error:new d.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}))})).catch((function(e){v(l),h.trigger(p.KEY_SESSION_CREATED,{data:null,error:new d.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)})}))},removeKeySession:function(e){e.session.remove().then((function(){n.debug("DRM: Session removed.  SessionID = "+e.getSessionId()),h.trigger(p.KEY_SESSION_REMOVED,{data:e.getSessionId()})}),(function(t){h.trigger(p.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionId()+"). "+t.name})}))},closeKeySession:function(e){y(e).catch((function(t){v(e),h.trigger(p.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionId()+") "+t.name})}))},stop:function(){for(var e,t=0;t<a.length;t++)(e=a[t]).getUsable()||y(e).catch((function(){v(e)}))},reset:function(){var e,t=a.length;0!==t?function(){for(var n=function(e){v(e),0===a.length&&(i?(i.removeEventListener("encrypted",s),i.setMediaKeys(null).then((function(){h.trigger(p.TEARDOWN_COMPLETE)}))):h.trigger(p.TEARDOWN_COMPLETE))},r=0;r<t;r++)!function(t){e.session.closed.then((function(){n(t)})),y(e).catch((function(){n(t)}))}(e=a[r])}():h.trigger(p.TEARDOWN_COMPLETE)}},n=f.getLogger(t),r=null,i=null,o=null,a=[],l=J(u).getInstance(),s={handleEvent:function(e){if("encrypted"===e.type&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;h.trigger(p.NEED_KEY,{key:new ie(t,e.initDataType)})}}},t}se[T.PLAYREADY_KEYSTEM_STRING]=[T.PLAYREADY_KEYSTEM_STRING,T.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],se[T.WIDEVINE_KEYSTEM_STRING]=[T.WIDEVINE_KEYSTEM_STRING],se[T.CLEARKEY_KEYSTEM_STRING]=[T.CLEARKEY_KEYSTEM_STRING],le.__dashjs_factory_name="ProtectionModel_21Jan2015";const ue=dashjs.FactoryMaker.getClassFactory(le);function ce(e){e=e||{};var t,n,r,i,o,s,l,u,h,p=this.context,f=e.eventBus,m=e.events,g=e.debug,y=e.api;function v(){try{for(var e=0;e<l.length;e++)b(l[e]);r&&r.removeEventListener(y.needkey,u),f.trigger(m.TEARDOWN_COMPLETE)}catch(e){f.trigger(m.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function b(e){var t=e.session;t.removeEventListener(y.error,e),t.removeEventListener(y.message,e),t.removeEventListener(y.ready,e),t.removeEventListener(y.close,e);for(var n=0;n<l.length;n++)if(l[n]===e){l.splice(n,1);break}t[y.release]()}function _(){var e=null,t=function(){r.removeEventListener("loadedmetadata",e),r[y.setMediaKeys](o),f.trigger(m.VIDEO_ELEMENT_SELECTED)};r.readyState>=1?t():(e=t.bind(this),r.addEventListener("loadedmetadata",e))}return t={getAllInitData:function(){for(var e=[],t=0;t<l.length;t++)e.push(l[t].initData);return e},getSessions:function(){return l},requestKeySystemAccess:function(e){return new Promise((function(t,n){for(var r=!1,i=0;i<e.length;i++)for(var o=e[i].ks.systemString,s=e[i].configs,l=null,u=null,c=0;c<s.length;c++){var d=s[c].audioCapabilities,p=s[c].videoCapabilities;if(d&&0!==d.length){l=[];for(var g=0;g<d.length;g++)window[y.MediaKeys].isTypeSupported(o,d[g].contentType)&&l.push(d[g])}if(p&&0!==p.length){u=[];for(var v=0;v<p.length;v++)window[y.MediaKeys].isTypeSupported(o,p[v].contentType)&&u.push(p[v])}if(!(!l&&!u||l&&0===l.length||u&&0===u.length)){r=!0;var b=new a(l,u),_=h.getKeySystemBySystemString(o),E=new ae(_,b);f.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{data:E}),t({data:E});break}}if(!r){var w="Key system access denied! -- No valid audio/video content configurations detected!";f.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{error:w}),n({error:w})}}))},selectKeySystem:function(e){return new Promise((function(t,n){try{o=e.mediaKeys=new window[y.MediaKeys](e.keySystem.systemString),i=e.keySystem,s=e,r&&_(),t(i)}catch(e){n({error:"Error selecting keys system ("+i.systemString+")! Could not create MediaKeys -- TODO"})}}))},setMediaElement:function(e){r!==e&&(r&&r.removeEventListener(y.needkey,u),(r=e)&&(r.addEventListener(y.needkey,u),o&&_()))},createKeySession:function(e){if(!i||!o||!s)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(s.ksConfiguration.videoCapabilities&&s.ksConfiguration.videoCapabilities.length>0&&(t=s.ksConfiguration.videoCapabilities[0]),null===t&&s.ksConfiguration.audioCapabilities&&s.ksConfiguration.audioCapabilities.length>0&&(t=s.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var r=t.contentType,a=o.createSession(r,new Uint8Array(e.initData),e.cdmData?new Uint8Array(e.cdmData):null),u=function(e,t){return{session:e,keyId:t.keyId,initData:t.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case y.error:f.trigger(m.KEY_ERROR,{error:new d.Z(c.MEDIA_KEYERR_CODE,"KeyError",this)});break;case y.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;f.trigger(m.INTERNAL_KEY_MESSAGE,{data:new oe(this,t,e.destinationURL)});break;case y.ready:n.debug("DRM: Key added."),f.trigger(m.KEY_ADDED);break;case y.close:n.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),f.trigger(m.KEY_SESSION_CLOSED,{data:this.getSessionId()})}}}}(a,e);a.addEventListener(y.error,u),a.addEventListener(y.message,u),a.addEventListener(y.ready,u),a.addEventListener(y.close,u),l.push(u),n.debug("DRM: Session created.  SessionID = "+u.getSessionId()),f.trigger(m.KEY_SESSION_CREATED,{data:u})},updateKeySession:function(e,t){var n=e.session;h.isClearKey(i)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t)),f.trigger(m.KEY_SESSION_UPDATED)},closeKeySession:b,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:v,reset:v},n=g.getLogger(t),r=null,i=null,o=null,s=null,l=[],h=J(p).getInstance(),u={handleEvent:function(e){if(e.type===y.needkey&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;f.trigger(m.NEED_KEY,{key:new ie(t,"cenc")})}}},t}ce.__dashjs_factory_name="ProtectionModel_3Feb2014";const de=dashjs.FactoryMaker.getClassFactory(ce);function he(e){e=e||{};var t,n,r,i,o,s,l,u,h,p=this.context,f=e.eventBus,m=e.events,g=e.debug,y=e.api,v=e.errHandler;function b(){r&&w();for(var e=0;e<l.length;e++)_(l[e]);f.trigger(m.TEARDOWN_COMPLETE)}function _(e){try{r[y.cancelKeyRequest](i.systemString,e.sessionId)}catch(t){f.trigger(m.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionId+") "+t.message})}}function E(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionId==t)return e[r];return null}return null}function w(){r.removeEventListener(y.keyerror,h),r.removeEventListener(y.needkey,h),r.removeEventListener(y.keymessage,h),r.removeEventListener(y.keyadded,h)}return t={getAllInitData:function(){for(var e=[],t=0;t<s.length;t++)e.push(s[t].initData);for(var n=0;n<l.length;n++)e.push(l[n].initData);return e},getSessions:function(){return l.concat(s)},requestKeySystemAccess:function(e){return new Promise((function(t,n){var i=r;i||(i=document.createElement("video"));for(var s=!1,l=0;l<e.length;l++)for(var u=e[l].ks.systemString,c=e[l].configs,d=null,h=0;h<c.length;h++){var p=c[h].videoCapabilities;if(p&&0!==p.length){d=[];for(var g=0;g<p.length;g++)""!==i.canPlayType(p[g].contentType,u)&&d.push(p[g])}if(d&&(!d||0!==d.length)){s=!0;var y=new a(null,d),v=o.getKeySystemBySystemString(u),b=new ae(v,y);f.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{data:b}),t({data:b});break}}if(!s){var _="Key system access denied! -- No valid audio/video content configurations detected!";f.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{error:_}),n({error:_})}}))},selectKeySystem:function(e){return i=e.keySystem,Promise.resolve(i)},setMediaElement:function(e){if(r!==e){if(r){w();for(var t=0;t<l.length;t++)_(l[t]);l=[]}(r=e)&&(r.addEventListener(y.keyerror,h),r.addEventListener(y.needkey,h),r.addEventListener(y.keymessage,h),r.addEventListener(y.keyadded,h),f.trigger(m.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!i)throw new Error("Can not create sessions until you have selected a key system");if(u||0===l.length){var t={sessionId:null,keyId:e.keyId,initData:e.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return s.push(t),r[y.generateKeyRequest](i.systemString,new Uint8Array(e.initData)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionId;if(o.isClearKey(i))for(var a=0;a<t.keyPairs.length;a++)r[y.addKey](i.systemString,t.keyPairs[a].key,t.keyPairs[a].keyID,n);else r[y.addKey](i.systemString,new Uint8Array(t),new Uint8Array(e.initData),n);f.trigger(m.KEY_SESSION_UPDATED)},closeKeySession:_,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:b,reset:b},n=g.getLogger(t),r=null,i=null,s=[],l=[],o=J(p).getInstance(),h={handleEvent:function(e){var t=null;switch(e.type){case y.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;f.trigger(m.NEED_KEY,{key:new ie(r,"cenc")});break;case y.keyerror:if((t=E(l,e.sessionId))||(t=E(s,e.sessionId)),t){var i=c.MEDIA_KEYERR_CODE,o="";switch(e.errorCode.code){case 1:i=c.MEDIA_KEYERR_UNKNOWN_CODE,o+="MEDIA_KEYERR_UNKNOWN - "+c.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:i=c.MEDIA_KEYERR_CLIENT_CODE,o+="MEDIA_KEYERR_CLIENT - "+c.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:i=c.MEDIA_KEYERR_SERVICE_CODE,o+="MEDIA_KEYERR_SERVICE - "+c.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:i=c.MEDIA_KEYERR_OUTPUT_CODE,o+="MEDIA_KEYERR_OUTPUT - "+c.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:i=c.MEDIA_KEYERR_HARDWARECHANGE_CODE,o+="MEDIA_KEYERR_HARDWARECHANGE - "+c.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:i=c.MEDIA_KEYERR_DOMAIN_CODE,o+="MEDIA_KEYERR_DOMAIN - "+c.MEDIA_KEYERR_DOMAIN_MESSAGE}o+="  System Code = "+e.systemCode,f.trigger(m.KEY_ERROR,{error:new d.Z(i,o,t)})}else n.error("No session token found for key error");break;case y.keyadded:(t=E(l,e.sessionId))||(t=E(s,e.sessionId)),t?(n.debug("DRM: Key added."),f.trigger(m.KEY_ADDED,{data:t})):n.debug("No session token found for key added");break;case y.keymessage:if((u=null!==e.sessionId&&void 0!==e.sessionId)?!(t=E(l,e.sessionId))&&s.length>0&&(t=s.shift(),l.push(t),t.sessionId=e.sessionId,f.trigger(m.KEY_SESSION_CREATED,{data:t})):s.length>0&&(t=s.shift(),l.push(t),0!==s.length&&v.error(new d.Z(c.MEDIA_KEY_MESSAGE_ERROR_CODE,c.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var a=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=a,f.trigger(m.INTERNAL_KEY_MESSAGE,{data:new oe(t,a,e.defaultURL)})}else n.warn("No session token found for key message")}}},t}he.__dashjs_factory_name="ProtectionModel_01b";const pe=dashjs.FactoryMaker.getClassFactory(he);var fe=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],me=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function ge(){var e,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}return e={createProtectionSystem:function(r){var i=null,o=J(t).getInstance();o.setConfig({debug:r.debug,BASE64:r.BASE64,settings:r.settings}),o.initialize();var a=function(r){var i=r.debug,o=i.getLogger(e),a=r.eventBus,s=r.errHandler,l=r.videoModel?r.videoModel.getElement():null;return l&&void 0===l.onencrypted||l&&void 0===l.mediaKeys?n(l,me)?(o.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),de(t).create({debug:i,eventBus:a,events:r.events,api:n(l,me)})):n(l,fe)?(o.info("EME detected on this user agent! (ProtectionModel_01b)"),pe(t).create({debug:i,eventBus:a,errHandler:s,events:r.events,api:n(l,fe)})):(o.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(o.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),ue(t).create({debug:i,eventBus:a,events:r.events}))}(r);return!i&&a&&(i=_(t).create({protectionModel:a,protectionKeyController:o,eventBus:r.eventBus,debug:r.debug,events:r.events,BASE64:r.BASE64,constants:r.constants,cmcdModel:r.cmcdModel,customParametersModel:r.customParametersModel,settings:r.settings}),r.capabilities.setEncryptedMediaSupported(!0)),i}}}ge.__dashjs_factory_name="Protection";var ye=dashjs.FactoryMaker.getClassFactory(ge);ye.events=re,ye.errors=c,dashjs.FactoryMaker.updateClassFactory(ge.__dashjs_factory_name,ye);const ve=ye},2068:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i={DEFAULT:.5,STRONG:1,WEAK:0};function o(e,t,n){var r,o;return r=void 0===e?-1:e,o=function(e){var t=i.DEFAULT;return e!==i.DEFAULT&&e!==i.STRONG&&e!==i.WEAK||(t=e),t}(n),{quality:r,reason:void 0===t?null:t,priority:o}}o.__dashjs_factory_name="SwitchRequest";var a=r.Z.getClassFactory(o);a.NO_CHANGE=-1,a.PRIORITY=i,r.Z.updateClassFactory(o.__dashjs_factory_name,a);const s=a},1767:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(5628),i=n(6535),o=n(7423),a=n(895),s=n(6070),l=n(3112),u=n(1914),c=n(5435),d=n(5448),h=n(2068),p=n(3393),f="qualitySwitchRules",m="abandonFragmentRules";function g(e){e=e||{};var t,n,d=this.context,g=e.mediaPlayerModel,y=e.customParametersModel,v=e.dashMetrics,b=e.settings;function _(e){return e.filter((function(e){return e.quality>h.Z.NO_CHANGE}))}function E(e){var t,n,r,i,o,a={},s=null;if(0!==e.length){for(a[h.Z.PRIORITY.STRONG]={quality:h.Z.NO_CHANGE,reason:null},a[h.Z.PRIORITY.WEAK]={quality:h.Z.NO_CHANGE,reason:null},a[h.Z.PRIORITY.DEFAULT]={quality:h.Z.NO_CHANGE,reason:null},t=0,n=e.length;t<n;t+=1)(r=e[t]).quality!==h.Z.NO_CHANGE&&(a[r.priority].quality===h.Z.NO_CHANGE||a[r.priority].quality>r.quality)&&(a[r.priority].quality=r.quality,a[r.priority].reason=r.reason||null);return a[h.Z.PRIORITY.WEAK].quality!==h.Z.NO_CHANGE&&(s=a[h.Z.PRIORITY.WEAK]),a[h.Z.PRIORITY.DEFAULT].quality!==h.Z.NO_CHANGE&&(s=a[h.Z.PRIORITY.DEFAULT]),a[h.Z.PRIORITY.STRONG].quality!==h.Z.NO_CHANGE&&(s=a[h.Z.PRIORITY.STRONG]),s&&(i=s.quality,o=s.reason),(0,h.Z)(d).create(i,o)}}return{initialize:function(){t=[],n=[],b.get().streaming.abr.useDefaultABRRules&&(b.get().streaming.abr.ABRStrategy===p.Z.ABR_STRATEGY_L2A?t.push((0,u.Z)(d).create({dashMetrics:v,settings:b})):b.get().streaming.abr.ABRStrategy===p.Z.ABR_STRATEGY_LoLP?t.push((0,c.Z)(d).create({dashMetrics:v})):(t.push((0,l.Z)(d).create({dashMetrics:v,mediaPlayerModel:g,settings:b})),t.push((0,r.Z)(d).create({dashMetrics:v})),b.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&t.push((0,i.Z)(d).create({dashMetrics:v,settings:b})),b.get().streaming.abr.additionalAbrRules.switchHistoryRule&&t.push((0,s.Z)(d).create()),b.get().streaming.abr.additionalAbrRules.droppedFramesRule&&t.push((0,a.Z)(d).create()),b.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&n.push((0,o.Z)(d).create({dashMetrics:v,mediaPlayerModel:g,settings:b})))),y.getAbrCustomRules().forEach((function(e){e.type===f&&t.push(e.rule(d).create()),e.type===m&&n.push(e.rule(d).create())}))},reset:function(){[t,n].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),t=[],n=[]},getMaxQuality:function(e){return E(_(t.map((function(t){return t.getMaxIndex(e)}))))||(0,h.Z)(d).create()},getMinSwitchRequest:E,shouldAbandonFragment:function(e,t){return E(_(n.map((function(n){return n.shouldAbandon(e,t)}))))||(0,h.Z)(d).create()},getQualitySwitchRules:function(){return t}}}g.__dashjs_factory_name="ABRRulesCollection";var y=d.Z.getClassFactory(g);y.QUALITY_SWITCH_RULES=f,y.ABANDON_FRAGMENT_RULES=m,d.Z.updateSingletonFactory(g.__dashjs_factory_name,y);const v=y},7423:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(2068),i=n(5448),o=n(6398);function a(e){e=e||{};var t,n,i,s,l,u=this.context,c=e.mediaPlayerModel,d=e.dashMetrics,h=e.settings;function p(){i={},s={},l=[]}return t={shouldAbandon:function(e){var t=(0,r.Z)(u).create(r.Z.NO_CHANGE,{name:a.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var o,p,f=e.getMediaInfo(),m=e.getMediaType(),g=e.getStreamInfo(),y=g?g.id:null,v=e.getCurrentRequest();if(!isNaN(v.index)){o=m,p=v.index,i[o]=i[o]||{},i[o][p]=i[o][p]||{};var b=c.getStableBufferTime();if(d.getCurrentBufferLevel(m)>b)return t;var _=i[m][v.index];if(null===_||null===v.firstByteDate||s.hasOwnProperty(_.id))return t;if(void 0===_.firstByteTime&&(l[m]=[],_.firstByteTime=v.firstByteDate.getTime(),_.segmentDuration=v.duration,_.bytesTotal=v.bytesTotal,_.id=v.index),_.bytesLoaded=v.bytesLoaded,_.elapsedTime=(new Date).getTime()-_.firstByteTime,_.bytesLoaded>0&&_.elapsedTime>0&&function(e,t){l[e]=l[e]||[],l[e].push(t)}(m,Math.round(8*_.bytesLoaded/_.elapsedTime)),l[m].length>=5&&_.elapsedTime>500&&_.bytesLoaded<_.bytesTotal){var E=l[m].reduce((function(e,t){return e+t}),0);if(_.measuredBandwidthInKbps=Math.round(E/l[m].length),_.estimatedTimeOfDownload=+(8*_.bytesTotal/_.measuredBandwidthInKbps/1e3).toFixed(2),_.estimatedTimeOfDownload<1.8*_.segmentDuration||0===e.getRepresentationInfo().quality)return t;if(!s.hasOwnProperty(_.id)){var w=e.getAbrController(),T=_.bytesTotal-_.bytesLoaded,A=w.getBitrateList(f),S=w.getQualityForBitrate(f,_.measuredBandwidthInKbps*h.get().streaming.abr.bandwidthSafetyFactor,y),x=w.getMinAllowedIndexFor(m,y),I=void 0!==x?Math.max(x,S):S;T>_.bytesTotal*A[I].bitrate/A[w.getQualityFor(m,y)].bitrate&&(t.quality=I,t.reason.throughput=_.measuredBandwidthInKbps,t.reason.fragmentID=_.id,t.reason.rule=this.getClassName(),s[_.id]=_,n.debug("["+m+"] frag id",_.id," is asking to abandon and switch to quality to ",I," measured bandwidth was",_.measuredBandwidthInKbps),delete i[m][_.id])}}else _.bytesLoaded===_.bytesTotal&&delete i[m][_.id]}return t},reset:p},n=(0,o.Z)(u).getInstance().getLogger(t),p(),t}a.__dashjs_factory_name="AbandonRequestsRule";const s=i.Z.getClassFactory(a)},3112:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(3860),i=n(2068),o=n(5448),a=n(7855),s=n(5595),l=n(8512),u=n(6398),c=n(8825),d=n(3393),h=10;function p(e){e=e||{};var t,n,o,p=this.context,f=e.dashMetrics,m=e.mediaPlayerModel,g=(0,s.Z)(p).getInstance();function y(e,t,n){var r=n.reduce((function(e,t,r){return t>n[e]?r:e}),0);if(0===r)return null;var i=Math.max(e,h+2*t.length),o=(n[r]-1)/(i/h-1);return{gp:o,Vp:h/o}}function v(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function b(e,t){var n=m.getStableBufferTime();if(e.stableBufferTime!==n){var r=y(n,e.bitrates,e.utilities);if(r.Vp!==e.Vp||r.gp!==e.gp){var i=f.getCurrentBufferLevel(t),o=i+e.placeholderBuffer;o-=h,o*=r.Vp/e.Vp,o+=h,e.stableBufferTime=n,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,o-i)}}}function _(e,t){return e.Vp*(e.utilities[t]+e.gp)}function E(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,o=t-1;o>=0;--o)if(e.utilities[o]<e.utilities[t]){var a=e.bitrates[o],s=e.utilities[o],l=e.Vp*(e.gp+(n*s-a*r)/(n-a));i=Math.max(i,l)}return i}function w(e){var t=e.mediaType===d.Z.AUDIO?[d.Z.AUDIO]:o;for(var n in t)o.hasOwnProperty(n)&&2===o[n].state&&(o[n].placeholderBuffer=0)}function T(){for(var e in o)if(o.hasOwnProperty(e)){var t=o[e];0!==t.state&&(t.state=1,v(t))}}function A(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=o[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,x(t,e.chunk.mediaInfo.type)}}}function S(e){if(e&&e.metric===r.Z.HTTP_REQUEST&&e.value&&e.value.type===a.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=o[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),x(t,e.mediaType))}}function x(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var n=f.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=_(e,e.lastQuality),i=Math.max(0,r-n);e.placeholderBuffer=Math.min(i,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function I(e){if(e){var t=o[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function R(e){if(e){var t=o[e.mediaType];if(t&&0!==t.state){var n,r=f.getCurrentBufferLevel(e.mediaType);n=t.abrQuality>0?E(t,t.abrQuality):h;var i=Math.max(0,n-r);t.placeholderBuffer=Math.min(t.placeholderBuffer,i)}}}function C(){o={}}return t={getMaxIndex:function(e){var t=(0,i.Z)(p).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var r=e.getMediaInfo(),a=e.getMediaType(),s=e.getScheduleController(),l=e.getStreamInfo(),u=e.getAbrController(),c=u.getThroughputHistory(),d=l?l.id:null,h=l&&l.manifestInfo&&l.manifestInfo.isDynamic,g=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!g)return t;s.setTimeToLoadDelay(0);var w=function(e){var t=e.getMediaType(),n=o[t];return n?0!==n.state&&b(n,t):(n=function(e){var t={},n=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),r=function(e){return e.map((function(e){return Math.log(e)}))}(n);r=r.map((function(e){return e-r[0]+1}));var i=m.getStableBufferTime(),o=y(i,n,r);return o?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=o.Vp,t.gp=o.gp,t.lastQuality=0,v(t)):t.state=0,t}(e),o[t]=n),n}(e);if(0===w.state)return t;var T,A=f.getCurrentBufferLevel(a),S=c.getAverageThroughput(a,h),x=c.getSafeAverageThroughput(a,h),I=c.getAverageLatency(a);if(t.reason.state=w.state,t.reason.throughput=S,t.reason.latency=I,isNaN(S))return t;switch(w.state){case 1:T=u.getQualityForBitrate(r,x,d,I),t.quality=T,t.reason.throughput=x,w.placeholderBuffer=Math.max(0,E(w,T)-A),w.lastQuality=T,!isNaN(w.lastSegmentDurationS)&&A>=w.lastSegmentDurationS&&(w.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,b(e,t)}(w,a),T=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,o=0;o<n;++o){var a=(e.Vp*(e.utilities[o]+e.gp)-t)/e.bitrates[o];(isNaN(i)||a>=i)&&(i=a,r=o)}return r}(w,A+w.placeholderBuffer);var R=u.getQualityForBitrate(r,x,d,I);T>w.lastQuality&&T>R&&(T=Math.max(R,w.lastQuality));var C=Math.max(0,A+w.placeholderBuffer-_(w,T));C<=w.placeholderBuffer?(w.placeholderBuffer-=C,C=0):(C-=w.placeholderBuffer,w.placeholderBuffer=0,T<u.getMaxAllowedIndexFor(a,d)?s.setTimeToLoadDelay(1e3*C):C=0),t.quality=T,t.reason.throughput=S,t.reason.latency=I,t.reason.bufferLevel=A,t.reason.placeholderBuffer=w.placeholderBuffer,t.reason.delay=C,w.lastQuality=T;break;default:n.debug("BOLA ABR rule invoked in bad state."),t.quality=u.getQualityForBitrate(r,x,d,I),t.reason.state=w.state,t.reason.throughput=x,t.reason.latency=I,w.state=1,v(w)}return t},reset:function(){C(),g.off(c.Z.BUFFER_EMPTY,w,t),g.off(c.Z.PLAYBACK_SEEKING,T,t),g.off(c.Z.METRIC_ADDED,S,t),g.off(c.Z.QUALITY_CHANGE_REQUESTED,I,t),g.off(c.Z.FRAGMENT_LOADING_ABANDONED,R,t),g.off(l.Z.MEDIA_FRAGMENT_LOADED,A,t)}},n=(0,u.Z)(p).getInstance().getLogger(t),C(),g.on(c.Z.BUFFER_EMPTY,w,t),g.on(c.Z.PLAYBACK_SEEKING,T,t),g.on(c.Z.METRIC_ADDED,S,t),g.on(c.Z.QUALITY_CHANGE_REQUESTED,I,t),g.on(c.Z.FRAGMENT_LOADING_ABANDONED,R,t),g.on(l.Z.MEDIA_FRAGMENT_LOADED,A,t),t}p.__dashjs_factory_name="BolaRule";const f=o.Z.getClassFactory(p)},895:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i=n(2068),o=n(6398);function a(){var e,t,n=this.context;return e={getMaxIndex:function(e){var r=(0,i.Z)(n).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return r;var o=e.getDroppedFramesHistory(),a=e.getStreamInfo().id;if(o){var s=o.getFrameHistory(a);if(!s||0===s.length)return r;for(var l=0,u=0,c=i.Z.NO_CHANGE,d=1;d<s.length;d++)if(s[d]&&(l=s[d].droppedVideoFrames,(u=s[d].totalVideoFrames)>375&&l/u>.15)){c=d-1,t.debug("index: "+c+" Dropped Frames: "+l+" Total Frames: "+u);break}return(0,i.Z)(n).create(c,{droppedFrames:l})}return r}},t=(0,o.Z)(n).getInstance().getLogger(e),e}a.__dashjs_factory_name="DroppedFramesRule";const s=r.Z.getClassFactory(a)},6535:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(5595),i=n(8512),o=n(5448),a=n(6398),s=n(2068),l=n(3393),u=n(3860),c=n(8825);function d(e){e=e||{};var t,n,o,d=this.context,h=(0,r.Z)(d).getInstance(),p=e.dashMetrics;function f(){(o={})[l.Z.VIDEO]={ignoreCount:2},o[l.Z.AUDIO]={ignoreCount:2}}function m(){f()}function g(e){isNaN(e.startTime)||e.mediaType!==l.Z.AUDIO&&e.mediaType!==l.Z.VIDEO||o[e.mediaType].ignoreCount>0&&o[e.mediaType].ignoreCount--}return t={getMaxIndex:function(e){var t=(0,s.Z)(d).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!p||!p.hasOwnProperty("getCurrentBufferLevel")||!p.hasOwnProperty("getCurrentBufferState"))throw new Error(l.Z.MISSING_CONFIG_ERROR)}();var r=e.getMediaType(),i=p.getCurrentBufferState(r),a=e.getRepresentationInfo().fragmentDuration,c=e.getStreamInfo(),h=c?c.id:null,f=e.getScheduleController(),m=c&&c.manifestInfo&&c.manifestInfo.isDynamic;if(function(e,t){return!e&&o[t].ignoreCount>0}(f.getPlaybackController().getLowLatencyModeEnabled(),r)||!a)return t;if(i&&i.state===u.Z.BUFFER_EMPTY)n.debug("["+r+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty";else{var g=e.getMediaInfo(),y=e.getAbrController(),v=y.getThroughputHistory(),b=p.getCurrentBufferLevel(r),_=v.getAverageThroughput(r,m),E=v.getAverageLatency(r),w=_*(b/a)*.5;t.quality=y.getQualityForBitrate(g,w,h,E),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return t},reset:function(){f(),h.off(c.Z.PLAYBACK_SEEKING,m,t),h.off(i.Z.BYTES_APPENDED_END_FRAGMENT,g,t)}},n=(0,a.Z)(d).getInstance().getLogger(t),f(),h.on(c.Z.PLAYBACK_SEEKING,m,t),h.on(i.Z.BYTES_APPENDED_END_FRAGMENT,g,t),t}d.__dashjs_factory_name="InsufficientBufferRule";const h=o.Z.getClassFactory(d)},1914:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(3860),i=n(2068),o=n(5448),a=n(7855),s=n(5595),l=n(8512),u=n(6398),c=n(3393);function d(e){e=e||{};var t,n,o,d,h=this.context,p=e.dashMetrics,f=(0,s.Z)(h).getInstance();function m(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,e.lastSegmentUrl=""}function g(){for(var e in n)if(n.hasOwnProperty(e)){var t=n[e];0!==t.state&&(t.state=1,m(t))}}function y(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=n[e.chunk.mediaInfo.type],r=o[e.chunk.mediaInfo.type];if(t&&0!==t.state){var i=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||i>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=i,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=i,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,b(t,r)}}}function v(e){if(e&&e.metric===r.Z.HTTP_REQUEST&&e.value&&e.value.type===a.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=n[e.mediaType],i=o[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),b(t,i))}}function b(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function _(e){if(e&&e.mediaType){var t=n[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function E(e,t){if(e.length!==t.length)return-1;for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function w(){n={},o={}}return t={getMaxIndex:function(e){var t,r=(0,i.Z)(h).create(),s=Math.pow(4,.99),l=Math.max(Math.pow(4,1),s*Math.sqrt(4)),u=e.getMediaInfo(),f=e.getMediaType(),g=u.bitrateList.map((function(e){return e.bandwidth})),y=g.length,v=e.getScheduleController(),b=e.getStreamInfo(),_=e.getAbrController(),w=_.getThroughputHistory(),T=b&&b.manifestInfo&&b.manifestInfo.isDynamic,A=e.useL2AABR(),S=p.getCurrentBufferLevel(f,!0),x=w.getSafeAverageThroughput(f,T),I=w.getAverageThroughput(f,T),R=w.getAverageLatency(f),C=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return r;if(r.reason=r.reason||{},!A||f===c.Z.AUDIO)return r;v.setTimeToLoadDelay(0);var M=function(e){var t=e.getMediaType(),r=n[t];return r||(r=function(e){var t={},n=e.getMediaInfo(),r=n.bitrateList.map((function(e){return e.bandwidth/1e3}));return t.state=1,t.bitrates=r,t.lastQuality=0,function(e){e&&e.type&&(o[e.type]={},o[e.type].w=[],o[e.type].prev_w=[],o[e.type].Q=0,o[e.type].segment_request_start_s=0,o[e.type].segment_download_finish_s=0,o[e.type].B_target=1.5)}(n),m(t),t}(e),n[t]=r),r}(e);if(0===M.state)return r;var L=o[f];if(!L)return r;if(r.reason.state=M.state,r.reason.throughput=I,r.reason.latency=R,isNaN(I))return r;switch(M.state){case 1:if(t=_.getQualityForBitrate(u,x,b.id,R),r.quality=t,r.reason.throughput=x,M.lastQuality=t,!isNaN(M.lastSegmentDurationS)&&S>=L.B_target){M.state=2,L.Q=s;for(var P=0;P<y;++P)P===M.lastQuality?L.prev_w[P]=1:L.prev_w[P]=0}break;case 2:var D=[],O=p.getCurrentHttpRequest(f).trace.reduce((function(e,t){return e+t.d}),0),N=p.getCurrentHttpRequest(f).trace.reduce((function(e,t){return e+t.b[0]}),0),k=Math.round(8*N/O),F=p.getCurrentHttpRequest(f);if(k<1&&(k=1),F.url===M.lastSegmentUrl||F.type===a.w.INIT_SEGMENT_TYPE)t=M.lastQuality;else{for(var B=M.lastSegmentDurationS,U=1,z=0;z<y;++z)g[z]=g[z]/1e3,C*g[z]>k&&(U=-1),L.w[z]=L.prev_w[z]+U*(B/(2*l))*((L.Q+s)*(C*g[z]/k));L.w=function(e){for(var t=e.length,n=!1,r=[],i=0;i<t;++i)r[i]=e[i];for(var o=e.sort((function(e,t){return t-e})),a=0,s=0,l=[],u=0;u<t-1;++u)if((s=((a+=o[u])-1)/(u+1))>=o[u+1]){n=!0;break}n||(s=(a+o[t-1]-1)/t);for(var c=0;c<t;++c)l[c]=Math.max(r[c]-s,0);return l}(L.w);for(var G=0;G<y;++G)D[G]=L.w[G]-L.prev_w[G],L.prev_w[G]=L.w[G];L.Q=Math.max(0,L.Q-B+B*C*((E(g,L.prev_w)+E(g,D))/k));for(var V=[],j=0;j<y;++j)V[j]=Math.abs(g[j]-E(L.w,g));(t=V.indexOf(Math.min.apply(Math,V)))>M.lastQuality&&g[M.lastQuality+1]<=k&&(t=M.lastQuality+1),g[t]>=k&&(L.Q=2*Math.max(s,L.Q)),M.lastSegment.url=F.url}r.quality=t,r.reason.throughput=I,r.reason.latency=R,r.reason.bufferLevel=S,M.lastQuality=r.quality;break;default:d.debug("L2A ABR rule invoked in bad state."),r.quality=_.getQualityForBitrate(u,x,b.id,R),r.reason.state=M.state,r.reason.throughput=x,r.reason.latency=R,M.state=1,m(M)}return r},reset:function(){w(),f.off(l.Z.PLAYBACK_SEEKING,g,t),f.off(l.Z.MEDIA_FRAGMENT_LOADED,y,t),f.off(l.Z.METRIC_ADDED,v,t),f.off(l.Z.QUALITY_CHANGE_REQUESTED,_,t)}},d=(0,u.Z)(h).getInstance().getLogger(t),w(),f.on(l.Z.PLAYBACK_SEEKING,g,t),f.on(l.Z.MEDIA_FRAGMENT_LOADED,y,t),f.on(l.Z.METRIC_ADDED,v,t),f.on(l.Z.QUALITY_CHANGE_REQUESTED,_,t),t}d.__dashjs_factory_name="L2ARule";const h=o.Z.getClassFactory(d)},6070:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5448),i=n(6398),o=n(2068);function a(){var e,t,n=this.context;return e={getMaxIndex:function(e){for(var r=e?e.getSwitchHistory():null,i=r?r.getSwitchRequests():[],a=0,s=0,l=0,u=(0,o.Z)(n).create(),c=0;c<i.length;c++)if(void 0!==i[c]&&(a+=i[c].drops,s+=i[c].noDrops,l+=i[c].dropSize,a+s>=6&&a/s>.075)){u.quality=c>0&&i[c].drops>0?c-1:c,u.reason={index:u.quality,drops:a,noDrops:s,dropSize:l},t.debug("Switch history rule index: "+u.quality+" samples: "+(a+s)+" drops: "+a);break}return u}},t=(0,i.Z)(n).getInstance().getLogger(e),e}a.__dashjs_factory_name="SwitchHistoryRule";const s=r.Z.getClassFactory(a)},5628:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(5448),i=n(2068),o=n(3393),a=n(3860);function s(e){e=e||{};var t=this.context,n=e.dashMetrics;return{getMaxIndex:function(e){var r=(0,i.Z)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return r;!function(){if(!n||!n.hasOwnProperty("getCurrentBufferState"))throw new Error(o.Z.MISSING_CONFIG_ERROR)}();var s=e.getMediaInfo(),l=e.getMediaType(),u=n.getCurrentBufferState(l),c=e.getScheduleController(),d=e.getAbrController(),h=e.getStreamInfo(),p=h?h.id:null,f=h&&h.manifestInfo?h.manifestInfo.isDynamic:null,m=d.getThroughputHistory(),g=m.getSafeAverageThroughput(l,f),y=m.getAverageLatency(l),v=e.useBufferOccupancyABR();return isNaN(g)||!u||v||d.getAbandonmentStateFor(p,l)!==a.Z.ABANDON_LOAD&&(u.state===a.Z.BUFFER_LOADED||f)&&(r.quality=d.getQualityForBitrate(s,g,p,y),c.setTimeToLoadDelay(0),r.reason={throughput:g,latency:y}),r},reset:function(){}}}s.__dashjs_factory_name="ThroughputRule";const l=r.Z.getClassFactory(s)},4722:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5448),i=n(6398);function o(){var e,t,n,r,o,a,s,l,u,c=this.context;function d(){n=null,r=1,o=100,a=0,s=null,l=null,u="dynamic_weight_selection"}function h(){var e=0;if(n)for(var t=0;t<n.length;t++){var r=n[t];r.state.throughput>e&&(e=r.state.throughput)}return e}function p(e,t,n){var r=e.map((function(e,r){return n[r]*Math.pow(e-t[r],2)})).reduce((function(e,t){return e+t}));return(r<0?-1:1)*Math.sqrt(Math.abs(r))}function f(e,t){return p([e.state.throughput,e.state.latency,e.state.rebuffer,e.state.switch],[t.state.throughput,t.state.latency,t.state.rebuffer,t.state.switch],[1,1,1,1])}function m(e,t,n){for(var r=0;r<t.length;r++){var i=t[r],o=f(i,e);g(i,n,Math.exp(-1*Math.pow(o,2)/(2*Math.pow(.1,2))))}}function g(e,t,n){var r=e.state,i=[.01,.01,.01,.01];r.throughput=r.throughput+(t[0]-r.throughput)*i[0]*n,r.latency=r.latency+(t[1]-r.latency)*i[1]*n,r.rebuffer=r.rebuffer+(t[2]-r.rebuffer)*i[2]*n,r.switch=r.switch+(t[3]-r.switch)*i[3]*n}return e={getNextQuality:function(e,i,c,d,f,g,y){var v=c,b=d,_=i,E=function(e){if(!n){n=[];var t=e.bitrateList,i=[];a=t[0].bandwidth,t.forEach((function(e){i.push(e.bandwidth),e.bandwidth<a&&(a=e.bandwidth)})),u=i.map((function(e){return Math.pow(e,2)})).reduce((function(e,t){return e+t})),r=Math.sqrt(u);for(var o=0;o<t.length;o++){var s={qualityIndex:o,bitrate:t[o].bandwidth,state:{throughput:t[o].bandwidth/r,latency:0,rebuffer:0,switch:0}};n.push(s)}l=function(e){var t=[],n=function(e){for(var t=[],n=0;n<e;n++){var r=[Math.random()*h(),Math.random(),Math.random(),Math.random()];t.push(r)}return t}(Math.pow(e.length,2));t.push(n[0]);for(var r=[1,1,1,1],i=1;i<e.length;i++){for(var o=null,a=null,s=0;s<n.length;s++){for(var l=n[s],u=null,c=0;c<t.length;c++){var d=p(l,t[c],r);(null===u||d<u)&&(u=d)}(null===a||u>a)&&(o=l,a=u)}t.push(o)}for(var f=null,m=null,g=0;g<t.length;g++){for(var y=0,v=0;v<t.length;v++)g!==v&&(y+=p(t[g],t[v],r));(null===f||y>f)&&(f=y,m=g)}var b=[];for(b.push(t[m]),t.splice(m,1);t.length>0;){for(var _=null,E=null,w=0;w<t.length;w++){var T=p(b[0],t[w],r);(null===_||T<_)&&(_=T,E=w)}b.push(t[E]),t.splice(E,1)}return b}(n)}var u;return n}(e),w=i/r;w>1&&(w=h()),c/=o,t.debug("getNextQuality called throughput:".concat(w," latency:").concat(c," bufferSize:").concat(d," currentQualityIndex:").concat(g," playbackRate:").concat(f));var T=E[g],A=T.bitrate*y.getSegmentDuration()/_,S=Math.max(0,A-b);if(b-A<y.getMinBuffer())return t.debug("Buffer is low for bitrate= ".concat(T.bitrate," downloadTime=").concat(A," currentBuffer=").concat(b," rebuffer=").concat(S)),function(e,t){var r=0,i=e;if(n)for(var o=0;o<n.length;o++){var a=n[o];a.bitrate<e.bitrate&&a.bitrate>r&&t>a.bitrate&&(r=a.bitrate,i=a)}return i}(T,_).qualityIndex;switch(u){case"manual_weight_selection":s=[.4,.4,.4,.4];break;case"random_weight_selection":!function(e){s=function(e,t){for(var n=[],r=Math.sqrt(2/e),i=0;i<4;i++)n.push(Math.random()*r);return s=n}(e.length)}(E);break;default:!function(e,t,n,r,i,o,a){s||(s=l[l.length-1]);var u=e.findWeightVector(t,n,r,i,o,a);null!==u&&-1!==u&&(s=u)}(y,E,v,b,S,_,f)}for(var x=null,I=null,R=null,C=0;C<E.length;C++){var M=E[C],L=M.state,P=[L.throughput,L.latency,L.rebuffer,L.switch],D=s.slice(),O=y.getNextBufferWithBitrate(M.bitrate,b,_),N=O<y.getMinBuffer();N&&t.debug("Buffer is low for bitrate=".concat(M.bitrate," downloadTime=").concat(A," currentBuffer=").concat(b," nextBuffer=").concat(O)),(M.bitrate>i-1e4||N)&&M.bitrate!==a&&(D[0]=100);var k=p(P,[w,0,0,0],D);(null===x||k<x)&&(x=k,I=M.qualityIndex,R=M)}var F=Math.abs(T.bitrate-R.bitrate)/r;return m(T,E,[w,c,S,F]),m(R,E,[w,0,0,F]),I},reset:function(){d()}},t=(0,i.Z)(c).getInstance().getLogger(e),d(),e}o.__dashjs_factory_name="LearningAbrController";const a=r.Z.getClassFactory(o)},5317:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5448),i=n(2298);function o(){var e,t,n,r,o;function a(){t=null,n=null,r=null,o=null}function s(e,t,n,r){var o=new i.Z;return o.type=e,o.weights.bitrateReward=t||1,o.weights.bitrateSwitchPenalty=1,o.weights.rebufferPenalty=n||1e3,o.weights.latencyPenalty=[],o.weights.latencyPenalty.push({threshold:1.1,penalty:.05*r}),o.weights.latencyPenalty.push({threshold:1e8,penalty:.1*n}),o.weights.playbackSpeedPenalty=r||200,o}function l(e,t,n,r,i){i.bitrateWSum+=i.weights.bitrateReward*e,i.lastBitrate&&(i.bitrateSwitchWSum+=i.weights.bitrateSwitchPenalty*Math.abs(e-i.lastBitrate)),i.lastBitrate=e,i.rebufferWSum+=i.weights.rebufferPenalty*t;for(var o=0;o<i.weights.latencyPenalty.length;o++){var a=i.weights.latencyPenalty[o];if(n<=a.threshold){i.latencyWSum+=a.penalty*n;break}}i.playbackSpeedWSum+=i.weights.playbackSpeedPenalty*Math.abs(1-r),i.totalQoe=i.bitrateWSum-i.bitrateSwitchWSum-i.rebufferWSum-i.latencyWSum-i.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,i,a){t=s("segment",e,i,a),n=e,r=i,o=a},logSegmentMetrics:function(e,n,r,i){t&&l(e,n,r,i,t)},getPerSegmentQoe:function(){return t},calculateSingleUseQoe:function(e,t,i,a){var u=null;return n&&r&&o&&(u=s("segment",n,r,o)),u?(l(e,t,i,a,u),u.totalQoe):0},reset:function(){a()}},a(),e}o.__dashjs_factory_name="LoLpQoeEvaluator";const a=r.Z.getClassFactory(o)},5435:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(6398),i=n(5448),o=n(4722),a=n(5317),s=n(2068),l=n(3860),u=n(6523),c=n(3393);function d(e){var t,n,i,d,h=(e=e||{}).dashMetrics,p=this.context;return n={getMaxIndex:function(e){try{var n=(0,s.Z)(p).create(),r=e.getMediaInfo().type,o=e.getAbrController(),a=e.getStreamInfo(),f=o.getQualityFor(r,a.id),m=e.getMediaInfo(),g=h.getCurrentBufferState(r),y=e.getScheduleController(),v=h.getCurrentBufferLevel(r,!0),b=a&&a.manifestInfo?a.manifestInfo.isDynamic:null,_=y.getPlaybackController(),E=_.getCurrentLiveLatency();if(!e.useLoLPABR()||r===c.Z.AUDIO)return n;E||(E=0);var w=_.getPlaybackRate(),T=o.getThroughputHistory().getSafeAverageThroughput(r,b);if(t.debug("Throughput ".concat(Math.round(T)," kbps")),isNaN(T)||!g)return n;if(o.getAbandonmentStateFor(a.id,r)===l.Z.ABANDON_LOAD)return n;for(var A=m.bitrateList,S=e.getRepresentationInfo().fragmentDuration,x=A[0].bandwidth/1e3,I=A[A.length-1].bandwidth/1e3,R=0;R<A.length;R++){var C=A[R].bandwidth/1e3;C>I?I=C:C<x&&(x=C)}var M=A[f].bandwidth/1e3,L=h.getCurrentHttpRequest(r,!0),P=(L.tresponse.getTime()-L.trequest.getTime())/1e3,D=P>S?P-S:0;d.setupPerSegmentQoe(S,I,x),d.logSegmentMetrics(M,D,E,w);var O=(0,u.Z)(p).create({targetLatency:1.5,bufferMin:.3,segmentDuration:S,qoeEvaluator:d});return n.quality=i.getNextQuality(m,1e3*T,E,v,w,f,O),n.reason={throughput:T,latency:E},n.priority=s.Z.PRIORITY.STRONG,y.setTimeToLoadDelay(0),n.quality!==f&&t.debug("[TgcLearningRule]["+r+"] requesting switch to index: ",n.quality,"Average throughput",Math.round(T),"kbps"),n}catch(e){throw e}},reset:function(){i.reset(),d.reset()}},t=(0,r.Z)(p).getInstance().getLogger(n),i=(0,o.Z)(p).create(),d=(0,a.Z)(p).create(),n}d.__dashjs_factory_name="LoLPRule";const h=i.Z.getClassFactory(d)},6523:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(5448);function i(e){var t,n,r,i,o=e.targetLatency,a=e.bufferMin,s=e.segmentDuration,l=e.qoeEvaluator;function u(){return s}function c(e,t){var n=u();return t>n?e-n:e+n-t}return t={getMinBuffer:function(){return a},getSegmentDuration:u,getNextBufferWithBitrate:function(e,t,n){return c(t,e*s/n)},getNextBuffer:c,findWeightVector:function(e,t,i,u,d,h){var p=null,f=null,m=null,g=Math.abs(t-r);return e.forEach((function(e){n.forEach((function(n){n[0];var r=n[1],u=n[2],y=(n[3],e.bitrate*s/d),v=c(i,y),b=(0===u?10:1/u)*Math.max(1e-5,y-v),_=(0===r?10:1/r)*e.state.latency,E=l.calculateSingleUseQoe(e.bitrate,b,_,h);(null===p||E>p)&&function(e,t,n){return!(e>o+n)&&t>=a}(t,v,g)&&(p=E,f=n,m=e.bitrate)}))})),null===f&&null===m&&(f=-1),r=t,f}},n=function e(t,n,r){if(r===n)return t;for(var o=t.length,a=0;a<o;a++)for(var s=t.shift(),l=0;l<i.length;l++)t.push(s.concat(i[l]));return e(t,n,r+1)}((i=[.2,.4,.6,.8,1]).map((function(e){return[e]})),4,1),r=0,t}i.__dashjs_factory_name="LoLpWeightSelector";const o=r.Z.getClassFactory(i)},2298:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},7803:(e,t,n)=>{"use strict";n.d(t,{Y:()=>p,Z:()=>m});var r=n(3393),i=n(1553),o=n(5448),a=n(2128),s=n(2594),l=n(7387),u=n(7417),c=n(9032),d=n(9326),h=n(7802),p=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function f(e){var t,n,o,f,m,g,y,v,b=this.context,_=e.adapter,E=e.baseURLController,w=e.streamInfo,T=e.timelineConverter,A=e.debug,S=e.eventBus,x=e.events,I=e.dashConstants,R=(0,s.Z)(b).getInstance();function C(e,t){var r=new a.Z;r.id=e.id,r.bitrate=e.bandwidth,r.width=e.width,r.height=e.height,r.tilesHor=1,r.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach((function(e){if(p.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(r.tilesHor=parseInt(t[0],10),r.tilesVert=parseInt(t[1],10))}})),t?g.updateSegmentData(e).then((function(t){!function(e,t,n){var r=[],i=function(e,t){var n,r,i,o,a=[],s=0;for(n=0,r=e.segments.length;n<r;n++)i=e.segments[n],(o=(0,l.TJ)(T,_.getIsDynamic(),t,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,s))&&(a.push(o),o=null,s++);return a}(n,t);t.segments=i,e.segmentDuration=t.segments[0].duration,e.readThumbnail=function(e,n){var i=null;r.some((function(t){if(t.start<=e&&t.end>e)return i=t.url,!0})),i?n(i):t.segments.some((function(i){if(i.mediaStartTime<=e&&i.mediaStartTime+i.duration>e){var o=E.resolve(t.path);return y.load({method:"get",url:o.url,request:{range:i.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=v.getSamplesInfo(e.target.response),o=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),a=window.URL.createObjectURL(o);r.push({start:i.mediaStartTime,end:i.mediaStartTime+i.duration,url:a}),n&&n(a)}}),!0}}))}}(r,e,t)})):(r.startNumber=e.startNumber,r.segmentDuration=e.segmentDuration,r.timescale=e.timescale,r.templateUrl=function(e){var t=R.isRelative(e.media)?R.resolve(e.media,E.resolve(e.path).url):e.media;return t?(0,l.Aj)(t,e.id):""}(e)),r.tilesHor>0&&r.tilesVert>0&&(r.widthPerTile=r.width/r.tilesHor,r.heightPerTile=r.height/r.tilesVert,n.push(r))}function M(){n=[],f=-1,m=null}return t={getTracks:function(){return n},addTracks:function(){if(w&&_&&(m=_.getMediaInfoForType(w,r.Z.IMAGE))){var e=_.getVoRepresentations(m);e&&e.length>0&&e.forEach((function(e){(e.segmentInfoType===i.Z.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===i.Z.SEGMENT_TIMELINE)&&C(e),e.segmentInfoType===i.Z.SEGMENT_BASE&&C(e,!0)})),n.length>0&&n.sort((function(e,t){return e.bitrate-t.bitrate}))}},reset:M,setTrackByIndex:function(e){n&&0!==n.length&&(e>=n.length&&(e=n.length-1),f=e)},getCurrentTrack:function(){return f<0?null:n[f]},getCurrentTrackIndex:function(){return f},getThumbnailRequestForTime:function(e){for(var t,r=_.getVoRepresentations(m),i=0;i<r.length;i++)if(n[f].id===r[i].id){t=r[i];break}return o.getSegmentRequestForTime(m,t,e)}},M(),y=(0,c.Z)(b).create({}),v=(0,u.Z)(b).getInstance(),g=(0,h.Z)(b).create({events:x,eventBus:S,streamInfo:w,timelineConverter:T,dashConstants:I,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController,type:r.Z.IMAGE}),(o=(0,d.Z)(b).create({streamInfo:w,type:r.Z.IMAGE,timelineConverter:T,segmentsController:g,baseURLController:E,debug:A,eventBus:S,events:x,dashConstants:I,urlUtils:R})).initialize(!!_&&_.getIsDynamic()),t}f.__dashjs_factory_name="ThumbnailTracks";const m=o.Z.getClassFactory(f)},7417:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(6398),i=n(8260),o=n(5448),a=n(6934),s=n(9597);function l(){var e,t,n=this.context;function o(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=a.parseBuffer(e),r=(0,i.Z)(n).create();return r.setData(t),r}function l(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:o,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.Z(0,!1);for(var r,i=t instanceof ArrayBuffer?new Uint8Array(t):t,o=0;n<i.byteLength;){var a=l(i,n),c=u(i,n+4);if(0===a)break;n+a<=i.byteLength&&(e.indexOf(c)>=0?r=new s.Z(n,!0,a):o=n+a),n+=a}return r||new s.Z(o,!1)},getMediaTimescaleFromMoov:function(e){var t=o(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,r,i,a,s,l,u,c,d,h,p,f,m,g,y,v=o(e),b=v.getBoxes("moof"),_=v.getBoxes("mfhd");g=v.getBoxes("moof").length,m=_[_.length-1].sequence_number,n=0,a=[];var E=-1,w=-1;for(d=0;d<b.length;d++){var T=b[d],A=T.getChildBoxes("traf");for(u=0;u<A.length;u++){var S=A[u],x=S.getChildBox("tfhd"),I=S.getChildBox("tfdt");i=I.baseMediaDecodeTime;var R=S.getChildBoxes("trun"),C=S.getChildBoxes("subs");for(c=0;c<R.length;c++){var M=R[c];for(n=M.sample_count,f=(x.base_data_offset||0)+(M.data_offset||0),l=0;l<n;l++){t=void 0!==(s=M.samples[l]).sample_duration?s.sample_duration:x.default_sample_duration,r=void 0!==s.sample_size?s.sample_size:x.default_sample_size;var L={dts:i,cts:i+(void 0!==s.sample_composition_time_offset?s.sample_composition_time_offset:0),duration:t,offset:T.offset+f,size:r,subSizes:[r]};if(C)for(h=0;h<C.length;h++){var P=C[h];if(E<P.entry_count-1&&l>w&&(E++,w+=P.entries[E].sample_delta),l==w){L.subSizes=[];var D=P.entries[E];for(p=0;p<D.subsample_count;p++)L.subSizes.push(D.subsamples[p].subsample_size)}}a.push(L),f+=r,i+=t}}y=i-I.baseMediaDecodeTime}}return{sampleList:a,lastSequenceNumber:m,totalDuration:y,numSequences:g}},findInitRange:function(t){var n=null,r=o(t);if(!r)return n;var i=r.getBox("ftyp"),a=r.getBox("moov");return e.debug("Searching for initialization."),a&&a.isComplete&&(n=(i?i.offset:a.offset)+"-"+(a.offset+a.size-1),e.debug("Found the initialization.  Range: "+n)),n},parsePayload:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.Z(0,!1);for(var r,i=t instanceof ArrayBuffer?new Uint8Array(t):t,o=0;n<i.byteLength;){var a=l(i,n),c=u(i,n+4);if(0===a)break;n+a<=i.byteLength&&(e.indexOf(c)>=0?r=new s.Z(n,!0,a,c):o=n+a),n+=a}return r||new s.Z(o,!1)}},e=(0,r.Z)(n).getInstance().getLogger(t),t}l.__dashjs_factory_name="BoxParser";const u=o.Z.getSingletonFactory(l)},1715:(e,t,n)=>{"use strict";n.d(t,{B:()=>s,Z:()=>u});var r=n(5448),i=n(7803),o=n(3393),a=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function s(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function l(){var e,t,n;return e={setConfig:function(e){e&&e.settings&&(t=e.settings)},supportsMediaSource:s,supportsEncryptedMedia:function(){return n},supportsCodec:function(e,n){return n!==o.Z.AUDIO&&n!==o.Z.VIDEO?Promise.resolve(!0):function(e,n){return t.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(e.codec&&n===o.Z.AUDIO||n===o.Z.VIDEO&&e.codec&&e.width&&e.height&&e.bitrate&&e.framerate)}(e,n)?function(e,t){return new Promise((function(n){if(e&&e.codec){var r={type:"media-source"};r[t]={},r[t].contentType=e.codec,r[t].width=e.width,r[t].height=e.height,r[t].bitrate=parseInt(e.bitrate),r[t].framerate=parseFloat(e.framerate),navigator.mediaCapabilities.decodingInfo(r).then((function(e){n(e.supported)})).catch((function(){n(!1)}))}else n(!1)}))}(e,n):function(e){return new Promise((function(t){if(e&&e.codec){var n=e.codec;e.width&&e.height&&(n+=';width="'+e.width+'";height="'+e.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(n)||"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(n)?t(!0):t(!1)}else t(!1)}))}(e)},setEncryptedMediaSupported:function(e){n=e},supportsEssentialProperty:function(e){try{return-1!==i.Y.indexOf(e.schemeIdUri)}catch(e){return!0}},codecRootCompatibleWithCodec:function(e,t){for(var n,r=e.split(".")[0],i=0===t.indexOf(r),o=0;o<a.length;o++)if(a[o].codec===r){n=a[o];break}return n?i||n.compatibleCodecs.some((function(e){return 0===t.indexOf(e)})):i}},n=!1,e}l.__dashjs_factory_name="Capabilities";const u=r.Z.getSingletonFactory(l)},2295:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5448),i=n(3106);function o(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,i.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,i.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}o.__dashjs_factory_name="CustomTimeRanges";const a=r.Z.getClassFactory(o)},5:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(5448);function i(){var e,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,r=/^https:\/\//i,i=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,o=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},a=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;d(e)&&(n=l),h(e)&&(n=u);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(i)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function l(e){var t=e.match(i);return t?t[1]:""}function u(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function d(e){return c(e)&&"/"===e.charAt(0)}function h(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y"),e=o}catch(e){}finally{e=e||a}}(),{parseBaseUrl:s,parseOrigin:l,parseScheme:u,isRelative:c,isPathAbsolute:d,isSchemeRelative:h,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return r.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,n){return e(t,n)}}}i.__dashjs_factory_name="DefaultURLUtils";const o=r.Z.getSingletonFactory(i)},8260:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(2839),i=n(5448);function o(){var e;function t(t){var r=[];if(!t||!e||"function"!=typeof e.fetchAll)return r;for(var i,o=e.fetchAll(t),a=0,s=o.length;a<s;a++)(i=n(o[a]))&&r.push(i);return r}function n(e){if(!e)return null;var t=new r.Z(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}o.__dashjs_factory_name="IsoFile";const a=i.Z.getClassFactory(o)},7473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a,k:()=>i});var r=n(5448);function i(e,t){var n={url:e.url,method:e.method,headers:Object.assign({},e.headers),credentials:e.withCredentials?"include":void 0};return Promise.resolve(t.modifyRequest(n)).then((function(){return Object.assign(e,n,{withCredentials:"include"===n.credentials})}))}function o(){return{modifyRequest:null,modifyRequestURL:function(e){return e},modifyRequestHeader:function(e,t){return t.url,e}}}o.__dashjs_factory_name="RequestModifier";const a=r.Z.getSingletonFactory(o)},3106:(e,t,n)=>{"use strict";n.d(t,{PS:()=>o,SE:()=>a});var r=n(3393);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){if(i(e)!==t)throw r.Z.BAD_ARGUMENT_ERROR}function a(e){if(null===e||isNaN(e)||e%1!=0)throw r.Z.BAD_ARGUMENT_ERROR+" : argument is not an integer"}},2594:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(5448),i=n(5);function o(){var e,t=[],n=this.context;function r(n,r,i){var o=function(n){var r;for(r=0;r<t.length;r++)if(t[r].regex.test(n))return t[r].utils;return e}(i||r);return o&&"function"==typeof o[n]?o[n](r,i):e[n](r,i)}return e=(0,i.Z)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n})},parseBaseUrl:function(e){return r("parseBaseUrl",e)},parseOrigin:function(e){return r("parseOrigin",e)},parseScheme:function(e){return r("parseScheme",e)},isRelative:function(e){return r("isRelative",e)},isPathAbsolute:function(e){return r("isPathAbsolute",e)},isSchemeRelative:function(e){return r("isSchemeRelative",e)},isHTTPURL:function(e){return r("isHTTPURL",e)},isHTTPS:function(e){return r("isHTTPS",e)},removeHostname:function(e){return r("removeHostname",e)},resolve:function(e,t){return r("resolve",e,t)}}}o.__dashjs_factory_name="URLUtils";const a=r.Z.getSingletonFactory(o)},5459:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null}},3186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(7855),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}var t;return(t=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===r.w.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?r.w.INIT_SEGMENT_TYPE:r.w.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}();i.ACTION_DOWNLOAD="download",i.ACTION_COMPLETE="complete";const o=i},2839:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var r=0;r<t.references.length;r++){var i={reference_type:t.references[r].reference_type,referenced_size:t.references[r].referenced_size,subsegment_duration:t.references[r].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var o=0,a=t.samples.length;o<a;o++){var s={sample_size:t.samples[o].sample_size,sample_duration:t.samples[o].sample_duration,sample_composition_time_offset:t.samples[o].sample_composition_time_offset};this.samples.push(s)}}break;case"prft":this.version=t.version,this.reference_track_ID=t.reference_track_ID,this.ntp_timestamp_sec=t.ntp_timestamp_sec,this.ntp_timestamp_frac=t.ntp_timestamp_frac,this.media_time=t.media_time,this.flags=t.flags}}var t;return(t=[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}()},9597:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r}},2128:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},7855:(e,t,n)=>{"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{O:()=>o,w:()=>i});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},o=function e(){r(this,e),this.s=null,this.d=null,this.b=[]};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",i.DVB_REPORTING_TYPE="DVBReporting",i.LICENSE="license",i.CONTENT_STEERING_TYPE="ContentSteering",i.OTHER_TYPE="other"},3039:(e,t)=>{"use strict";function n(e,t){return function(n,i){for(var o,a,s,l=r(n,"tag"),u=r(null==i?"*":i,"range"),c=[],d=-1;++d<u.length;)if(o=u[d].toLowerCase(),t||"*"!==o){for(a=-1,s=[];++a<l.length;)if(e(l[a].toLowerCase(),o)){if(!t)return l[a];c.push(l[a])}else s.push(l[a]);l=s}return t?c:void 0}}function r(e,t){var n=e&&"string"==typeof e?[e]:e;if(!n||"object"!=typeof n||!("length"in n))throw new Error("Invalid "+t+" `"+n+"`, expected non-empty string");return n}t.basicFilter=n((function(e,t){return"*"===t||e===t||e.indexOf(t+"-")>-1}),!0),t.extendedFilter=n((function(e,t){var n=e.split("-"),r=t.split("-"),i=0,o=0;if("*"!==r[o]&&n[i]!==r[o])return!1;for(i++,o++;o<r.length;)if("*"!==r[o]){if(!n[i])return!1;if(n[i]!==r[o]){if(1===n[i].length)return!1;i++}else i++,o++}else o++;return!0}),!0),t.lookup=n((function(e,t){for(var n,r=t;;){if("*"===r||e===r)return!0;if((n=r.lastIndexOf("-"))<0)return!1;"-"===r.charAt(n-2)&&(n-=2),r=r.slice(0,n)}}))},3973:(e,t,n)=>{"use strict";e.exports=n(3854)},3854:(e,t,n)=>{"use strict";var r=n(2415),i=n(3039),o=n(7778),a=n(5813),s=n(3165),l=n(9460);e.exports=function(e,t){var n,c=t||{},g=r.parse(String(e||"").toLowerCase(),c),y=r.stringify(g),v=-1;if(!y)return y;for(;++v<o.length;)i.extendedFilter(y,o[v].from).length&&(h(g,o[v].from,o[v].to),y=r.stringify(g));for(v=-1;++v<a.length;)p(g,a[v].from.field,a[v].from.value)&&f(g,a[v].to.field,a[v].to.value);for(y=r.stringify(Object.assign({},g,d)),v=-1;++v<s.length;)y===s[v]&&(h(g,s[v],s[v].split("-").slice(0,-1).join("-")),y=r.stringify(Object.assign({},g,d)));if(g.extensions.sort(m),c.warning)for(n in l)u.call(l[n],g[n])&&c.warning("Deprecated "+n+" `"+g[n]+"`, expected one of `"+l[n][g[n]].join("`, `")+"`",null,7);return g.script&&(g.script=g.script.charAt(0).toUpperCase()+g.script.slice(1)),g.region&&(g.region=g.region.toUpperCase()),r.stringify(g)};var u={}.hasOwnProperty,c=new Intl.Collator,d={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function h(e,t,n){var i,o=r.parse(t),a=r.parse(n),s=[];for(i in o)o[i]&&o[i].length&&p(e,i,o[i])&&s.push(i);for(i in a)a[i]&&a[i].length&&(s.indexOf(i)>-1||!e[i]||!e[i].length)&&f(e,i,a[i])}function p(e,t,n){var r,i,o,a,s=!1;if(n){if(i=r=e[t],r&&"object"==typeof r)for(i=[],o=-1;++o<r.length;)a=r[o],n.indexOf(a)<0?i.push(a):s=!0;else r===n&&(i=null,s=!0);e[t]=i}return s}function f(e,t,n){var r,i,o,a=e[t];if(a&&"object"==typeof a)for(r=[].concat(n),i=-1;++i<r.length;)o=r[i],a.indexOf(o)<0&&a.push(o);else e[t]=n}function m(e,t){return c.compare(e.singleton,t.singleton)}},2415:(e,t,n)=>{"use strict";t.parse=n(6903),t.stringify=n(6713)},6903:(e,t,n)=>{"use strict";var r=n(2219),i=n(3516),o=n(395),a=n(858),s=n(8589);e.exports=function e(t,n){var u,c,d,h=n||{},p={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},f=String(t),m=f.toLowerCase(),g=0;if(null==t)throw new Error("Expected string, got `"+t+"`");if(l.call(s,m))return(null==h.normalize||h.normalize)&&s[m]?e(s[m]):(p[-1===a.indexOf(m)?"irregular":"regular"]=f,p);for(;i(m.charCodeAt(g))&&g<9;)g++;if(g>1&&g<9){if(p.language=f.slice(0,g),g<4)for(c=0;45===m.charCodeAt(g)&&i(m.charCodeAt(g+1))&&i(m.charCodeAt(g+2))&&i(m.charCodeAt(g+3))&&!i(m.charCodeAt(g+4));){if(c>2)return y(g,3,"Too many extended language subtags, expected at most 3 subtags");p.extendedLanguageSubtags.push(f.slice(g+1,g+4)),g+=4,c++}for(45===m.charCodeAt(g)&&i(m.charCodeAt(g+1))&&i(m.charCodeAt(g+2))&&i(m.charCodeAt(g+3))&&i(m.charCodeAt(g+4))&&!i(m.charCodeAt(g+5))&&(p.script=f.slice(g+1,g+5),g+=5),45===m.charCodeAt(g)&&(i(m.charCodeAt(g+1))&&i(m.charCodeAt(g+2))&&!i(m.charCodeAt(g+3))?(p.region=f.slice(g+1,g+3),g+=3):o(m.charCodeAt(g+1))&&o(m.charCodeAt(g+2))&&o(m.charCodeAt(g+3))&&!o(m.charCodeAt(g+4))&&(p.region=f.slice(g+1,g+4),g+=4));45===m.charCodeAt(g);){for(d=u=g+1;r(m.charCodeAt(d));){if(d-u>7)return y(d,1,"Too long variant, expected at most 8 characters");d++}if(!(d-u>4||d-u>3&&o(m.charCodeAt(u))))break;p.variants.push(f.slice(u,d)),g=d}for(;45===m.charCodeAt(g)&&120!==m.charCodeAt(g+1)&&r(m.charCodeAt(g+1))&&45===m.charCodeAt(g+2)&&r(m.charCodeAt(g+3));){for(d=g+2,c=0;45===m.charCodeAt(d)&&r(m.charCodeAt(d+1))&&r(m.charCodeAt(d+2));)for(d=(u=d+1)+2,c++;r(m.charCodeAt(d));){if(d-u>7)return y(d,2,"Too long extension, expected at most 8 characters");d++}if(!c)return y(d,4,"Empty extension, extensions must have at least 2 characters of content");p.extensions.push({singleton:f.charAt(g+1),extensions:f.slice(g+3,d).split("-")}),g=d}}else g=0;if(0===g&&120===m.charCodeAt(g)||45===m.charCodeAt(g)&&120===m.charCodeAt(g+1))for(d=g=g?g+2:1;45===m.charCodeAt(d)&&r(m.charCodeAt(d+1));){for(d=u=g+1;r(m.charCodeAt(d));){if(d-u>7)return y(d,5,"Too long private-use area, expected at most 8 characters");d++}p.privateuse.push(f.slice(g+1,d)),g=d}return g!==f.length?y(g,6,"Found superfluous content after tag"):p;function y(e,t,n){return h.warning&&h.warning(n,t,e),h.forgiving?p:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}};var l={}.hasOwnProperty},6713:e=>{"use strict";e.exports=function(e){var t,n,r,i=e||{},o=[];if(i.irregular||i.regular)return i.irregular||i.regular;if(i.language)for(o=o.concat(i.language,i.extendedLanguageSubtags||[],i.script||[],i.region||[],i.variants||[]),t=i.extensions||[],n=-1;++n<t.length;)(r=t[n]).singleton&&r.extensions&&r.extensions.length&&(o=o.concat(r.singleton,r.extensions));return i.privateuse&&i.privateuse.length&&(o=o.concat("x",i.privateuse)),o.join("-")}},1549:(e,t,n)=>{"use strict";var r=n(6693),i=n(2165),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;var a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|m(e,t),r=s(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){var t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);var i=function(e){if(l.isBuffer(e)){var t=0|f(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||V(e.length)?s(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return c(e),s(e<0?0:0|f(e))}function h(e){for(var t=e.length<0?0:0|f(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function f(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(i)return r?-1:B(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return C(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),V(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){var o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var c=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(u(e,o+h)!==u(t,h)){d=!1;break}if(d)return o}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(V(s))return a;e[n+a]=s}return a}function E(e,t,n,r){return z(B(t,e.length-n),e,n,r)}function w(e,t,n,r){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return z(U(t),e,n,r)}function A(e,t,n,r){return z(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function S(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,l,u=e[i],c=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=I));return n}(r)}t.kMaxLength=a,l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(G(o,Uint8Array))i+o.length>r.length?l.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,i){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),c=e.slice(t,n),d=0;d<s;++d)if(u[d]!==c[d]){o=u[d],a=c[d];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":case"latin1":case"binary":return w(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=j[e[o]];return i}function L(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,r,o){return t=+t,n>>>=0,o||O(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function k(e,t,n,r,o){return t=+t,n>>>=0,o||O(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||P(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return k(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return k(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:l.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+/0-9A-Za-z-_]/g;function B(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function V(e){return e!=e}var j=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}()},6693:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=s(e),a=o[0],l=o[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,l)),c=0,d=l>0?a-4:a;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[c++]=255&t),1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,u=r-i;s<u;s+=a)o.push(l(e,s,s+a>u?u:s+a));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},2165:(e,t)=>{t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+e[t+d],d+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+d],d+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=u}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=c?(s=0,a=c):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=f,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+p]=255&a,p+=f,a/=256,u-=8);e[n+p-f]|=128*m}},6934:(e,t)=>{var n={parseBuffer:function(e){return new r(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(i.prototype._boxProcessors[e]=t)},createFile:function(){return new r},createBox:function(e,t,n){var r=i.create(e);return t&&t.append(r,n),r},createFullBox:function(e,t,r){var i=n.createBox(e,t,r);return i.version=0,i.flags=0,i},Utils:{}};n.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var o=e.getUint8(i++);o<128||(o<224?(o=(31&o)<<6,o|=63&e.getUint8(i++)):o<240?(o=(15&o)<<12,o|=(63&e.getUint8(i++))<<6,o|=63&e.getUint8(i++)):(o=(7&o)<<18,o|=(63&e.getUint8(i++))<<12,o|=(63&e.getUint8(i++))<<6,o|=63&e.getUint8(i++))),r.push(String.fromCharCode(o))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},n.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},n.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var r,i=-1;if("number"==typeof n)i=n;else{if("string"==typeof n)r=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type}for(var o=0;o<e.boxes.length;o++)if(r===e.boxes[o].type){i=o+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=n.parseBuffer,t.addBoxProcessor=n.addBoxProcessor,t.createFile=n.createFile,t.createBox=n.createBox,t.createFullBox=n.createFullBox,t.Utils=n.Utils,n.Cursor=function(e){this.offset=void 0===e?0:e};var r=function(e){this._cursor=new n.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};r.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},r.prototype.fetchAll=function(e,t){var n=[];return r._sweep.call(this,e,n,t),n},r.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=i.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},r._sweep=function(e,t,n){for(var i in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;r._sweep.call(this.boxes[i],e,t,n)}},r.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},r.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)};var i=function(){this._cursor=new n.Cursor};i.parse=function(e){var t=new i;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},i.create=function(e){var t=new i;return t.type=e,t.boxes=[],t},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},i.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r])},i.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i])},i.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t])},i.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(i.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},i.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(n+4);t=r*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},i.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(i+2));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(i+4),r=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,r},i.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},i.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},i.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},i.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?n.Utils.dataViewToString(t):t},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(e,t){n.Utils.appendBox(this,e,t)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(n+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(i+2,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(i+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},i.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},i.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r)},i.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},i.prototype._writeUTF8String=function(e){var t=n.Utils.utf8ToByteArray(e);if(this._rawo)for(var r=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)r.setUint8(i,t[i]);else this.size+=t.length},i.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.avc2=i.prototype._boxProcessors.avc3=i.prototype._boxProcessors.avc4=i.prototype._boxProcessors.hvc1=i.prototype._boxProcessors.hev1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_offset",1===this.version?"int":"uint",32)}))},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)}))},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",1==this.version?64:32)},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,(function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)}))}))},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.sttg=function(){this._procField("settings","utf8")},i.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_delta","uint",32)}))},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,(function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)}))}))},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}},5530:(e,t,n)=>{"use strict";e.exports=n(6146).polyfill()},6146:function(e,t,n){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,i=void 0,o=void 0,a=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(o?o(f):b())},s="undefined"!=typeof window?window:void 0,l=s||{},u=l.MutationObserver||l.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(f,1)}}var p=new Array(1e3);function f(){for(var e=0;e<r;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;r=0}var m,g,y,v,b=void 0;function _(e,t){var n=this,r=new this.constructor(T);void 0===r[w]&&O(r);var i=n._state;if(i){var o=arguments[i-1];a((function(){return P(i,r,o,n._result)}))}else M(n,r,e,t);return r}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(T);return x(t,e),t}b=c?function(){return process.nextTick(f)}:u?(g=0,y=new u(f),v=document.createTextNode(""),y.observe(v,{characterData:!0}),function(){v.data=g=++g%2}):d?((m=new MessageChannel).port1.onmessage=f,function(){return m.port2.postMessage(0)}):void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(f)}:h()}catch(e){return h()}}():h();var w=Math.random().toString(36).substring(2);function T(){}var A=void 0;function S(t,n,r){n.constructor===t.constructor&&r===_&&n.constructor.resolve===E?function(e,t){1===t._state?R(e,t._result):2===t._state?C(e,t._result):M(t,void 0,(function(t){return x(e,t)}),(function(t){return C(e,t)}))}(t,n):void 0===r?R(t,n):e(r)?function(e,t,n){a((function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?x(e,n):R(e,n))}),(function(t){r||(r=!0,C(e,t))}),e._label);!r&&i&&(r=!0,C(e,i))}),e)}(t,n,r):R(t,n)}function x(e,t){if(e===t)C(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=t),null===r||"object"!==i&&"function"!==i)R(e,t);else{var n=void 0;try{n=t.then}catch(t){return void C(e,t)}S(e,t,n)}var r,i}function I(e){e._onerror&&e._onerror(e._result),L(e)}function R(e,t){e._state===A&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(L,e))}function C(e,t){e._state===A&&(e._state=2,e._result=t,a(I,e))}function M(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=n,i[o+2]=r,0===o&&e._state&&a(L,e)}function L(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?P(n,r,i,o):i(o);e._subscribers.length=0}}function P(t,n,r,i){var o=e(r),a=void 0,s=void 0,l=!0;if(o){try{a=r(i)}catch(e){l=!1,s=e}if(n===a)return void C(n,new TypeError("A promises callback cannot return that same promise."))}else a=i;n._state!==A||(o&&l?x(n,a):!1===l?C(n,s):1===t?R(n,a):2===t&&C(n,a))}var D=0;function O(e){e[w]=D++,e._state=void 0,e._result=void 0,e._subscribers=[]}var N=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(T),this.promise[w]||O(this.promise),t(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&R(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===E){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(e){a=!0,o=e}if(i===_&&e._state!==A)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===k){var s=new n(T);a?C(s,o):S(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===A&&(this._remaining--,2===e?C(r,n):this._result[t]=n),0===this._remaining&&R(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;M(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}(),k=function(){function t(e){this[w]=D++,this._result=this._state=void 0,this._subscribers=[],T!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){x(e,t)}),(function(t){C(e,t)}))}catch(t){C(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this,r=n.constructor;return e(t)?n.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):n.then(t,t)},t}();return k.prototype.then=_,k.all=function(e){return new N(this,e).promise},k.race=function(e){var n=this;return t(e)?new n((function(t,r){for(var i=e.length,o=0;o<i;o++)n.resolve(e[o]).then(t,r)})):new n((function(e,t){return t(new TypeError("You must pass an array to race."))}))},k.resolve=E,k.reject=function(e){var t=new this(T);return C(t,e),t},k._setScheduler=function(e){o=e},k._setAsap=function(e){a=e},k._asap=a,k.polyfill=function(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=k},k.Promise=k,k}()},1159:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,a,u;if(s(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(e))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var u=l.length,c=f(l,u);for(n=0;n<u;++n)r(c[n],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},3101:e=>{"use strict";var t=Array.isArray,n=Object.keys,r=Object.prototype.hasOwnProperty;e.exports=function e(i,o){if(i===o)return!0;if(i&&o&&"object"==typeof i&&"object"==typeof o){var a,s,l,u=t(i),c=t(o);if(u&&c){if((s=i.length)!=o.length)return!1;for(a=s;0!=a--;)if(!e(i[a],o[a]))return!1;return!0}if(u!=c)return!1;var d=i instanceof Date,h=o instanceof Date;if(d!=h)return!1;if(d&&h)return i.getTime()==o.getTime();var p=i instanceof RegExp,f=o instanceof RegExp;if(p!=f)return!1;if(p&&f)return i.toString()==o.toString();var m=n(i);if((s=m.length)!==n(o).length)return!1;for(a=s;0!=a--;)if(!r.call(o,m[a]))return!1;for(a=s;0!=a--;)if(!e(i[l=m[a]],o[l]))return!1;return!0}return i!=i&&o!=o}},3362:(e,t,n)=>{!function(e,t,n,r,i){function o(e){if("contents"in e)for(var t=("styleAttrs"in e?e.styleAttrs[r.byName.ruby.qname]:null),n="span"===e.kind&&("container"===t||"textContainer"===t||"baseContainer"===t),i=e.contents.length-1;i>=0;i--)!n||"styleAttrs"in e.contents[i]&&r.byName.ruby.qname in e.contents[i].styleAttrs?o(e.contents[i]):delete e.contents[i]}function a(e,t,n,r){var i=r&&"seq"===r.timeContainer,o=0;r&&(o=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+o:o;var s=t.begin,l=null;if("sets"in t)for(var u=0;u<t.sets.length;u++)a(e,t.sets[u],l,t),s="seq"===t.timeContainer?t.sets[u].end:Math.max(s,t.sets[u].end),l=t.sets[u];if("contents"in t){if("contents"in t)for(var c=0;c<t.contents.length;c++)a(e,t.contents[c],l,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),l=t.contents[c]}else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,o+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=o+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function s(e){this.node=e}function l(){this.events=[],this.head=new u,this.body=null}function u(){this.styling=new c,this.layout=new p}function c(){this.styles={},this.initials={}}function d(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function h(){this.styleAttrs=null}function p(){this.regions={}}function f(e,t){m.call(this,"image"),this.src=e,this.type=t}function m(e){this.kind=e}function g(e){this.id=e}function y(e){this.regionID=e}function v(e){this.styleAttrs=e}function b(e){this.sets=e}function _(e){this.contents=e}function E(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function w(){m.call(this,"body")}function T(){m.call(this,"div")}function A(){m.call(this,"p")}function S(){m.call(this,"span")}function x(){m.call(this,"span")}function I(){m.call(this,"br")}function R(){}function C(){}function M(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function L(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function P(e,t){var n={};if(null!==e)for(var i in e.attributes){var o=e.attributes[i].uri+" "+e.attributes[i].local,a=r.byQName[o];if(void 0!==a){var s=a.parse(e.attributes[i].value);null!==s?(n[o]=s,a===r.byName.zIndex&&B(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):U(t,"Cannot parse styling attribute "+o+" --\x3e "+e.attributes[i].value)}}return n}function D(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function O(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i}function N(e,t,n){for(;t.styleRefs.length>0;){var r=t.styleRefs.pop();r in e.styles?(N(e,e.styles[r],n),F(e.styles[r].styleAttrs,t.styleAttrs)):U(n,"Non-existant style id referenced")}}function k(e,t,n,r){for(var i=t.length-1;i>=0;i--){var o=t[i];o in e.styles?F(e.styles[o].styleAttrs,n):U(r,"Non-existant style id referenced")}}function F(e,t){for(var n in e)e.hasOwnProperty(n)&&(n in t||(t[n]=e[n]))}function B(e,t){if(e&&e.warn&&e.warn(t))throw t}function U(e,t){if(e&&e.error&&e.error(t))throw t}function z(e,t){throw e&&e.fatal&&e.fatal(t),t}function G(e,t){for(var n,r=0,i=e.length-1;r<=i;){var o=e[n=Math.floor((r+i)/2)];if(o<t)r=n+1;else{if(!(o>t))return{found:!0,index:n};i=n-1}}return{found:!1,index:r}}e.fromXML=function(e,i,m){var g=t.parser(!0,{xmlns:!0}),y=[],v=[],b=[],_=0,E=null;g.onclosetag=function(e){if(y[0]instanceof R)null!==E.head&&null!==E.head.styling&&k(E.head.styling,y[0].styleRefs,y[0].styleAttrs,i),delete y[0].styleRefs;else if(y[0]instanceof c)for(var t in y[0].styles)y[0].styles.hasOwnProperty(t)&&N(y[0],y[0].styles[t],i);else if(y[0]instanceof A||y[0]instanceof S){if(y[0].contents.length>1){var r,o=[y[0].contents[0]];for(r=1;r<y[0].contents.length;r++)y[0].contents[r]instanceof x&&o[o.length-1]instanceof x?o[o.length-1].text+=y[0].contents[r].text:o.push(y[0].contents[r]);y[0].contents=o}y[0]instanceof S&&1===y[0].contents.length&&y[0].contents[0]instanceof x&&(y[0].text=y[0].contents[0].text,delete y[0].contents)}else y[0]instanceof s&&(y[0].node.uri===n.ns_tt&&"metadata"===y[0].node.local?_--:_>0&&m&&"onCloseTag"in m&&m.onCloseTag());b.shift(),v.shift(),y.shift()},g.ontext=function(e){if(void 0===y[0]);else if(y[0]instanceof S||y[0]instanceof A){if(y[0]instanceof S){var t=y[0].styleAttrs[r.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return}var n=new x;n.initFromText(E,y[0],e,v[0],b[0],i),y[0].contents.push(n)}else y[0]instanceof s&&_>0&&m&&"onText"in m&&m.onText(e)},g.onopentag=function(e){var t=e.attributes["xml:space"];t?b.unshift(t.value):0===b.length?b.unshift("default"):b.unshift(b[0]);var o=e.attributes["xml:lang"];if(o?v.unshift(o.value):0===v.length?v.unshift(""):v.unshift(v[0]),e.uri===n.ns_tt)if("tt"===e.local)null!==E&&z(i,"Two <tt> elements at ("+this.line+","+this.column+")"),(E=new l).initFromNode(e,v[0],i),y.unshift(E);else if("head"===e.local)y[0]instanceof l||z(i,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),y.unshift(E.head);else if("styling"===e.local)y[0]instanceof u||z(i,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),y.unshift(E.head.styling);else if("style"===e.local){var a;y[0]instanceof c?((a=new d).initFromNode(e,i),a.id?E.head.styling.styles[a.id]=a:U(i,"<style> element missing @id attribute"),y.unshift(a)):y[0]instanceof R?((a=new d).initFromNode(e,i),F(a.styleAttrs,y[0].styleAttrs),y.unshift(a)):z(i,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var g;if(y[0]instanceof c){for(var x in(g=new h).initFromNode(e,i),g.styleAttrs)g.styleAttrs.hasOwnProperty(x)&&(E.head.styling.initials[x]=g.styleAttrs[x]);y.unshift(g)}else z(i,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)y[0]instanceof u||z(i,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),y.unshift(E.head.layout);else if("region"===e.local){y[0]instanceof p||z(i,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var M=new R;M.initFromNode(E,e,v[0],i),!M.id||M.id in E.head.layout.regions?U(i,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):E.head.layout.regions[M.id]=M,y.unshift(M)}else if("body"===e.local){y[0]instanceof l||z(i,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==E.body&&z(i,"Second <body> element at "+this.line+","+this.column+")");var L=new w;L.initFromNode(E,e,v[0],i),E.body=L,y.unshift(L)}else if("div"===e.local){y[0]instanceof T||y[0]instanceof w||z(i,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var P=new T;P.initFromNode(E,y[0],e,v[0],i);var D=P.styleAttrs[r.byName.backgroundImage.qname];D&&(P.contents.push(new f(D)),delete P.styleAttrs[r.byName.backgroundImage.qname]),y[0].contents.push(P),y.unshift(P)}else if("image"===e.local){y[0]instanceof T||z(i,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var O=new f;O.initFromNode(E,y[0],e,v[0],i),y[0].contents.push(O),y.unshift(O)}else if("p"===e.local){y[0]instanceof T||z(i,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var N=new A;N.initFromNode(E,y[0],e,v[0],i),y[0].contents.push(N),y.unshift(N)}else if("span"===e.local){y[0]instanceof S||y[0]instanceof A||z(i,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var k=new S;k.initFromNode(E,y[0],e,v[0],b[0],i),y[0].contents.push(k),y.unshift(k)}else if("br"===e.local){y[0]instanceof S||y[0]instanceof A||z(i,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var B=new I;B.initFromNode(E,y[0],e,v[0],i),y[0].contents.push(B),y.unshift(B)}else if("set"===e.local){y[0]instanceof S||y[0]instanceof A||y[0]instanceof T||y[0]instanceof w||y[0]instanceof R||y[0]instanceof I||z(i,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var G=new C;G.initFromNode(E,y[0],e,i),y[0].sets.push(G),y.unshift(G)}else y.unshift(new s(e));else y.unshift(new s(e));if(y[0]instanceof s)if(e.uri===n.ns_tt&&"metadata"===e.local)_++;else if(_>0&&m&&"onOpenTag"in m){var V=[];for(var j in e.attributes)V[e.attributes[j].uri+" "+e.attributes[j].local]={uri:e.attributes[j].uri,local:e.attributes[j].local,value:e.attributes[j].value};m.onOpenTag(e.uri,e.local,V)}},g.write(e).close(),delete E.head.styling.styles;var M=!1;for(var L in E.head.layout.regions)if(E.head.layout.regions.hasOwnProperty(L)){M=!0;break}if(!M){var P=R.prototype.createDefaultRegion(E.lang);E.head.layout.regions[P.id]=P}for(var D in E.head.layout.regions)E.head.layout.regions.hasOwnProperty(D)&&a(E,E.head.layout.regions[D],null,null);return E.body&&a(E,E.body,null,null),E.body&&o(E.body),E},l.prototype.initFromNode=function(e,t,r){var o=function(e,t){var r=D(e,n.ns_ttp,"cellResolution"),i=15,o=32;if(null!==r){var a=/(\d+) (\d+)/.exec(r);null!==a?(o=parseInt(a[1]),i=parseInt(a[2])):B(t,"Malformed cellResolution value (using initial value instead)")}return{w:o,h:i}}(e,r);this.cellLength={h:new i.ComputedLength(0,1/o.h),w:new i.ComputedLength(1/o.w,0)};var a=function(e,t){var r,i=D(e,n.ns_ttp,"frameRate"),o=30;null!==i&&(null!==(r=/(\d+)/.exec(i))?o=parseInt(r[1]):B(t,"Malformed frame rate attribute (using initial value instead)"));var a=D(e,n.ns_ttp,"frameRateMultiplier"),s=1;null!==a&&(null!==(r=/(\d+) (\d+)/.exec(a))?s=parseInt(r[1])/parseInt(r[2]):B(t,"Malformed frame rate multiplier attribute (using initial value instead)"));var l=s*o,u=1,c=D(e,n.ns_ttp,"tickRate");return null===c?null!==i&&(u=l):null!==(r=/(\d+)/.exec(c))?u=parseInt(r[1]):B(t,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:l,tickRate:u}}(e,r);this.effectiveFrameRate=a.effectiveFrameRate,this.tickRate=a.tickRate,this.aspectRatio=function(e,t){var r=D(e,n.ns_ittp,"aspectRatio");null===r&&(r=D(e,n.ns_ttp,"displayAspectRatio"));var i=null;if(null!==r){var o=/(\d+)\s+(\d+)/.exec(r);if(null!==o){var a=parseInt(o[1]),s=parseInt(o[2]);0!==a&&0!==s?i=a/s:U(t,"Illegal aspectRatio values (ignoring)")}else U(t,"Malformed aspectRatio attribute (ignoring)")}return i}(e,r);var s=D(e,n.ns_ttp,"timeBase");null!==s&&"media"!==s&&z(r,"Unsupported time base");var l=function(e,t){var r=D(e,n.ns_tts,"extent");if(null===r)return null;var o=r.split(" ");if(2!==o.length)return B(t,"Malformed extent (ignoring)"),null;var a=i.parseLength(o[0]),s=i.parseLength(o[1]);return s&&a?{h:s,w:a}:(B(t,"Malformed extent values (ignoring)"),null)}(e,r);null===l?this.pxLength={h:null,w:null}:("px"===l.h.unit&&"px"===l.w.unit||z(r,"Extent on TT must be in px or absent"),this.pxLength={h:new i.ComputedLength(0,1/l.h.value),w:new i.ComputedLength(1/l.w.value,0)}),this.dimensions={h:new i.ComputedLength(0,1),w:new i.ComputedLength(1,0)},this.lang=t},l.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=G(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=G(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},l.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},l.prototype.getMediaTimeEvents=function(){return this.events},d.prototype.initFromNode=function(e,t){this.id=M(e),this.styleAttrs=P(e,t),this.styleRefs=L(e)},h.prototype.initFromNode=function(e,t){for(var r in this.styleAttrs={},e.attributes)if(e.attributes[r].uri===n.ns_itts||e.attributes[r].uri===n.ns_ebutts||e.attributes[r].uri===n.ns_tts){var i=e.attributes[r].uri+" "+e.attributes[r].local;this.styleAttrs[i]=e.attributes[r].value}},f.prototype.initFromNode=function(e,t,n,r,i){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||U(i,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||U(i,"Invalid image@type attribute"),v.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),this.lang=r},g.prototype.initFromNode=function(e,t,n,r){this.id=M(n)},y.prototype.initFromNode=function(e,t,n,r){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},v.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=P(n,r),null!==e.head&&null!==e.head.styling&&k(e.head.styling,L(n),this.styleAttrs,r)},b.prototype.initFromNode=function(e,t,n,r){this.sets=[]},_.prototype.initFromNode=function(e,t,n,r){this.contents=[]},E.prototype.initFromNode=function(e,t,n,r){var i=function(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=O(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&B(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var o=null;n&&"dur"in n.attributes&&null===(o=O(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&B(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var a=null;return n&&"end"in n.attributes&&null===(a=O(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&B(r,"Malformed end value (ignoring)"),{explicit_begin:i,explicit_end:a,explicit_dur:o}}(e,0,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(U(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,r)},w.prototype.initFromNode=function(e,t,n,r){v.prototype.initFromNode.call(this,e,null,t,r),E.prototype.initFromNode.call(this,e,null,t,r),b.prototype.initFromNode.call(this,e,null,t,r),y.prototype.initFromNode.call(this,e,null,t,r),_.prototype.initFromNode.call(this,e,null,t,r),this.lang=n},T.prototype.initFromNode=function(e,t,n,r,i){v.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),this.lang=r},A.prototype.initFromNode=function(e,t,n,r,i){v.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),this.lang=r},S.prototype.initFromNode=function(e,t,n,r,i,o){v.prototype.initFromNode.call(this,e,t,n,o),E.prototype.initFromNode.call(this,e,t,n,o),b.prototype.initFromNode.call(this,e,t,n,o),y.prototype.initFromNode.call(this,e,t,n,o),_.prototype.initFromNode.call(this,e,t,n,o),this.space=i,this.lang=r},x.prototype.initFromText=function(e,t,n,r,i,o){E.prototype.initFromNode.call(this,e,t,null,o),this.text=n,this.space=i,this.lang=r},I.prototype.initFromNode=function(e,t,n,r,i){y.prototype.initFromNode.call(this,e,t,n,i),E.prototype.initFromNode.call(this,e,t,n,i),this.lang=r},R.prototype.createDefaultRegion=function(e){var t=new R;return g.call(t,""),v.call(t,{}),b.call(t,[]),E.call(t,0,Number.POSITIVE_INFINITY,null),this.lang=e,t},R.prototype.initFromNode=function(e,t,n,r){g.prototype.initFromNode.call(this,e,null,t,r),E.prototype.initFromNode.call(this,e,null,t,r),b.prototype.initFromNode.call(this,e,null,t,r),this.styleAttrs=P(t,r),this.styleRefs=L(t),this.lang=n},C.prototype.initFromNode=function(e,t,n,r){E.prototype.initFromNode.call(this,e,t,n,r);var i=P(n,r);for(var o in this.qname=null,this.value=null,i)if(i.hasOwnProperty(o)){if(this.qname){U(r,"More than one style specified on set");break}this.qname=o,this.value=i[o]}}}(t,"undefined"==typeof sax?n(5378):sax,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils)},506:(e,t,n)=>{!function(e,t,n){function r(e,t,c,h){var p;if("region"===c.kind)(p=document.createElement("div")).style.position="absolute";else if("body"===c.kind)p=document.createElement("div");else if("div"===c.kind)p=document.createElement("div");else if("image"===c.kind){if(p=document.createElement("img"),null!==e.imgResolver&&null!==c.src){var g=e.imgResolver(c.src,p);g&&(p.src=g),p.height=e.regionH,p.width=e.regionW}}else if("p"===c.kind)p=document.createElement("p");else if("span"===c.kind)if("container"===c.styleAttrs[n.byName.ruby.qname])p=document.createElement("ruby"),e.ruby=!0;else if("base"===c.styleAttrs[n.byName.ruby.qname])p=document.createElement("rb");else if("text"===c.styleAttrs[n.byName.ruby.qname])p=document.createElement("rt");else if("baseContainer"===c.styleAttrs[n.byName.ruby.qname])p=document.createElement("rbc");else if("textContainer"===c.styleAttrs[n.byName.ruby.qname])p=document.createElement("rtc");else{if("delimiter"===c.styleAttrs[n.byName.ruby.qname])return;p=document.createElement("span")}else"br"===c.kind&&(p=document.createElement("br"));if(p){if(c.lang&&("region"!==c.kind&&c.lang===h.lang||(p.lang=c.lang)),t.appendChild(p),p.style.margin="0","region"===c.kind){var v=c.styleAttrs[n.byName.writingMode.qname];"lrtb"===v||"lr"===v?(e.ipd="lr",e.bpd="tb"):"rltb"===v||"rl"===v?(e.ipd="rl",e.bpd="tb"):"tblr"===v?(e.ipd="tb",e.bpd="lr"):"tbrl"!==v&&"tb"!==v||(e.ipd="tb",e.bpd="rl")}else if("p"===c.kind&&"tb"===e.bpd){var b=c.styleAttrs[n.byName.direction.qname];e.ipd="ltr"===b?"lr":"rl"}for(var _=0;_<d.length;_++){var E=d[_],w=c.styleAttrs[E.qname];void 0!==w&&null!==E.map&&E.map(e,p,c,w)}var T=p,A=c.styleAttrs[n.byName.linePadding.qname];if(A&&!A.isZero()){var S=A.toUsedLength(e.w,e.h);if(S>0){var x=Math.ceil(S)+"px";"tb"===e.bpd?(T.style.paddingLeft=x,T.style.paddingRight=x):(T.style.paddingTop=x,T.style.paddingBottom=x),e.lp=A}}var I=c.styleAttrs[n.byName.multiRowAlign.qname];if(I&&"auto"!==I){var R=document.createElement("span");R.style.display="inline-block",R.style.textAlign=I,p.appendChild(R),T=R,e.mra=I}var C=c.styleAttrs[n.byName.rubyReserve.qname];if(C&&"none"!==C[0]&&(e.rubyReserve=C),c.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===c.kind&&c.text){var M=c.styleAttrs[n.byName.textEmphasis.qname];if(M&&"none"!==M.style&&(e.textEmphasis=!0),n.byName.textCombine.qname in c.styleAttrs&&"all"===c.styleAttrs[n.byName.textCombine.qname])p.textContent=c.text,M&&u(e,p,0,M);else for(var L="",P=0;P<c.text.length;P++){L+=c.text.charAt(P);var D=c.text.charCodeAt(P);if(D<55296||D>56319||P===c.text.length-1){var O=document.createElement("span");O.textContent=L,M&&u(e,O,0,M),p.appendChild(O),L="",O._isd_element=c}}}if("contents"in c)for(var N=0;N<c.contents.length;N++)r(e,T,c.contents[N],c);var k=[];if("p"===c.kind&&(l(e,T,k,null),e.rubyReserve&&(function(e,t){for(var n=0;n<e.length;n++){var r,i,o=document.createElement("ruby"),a=document.createElement("rb");a.textContent="â",o.appendChild(a);var s,l=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&1==e.length?((r=document.createElement("rtc")).style[m]=f?"after":"under",r.textContent="â",r.style.fontSize=l,(i=document.createElement("rtc")).style[m]=f?"before":"over",i.textContent="â",i.style.fontSize=l,o.appendChild(r),o.appendChild(i)):((r=document.createElement("rtc")).textContent="â",r.style.fontSize=l,s="after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?f?"after":"tb"===t.bpd||"rl"===t.bpd?"under":"over":f?"before":"tb"===t.bpd||"rl"===t.bpd?"over":"under",r.style[m]=s,o.appendChild(r));for(var u=null,c=0;c<e[n].rbc.length;c++)if("ruby"===e[n].rbc[c].localName){u=e[n].rbc[c];for(var d=0;d<u.style.length;d++)o.style.setProperty(u.style.item(d),u.style.getPropertyValue(u.style.item(d)));break}(u=u||e[n].elements[0].node).parentElement.insertBefore(o,u)}}(k,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].rbc.length;r++){var i;e[n].rbc[r].style[m]||(i=f?0===n?"before":"after":"tb"===t.bpd||"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[r].style[m]=i)}}(k,e),e.ruby=null),e.textEmphasis&&(function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].te.length;r++){var i;e[n].te[r].style[y]&&"none"!==e[n].te[r].style[y]||(i="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[r].style[y]=i)}}(k,e),e.textEmphasis=null),e.mra&&(function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling)}}}(k),e.mra=null),e.lp&&(function(e,t,n){if(null!==e)for(var r=0;r<e.length;r++){var i=e[r].elements.length,o=Math.ceil(t)+"px",a="-"+Math.ceil(t)+"px";if(0!==i){var s=e[r].elements[e[r].start_elem],l=e[r].elements[e[r].end_elem];if(s===l&&(elementBoundingRect=s.node.getBoundingClientRect(),0==elementBoundingRect.width||0==elementBoundingRect.height))continue;"lr"===n.ipd?(s.node.style.marginLeft=a,s.node.style.paddingLeft=o):"rl"===n.ipd?(s.node.style.paddingRight=o,s.node.style.marginRight=a):"tb"===n.ipd&&(s.node.style.paddingTop=o,s.node.style.marginTop=a),"lr"===n.ipd?(l.node.style.marginRight=a,l.node.style.paddingRight=o):"rl"===n.ipd?(l.node.style.paddingLeft=o,l.node.style.marginLeft=a):"tb"===n.ipd&&(l.node.style.paddingBottom=o,l.node.style.marginBottom=a)}}}(k,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),function(e){for(var t=0;t<e.length;t++)for(var n=e[t],r=1;r<n.elements.length;){var a=n.elements[r-1],s=n.elements[r];o(a.node,s.node)?n.elements.splice(r,1):r++}for(var l,u,c=[],d=0;d<e.length;d++)for(var h=0;h<e[d].elements.length;h++)(u=i(l=e[d].elements[h].node,c,!1))&&(l.style.backgroundColor=u);for(var p=0;p<c.length;p++)c[p].style.backgroundColor=""}(k),e.flg)){var F=s(T.getBoundingClientRect(),e);!function(e,t,n,r,i){for(var o=Math.sign(n-t),a=0;a<=e.length;a++){var s,l,u,c;if(s=0===a?Math.round(t):a===e.length?Math.round(n):Math.round((e[a-1].after+e[a].before)/2),a>0&&e[a-1])for(u=0;u<e[a-1].elements.length;u++)l=o*(s-(c=e[a-1].elements[u]).after)+"px","lr"===r.bpd?c.node.style.paddingRight=l:"rl"===r.bpd?c.node.style.paddingLeft=l:"tb"===r.bpd&&(c.node.style.paddingBottom=l);if(a<e.length)for(u=0;u<e[a].elements.length;u++)l=o*((c=e[a].elements[u]).before-s)+"px","lr"===r.bpd?c.node.style.paddingLeft=l:"rl"===r.bpd?c.node.style.paddingRight=l:"tb"===r.bpd&&(c.node.style.paddingTop=l)}}(k,F.before,F.after,e),e.flg=null}if("region"===c.kind&&"tb"===e.bpd&&e.enableRollUp&&c.contents.length>0&&"after"===c.styleAttrs[n.byName.displayAlign.qname]){l(e,T,k,null);var B=new a(""===c.id?"_":c.id,k);if(e.currentISDState[B.id]=B,e.previousISDState&&B.id in e.previousISDState&&e.previousISDState[B.id].plist.length>0&&B.plist.length>1&&B.plist[B.plist.length-2].text===e.previousISDState[B.id].plist[e.previousISDState[B.id].plist.length-1].text){var U=p.firstElementChild,z=B.plist[B.plist.length-1].after-B.plist[B.plist.length-1].before;U.style.bottom="-"+z+"px",U.style.transition="transform 0.4s",U.style.position="relative",U.style.transform="translateY(-"+z+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+c.kind)}function i(e,t,n){return e.style.backgroundColor?(n&&!t.includes(e)&&t.push(e),e.style.backgroundColor):"SPAN"===e.parentElement.nodeName?i(e.parentElement,t,!0):void 0}function o(e,t){if("SPAN"===e.tagName&&"SPAN"===t.tagName&&e._isd_element===t._isd_element){e.textContent+=t.textContent;for(var n=0;n<t.style.length;n++){var r=t.style[n];(r.indexOf("border")>=0||r.indexOf("padding")>=0||r.indexOf("margin")>=0)&&(e.style[r]=t.style[r])}return t.parentElement.removeChild(t),!0}return!1}function a(e,t){this.id=e,this.plist=t}function s(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function l(e,t,n,r){if("rt"!==t.localName&&"rtc"!==t.localName){var i,o,a,u,c=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var d=s(t.getBoundingClientRect(),e);if(0!==n.length&&(i=d.before,o=d.after,a=n[n.length-1].before,o<(u=n[n.length-1].after)&&i>a||u<=o&&a>=i)){var h=Math.sign(d.after-d.before),p=Math.sign(d.end-d.start);h*(d.before-n[n.length-1].before)<0&&(n[n.length-1].before=d.before),h*(d.after-n[n.length-1].after)>0&&(n[n.length-1].after=d.after),p*(d.start-n[n.length-1].start)<0&&(n[n.length-1].start=d.start,n[n.length-1].start_elem=n[n.length-1].elements.length),p*(d.end-n[n.length-1].end)>0&&(n[n.length-1].end=d.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:d.before,after:d.after,start:d.start,end:d.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:c,before:d.before,after:d.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var f=t.firstChild;f;)f.nodeType===Node.ELEMENT_NODE&&(l(e,f,n,c),"ruby"===f.localName||"rtc"===f.localName?n.length>0&&n[n.length-1].rbc.push(f):"span"===f.localName&&f.style[g]&&"none"!==f.style[g]&&n.length>0&&n[n.length-1].te.push(f)),f=f.nextSibling}}function u(e,t,n,r){var i;"none"!==r.style&&("auto"===r.style?t.style[g]="filled":t.style[g]=r.style+" "+r.symbol,("before"===r.position||"after"===r.position)&&(i="tb"===e.bpd?"before"===r.position?"left over":"left under":"rl"===e.bpd?"before"===r.position?"right under":"left under":"before"===r.position?"left under":"right under",t.style[y]=i))}function c(e,t){this.qname=e,this.map=t}e.render=function(e,t,n,i,o,a,s,l,u){var c=i||t.clientHeight,d=o||t.clientWidth;if(null!==e.aspectRatio){var h=c*e.aspectRatio;h>d?c=Math.round(d/e.aspectRatio):d=h}var p=document.createElement("div");p.style.position="relative",p.style.width=d+"px",p.style.height=c+"px",p.style.margin="auto",p.style.top=0,p.style.bottom=0,p.style.left=0,p.style.right=0,p.style.zIndex=0;var f={h:c,w:d,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:a||!1,isd:e,errorHandler:s,previousISDState:l,enableRollUp:u||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};if(t.appendChild(p),"contents"in e)for(var m=0;m<e.contents.length;m++)r(f,p,e.contents[m],e);return f.currentISDState};for(var d=[new c("http://www.w3.org/ns/ttml#styling backgroundColor",(function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")})),new c("http://www.w3.org/ns/ttml#styling color",(function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"})),new c("http://www.w3.org/ns/ttml#styling direction",(function(e,t,n,r){t.style.direction=r})),new c("http://www.w3.org/ns/ttml#styling display",(function(e,t,n,r){})),new c("http://www.w3.org/ns/ttml#styling displayAlign",(function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end")})),new c("http://www.w3.org/ns/ttml#styling extent",(function(e,t,n,r){e.regionH=r.h.toUsedLength(e.w,e.h),e.regionW=r.w.toUsedLength(e.w,e.h);var i=0,o=0,a=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];a&&(i=a[0].toUsedLength(e.w,e.h)+a[2].toUsedLength(e.w,e.h),o=a[1].toUsedLength(e.w,e.h)+a[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-o+"px"})),new c("http://www.w3.org/ns/ttml#styling fontFamily",(function(e,t,n,r){for(var i=[],o=0;o<r.length;o++)"monospaceSerif"===r[o]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[o]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[o]?i.push("monospace"):"sansSerif"===r[o]?i.push("sans-serif"):"serif"===r[o]?i.push("serif"):"monospaceSansSerif"===r[o]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[o]?i.push("serif"):i.push(r[o]);if(i.length>0){for(var a=[i[0]],s=1;s<i.length;s++)-1==a.indexOf(i[s])&&a.push(i[s]);i=a}t.style.fontFamily=i.join(",")})),new c("http://www.w3.org/ns/ttml#styling shear",(function(e,t,n,r){if(0!==r){var i=-.9*r;"tb"===e.bpd?t.style.transform="skewX("+i+"deg)":t.style.transform="skewY("+i+"deg)"}})),new c("http://www.w3.org/ns/ttml#styling fontSize",(function(e,t,n,r){t.style.fontSize=r.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling fontStyle",(function(e,t,n,r){t.style.fontStyle=r})),new c("http://www.w3.org/ns/ttml#styling fontWeight",(function(e,t,n,r){t.style.fontWeight=r})),new c("http://www.w3.org/ns/ttml#styling lineHeight",(function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling opacity",(function(e,t,n,r){t.style.opacity=r})),new c("http://www.w3.org/ns/ttml#styling origin",(function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling overflow",(function(e,t,n,r){t.style.overflow=r})),new c("http://www.w3.org/ns/ttml#styling padding",(function(e,t,n,r){var i=[];i[0]=r[0].toUsedLength(e.w,e.h)+"px",i[1]=r[3].toUsedLength(e.w,e.h)+"px",i[2]=r[2].toUsedLength(e.w,e.h)+"px",i[3]=r[1].toUsedLength(e.w,e.h)+"px",t.style.padding=i.join(" ")})),new c("http://www.w3.org/ns/ttml#styling position",(function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling rubyAlign",(function(e,t,n,r){t.style.rubyAlign="spaceAround"===r?"space-around":"center"})),new c("http://www.w3.org/ns/ttml#styling rubyPosition",(function(e,t,n,r){var i;"before"!==r&&"after"!==r||(i=f?r:"tb"===e.bpd||"rl"===e.bpd?"before"===r?"over":"under":"before"===r?"under":"over",t.parentElement.style[m]=i)})),new c("http://www.w3.org/ns/ttml#styling showBackground",null),new c("http://www.w3.org/ns/ttml#styling textAlign",(function(e,t,n,r){var i;i="start"===r?"rl"===e.ipd?"right":"left":"end"===r?"rl"===e.ipd?"left":"right":r,t.style.textAlign=i})),new c("http://www.w3.org/ns/ttml#styling textDecoration",(function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through")})),new c("http://www.w3.org/ns/ttml#styling textOutline",(function(e,t,n,r){})),new c("http://www.w3.org/ns/ttml#styling textShadow",(function(e,t,r,i){var o=r.styleAttrs[n.byName.textOutline.qname];if("none"===i&&"none"===o)t.style.textShadow="";else{var a=[];if("none"!==o){var s="rgba("+o.color[0].toString()+","+o.color[1].toString()+","+o.color[2].toString()+","+(o.color[3]/255).toString()+")";a.push("1px 1px 1px "+s),a.push("-1px 1px 1px "+s),a.push("1px -1px 1px "+s),a.push("-1px -1px 1px "+s)}if("none"!==i)for(var l=0;l<i.length;l++)a.push(i[l].x_off.toUsedLength(e.w,e.h)+"px "+i[l].y_off.toUsedLength(e.w,e.h)+"px "+i[l].b_radius.toUsedLength(e.w,e.h)+"px rgba("+i[l].color[0].toString()+","+i[l].color[1].toString()+","+i[l].color[2].toString()+","+(i[l].color[3]/255).toString()+")");t.style.textShadow=a.join(",")}})),new c("http://www.w3.org/ns/ttml#styling textCombine",(function(e,t,n,r){t.style.textCombineUpright=r})),new c("http://www.w3.org/ns/ttml#styling textEmphasis",(function(e,t,n,r){})),new c("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i})),new c("http://www.w3.org/ns/ttml#styling visibility",(function(e,t,n,r){t.style.visibility=r})),new c("http://www.w3.org/ns/ttml#styling wrapOption",(function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"})),new c("http://www.w3.org/ns/ttml#styling writingMode",(function(e,t,n,r){"lrtb"===r||"lr"===r||"rltb"===r||"rl"===r?t.style.writingMode="horizontal-tb":"tblr"===r?t.style.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(t.style.writingMode="vertical-rl")})),new c("http://www.w3.org/ns/ttml#styling zIndex",(function(e,t,n,r){t.style.zIndex=r})),new c("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden")}))],h={},p=0;p<d.length;p++)h[d[p].qname]=d[p];var f="webkitRubyPosition"in window.getComputedStyle(document.documentElement),m=f?"webkitRubyPosition":"rubyPosition",g="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",y="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils)},4080:(e,t,n)=>{!function(e,t,n,r){e.generateISD=function(e,t,r){var i,a=new l(e),s={},u={},c=e.head.styling.initials[n.byName.showBackground.qname],d=e.head.styling.initials[n.byName.backgroundColor.qname];for(var h in e.head.layout.regions)if(e.head.layout.regions.hasOwnProperty(h)){var p=e.head.layout.regions[h],f=p.styleAttrs[n.byName.showBackground.qname]||c,m=p.styleAttrs[n.byName.backgroundColor.qname]||d;u[p.id]=("always"===f||void 0===f)&&void 0!==m&&!(t<p.begin||t>=p.end)}for(var g in e.body&&e.body.regionID&&(u[e.body.regionID]=!0),i=null!==e.body?function e(t,n){if(n.contents){var r={};for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i]);return r.contents=[],n.contents.filter((function(e){return!(t<e.begin||t>=e.end)})).forEach((function(n){var i=e(t,n);i.regionID&&(u[i.regionID]=!0),null!==i&&r.contents.push(i)})),r}return n}(t,e.body):null,void 0!==u[""]&&(u[""]=!0),u)if(u[g]){var y=o(e,t,e.head.layout.regions[g],i,null,"",e.head.layout.regions[g],r,s);null!==y&&a.contents.push(y.element)}return a};var i=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function o(e,t,l,d,h,p,f,m,g){if(t<f.begin||t>=f.end)return null;var y="regionID"in f&&""!==f.regionID?f.regionID:p;if(null!==h&&y!==l.id&&(!("contents"in f)||"contents"in f&&0===f.contents.length||""!==y))return null;var v=new u(f);if("sets"in f)for(var b=0;b<f.sets.length;b++)t<f.sets[b].begin||t>=f.sets[b].end||(v.styleAttrs[f.sets[b].qname]=f.sets[b].value);var _={};for(var E in v.styleAttrs)if(v.styleAttrs.hasOwnProperty(E)&&(_[E]=!0,"region"===v.kind&&E===n.byName.writingMode.qname&&!(n.byName.direction.qname in v.styleAttrs))){var w=v.styleAttrs[E];"lrtb"===w||"lr"===w?v.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==w&&"rl"!==w||(v.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==h)for(var T=0;T<n.all.length;T++){var A=n.all[T];if(A.qname===n.byName.textDecoration.qname){var S=h.styleAttrs[A.qname],x=v.styleAttrs[A.qname],I=[];void 0===x?I=S:-1===x.indexOf("none")?((-1===x.indexOf("noUnderline")&&-1!==S.indexOf("underline")||-1!==x.indexOf("underline"))&&I.push("underline"),(-1===x.indexOf("noLineThrough")&&-1!==S.indexOf("lineThrough")||-1!==x.indexOf("lineThrough"))&&I.push("lineThrough"),(-1===x.indexOf("noOverline")&&-1!==S.indexOf("overline")||-1!==x.indexOf("overline"))&&I.push("overline")):I.push("none"),v.styleAttrs[A.qname]=I}else if(A.qname!==n.byName.fontSize.qname||A.qname in v.styleAttrs||"span"!==v.kind||"textContainer"!==v.styleAttrs[n.byName.ruby.qname])if(A.qname!==n.byName.fontSize.qname||A.qname in v.styleAttrs||"span"!==v.kind||"text"!==v.styleAttrs[n.byName.ruby.qname])A.inherit&&A.qname in h.styleAttrs&&!(A.qname in v.styleAttrs)&&(v.styleAttrs[A.qname]=h.styleAttrs[A.qname]);else{var R=h.styleAttrs[n.byName.fontSize.qname];"textContainer"===h.styleAttrs[n.byName.ruby.qname]?v.styleAttrs[A.qname]=R:v.styleAttrs[A.qname]=new r.ComputedLength(.5*R.rw,.5*R.rh)}else{var C=h.styleAttrs[n.byName.fontSize.qname];v.styleAttrs[A.qname]=new r.ComputedLength(.5*C.rw,.5*C.rh)}}for(var M=0;M<n.all.length;M++){var L=n.all[M];if(!(L.qname in v.styleAttrs)&&!(L.qname===n.byName.position.qname&&n.byName.origin.qname in v.styleAttrs||L.qname===n.byName.origin.qname&&n.byName.position.qname in v.styleAttrs)){var P=e.head.styling.initials[L.qname]||L.initial;if(null!==P&&("region"===v.kind||!1===L.inherit&&null!==P)){var D=L.parse(P);null!==D?(v.styleAttrs[L.qname]=D,_[L.qname]=!0):c(m,"Invalid initial value for '"+L.qname+"' on element '"+v.kind)}}}for(var O=0;O<n.all.length;O++){var N=n.all[O];if(N.qname in _&&null!==N.compute){var k=N.compute(e,h,v,v.styleAttrs[N.qname],g);null!==k?v.styleAttrs[N.qname]=k:(v.styleAttrs[N.qname]=N.compute(e,h,v,N.parse(N.initial),g),c(m,"Style '"+N.qname+"' on element '"+v.kind+"' cannot be computed"))}}if("none"===v.styleAttrs[n.byName.display.qname])return null;var F=null;null===h?F=null===d?[]:[d]:"contents"in f&&(F=f.contents);for(var B=0;null!==F&&B<F.length;B++){var U=o(e,t,l,d,v,y,F[B],m,g);null!==U&&v.contents.push(U.element)}for(var z in v.styleAttrs)if(v.styleAttrs.hasOwnProperty(z)){var G=!1;if("span"===v.kind){var V=v.styleAttrs[n.byName.ruby.qname];(G=("container"===V||"textContainer"===V||"baseContainer"===V)&&-1!==i.indexOf(z))||(G="container"!==V&&z===n.byName.rubyAlign.qname),G||(G=!("textContainer"===V||"text"===V)&&z===n.byName.rubyPosition.qname)}if(!G){var j=n.byQName[z];"applies"in j&&(G=-1===j.applies.indexOf(v.kind))}G&&delete v.styleAttrs[z]}var H=v.styleAttrs[n.byName.ruby.qname];if("p"===v.kind||"span"===v.kind&&("textContainer"===H||"text"===H)){var Z=[];a(v,Z),function(e){for(var t,n=0;n<e.length;)if("br"!==(t=e[n]).kind&&"preserve"!==t.space){var r=t.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(r)&&(0===n||"br"===(i=e[n-1]).kind||/[\r\n\t ]$/.test(i.text))&&(r=r.substring(1)),t.text=r,0===r.length?e.splice(n,1):n++}else n++;var i,o;for(n=0;n<e.length;n++)"br"!==(t=e[n]).kind&&"preserve"!==t.space?/[ ]$/.test(t.text)&&(n===e.length-1||"br"===(o=e[n+1]).kind||"preserve"===o.space&&/^[\r\n]/.test(o.text))&&(t.text=t.text.slice(0,-1)):n++}(Z),s(v)}return"div"===v.kind&&n.byName.backgroundImage.qname in v.styleAttrs||"br"===v.kind||"image"===v.kind||"contents"in v&&v.contents.length>0||"span"===v.kind&&null!==v.text||"region"===v.kind&&"always"===v.styleAttrs[n.byName.showBackground.qname]?{region_id:y,element:v}:null}function a(e,t){if("contents"in e)for(var r=0;r<e.contents.length;r++){var i=e.contents[r],o=i.styleAttrs[n.byName.ruby.qname];("span"!==i.kind||"textContainer"!==o&&"text"!==o)&&("contents"in i?a(i,t):("span"===i.kind&&0!==i.text.length||"br"===i.kind)&&t.push(i))}}function s(e){if("br"===e.kind)return!1;if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)s(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length}}function l(e){this.contents=[],this.aspectRatio=e.aspectRatio,this.lang=e.lang}function u(e){for(var t in this.kind=e.kind||"region",this.lang=e.lang,e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)e.styleAttrs.hasOwnProperty(t)&&(this.styleAttrs[t]=e.styleAttrs[t]);"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function c(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscStyles?n(6811):imscStyles,"undefined"==typeof imscUtils?n(5926):imscUtils)},4403:(e,t,n)=>{t.generateISD=n(4080).generateISD,t.fromXML=n(3362).fromXML,t.renderHTML=n(506).render},210:(e,t)=>{!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)},6811:(e,t,n)=>{!function(e,t,n){function r(e,t,n,r,i,o,a,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=o,this.initial=n,this.applies=r,this.parse=a,this.compute=s}for(var i in e.all=[new r(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new r(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new r(t.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"displayAlign","before",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null}),(function(e,t,r,i,o){var a,s;if("auto"===i)a=new n.ComputedLength(0,1);else if(null===(a=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:a,w:s}})),new r(t.ns_tts,"fontFamily","default",["span","p"],!0,!0,(function(e){for(var t=e.split(","),n=[],r=0;r<t.length;r++)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n}),null),new r(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,(function(e,t,n,r){return"%"!==r.unit?null:Math.abs(r.value)>100?100*Math.sign(r.value):r.value})),new r(t.ns_tts,"fontSize","1c",["span","p"],!0,!0,n.parseLength,(function(t,r,i,o,a){return n.toComputedLength(o.value,o.unit,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)})),new r(t.ns_tts,"fontStyle","normal",["span","p"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"fontWeight","normal",["span","p"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(e){return"normal"===e?e:n.parseLength(e)}),(function(t,r,i,o,a){var s;if("normal"===o)s=o;else if(null===(s=n.toComputedLength(o.value,o.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s})),new r(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new r(t.ns_tts,"origin","auto",["region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null}),(function(e,t,r,i,o){var a,s;if("auto"===i)a=new n.ComputedLength(0,0);else if(null===(a=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:a,w:s}})),new r(t.ns_tts,"overflow","hidden",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"padding","0px",["region"],!1,!0,(function(e){var t=e.split(" ");if(t.length>4)return null;for(var r=[],i=0;i<t.length;i++){var o=n.parseLength(t[i]);if(!o)return null;r.push(o)}return r}),(function(t,r,i,o,a){var s;if(1===o.length)s=[o[0],o[0],o[0],o[0]];else if(2===o.length)s=[o[0],o[1],o[0],o[1]];else if(3===o.length)s=[o[0],o[1],o[2],o[1]];else{if(4!==o.length)return null;s=[o[0],o[1],o[2],o[3]]}var l=i.styleAttrs[e.byName.writingMode.qname];if("lrtb"===l||"lr"===l)s=[s[0],s[3],s[2],s[1]];else if("rltb"===l||"rl"===l)s=[s[0],s[1],s[2],s[3]];else if("tblr"===l)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==l&&"tb"!==l)return null;s=[s[3],s[2],s[1],s[0]]}for(var u=[],c=0;c<s.length;c++)if(0===s[c].value)u[c]=new n.ComputedLength(0,0);else if(u[c]=n.toComputedLength(s[c].value,s[c].unit,i.styleAttrs[e.byName.fontSize.qname],0===c||2===c?i.styleAttrs[e.byName.extent.qname].h:i.styleAttrs[e.byName.extent.qname].w,0===c||2===c?t.cellLength.h:t.cellLength.w,0===c||2===c?t.pxLength.h:t.pxLength.w),null===u[c])return null;return u})),new r(t.ns_tts,"position","top left",["region"],!1,!0,(function(e){return n.parsePosition(e)}),(function(t,r,i,o){var a,s;return null===(a=n.toComputedLength(o.v.offset.value,o.v.offset.unit,null,new n.ComputedLength(-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-i.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===o.v.edge&&(a=new n.ComputedLength(-a.rw-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-a.rh-i.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(o.h.offset.value,o.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-i.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===a?null:("right"===o.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-i.styleAttrs[e.byName.extent.qname].w.rh)),{h:a,w:s}))})),new r(t.ns_tts,"ruby","none",["span"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(e){return"center"!==e&&"spaceAround"!==e?null:e}),null),new r(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(e){var t=e.split(" "),r=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(r[0]=t[0],2===t.length&&"none"!==t[0]){var i=n.parseLength(t[1]);if(!i)return null;r[1]=i}return r}),(function(t,r,i,o,a){return"none"===o[0]?o:null===(s=null===o[1]?new n.ComputedLength(.5*i.styleAttrs[e.byName.fontSize.qname].rw,.5*i.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(o[1].value,o[1].unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[o[0],s];var s})),new r(t.ns_tts,"showBackground","always",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"textAlign","start",["p"],!0,!0,(function(e){return e}),(function(e,t,n,r,i){return"left"===r?"start":"right"===r?"end":r})),new r(t.ns_tts,"textCombine","none",["span"],!0,!0,(function(e){return"none"===e||"all"===e?e:null}),null),new r(t.ns_tts,"textDecoration","none",["span"],!0,!0,(function(e){return e.split(" ")}),null),new r(t.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(e){for(var t=e.split(" "),r={style:null,symbol:null,color:null,position:null},i=0;i<t.length;i++)if("none"===t[i]||"auto"===t[i])r.style=t[i];else if("filled"===t[i]||"open"===t[i])r.style=t[i];else if("circle"===t[i]||"dot"===t[i]||"sesame"===t[i])r.symbol=t[i];else if("current"===t[i])r.color=t[i];else if("outside"===t[i]||"before"===t[i]||"after"===t[i])r.position=t[i];else if(r.color=n.parseColor(t[i]),null===r.color)return null;return null==r.style&&null==r.symbol?r.style="auto":(r.symbol=r.symbol||"circle",r.style=r.style||"filled"),r.position=r.position||"outside",r.color=r.color||"current",r}),null),new r(t.ns_tts,"textOutline","none",["span"],!0,!0,(function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||r.length>2)return null;var i=n.parseColor(r[0]);if(t.color=i,null!==i&&r.shift(),1!==r.length)return null;var o=n.parseLength(r[0]);return o?(t.thickness=o,t):null}),(function(t,r,i,o,a){if("none"===o)return o;var s={};return null===o.color?s.color=i.styleAttrs[e.byName.color.qname]:s.color=o.color,s.thickness=n.toComputedLength(o.thickness.value,o.thickness.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s})),new r(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,(function(t,r,i,o){if("none"===o)return o;for(var a=[],s=0;s<o.length;s++){var l={};if(l.x_off=n.toComputedLength(o[s][0].value,o[s][0].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===l.x_off)return null;if(l.y_off=n.toComputedLength(o[s][1].value,o[s][1].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.y_off)return null;if(null===o[s][2])l.b_radius=0;else if(l.b_radius=n.toComputedLength(o[s][2].value,o[s][2].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.b_radius)return null;null===o[s][3]?l.color=i.styleAttrs[e.byName.color.qname]:l.color=o[s][3],a.push(l)}return a})),new r(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"zIndex","auto",["region"],!1,!0,(function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t}),null),new r(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,(function(e,t,r,i,o){return n.toComputedLength(i.value,i.unit,null,null,e.cellLength.w,null)})),new r(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(e){return e}),null),new r(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(e){return e}),null),new r(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(e){return"true"===e}),null),new r(t.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(e){return"true"===e}),null)],e.byQName={},e.all)e.byQName[e.all[i].qname]=e.all[i];for(var o in e.byName={},e.all)e.byName[e.all[o].name]=e.all[o]}(t,"undefined"==typeof imscNames?n(210):imscNames,"undefined"==typeof imscUtils?n(5926):imscUtils)},5926:(e,t)=>{!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var o,a=null,s=i[e.toLowerCase()];return void 0!==s?a=s:null!==(o=t.exec(e))?a=[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16),void 0!==o[4]?parseInt(o[4],16):255]:null!==(o=n.exec(e))?a=[parseInt(o[1]),parseInt(o[2]),parseInt(o[3]),255]:null!==(o=r.exec(e))&&(a=[parseInt(o[1]),parseInt(o[2]),parseInt(o[3]),parseInt(o[4])]),a};var o=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=o.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){for(var n=t.match(/([^\(,\)]|\([^\)]+\))+/g),r=[],i=0;i<n.length;i++){var o=n[i].split(" ");if(1===o.length&&"none"===o[0])return"none";if(o.length>1&&o.length<5){var a=[null,null,null,null],s=e.parseLength(o.shift());if(null===s)return null;if(a[0]=s,null===(s=e.parseLength(o.shift())))return null;if(a[1]=s,0===o.length){r.push(a);continue}if(null!==(s=e.parseLength(o[0]))&&(a[2]=s,o.shift()),0===o.length){r.push(a);continue}var l=e.parseColor(o[0]);if(null===l)return null;a[3]=l,r.push(a)}}return r},e.parsePosition=function(t){var n=t.split(" "),r=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var i=0;i<n.length;i++)if(!r(n[i])){var o=e.parseLength(n[i]);if(null===o)return null;n[i]=o}for(var a={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var l=n[s++];if(r(l)){var u={value:0,unit:"%"};2!==n.length&&s<n.length&&!r(n[s])&&(u=n[s++]),"right"===l?(a.h.edge=l,a.h.offset=u):"bottom"===l?(a.v.edge=l,a.v.offset=u):"left"===l?a.h.offset=u:"top"===l&&(a.v.offset=u)}else{if(1!==n.length&&2!==n.length)return null;1===s?a.h.offset=l:a.v.offset=l}}return a},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,r,i,o,a){return"%"===n&&i?new e.ComputedLength(i.rw*t/100,i.rh*t/100):"em"===n&&r?new e.ComputedLength(r.rw*t,r.rh*t):"c"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"px"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}(t)},3516:e=>{"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90}},2219:(e,t,n)=>{"use strict";var r=n(3516),i=n(395);e.exports=function(e){return r(e)||i(e)}},395:e=>{"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=48&&t<=57}},3875:e=>{"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",i=0,o=-1,a=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(o===s-1||1===a);else if(o!==s-1&&2===a){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){-1===l?(r="",i=0):i=(r=r.slice(0,l)).length-1-r.lastIndexOf("/"),o=s,a=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=s,a=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,s):r=e.slice(o+1,s),i=s-o-1;o=s,a=0}else 46===n&&-1!==a?++a:a=-1}return r}var r={resolve:function(){for(var e,r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a;o>=0?a=arguments[o]:(void 0===e&&(e=process.cwd()),a=e),t(a),0!==a.length&&(r=a+"/"+r,i=47===a.charCodeAt(0))}return r=n(r,!i),i?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var i=arguments[n];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=r.resolve(e))===(n=r.resolve(n)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var o=e.length,a=o-i,s=1;s<n.length&&47===n.charCodeAt(s);++s);for(var l=n.length-s,u=a<l?a:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(47===n.charCodeAt(s+d))return n.slice(s+d+1);if(0===d)return n.slice(s+d)}else a>u&&(47===e.charCodeAt(i+d)?c=d:0===d&&(c=0));break}var h=e.charCodeAt(i+d);if(h!==n.charCodeAt(s+d))break;47===h&&(c=d)}var p="";for(d=i+c+1;d<=o;++d)d!==o&&47!==e.charCodeAt(d)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(s+c):(s+=c,47===n.charCodeAt(s)&&++s,n.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,i=-1,o=!0,a=e.length-1;a>=1;--a)if(47===(n=e.charCodeAt(a))){if(!o){i=a;break}}else o=!1;return-1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var r,i=0,o=-1,a=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var s=n.length-1,l=-1;for(r=e.length-1;r>=0;--r){var u=e.charCodeAt(r);if(47===u){if(!a){i=r+1;break}}else-1===l&&(a=!1,l=r+1),s>=0&&(u===n.charCodeAt(s)?-1==--s&&(o=r):(s=-1,o=l))}return i===o?o=l:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){i=r+1;break}}else-1===o&&(a=!1,o=r+1);return-1===o?"":e.slice(i,o)},extname:function(e){t(e);for(var n=-1,r=0,i=-1,o=!0,a=0,s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(47!==l)-1===i&&(o=!1,i=s+1),46===l?-1===n?n=s:1!==a&&(a=1):-1!==n&&(a=-1);else if(!o){r=s+1;break}}return-1===n||-1===i||0===a||1===a&&n===i-1&&n===r+1?"":e.slice(n,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var r,i=e.charCodeAt(0),o=47===i;o?(n.root="/",r=1):r=0;for(var a=-1,s=0,l=-1,u=!0,c=e.length-1,d=0;c>=r;--c)if(47!==(i=e.charCodeAt(c)))-1===l&&(u=!1,l=c+1),46===i?-1===a?a=c:1!==d&&(d=1):-1!==a&&(d=-1);else if(!u){s=c+1;break}return-1===a||-1===l||0===d||1===d&&a===l-1&&a===s+1?-1!==l&&(n.base=n.name=0===s&&o?e.slice(1,l):e.slice(s,l)):(0===s&&o?(n.name=e.slice(1,a),n.base=e.slice(1,l)):(n.name=e.slice(s,a),n.base=e.slice(s,l)),n.ext=e.slice(a,l)),s>0?n.dir=e.slice(0,s-1):o&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r},8387:(e,t,n)=>{var r=n(1549),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},5378:(e,t,n)=>{!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=a,e.createStream=function(e,t){return new a(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,n){if(!(this instanceof i))return new i(t,n);var o=this;!function(e){for(var t=0,n=r.length;t<n;t++)e[r[t]]=""}(o),o.q=o.c="",o.bufferCheckPosition=e.MAX_BUFFER_LENGTH,o.opt=n||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!t,o.noscript=!(!t&&!o.opt.noscript),o.state=S.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(f)),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),I(o,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),i.prototype={end:function(){P(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return L(n,"Cannot write after close. Assign an onready handler.");if(null===t)return P(n);"object"==typeof t&&(t=t.toString());for(var i=0,o="";o=G(t,i++),n.c=o,o;)switch(n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++),n.state){case S.BEGIN:if(n.state=S.BEGIN_WHITESPACE,"\ufeff"===o)continue;z(n,o);continue;case S.BEGIN_WHITESPACE:z(n,o);continue;case S.TEXT:if(n.sawRoot&&!n.closedRoot){for(var a=i-1;o&&"<"!==o&&"&"!==o;)(o=G(t,i++))&&n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(a,i-1)}"<"!==o||n.sawRoot&&n.closedRoot&&!n.strict?(!E(s,o)||n.sawRoot&&!n.closedRoot||D(n,"Text data outside of root node."),"&"===o?n.state=S.TEXT_ENTITY:n.textNode+=o):(n.state=S.OPEN_WAKA,n.startTagPosition=n.position);continue;case S.SCRIPT:"<"===o?n.state=S.SCRIPT_ENDING:n.script+=o;continue;case S.SCRIPT_ENDING:"/"===o?n.state=S.CLOSE_TAG:(n.script+="<"+o,n.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===o)n.state=S.SGML_DECL,n.sgmlDecl="";else if(_(s,o));else if(_(m,o))n.state=S.OPEN_TAG,n.tagName=o;else if("/"===o)n.state=S.CLOSE_TAG,n.tagName="";else if("?"===o)n.state=S.PROC_INST,n.procInstName=n.procInstBody="";else{if(D(n,"Unencoded <"),n.startTagPosition+1<n.position){var l=n.position-n.startTagPosition;o=new Array(l).join(" ")+o}n.textNode+="<"+o,n.state=S.TEXT}continue;case S.SGML_DECL:"[CDATA["===(n.sgmlDecl+o).toUpperCase()?(R(n,"onopencdata"),n.state=S.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+o==="--"?(n.state=S.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+o).toUpperCase()?(n.state=S.DOCTYPE,(n.doctype||n.sawRoot)&&D(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===o?(R(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=S.TEXT):_(c,o)?(n.state=S.SGML_DECL_QUOTED,n.sgmlDecl+=o):n.sgmlDecl+=o;continue;case S.SGML_DECL_QUOTED:o===n.q&&(n.state=S.SGML_DECL,n.q=""),n.sgmlDecl+=o;continue;case S.DOCTYPE:">"===o?(n.state=S.TEXT,R(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=o,"["===o?n.state=S.DOCTYPE_DTD:_(c,o)&&(n.state=S.DOCTYPE_QUOTED,n.q=o));continue;case S.DOCTYPE_QUOTED:n.doctype+=o,o===n.q&&(n.q="",n.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:n.doctype+=o,"]"===o?n.state=S.DOCTYPE:_(c,o)&&(n.state=S.DOCTYPE_DTD_QUOTED,n.q=o);continue;case S.DOCTYPE_DTD_QUOTED:n.doctype+=o,o===n.q&&(n.state=S.DOCTYPE_DTD,n.q="");continue;case S.COMMENT:"-"===o?n.state=S.COMMENT_ENDING:n.comment+=o;continue;case S.COMMENT_ENDING:"-"===o?(n.state=S.COMMENT_ENDED,n.comment=M(n.opt,n.comment),n.comment&&R(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+o,n.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==o?(D(n,"Malformed comment"),n.comment+="--"+o,n.state=S.COMMENT):n.state=S.TEXT;continue;case S.CDATA:"]"===o?n.state=S.CDATA_ENDING:n.cdata+=o;continue;case S.CDATA_ENDING:"]"===o?n.state=S.CDATA_ENDING_2:(n.cdata+="]"+o,n.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===o?(n.cdata&&R(n,"oncdata",n.cdata),R(n,"onclosecdata"),n.cdata="",n.state=S.TEXT):"]"===o?n.cdata+="]":(n.cdata+="]]"+o,n.state=S.CDATA);continue;case S.PROC_INST:"?"===o?n.state=S.PROC_INST_ENDING:_(s,o)?n.state=S.PROC_INST_BODY:n.procInstName+=o;continue;case S.PROC_INST_BODY:if(!n.procInstBody&&_(s,o))continue;"?"===o?n.state=S.PROC_INST_ENDING:n.procInstBody+=o;continue;case S.PROC_INST_ENDING:">"===o?(R(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=S.TEXT):(n.procInstBody+="?"+o,n.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:_(g,o)?n.tagName+=o:(O(n),">"===o?F(n):"/"===o?n.state=S.OPEN_TAG_SLASH:(E(s,o)&&D(n,"Invalid character in tag name"),n.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===o?(F(n,!0),B(n)):(D(n,"Forward-slash in opening tag not followed by >"),n.state=S.ATTRIB);continue;case S.ATTRIB:if(_(s,o))continue;">"===o?F(n):"/"===o?n.state=S.OPEN_TAG_SLASH:_(m,o)?(n.attribName=o,n.attribValue="",n.state=S.ATTRIB_NAME):D(n,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===o?n.state=S.ATTRIB_VALUE:">"===o?(D(n,"Attribute without value"),n.attribValue=n.attribName,k(n),F(n)):_(s,o)?n.state=S.ATTRIB_NAME_SAW_WHITE:_(g,o)?n.attribName+=o:D(n,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===o)n.state=S.ATTRIB_VALUE;else{if(_(s,o))continue;D(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",R(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===o?F(n):_(m,o)?(n.attribName=o,n.state=S.ATTRIB_NAME):(D(n,"Invalid attribute name"),n.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(_(s,o))continue;_(c,o)?(n.q=o,n.state=S.ATTRIB_VALUE_QUOTED):(D(n,"Unquoted attribute value"),n.state=S.ATTRIB_VALUE_UNQUOTED,n.attribValue=o);continue;case S.ATTRIB_VALUE_QUOTED:if(o!==n.q){"&"===o?n.state=S.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=o;continue}k(n),n.q="",n.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:_(s,o)?n.state=S.ATTRIB:">"===o?F(n):"/"===o?n.state=S.OPEN_TAG_SLASH:_(m,o)?(D(n,"No whitespace between attributes"),n.attribName=o,n.attribValue="",n.state=S.ATTRIB_NAME):D(n,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(E(d,o)){"&"===o?n.state=S.ATTRIB_VALUE_ENTITY_U:n.attribValue+=o;continue}k(n),">"===o?F(n):n.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(n.tagName)">"===o?B(n):_(g,o)?n.tagName+=o:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=S.SCRIPT):(E(s,o)&&D(n,"Invalid tagname in closing tag"),n.state=S.CLOSE_TAG_SAW_WHITE);else{if(_(s,o))continue;E(m,o)?n.script?(n.script+="</"+o,n.state=S.SCRIPT):D(n,"Invalid tagname in closing tag."):n.tagName=o}continue;case S.CLOSE_TAG_SAW_WHITE:if(_(s,o))continue;">"===o?B(n):D(n,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var u,h;switch(n.state){case S.TEXT_ENTITY:u=S.TEXT,h="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:u=S.ATTRIB_VALUE_QUOTED,h="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:u=S.ATTRIB_VALUE_UNQUOTED,h="attribValue"}";"===o?(n[h]+=U(n),n.entity="",n.state=u):_(n.entity.length?v:y,o)?n.entity+=o:(D(n,"Invalid character in entity name"),n[h]+="&"+n.entity+o,n.entity="",n.state=u);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,o=0,a=r.length;o<a;o++){var s=t[r[o]].length;if(s>n)switch(r[o]){case"textNode":C(t);break;case"cdata":R(t,"oncdata",t.cdata),t.cdata="";break;case"script":R(t,"onscript",t.script),t.script="";break;default:L(t,"Max buffer length exceeded: "+r[o])}i=Math.max(i,s)}var l=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=l+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;C(e=this),""!==e.cdata&&(R(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(R(e,"onscript",e.script),e.script="")}};try{t=n(182).Stream}catch(e){t=function(){}}var o=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function a(e,n){if(!(this instanceof a))return new a(e,n);t.apply(this),this._parser=new i(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})}))}a.prototype=Object.create(t.prototype,{constructor:{value:a}}),a.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=n(7503).s;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},a.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},a.prototype.on=function(e,n){var r=this;return r._parser["on"+e]||-1===o.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),t.prototype.on.call(r,e,n)};var s="\r\n\t ",l="0124356789",u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="'\"",d=s+">",h="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",f={xml:h,xmlns:p};s=b(s),l=b(l),u=b(u);var m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function b(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}function _(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function E(e,t){return!_(e,t)}c=b(c),d=b(d);var w,T,A,S=0;for(var x in e.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r})),e.STATE)e.STATE[e.STATE[x]]=x;function I(e,t,n){e[t]&&e[t](n)}function R(e,t,n){e.textNode&&C(e),I(e,t,n)}function C(e){e.textNode=M(e.opt,e.textNode),e.textNode&&I(e,"ontext",e.textNode),e.textNode=""}function M(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function L(e,t){return C(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,I(e,"onerror",t),e}function P(e){return e.sawRoot&&!e.closedRoot&&D(e,"Unclosed root tag"),e.state!==S.BEGIN&&e.state!==S.BEGIN_WHITESPACE&&e.state!==S.TEXT&&L(e,"Unexpected end"),C(e),e.c="",e.closed=!0,I(e,"onend"),i.call(e,e.strict,e.opt),e}function D(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&L(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,R(e,"onopentagstart",n)}function N(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function k(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=N(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==h)D(e,"xml: prefix must be bound to "+h+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==p)D(e,"xmlns: prefix must be bound to "+p+"\nActual: "+e.attribValue);else{var i=e.tag,o=e.tags[e.tags.length-1]||e;i.ns===o.ns&&(i.ns=Object.create(o.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,R(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function F(e,t){if(e.opt.xmlns){var n=e.tag,r=N(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(D(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){R(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var o=0,a=e.attribList.length;o<a;o++){var s=e.attribList[o],l=s[0],u=s[1],c=N(l,!0),d=c.prefix,h=c.local,p=""===d?"":n.ns[d]||"",f={name:l,value:u,prefix:d,local:h,uri:p};d&&"xmlns"!==d&&!p&&(D(e,"Unbound namespace prefix: "+JSON.stringify(d)),f.uri=d),e.tag.attributes[l]=f,R(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),R(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=S.TEXT:e.state=S.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function B(e){if(!e.tagName)return D(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=S.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=S.SCRIPT);R(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)D(e,"Unexpected close tag");if(t<0)return D(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=S.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,R(e,"onclosetag",e.tagName);var a={};for(var s in o.ns)a[s]=o.ns[s];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==l.ns&&Object.keys(o.ns).forEach((function(t){var n=o.ns[t];R(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=S.TEXT}function U(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(D(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function z(e,t){"<"===t?(e.state=S.OPEN_WAKA,e.startTagPosition=e.position):E(s,t)&&(D(e,"Non-whitespace before first tag."),e.textNode=t,e.state=S.TEXT)}function G(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}S=e.STATE,String.fromCodePoint||(w=String.fromCharCode,T=Math.floor,A=function(){var e,t,n=[],r=-1,i=arguments.length;if(!i)return"";for(var o="";++r<i;){var a=Number(arguments[r]);if(!isFinite(a)||a<0||a>1114111||T(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?n.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,n.push(e,t)),(r+1===i||n.length>16384)&&(o+=w.apply(null,n),n.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:A,configurable:!0,writable:!0}):String.fromCodePoint=A)}(t)},182:(e,t,n)=>{e.exports=i;var r=n(1159).EventEmitter;function i(){r.call(this)}n(1765)(i,r),i.Readable=n(2846),i.Writable=n(8318),i.Duplex=n(6138),i.Transform=n(9798),i.PassThrough=n(5472),i.finished=n(8800),i.pipeline=n(7295),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var a=!1;function s(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===r.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},1765:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},3690:e=>{"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,a,s;if("string"==typeof t&&("not ","not "===t.substr(0,4))?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length)," argument"===e.substring(n-9,n)}(e))o="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var l=("number"!=typeof s&&(s=0),s+1>(a=e).length||-1===a.indexOf(".",s)?"argument":"property");o='The "'.concat(e,'" ').concat(l," ").concat(i," ").concat(r(t,"type"))}return o+". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6138:(e,t,n)=>{"use strict";var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=u;var i=n(2846),o=n(8318);n(1765)(u,i);for(var a=r(o.prototype),s=0;s<a.length;s++){var l=a[s];u.prototype[l]||(u.prototype[l]=o.prototype[l])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||process.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},5472:(e,t,n)=>{"use strict";e.exports=i;var r=n(9798);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(1765)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},2846:(e,t,n)=>{"use strict";var r;e.exports=A,A.ReadableState=T,n(1159).EventEmitter;var i,o=function(e,t){return e.listeners(t).length},a=n(9299),s=n(1549).Buffer,l=n.g.Uint8Array||function(){},u=n(964);i=u&&u.debuglog?u.debuglog("stream"):function(){};var c,d,h,p=n(8393),f=n(6163),m=n(7269).getHighWaterMark,g=n(3690).q,y=g.ERR_INVALID_ARG_TYPE,v=g.ERR_STREAM_PUSH_AFTER_EOF,b=g.ERR_METHOD_NOT_IMPLEMENTED,_=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(1765)(A,a);var E=f.errorOrDestroy,w=["error","close","destroy","pause","resume"];function T(e,t,i){r=r||n(6138),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=m(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c||(c=n(7503).s),this.decoder=new c(e.encoding),this.encoding=e.encoding)}function A(e){if(r=r||n(6138),!(this instanceof A))return new A(e);var t=this instanceof r;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function S(e,t,n,r,o){i("readableAddChunk",t);var a,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(i("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?C(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}}(e,u);else if(o||(a=function(e,t){var n,r;return r=t,s.isBuffer(r)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],t)),n}(u,t)),a)E(e,a);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),r)u.endEmitted?E(e,new _):x(e,u,t,!0);else if(u.ended)E(e,new v);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!n?(t=u.decoder.write(t),u.objectMode||0!==t.length?x(e,u,t,!1):L(e,u)):x(e,u,t,!1)}else r||(u.reading=!1,L(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function x(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),L(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=f.destroy,A.prototype._undestroy=f.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),S(this,e,t,!1,n)},A.prototype.unshift=function(e){return S(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){c||(c=n(7503).s);var t=new c(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var I=1073741824;function R(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=I?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;i("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(i("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(M,e))}function M(e){var t=e._readableState;i("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,k(e)}function L(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(i("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function D(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function O(e){i("readable nexttick read 0"),e.read(0)}function N(e,t){i("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),k(e),t.flowing&&!t.reading&&e.read(0)}function k(e){var t=e._readableState;for(i("flow",t.flowing);t.flowing&&null!==e.read(););}function F(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function B(e){var t=e._readableState;i("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(U,t,e))}function U(e,t){if(i("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function z(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}A.prototype.read=function(e){i("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return i("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?B(this):C(this),null;if(0===(e=R(e,t))&&t.ended)return 0===t.length&&B(this),null;var r,o=t.needReadable;return i("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&i("length less than watermark",o=!0),t.ended||t.reading?i("reading or ended",o=!1):o&&(i("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=R(n,t))),null===(r=e>0?F(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&B(this)),null!==r&&this.emit("data",r),r},A.prototype._read=function(e){E(this,new b("_read()"))},A.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,i("pipe count=%d opts=%j",r.pipesCount,t);var a=t&&!1===t.end||e===process.stdout||e===process.stderr?f:s;function s(){i("onend"),e.end()}r.endEmitted?process.nextTick(a):n.once("end",a),e.on("unpipe",(function t(o,a){i("onunpipe"),o===n&&a&&!1===a.hasUnpiped&&(a.hasUnpiped=!0,i("cleanup"),e.removeListener("close",h),e.removeListener("finish",p),e.removeListener("drain",l),e.removeListener("error",d),e.removeListener("unpipe",t),n.removeListener("end",s),n.removeListener("end",f),n.removeListener("data",c),u=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}));var l=function(e){return function(){var t=e._readableState;i("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,k(e))}}(n);e.on("drain",l);var u=!1;function c(t){i("ondata");var o=e.write(t);i("dest.write",o),!1===o&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==z(r.pipes,e))&&!u&&(i("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(t){i("onerror",t),f(),e.removeListener("error",d),0===o(e,"error")&&E(e,t)}function h(){e.removeListener("finish",p),f()}function p(){i("onfinish"),e.removeListener("close",h),f()}function f(){i("unpipe"),n.unpipe(e)}return n.on("data",c),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",h),e.once("finish",p),e.emit("pipe",n),r.flowing||(i("pipe resume"),n.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=z(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},A.prototype.on=function(e,t){var n=a.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,i("on readable",r.length,r.reading),r.length?C(this):r.reading||process.nextTick(O,this))),n},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var n=a.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(D,this),n},A.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(D,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(i("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(N,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return i("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(i("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var o in e.on("end",(function(){if(i("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(o){i("wrapped data"),n.decoder&&(o=n.decoder.write(o)),n.objectMode&&null==o||(n.objectMode||o&&o.length)&&(t.push(o)||(r=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));for(var a=0;a<w.length;a++)e.on(w[a],this.emit.bind(this,w[a]));return this._read=function(t){i("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=n(7299)),d(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=F,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===h&&(h=n(6233)),h(A,e,t)})},9798:(e,t,n)=>{"use strict";e.exports=c;var r=n(3690).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,l=n(6138);function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}n(1765)(c,l),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,n){n(new i("_transform()"))},c.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},8318:(e,t,n)=>{"use strict";function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(void 0),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;e.exports=A,A.WritableState=T;var o,a={deprecate:n(7839)},s=n(9299),l=n(1549).Buffer,u=n.g.Uint8Array||function(){},c=n(6163),d=n(7269).getHighWaterMark,h=n(3690).q,p=h.ERR_INVALID_ARG_TYPE,f=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,y=h.ERR_STREAM_DESTROYED,v=h.ERR_STREAM_NULL_VALUES,b=h.ERR_STREAM_WRITE_AFTER_END,_=h.ERR_UNKNOWN_ENCODING,E=c.errorOrDestroy;function w(){}function T(e,t,o){i=i||n(6138),e=e||{},"boolean"!=typeof o&&(o=t instanceof i),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if("function"!=typeof i)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(process.nextTick(i,r),process.nextTick(M,e,t),e._writableState.errorEmitted=!0,E(e,r)):(i(r),e._writableState.errorEmitted=!0,E(e,r),M(e,t))}(e,n,r,t,i);else{var o=R(n)||e.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||I(e,n),r?process.nextTick(x,e,n,o,i):x(e,n,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function A(e){var t=this instanceof(i=i||n(6138));if(!t&&!o.call(A,this))return new A(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function S(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new y("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function x(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),M(e,t)}function I(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),a=t.corkedRequestsFree;a.entry=n;for(var s=0,l=!0;n;)o[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;o.allBuffers=l,S(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,c=n.encoding,d=n.callback;if(S(e,t,!1,t.objectMode?1:u.length,u,c,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function R(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final((function(n){t.pendingcb--,n&&E(e,n),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var n=R(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(C,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(1765)(A,s),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===A&&e&&e._writableState instanceof T}})):o=function(e){return e instanceof this},A.prototype.pipe=function(){E(this,new g)},A.prototype.write=function(e,t,n){var r,i=this._writableState,o=!1,a=!i.objectMode&&(r=e,l.isBuffer(r)||r instanceof u);return a&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=w),i.ending?function(e,t){var n=new b;E(e,n),process.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var i;return null===n?i=new v:"string"==typeof n||t.objectMode||(i=new p("chunk",["string","Buffer"],n)),!i||(E(e,i),process.nextTick(r,i),!1)}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,n)),t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,s,r,i,o);return u}(this,i,a,e,t,n)),o},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,n){n(new f("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,M(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=c.destroy,A.prototype._undestroy=c.undestroy,A.prototype._destroy=function(e,t){t(e)}},7299:(e,t,n)=>{"use strict";var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(8800),a=Symbol("lastResolve"),s=Symbol("lastReject"),l=Symbol("error"),u=Symbol("ended"),c=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function p(e,t){return{value:e,done:t}}function f(e){var t=e[a];if(null!==t){var n=e[h].read();null!==n&&(e[c]=null,e[a]=null,e[s]=null,t(p(n,!1)))}}function m(e){process.nextTick(f,e)}var g=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((i(r={get stream(){return this[h]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(p(void 0,!0));if(this[h].destroyed)return new Promise((function(t,n){process.nextTick((function(){e[l]?n(e[l]):t(p(void 0,!0))}))}));var n,r=this[c];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[u]?n(p(void 0,!0)):t[d](n,r)}),r)}}(r,this));else{var i=this[h].read();if(null!==i)return Promise.resolve(p(i,!1));n=new Promise(this[d])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),g);e.exports=function(e){var t,n=Object.create(y,(i(t={},h,{value:e,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var r=n[h].read();r?(n[c]=null,n[a]=null,n[s]=null,e(p(r,!1))):(n[a]=e,n[s]=t)},writable:!0}),t));return n[c]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[s];return null!==t&&(n[c]=null,n[a]=null,n[s]=null,t(e)),void(n[l]=e)}var r=n[a];null!==r&&(n[c]=null,n[a]=null,n[s]=null,r(p(void 0,!0))),n[u]=!0})),e.on("readable",m.bind(null,n)),n}},8393:(e,t,n)=>{"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(1549).Buffer,a=n(9862).inspect,s=a&&a.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t;return t=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,n,r,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,n=i,r=s,o.prototype.copy.call(t,n,r),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0==(e-=a)){a===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(a));break}++r}return this.length-=r,t}},{key:s,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}()},6163:e=>{"use strict";function t(e,t){r(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,i){var o=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?(i?i(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(r,this,e)):process.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!i&&e?o._writableState?o._writableState.errorEmitted?process.nextTick(n,o):(o._writableState.errorEmitted=!0,process.nextTick(t,o,e)):process.nextTick(t,o,e):i?(process.nextTick(n,o),i(e)):process.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},8800:(e,t,n)=>{"use strict";var r=n(3690).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var a=n.readable||!1!==n.readable&&t.readable,s=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||c()},u=t._writableState&&t._writableState.finished,c=function(){s=!1,u=!0,a||o.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,d=!0,s||o.call(t)},p=function(e){o.call(t,e)},f=function(){var e;return a&&!d?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):s&&!u?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},m=function(){t.req.on("finish",c)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",c),t.on("abort",f),t.req?m():t.on("request",m)):s&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",h),t.on("finish",c),!1!==n.error&&t.on("error",p),t.on("close",f),function(){t.removeListener("complete",c),t.removeListener("abort",f),t.removeListener("request",m),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",h),t.removeListener("error",p),t.removeListener("close",f)}}},6233:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},7295:(e,t,n)=>{"use strict";var r,i=n(3690).q,o=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function l(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var s=!1;e.on("close",(function(){s=!0})),void 0===r&&(r=n(8800)),r(e,{readable:t,writable:i},(function(e){if(e)return o(e);s=!0,o()}));var l=!1;return function(t){if(!s&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new a("pipe"))}}function u(e){e()}function c(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=function(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var a=t.map((function(e,n){var o=n<t.length-1;return l(e,o,n>0,(function(e){r||(r=e),e&&a.forEach(u),o||(a.forEach(u),i(r))}))}));return t.reduce(c)}},7269:(e,t,n)=>{"use strict";var r=n(3690).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},9299:(e,t,n)=>{e.exports=n(1159).EventEmitter},7503:(e,t,n)=>{"use strict";var r=n(8387).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=d,t=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"ï¿½";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"ï¿½";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"ï¿½"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.s=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"ï¿½":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=a(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=a(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},1067:function(e,t,n){var r;!function(i,o){"use strict";var a="function",s="undefined",l="object",u="string",c="model",d="name",h="type",p="vendor",f="version",m="architecture",g="console",y="mobile",v="tablet",b="smarttv",_="wearable",E="embedded",w="Amazon",T="Apple",A="ASUS",S="BlackBerry",x="Browser",I="Chrome",R="Firefox",C="Google",M="Huawei",L="LG",P="Microsoft",D="Motorola",O="Opera",N="Samsung",k="Sony",F="Xiaomi",B="Zebra",U="Facebook",z=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},G=function(e,t){return typeof e===u&&-1!==V(t).indexOf(V(e))},V=function(e){return e.toLowerCase()},j=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,255)},H=function(e,t){for(var n,r,i,s,u,c,d=0;d<t.length&&!u;){var h=t[d],p=t[d+1];for(n=r=0;n<h.length&&!u;)if(u=h[n++].exec(e))for(i=0;i<p.length;i++)c=u[++r],typeof(s=p[i])===l&&s.length>0?2===s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):o:this[s[0]]=c?s[1].call(this,c,s[2]):o:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):o):this[s]=c||o;d+=2}},Z=function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(G(t[n][r],e))return"?"===n?o:n}else if(G(t[n],e))return"?"===n?o:n;return e},q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},W={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[d,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[d,f],[/opios[\/ ]+([\w\.]+)/i],[f,[d,O+" Mini"]],[/\bopr\/([\w\.]+)/i],[f,[d,O]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[d,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[d,"UC"+x]],[/\bqbcore\/([\w\.]+)/i],[f,[d,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[d,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[d,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[d,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure "+x],f],[/\bfocus\/([\w\.]+)/i],[f,[d,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[d,O+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[d,O+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[d,"MIUI "+x]],[/fxios\/([-\w\.]+)/i],[f,[d,R]],[/\bqihu|(qi?ho?o?|360)browser/i],[[d,"360 "+x]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1 "+x],f],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[d,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[d],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[d,U],f],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[d,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[d,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[d,I+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[d,I+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[d,"Android "+x]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[d,f],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[f,[d,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[f,d],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[d,[f,Z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[d,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[d,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[d,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[d,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,V]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",V]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[p,N],[h,v]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[p,N],[h,y]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[p,T],[h,y]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[p,T],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[p,M],[h,v]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[c,[p,M],[h,y]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[p,F],[h,y]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[p,F],[h,v]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[p,"OPPO"],[h,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[p,"Vivo"],[h,y]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[p,"Realme"],[h,y]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[p,D],[h,y]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[p,D],[h,v]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[p,L],[h,v]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[p,L],[h,y]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[p,"Lenovo"],[h,v]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[p,"Nokia"],[h,y]],[/(pixel c)\b/i],[c,[p,C],[h,v]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[p,C],[h,y]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[p,k],[h,y]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[p,k],[h,v]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[p,"OnePlus"],[h,y]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[p,w],[h,v]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[p,w],[h,y]],[/(playbook);[-\w\),; ]+(rim)/i],[c,p,[h,v]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[p,S],[h,y]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[p,A],[h,v]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[p,A],[h,y]],[/(nexus 9)/i],[c,[p,"HTC"],[h,v]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[p,[c,/_/g," "],[h,y]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[p,"Acer"],[h,v]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[p,"Meizu"],[h,y]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[p,"Sharp"],[h,y]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,c,[h,y]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,c,[h,v]],[/(surface duo)/i],[c,[p,P],[h,v]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[p,"Fairphone"],[h,y]],[/(u304aa)/i],[c,[p,"AT&T"],[h,y]],[/\bsie-(\w*)/i],[c,[p,"Siemens"],[h,y]],[/\b(rct\w+) b/i],[c,[p,"RCA"],[h,v]],[/\b(venue[\d ]{2,7}) b/i],[c,[p,"Dell"],[h,v]],[/\b(q(?:mv|ta)\w+) b/i],[c,[p,"Verizon"],[h,v]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[p,"Barnes & Noble"],[h,v]],[/\b(tm\d{3}\w+) b/i],[c,[p,"NuVision"],[h,v]],[/\b(k88) b/i],[c,[p,"ZTE"],[h,v]],[/\b(nx\d{3}j) b/i],[c,[p,"ZTE"],[h,y]],[/\b(gen\d{3}) b.+49h/i],[c,[p,"Swiss"],[h,y]],[/\b(zur\d{3}) b/i],[c,[p,"Swiss"],[h,v]],[/\b((zeki)?tb.*\b) b/i],[c,[p,"Zeki"],[h,v]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],c,[h,v]],[/\b(ns-?\w{0,9}) b/i],[c,[p,"Insignia"],[h,v]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[p,"NextBook"],[h,v]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],c,[h,y]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],c,[h,y]],[/\b(ph-1) /i],[c,[p,"Essential"],[h,y]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[p,"Envizen"],[h,v]],[/\b(trio[-\w\. ]+) b/i],[c,[p,"MachSpeed"],[h,v]],[/\btu_(1491) b/i],[c,[p,"Rotor"],[h,v]],[/(shield[\w ]+) b/i],[c,[p,"Nvidia"],[h,v]],[/(sprint) (\w+)/i],[p,c,[h,y]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[p,P],[h,y]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[p,B],[h,v]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[p,B],[h,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,c,[h,g]],[/droid.+; (shield) bui/i],[c,[p,"Nvidia"],[h,g]],[/(playstation [345portablevi]+)/i],[c,[p,k],[h,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[p,P],[h,g]],[/smart-tv.+(samsung)/i],[p,[h,b]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[p,N],[h,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,L],[h,b]],[/(apple) ?tv/i],[p,[c,T+" TV"],[h,b]],[/crkey/i],[[c,I+"cast"],[p,C],[h,b]],[/droid.+aft(\w)( bui|\))/i],[c,[p,w],[h,b]],[/\(dtv[\);].+(aquos)/i],[c,[p,"Sharp"],[h,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[p,j],[c,j],[h,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,b]],[/((pebble))app/i],[p,c,[h,_]],[/droid.+; (glass) \d/i],[c,[p,C],[h,_]],[/droid.+; (wt63?0{2,3})\)/i],[c,[p,B],[h,_]],[/(quest( 2)?)/i],[c,[p,U],[h,_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[h,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[h,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[h,v]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,v]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[h,y]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[d,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,d]],os:[[/microsoft (windows) (vista|xp)/i],[d,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[d,[f,Z,q]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[d,"Windows"],[f,Z,q]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[d,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[d,"Mac OS"],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[f,d],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[d,f],[/\(bb(10);/i],[f,[d,S]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[d,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[d,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[d,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[d,I+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[d,"Chromium OS"],f],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[d,f],[/(sunos) ?([\w\.\d]*)/i],[[d,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[d,f]]},Y=function(e,t){if(typeof e===l&&(t=e,e=o),!(this instanceof Y))return new Y(e,t).getResult();var n=e||(typeof i!==s&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(W,t):W;return this.getBrowser=function(){var e,t={};return t[d]=o,t[f]=o,H.call(t,n,r.browser),t.major=typeof(e=t.version)===u?e.replace(/[^\d\.]/g,"").split(".")[0]:o,t},this.getCPU=function(){var e={};return e[m]=o,H.call(e,n,r.cpu),e},this.getDevice=function(){var e={};return e[p]=o,e[c]=o,e[h]=o,H.call(e,n,r.device),e},this.getEngine=function(){var e={};return e[d]=o,e[f]=o,H.call(e,n,r.engine),e},this.getOS=function(){var e={};return e[d]=o,e[f]=o,H.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===u&&e.length>255?j(e,255):e,this},this.setUA(n),this};Y.VERSION="1.0.2",Y.BROWSER=z([d,f,"major"]),Y.CPU=z([m]),Y.DEVICE=z([c,p,h,g,y,b,v,_,E]),Y.ENGINE=Y.OS=z([d,f]),typeof t!==s?(e.exports&&(t=e.exports=Y),t.UAParser=Y):n.amdO?(r=function(){return Y}.call(t,n,t,e))===o||(e.exports=r):typeof i!==s&&(i.UAParser=Y);var K=typeof i!==s&&(i.jQuery||i.Zepto);if(K&&!K.ua){var $=new Y;K.ua=$.getResult(),K.ua.get=function(){return $.getUA()},K.ua.set=function(e){$.setUA(e);var t=$.getResult();for(var n in t)K.ua[n]=t[n]}}}("object"==typeof window?window:this)},7839:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},9862:()=>{},964:()=>{},3165:e=>{"use strict";e.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},5813:e=>{"use strict";e.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},9460:e=>{"use strict";e.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},7778:e=>{"use strict";e.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},8589:e=>{"use strict";e.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},858:e=>{"use strict";e.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";n.d(r,{default:()=>c}),n(8416);var e,t=n(1715),i=n(8080),o=n(1737),a=n(7688),s=function(){var e,t="application/dash+xml";function n(n,r,i){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o,s=n.id||n.name||"video element";if(!(r=r||[].slice.call(n.querySelectorAll("source")).filter((function(e){return e.type==t}))[0])&&n.src)(r=document.createElement("source")).src=n.src;else if(!r&&!n.src)return null;return i=i||{},(o=(0,a.Z)(i).create()).initialize(n,r.src,n.autoplay),e||(e=o.getDebug().getLogger()),e.debug("Converted "+s+" to dash.js player and added content: "+r.src),n._dashjs_player=o,o}function r(e){return/^VIDEO$/i.test(e.nodeName)?e:r(e.parentNode)}return{create:n,createAll:function(e,i){var o=[];e=e||"[data-dashjs-player]";for(var a=(i=i||document).querySelectorAll(e),s=0;s<a.length;s++){var l=n(a[s],null);o.push(l)}for(var u=i.querySelectorAll('source[type="'+t+'"]'),c=0;c<u.length;c++){var d=n(r(u[c]),null);o.push(d)}return o}}}();!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?s.createAll():e=window.setInterval((function(){window.dashjs&&(window.clearInterval(e),s.createAll())}),500):window.addEventListener("load",(function e(){window.removeEventListener("load",e),s.createAll()})));const l=s;var u=n(6398);dashjs.Protection=o.default,dashjs.MetricsReporting=i.default,dashjs.MediaPlayerFactory=l,dashjs.Debug=u.Z,dashjs.supportsMediaSource=t.B;const c=dashjs})(),r.default})(),e.exports=t()},2702:function(e,t,n){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,i=void 0,o=void 0,a=function(e,t){p[r]=e,p[r+1]=t,2===(r+=2)&&(o?o(f):b())};var s="undefined"!=typeof window?window:void 0,l=s||{},u=l.MutationObserver||l.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(f,1)}}var p=new Array(1e3);function f(){for(var e=0;e<r;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;r=0}var m,g,y,v,b=void 0;function _(e,t){var n=this,r=new this.constructor(T);void 0===r[w]&&k(r);var i=n._state;if(i){var o=arguments[i-1];a((function(){return O(i,r,o,n._result)}))}else P(n,r,e,t);return r}function E(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(T);return R(t,e),t}b=c?function(){return process.nextTick(f)}:u?(g=0,y=new u(f),v=document.createTextNode(""),y.observe(v,{characterData:!0}),function(){v.data=g=++g%2}):d?((m=new MessageChannel).port1.onmessage=f,function(){return m.port2.postMessage(0)}):void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(f)}:h()}catch(e){return h()}}():h();var w=Math.random().toString(36).substring(2);function T(){}var A=void 0,S=1,x=2;function I(t,n,r){n.constructor===t.constructor&&r===_&&n.constructor.resolve===E?function(e,t){t._state===S?M(e,t._result):t._state===x?L(e,t._result):P(t,void 0,(function(t){return R(e,t)}),(function(t){return L(e,t)}))}(t,n):void 0===r?M(t,n):e(r)?function(e,t,n){a((function(e){var r=!1,i=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?R(e,n):M(e,n))}),(function(t){r||(r=!0,L(e,t))}),e._label);!r&&i&&(r=!0,L(e,i))}),e)}(t,n,r):M(t,n)}function R(e,t){if(e===t)L(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(r=t),null===r||"object"!==i&&"function"!==i)M(e,t);else{var n=void 0;try{n=t.then}catch(t){return void L(e,t)}I(e,t,n)}var r,i}function C(e){e._onerror&&e._onerror(e._result),D(e)}function M(e,t){e._state===A&&(e._result=t,e._state=S,0!==e._subscribers.length&&a(D,e))}function L(e,t){e._state===A&&(e._state=x,e._result=t,a(C,e))}function P(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+S]=n,i[o+x]=r,0===o&&e._state&&a(D,e)}function D(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?O(n,r,i,o):i(o);e._subscribers.length=0}}function O(t,n,r,i){var o=e(r),a=void 0,s=void 0,l=!0;if(o){try{a=r(i)}catch(e){l=!1,s=e}if(n===a)return void L(n,new TypeError("A promises callback cannot return that same promise."))}else a=i;n._state!==A||(o&&l?R(n,a):!1===l?L(n,s):t===S?M(n,a):t===x&&L(n,a))}var N=0;function k(e){e[w]=N++,e._state=void 0,e._result=void 0,e._subscribers=[]}var F=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(T),this.promise[w]||k(this.promise),t(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&M(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===E){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(e){a=!0,o=e}if(i===_&&e._state!==A)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===B){var s=new n(T);a?L(s,o):I(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===A&&(this._remaining--,e===x?L(r,n):this._result[t]=n),0===this._remaining&&M(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;P(e,void 0,(function(e){return n._settledAt(S,t,e)}),(function(e){return n._settledAt(x,t,e)}))},e}();var B=function(){function t(e){this[w]=N++,this._result=this._state=void 0,this._subscribers=[],T!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){R(e,t)}),(function(t){L(e,t)}))}catch(t){L(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this,r=n.constructor;return e(t)?n.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):n.then(t,t)},t}();return B.prototype.then=_,B.all=function(e){return new F(this,e).promise},B.race=function(e){var n=this;return t(e)?new n((function(t,r){for(var i=e.length,o=0;o<i;o++)n.resolve(e[o]).then(t,r)})):new n((function(e,t){return t(new TypeError("You must pass an array to race."))}))},B.resolve=E,B.reject=function(e){var t=new this(T);return L(t,e),t},B._setScheduler=function(e){o=e},B._setAsap=function(e){a=e},B._asap=a,B.polyfill=function(){var e=void 0;if(void 0!==n.g)e=n.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=B},B.Promise=B,B}()},6729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},9497:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(2702),i=n.n(r);"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const n=Object(e);for(let e=1;e<arguments.length;e++){const t=arguments[e];if(null!=t)for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},writable:!0,configurable:!0}),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})})),i().polyfill(),"undefined"==typeof window||window.dashjs||(window.dashjs={skipAutoCreate:!0,isDefaultSubject:!0});const o=[function(e,t){const n={AdStarted:()=>e.onStartVpaidAd,AdStopped:()=>e.onStopVpaidAd,AdSkipped:()=>e.onSkipVpaidAd,AdLoaded:()=>e.onVpaidAdLoaded,AdLinearChange:()=>e.onVpaidAdLinearChange,AdSizeChange:()=>e.onVpaidAdSizeChange,AdExpandedChange:()=>e.onVpaidAdExpandedChange,AdSkippableStateChange:()=>e.onVpaidAdSkippableStateChange,AdDurationChange:()=>e.onVpaidAdDurationChange,AdRemainingTimeChange:()=>e.onVpaidAdRemainingTimeChange,AdVolumeChange:()=>e.onVpaidAdVolumeChange,AdImpression:()=>e.onVpaidAdImpression,AdClickThru:()=>e.onVpaidAdClickThru,AdInteraction:()=>e.onVpaidAdInteraction,AdVideoStart:()=>e.onVpaidAdVideoStart,AdVideoFirstQuartile:()=>e.onVpaidAdVideoFirstQuartile,AdVideoMidpoint:()=>e.onVpaidAdVideoMidpoint,AdVideoThirdQuartile:()=>e.onVpaidAdVideoThirdQuartile,AdVideoComplete:()=>e.onVpaidAdVideoComplete,AdUserAcceptInvitation:()=>e.onVpaidAdUserAcceptInvitation,AdUserMinimize:()=>e.onVpaidAdUserMinimize,AdUserClose:()=>e.onVpaidAdUserClose,AdPaused:()=>e.onVpaidAdPaused,AdPlaying:()=>e.onVpaidAdPlaying,AdError:()=>e.onVpaidAdError,AdLog:()=>e.onVpaidAdLog};e.checkVPAIDInterface=e=>{const t=e;return!!(t.handshakeVersion&&"function"==typeof t.handshakeVersion&&t.initAd&&"function"==typeof t.initAd&&t.startAd&&"function"==typeof t.startAd&&t.stopAd&&"function"==typeof t.stopAd&&t.skipAd&&"function"==typeof t.skipAd&&t.resizeAd&&"function"==typeof t.resizeAd&&t.pauseAd&&"function"==typeof t.pauseAd&&t.resumeAd&&"function"==typeof t.resumeAd&&t.expandAd&&"function"==typeof t.expandAd&&t.collapseAd&&"function"==typeof t.collapseAd&&t.subscribe&&"function"==typeof t.subscribe&&t.unsubscribe&&"function"==typeof t.unsubscribe)},e.onVpaidAdPaused=()=>{e.vpaidTimeoutTimerClear(),e.debugMessage("onAdPaused")},e.onVpaidAdPlaying=()=>{e.vpaidTimeoutTimerClear(),e.debugMessage("onAdPlaying")},e.onVpaidAdError=t=>{e.debugMessage("onAdError: "+t),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.onVpaidAdLog=t=>{e.debugMessage("onAdLog: "+t)},e.onVpaidAdUserAcceptInvitation=()=>{e.debugMessage("onAdUserAcceptInvitation")},e.onVpaidAdUserMinimize=()=>{e.debugMessage("onAdUserMinimize")},e.onVpaidAdUserClose=()=>{e.debugMessage("onAdUserClose")},e.onVpaidAdSkippableStateChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Skippable State Changed to: "+e.vpaidAdUnit.getAdSkippableState())},e.onVpaidAdExpandedChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Expanded Changed to: "+e.vpaidAdUnit.getAdExpanded())},e.getVpaidAdExpanded=()=>{if(e.debugMessage("getAdExpanded"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdExpanded()},e.getVpaidAdSkippableState=()=>{if(e.debugMessage("getAdSkippableState"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdSkippableState()},e.onVpaidAdSizeChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad size changed to: w="+e.vpaidAdUnit.getAdWidth()+" h="+e.vpaidAdUnit.getAdHeight())},e.onVpaidAdDurationChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Duration Changed to: "+e.vpaidAdUnit.getAdDuration())},e.onVpaidAdRemainingTimeChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Remaining Time Changed to: "+e.vpaidAdUnit.getAdRemainingTime())},e.getVpaidAdRemainingTime=()=>{if(e.debugMessage("getAdRemainingTime"),e.vpaidAdUnit)return e.vpaidAdUnit.getAdRemainingTime()},e.onVpaidAdImpression=()=>{e.debugMessage("Ad Impression"),e.trackSingleEvent("impression")},e.onVpaidAdClickThru=(t,n,r)=>{e.debugMessage("Clickthrough portion of the ad was clicked"),r&&window.open(e.vastOptions.clickthroughUrl),e.pauseVpaidAd(),e.callUris(e.vastOptions.clicktracking)},e.onVpaidAdInteraction=t=>{e.debugMessage("A non-clickthrough event has occured")},e.onVpaidAdVideoStart=()=>{e.debugMessage("Video 0% completed"),e.trackSingleEvent("start")},e.onVpaidAdVideoFirstQuartile=()=>{e.debugMessage("Video 25% completed"),e.trackSingleEvent("firstQuartile")},e.onVpaidAdVideoMidpoint=()=>{e.debugMessage("Video 50% completed"),e.trackSingleEvent("midpoint")},e.onVpaidAdVideoThirdQuartile=()=>{e.debugMessage("Video 75% completed"),e.trackSingleEvent("thirdQuartile")},e.onVpaidAdVideoComplete=()=>{e.debugMessage("Video 100% completed"),e.trackSingleEvent("complete")},e.onVpaidAdLinearChange=()=>{const t=document.getElementsByClassName("fluid_vpaidNonLinear_ad")[0],n=document.getElementById("close_button_"+e.videoPlayerId),r=t.getAttribute("adlistid");if(e.debugMessage("Ad linear has changed: "+e.vpaidAdUnit.getAdLinear()),!e.vpaidAdUnit.getAdLinear())return;e.backupMainVideoContentTime(r.split("_")[0]),e.isCurrentlyPlayingAd=!0,n&&n.remove(),t.className="fluid_vpaid_slot",t.id=e.videoPlayerId+"_fluid_vpaid_slot",e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls");const i=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let t=0;t<i.length;t++)i[t].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;e.toggleLoader(!1)},e.getVpaidAdLinear=()=>(e.debugMessage("getAdLinear"),e.vpaidAdUnit.getAdLinear()),e.startVpaidAd=()=>{e.debugMessage("startAd"),e.vpaidTimeoutTimerStart(),e.vpaidAdUnit.startAd()},e.onVpaidAdLoaded=()=>{e.debugMessage("ad has been loaded"),e.vpaidTimeoutTimerClear(),e.startVpaidAd()},e.onStartVpaidAd=()=>{e.debugMessage("Ad has started"),e.vpaidTimeoutTimerClear()},e.stopVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit.stopAd()},e.hardStopVpaidAd=t=>{e.vpaidAdUnit&&(e.vpaidAdUnit.stopAd(),e.vpaidAdUnit=null);const n=document.getElementsByClassName("fluid_vpaid_iframe"),r=document.getElementsByClassName("fluid_vpaid_slot"),i=document.getElementsByClassName("fluid_vpaidNonLinear_ad");for(let e=0;e<n.length;e++)n[e].getAttribute("adListId")!==t.id&&n[e].remove();for(let e=0;e<r.length;e++)r[e].getAttribute("adListId")!==t.id&&r[e].remove();for(let e=0;e<i.length;e++)i[e].getAttribute("adListId")!==t.id&&i[e].remove()},e.onStopVpaidAd=()=>{e.debugMessage("Ad has stopped"),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.onSkipVpaidAd=()=>{e.debugMessage("Ad was skipped"),e.vpaidTimeoutTimerClear(),e.onVpaidEnded()},e.skipVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&(e.vpaidAdUnit.skipAd(),e.vpaidTimeoutTimerClear(),e.onVpaidEnded())},e.setVpaidAdVolume=t=>{e.vpaidAdUnit&&e.vpaidAdUnit.setAdVolume(t)},e.getVpaidAdVolume=()=>{if(e.vpaidAdUnit)return e.vpaidAdUnit.getAdVolume()},e.onVpaidAdVolumeChange=()=>{e.vpaidAdUnit&&e.debugMessage("Ad Volume has changed to - "+e.vpaidAdUnit.getAdVolume())},e.resizeVpaidAuto=()=>{if(null!==e.vastOptions&&e.vastOptions.vpaid&&e.vastOptions.linear){const t=e.domRef.player.offsetWidth,n=e.domRef.player.offsetHeight,r=e.fullscreenMode?"fullscreen":"normal";e.resizeVpaidAd(t,n,r)}},e.resizeVpaidAd=(t,n,r)=>{e.vpaidAdUnit&&e.vpaidAdUnit.resizeAd(t,n,r)},e.pauseVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&e.vpaidAdUnit.pauseAd()},e.resumeVpaidAd=()=>{e.vpaidTimeoutTimerStart(),e.vpaidAdUnit&&e.vpaidAdUnit.resumeAd()},e.expandVpaidAd=()=>{e.vpaidAdUnit&&e.vpaidAdUnit.expandAd()},e.collapseVpaidAd=()=>{e.vpaidAdUnit&&e.vpaidAdUnit.collapseAd()},e.vpaidTimeoutTimerClear=()=>{e.vpaidTimer&&clearTimeout(e.vpaidTimer)},e.vpaidTimeoutTimerStart=()=>{e.vpaidTimeoutTimerClear(),e.vpaidTimer=setTimeout((function(){e.announceLocalError("901"),e.onVpaidEnded()}),e.displayOptions.vastOptions.vpaidTimeout)},e.vpaidCallbackListenersAttach=()=>{for(let t in n)e.vpaidAdUnit.subscribe(n[t](),t,e)},e.vpaidCallbackListenersDetach=()=>{if(e.vpaidAdUnit)for(let t in n)e.vpaidAdUnit.unsubscribe(n[t](),t,e)},e.loadVpaid=(t,n)=>{const r=document.createElement("iframe");r.id=e.videoPlayerId+"_"+t.id+"_fluid_vpaid_iframe",r.className="fluid_vpaid_iframe",r.setAttribute("adListId",t.id),r.setAttribute("frameborder","0"),e.domRef.player.parentNode.insertBefore(r,e.domRef.player.nextSibling),r.contentWindow.document.write('<script src="'+n+'"><\/script>'),e.tempVpaidCounter=0,e.getVPAIDAdInterval=setInterval((function(){const n=r.contentWindow.getVPAIDAd;if(n&&"function"==typeof n)e.vpaidAdUnit&&e.hardStopVpaidAd(t),e.vpaidAdUnit=n(),clearInterval(e.getVPAIDAdInterval),e.checkVPAIDInterface(e.vpaidAdUnit)&&(e.getVpaidAdLinear()?(e.isCurrentlyPlayingAd=!0,e.switchPlayerToVpaidMode(t)):(e.debugMessage("non linear vpaid ad is loaded"),e.loadVpaidNonlinearAssets(t)));else{if(e.tempVpaidCounter++,e.tempVpaidCounter>=20)return clearInterval(e.getVPAIDAdInterval),e.rollsById[t.rollListId].error=!0,e.playMainVideoWhenVpaidFails(403),!1;e.debugMessage(e.tempVpaidCounter)}}),100)},e.onVpaidEnded=t=>{if(t&&t.stopImmediatePropagation(),!e.vpaidAdUnit)return;const n=document.getElementById(e.videoPlayerId+"_fluid_vpaid_slot");e.vpaidCallbackListenersDetach(),e.vpaidAdUnit=null,clearInterval(e.getVPAIDAdInterval),n&&n.remove(),e.checkForNextAd()},e.playMainVideoWhenVpaidFails=t=>{const n=document.getElementById(e.videoPlayerId+"_fluid_vpaid_slot");n&&n.remove(),clearInterval(e.getVPAIDAdInterval),e.playMainVideoWhenVastFails(t)}},function(e,t){function n(e){for(const t of e)if(void 0===t.data.attributes.sequence)return[t];return[]}async function r(t,i,o={},a=0,s=!0){const l={...o,children:[]},{responseXML:u}=await e.sendRequestAsync(t,!0,e.displayOptions.vastOptions.vastTimeout),c=Array.from(u.getElementsByTagName("Ad"));for(const t of c){const o=e.getVastAdTagUriFromWrapper(t),u=void 0!==t.attributes.sequence,c={data:t};if(o&&a<=i&&s){const[s]=t.getElementsByTagName("Wrapper"),d=s.attributes.followAdditionalWrappers&&["false","0"].includes(s.attributes.followAdditionalWrappers.value),h=s.attributes.allowMultipleAds&&["true","1"].includes(s.attributes.allowMultipleAds.value),p=s.attributes.fallbackOnNoAd&&["true","1"].includes(s.attributes.fallbackOnNoAd.value);try{const e=await r(o,i,{tagType:"wrapper",...c,fallbackOnNoAd:p},a+1,!d);e.fallbackOnNoAd=p,h&&!u||(e.children=n(e.children)),l.children.push(e)}catch(t){l.children.push({tagType:"wrapper",fallbackOnNoAd:p,httpError:!0}),e.debugMessage("Error when loading Wrapper, will trigger fallback if available",t)}}else o||l.children.push({tagType:"inLine",...c})}return l}function i(e,t=[],n=[]){return Array.isArray(e.children)&&e.children.length&&e.children.forEach((n=>i(n,t,[...e.wrappers||[],e.data]))),"inLine"===e.tagType&&t.push({...e,wrappers:n.filter(Boolean)}),t}e.setCTAFromVast=(t,n)=>{if(e.displayOptions.vastOptions.adCTATextVast&&t){const r=e.extractNodeDataByTagName(t,"MobileText"),i=e.extractNodeDataByTagName(t,"PCText"),o=e.extractNodeDataByTagName(t,"DisplayUrl")||e.extractNodeDataByTagName(t,"Link"),a=e.extractNodeDataByTagName(t,"Tracking"),s=window.matchMedia("(max-width: 768px)").matches;(i||r)&&a&&(n.titleCTA={text:s?r||i:i||r,link:o||null,tracking:a})}},e.getClickThroughUrlFromLinear=t=>{const n=t.getElementsByTagName("VideoClicks");if(n.length){const t=n[0].getElementsByTagName("ClickThrough");if(t.length)return e.extractNodeData(t[0])}return!1},e.getVastAdTagUriFromWrapper=t=>{const n=t.getElementsByTagName("Wrapper");if(void 0!==n&&n.length){const t=n[0].getElementsByTagName("VASTAdTagURI");if(t.length)return e.extractNodeData(t[0])}return!1},e.hasInLine=e=>{const t=e.getElementsByTagName("InLine");return void 0!==t&&t.length},e.hasVastAdTagUri=e=>{const t=e.getElementsByTagName("VASTAdTagURI");return void 0!==t&&t.length},e.getClickThroughUrlFromNonLinear=t=>{let n="";if(t.getElementsByTagName("NonLinear").length){const r=t.getElementsByTagName("NonLinearClickThrough");r.length&&(n=e.extractNodeData(r[0]))}return n},e.getTrackingFromLinear=e=>{const t=e.getElementsByTagName("TrackingEvents");return t.length?t[0].getElementsByTagName("Tracking"):[]},e.getDurationFromLinear=t=>{const n=t.getElementsByTagName("Duration");if(n.length&&void 0!==n[0].childNodes[0]){const t=e.extractNodeData(n[0]);return e.convertTimeStringToSeconds(t)}return!1},e.getDurationFromNonLinear=t=>{let n=0;const r=t.getElementsByTagName("NonLinear");return r.length&&void 0!==r[0].getAttribute("minSuggestedDuration")&&(n=e.convertTimeStringToSeconds(r[0].getAttribute("minSuggestedDuration"))),n},e.getDimensionFromNonLinear=e=>{const t={width:null,height:null},n=e.getElementsByTagName("NonLinear");return n.length&&(void 0!==n[0].getAttribute("width")&&(t.width=n[0].getAttribute("width")),void 0!==n[0].getAttribute("height")&&(t.height=n[0].getAttribute("height"))),t},e.getCreativeTypeFromStaticResources=e=>{let t="";const n=e.getElementsByTagName("NonLinear");return n.length&&void 0!==n[0].childNodes[0]&&(t=n[0].getElementsByTagName("StaticResource")[0].getAttribute("creativeType")),t.toLowerCase()},e.getMediaFilesFromLinear=e=>{const t=e.getElementsByTagName("MediaFiles");return t.length?t[0].getElementsByTagName("MediaFile"):[]},e.getStaticResourcesFromNonLinear=e=>{let t=[];const n=e.getElementsByTagName("NonLinear");return n.length&&(t=n[0].getElementsByTagName("StaticResource")),t},e.extractNodeDataByTagName=(t,n)=>{const r=t.getElementsByTagName(n);return r&&r.length?e.extractNodeData(r[0]):null},e.extractNodeData=e=>{let t="";for(let n=0;n<e.childNodes.length;n++){const r=e.childNodes[n];8===r.nodeType||3===r.nodeType&&/^\s*$/.test(r.nodeValue)||(t+=r.nodeValue)}return t.replace(/(^\s+|\s+$)/g,"")},e.getAdParametersFromLinear=t=>{const n=t.getElementsByTagName("AdParameters");let r=null;return n.length&&(r=e.extractNodeData(n[0])),r},e.getMediaFileListFromLinear=t=>{const n=[],r=e.getMediaFilesFromLinear(t);if(!r.length)return n;for(let t=0;t<r.length;t++){let i=r[t].getAttribute("mediaType");i||(i="2D"),n.push({src:e.extractNodeData(r[t]),type:r[t].getAttribute("type"),apiFramework:r[t].getAttribute("apiFramework"),codec:r[t].getAttribute("codec"),id:r[t].getAttribute("codec"),fileSize:r[t].getAttribute("fileSize"),delivery:r[t].getAttribute("delivery"),width:r[t].getAttribute("width"),height:r[t].getAttribute("height"),mediaType:i.toLowerCase()})}return n},e.getIconClickThroughFromLinear=t=>{const n=t.getElementsByTagName("IconClickThrough");return n.length?e.extractNodeData(n[0]):""},e.getStaticResourceFromNonLinear=t=>{let n;const r=e.getStaticResourcesFromNonLinear(t);for(let t=0;t<r.length;t++)if(r[t].getAttribute("type")||(n=e.extractNodeData(r[t])),r[t].getAttribute("type")===e.displayOptions.staticResource)return e.extractNodeData(r[t]);return n},e.registerTrackingEvents=(t,n)=>{const r=e.getTrackingFromLinear(t);let i="",o=0;for(let t=0;t<r.length;t++)switch(i=r[t].getAttribute("event"),i){case"start":case"firstQuartile":case"midpoint":case"thirdQuartile":case"complete":void 0===n.tracking[i]&&(n.tracking[i]=[]),void 0===n.stopTracking[i]&&(n.stopTracking[i]=[]),n.tracking[i].push(r[t].textContent.trim()),n.stopTracking[i]=!1;break;case"progress":void 0===n.tracking[i]&&(n.tracking[i]=[]),o=e.convertTimeStringToSeconds(r[t].getAttribute("offset")),void 0===n.tracking[i][o]&&(n.tracking[i][o]={elements:[],stopTracking:!1}),n.tracking[i][o].elements.push(r[t].textContent.trim())}},e.registerClickTracking=(e,t)=>{if(e&&e.length)for(let n=0;n<e.length;n++)""!==e[n]&&t.clicktracking.push(e[n])},e.registerImpressionEvents=(t,n)=>{if(t.length)for(let r=0;r<t.length;r++){const i=e.extractNodeData(t[r]);n.impression.push(i)}},e.registerErrorEvents=(e,t)=>{null!=e&&1===e.length&&1===e[0].childNodes.length&&(t.errorUrl=e[0].childNodes[0].nodeValue)},e.announceError=t=>{if(void 0===e.vastOptions.errorUrl||!e.vastOptions.errorUrl)return;const n=void 0!==t?parseInt(t):900,r=e.vastOptions.errorUrl.replace("[ERRORCODE]",n);e.callUris([r])},e.getClickTrackingEvents=t=>{const n=[],r=t.getElementsByTagName("VideoClicks");if(!r.length)return;const i=r[0].getElementsByTagName("ClickTracking");if(i.length){for(let t=0;t<i.length;t++){const r=e.extractNodeData(i[t]);n.push(r)}return n}},e.getNonLinearClickTrackingEvents=t=>{const n=[];if(!t.getElementsByTagName("NonLinear").length)return;const r=t.getElementsByTagName("NonLinearClickTracking");if(r.length){for(let t=0;t<r.length;t++){const i=e.extractNodeData(r[t]);n.push(i)}return n}},e.callUris=e=>{for(let t=0;t<e.length;t++)(new Image).src=e[t]},e.recalculateAdDimensions=()=>{const t=document.getElementById(e.videoPlayerId),n=document.getElementById("vast_clickthrough_layer_"+e.videoPlayerId);n&&(n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px");const r=e.checkFullscreenSupport("fluid_video_wrapper_"+e.videoPlayerId),i=document.getElementById(e.videoPlayerId+"_fluid_control_fullscreen"),o=document.getElementById(e.videoPlayerId+"context_option_fullscreen");if(r)null===document[r.isFullscreen]?e.fullscreenOff(i,o):e.fullscreenOn(i,o);else{const t=document.getElementById("fluid_video_wrapper_"+e.videoPlayerId);-1!==t.className.search(/\bpseudo_fullscreen\b/g)?(t.className+=" pseudo_fullscreen",e.fullscreenOn(i,o)):(t.className=t.className.replace(/\bpseudo_fullscreen\b/g,""),e.fullscreenOff(i,o))}},e.prepareVast=t=>{let n=e.findRoll(t);for(let t=0;t<n.length;t++){const r=n[t];!0!==e.rollsById[r].vastLoaded&&!0!==e.rollsById[r].error&&e.processVastWithRetries(e.rollsById[r])}},e.playMainVideoWhenVastFails=t=>{e.debugMessage("playMainVideoWhenVastFails called"),e.domRef.player.removeEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.pause(),e.toggleLoader(!1),e.displayOptions.vastOptions.vastAdvanced.noVastVideoCallback(),e.vastOptions&&void 0!==e.vastOptions.errorUrl?e.announceError(t):e.announceLocalError(t),e.switchToMainVideo()},e.switchPlayerToVastMode=()=>{},e.processVastWithRetries=t=>{let n=t.vastTag;const r=t.id;e.domRef.player.addEventListener("adId_"+r,e[t.roll]);const i=function(o,a){if(o&&Array.isArray(a)&&!e.displayOptions.vastOptions.allowVPAID&&a.some((e=>e.vpaid))&&(a=a.filter((e=>!0!==e.vpaid)),e.announceLocalError("103","VPAID not allowed, so skipping this VAST tag.")),o&&Array.isArray(a)&&a.length){e.adPool[r]=[],a.forEach(((t,n)=>{if(t.id=r+"_AD"+n,t.rollListId=r,"linear"===t.adType){void 0!==t.iconClick&&null!==t.iconClick&&t.iconClick.length&&(t.landingPage=t.iconClick);const n=e.getSupportedMediaFileObject(t.mediaFileList);n&&(t.mediaType=n.mediaType)}t.adType=t.adType?t.adType:"unknown",e.adPool[r].push(Object.assign({},t)),e.hasTitle()&&(document.getElementById(e.videoPlayerId+"_title").style.display="none"),e.rollsById[r].ads.push(t)})),e.rollsById[r].vastLoaded=!0;const t=document.createEvent("Event");t.initEvent("adId_"+r,!1,!0),e.domRef.player.dispatchEvent(t),e.displayOptions.vastOptions.vastAdvanced.vastLoadedCallback()}else e.announceLocalError("101"),t.hasOwnProperty("fallbackVastTags")&&t.fallbackVastTags.length>0?(n=t.fallbackVastTags.shift(),e.processUrl(n,i,r)):("preRoll"===t.roll&&e.preRollFail(t),e.rollsById[r].error=!0)};e.processUrl(n,i,r)},e.processUrl=(t,n,r)=>{e.resolveVastTag(t,0,{tracking:[],stopTracking:[],impression:[],clicktracking:[],vastLoaded:!1},n,r)},e.resolveVastTag=(t,n,o,a,s)=>{if(!t||""===t)return a(!1);r(t,e.displayOptions.vastOptions.maxAllowedVastTagRedirects).then((t=>{try{const n=t.children.some((e=>"wrapper"===e.tagType&&e.fallbackOnNoAd&&(!/"tagType":"ad"/.test(JSON.stringify(e))||e.httpError)));n&&e.debugMessage("Error on VAST Wrapper, triggering fallbackOnNoAd. Ad tree:",t),t=i(t).map((t=>function(t){const n=t.data;if(!n)return;const r=Array.from(n.getElementsByTagName("Creative")).splice(0,1);return r.length&&r.forEach((r=>{if("linear"===t.adType){const i=r.getElementsByTagName("Linear")[0];!e.hasVastAdTagUri(n)&&e.hasInLine(n)&&(t.adFinished=!1,t.vpaid=!1,t.skipoffset=e.convertTimeStringToSeconds(i.getAttribute("skipoffset")),t.clickthroughUrl=e.getClickThroughUrlFromLinear(i),t.duration=e.getDurationFromLinear(i),t.mediaFileList=e.getMediaFileListFromLinear(i),t.adParameters=e.getAdParametersFromLinear(i),t.iconClick=t.iconClick||e.getIconClickThroughFromLinear(i),t.adParameters&&(t.vpaid=!0))}if("nonLinear"===t.adType){const i=r.getElementsByTagName("NonLinearAds")[0];!e.hasVastAdTagUri(n)&&e.hasInLine(n)&&(t.vpaid=!1,t.clickthroughUrl=e.getClickThroughUrlFromNonLinear(i),t.duration=e.getDurationFromNonLinear(i),t.dimension=e.getDimensionFromNonLinear(i),t.staticResource=e.getStaticResourceFromNonLinear(i),t.creativeType=e.getCreativeTypeFromStaticResources(i),t.adParameters=e.getAdParametersFromLinear(i),t.adParameters&&(t.vpaid=!0))}})),t}(function(t,n){const r={...t,...JSON.parse(JSON.stringify(n))};return r.adType=(r.data.getElementsByTagName("Linear").length?"linear":r.data.getElementsByTagName("NonLinearAds").length&&"nonLinear")||"unknown",[...r.wrappers||[],r.data].filter(Boolean).forEach((t=>{const n=t.getElementsByTagName("Impression");null!==n&&e.registerImpressionEvents(n,r);const i=t.getElementsByTagName("Error");null!==i&&e.registerErrorEvents(i,r);const[o]=t.getElementsByTagName("TitleCTA");o&&e.setCTAFromVast(o,r),e.registerTrackingEvents(t,r);const a="linear"===r.adType?e.getClickTrackingEvents(t):e.getNonLinearClickTrackingEvents(t);e.registerClickTracking(a,r)})),r.sequence=r.data.attributes.sequence?Number(r.data.attributes.sequence.value):null,r.played=!1,r}(t,o))));const r=function(t,n,r,i){const{adPod:o}=t.filter((e=>Boolean(e.sequence))).sort(((e,t)=>e.sequence-t.sequence)).reduce(((e,t)=>(e.adPod.length<r&&e.totalDuration+t.duration<=n&&e.adPod.push(t),e)),{adPod:[],totalDuration:0}),a=t.filter((e=>!Boolean(e.sequence)&&e.duration<n)),s=o.map((e=>e.adType)).slice(0,-1).every((e=>"linear"===e));return o.length>0&&!i&&s?(e.debugMessage("Playing valid adPod",o),o):(e.debugMessage("Trying to play single ad, adBuffet:",a),a.length>0?[a[0]]:[])}(t,e.rollsById[s].maxTotalDuration||Number.MAX_SAFE_INTEGER,e.rollsById[s].maxTotalQuantity||Number.MAX_SAFE_INTEGER,n);r&&r.length?a(!0,r):a(!1)}catch(e){a(!1)}})).catch((()=>a(!1)))},e.setVastList=()=>{const t={},n={preRoll:[],postRoll:[],midRoll:[],onPauseRoll:[]},r={id:null,roll:null,vastLoaded:!1,error:!1,adText:null,adTextPosition:null};let i=0;const o=function(e){let t=!1;return"midRoll"===e.roll&&void 0===e.timer&&(t=!0),t},a=function(t){let n=!1;return t.vastTag||(e.announceLocalError(102,'"vastTag" property is missing from adList.'),n=!0),t.roll||(e.announceLocalError(102,'"roll" is missing from adList.'),n=!0),-1===e.availableRolls.indexOf(t.roll)&&(e.announceLocalError(102,"Only "+e.availableRolls.join(",")+" rolls are supported."),n=!0),t.size&&-1===e.supportedNonLinearAd.indexOf(t.size)&&(e.announceLocalError(102,"Only "+e.supportedNonLinearAd.join(",")+" size are supported."),n=!0),n};if(e.displayOptions.vastOptions.hasOwnProperty("adList"))for(let n in e.displayOptions.vastOptions.adList){let s=e.displayOptions.vastOptions.adList[n];if(a(s)){e.announceLocalError(102,"Wrong adList parameters.");continue}const l="ID"+i;t[l]=Object.assign({},r),t[l]=Object.assign(t[l],e.displayOptions.vastOptions.adList[n]),"midRoll"===s.roll&&(t[l].error=o("midRoll")),t[l].id=l,t[l].ads=[],i++}Object.keys(t).map((function(e){switch(t[e].roll.toLowerCase()){case"preRoll".toLowerCase():n.preRoll.push(t[e]);break;case"midRoll".toLowerCase():n.midRoll.push(t[e]);break;case"postRoll".toLowerCase():n.postRoll.push(t[e]);break;case"onPauseRoll".toLowerCase():n.onPauseRoll.push(t[e]);break;default:console.error(`${t[e].roll.toLowerCase()} is not a recognized roll`)}})),e.adGroupedByRolls=n,e.rollsById=t},e.onVastAdEnded=t=>{t&&t.stopImmediatePropagation(),e.vastOptions.adFinished=!0,e.deleteVastAdElements(),e.checkForNextAd()},e.vastLogoBehaviour=t=>{if(!e.displayOptions.layoutControls.logo.showOverAds){const n=document.getElementById(e.videoPlayerId+"_logo"),r=document.getElementById(e.videoPlayerId+"_logo_image");if(!n||!r)return;n.style.display=t?"none":"inline"}},e.deleteVastAdElements=()=>{e.removeClickthrough(),e.removeSkipButton(),e.removeAdCountdown(),e.removeAdPlayingText(),e.removeCTAButton(),e.vastLogoBehaviour(!1)}},function(e,t){e.createCardboardJoystickButton=t=>{const n=document.getElementById(e.videoPlayerId+"_fluid_vr_joystick_panel"),r=document.createElement("div");return r.id=e.videoPlayerId+"_fluid_vr_joystick_"+t,r.className="fluid_vr_button fluid_vr_joystick_"+t,n.appendChild(r),r},e.cardboardRotateLeftRight=t=>{const n=e.vrROTATION_POSITION,r=-e.vrROTATION_POSITION,i={val:t<1?n:r};new TWEEN.Tween(i).to({val:0},e.vrROTATION_SPEED).easing(TWEEN.Easing.Quadratic.InOut).onUpdate((function(){e.vrViewer.OrbitControls.rotateLeft(i.val)})).start()},e.cardboardRotateUpDown=t=>{const n=e.vrROTATION_POSITION,r=-e.vrROTATION_POSITION,i={val:t<1?n:r};new TWEEN.Tween(i).to({val:0},e.vrROTATION_SPEED).easing(TWEEN.Easing.Quadratic.InOut).onUpdate((function(){e.vrViewer.OrbitControls.rotateUp(i.val)})).start()},e.createCardboardJoystick=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_vr_container"),n=document.createElement("div");n.id=e.videoPlayerId+"_fluid_vr_joystick_panel",n.className="fluid_vr_joystick_panel",t.appendChild(n);const r=e.createCardboardJoystickButton("up"),i=e.createCardboardJoystickButton("left"),o=e.createCardboardJoystickButton("right"),a=e.createCardboardJoystickButton("down"),s=e.createCardboardJoystickButton("zoomdefault"),l=e.createCardboardJoystickButton("zoomin"),u=e.createCardboardJoystickButton("zoomout");r.addEventListener("click",(function(){e.cardboardRotateUpDown(1)})),a.addEventListener("click",(function(){e.cardboardRotateUpDown(0)})),o.addEventListener("click",(function(){e.cardboardRotateLeftRight(0)})),i.addEventListener("click",(function(){e.cardboardRotateLeftRight(1)})),s.addEventListener("click",(function(){e.vrViewer.camera.fov=60,e.vrViewer.camera.updateProjectionMatrix()})),u.addEventListener("click",(function(){e.vrViewer.camera.fov*=1.1,e.vrViewer.camera.updateProjectionMatrix()})),l.addEventListener("click",(function(){e.vrViewer.camera.fov*=.9,e.vrViewer.camera.updateProjectionMatrix()}))},e.cardBoardResize=()=>{e.domRef.player.addEventListener("theatreModeOn",(function(){e.vrViewer.onWindowResize()})),e.domRef.player.addEventListener("theatreModeOff",(function(){e.vrViewer.onWindowResize()}))},e.cardBoardSwitchToNormal=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_vr_joystick_panel"),n=document.getElementById(e.videoPlayerId+"_fluid_controls_container"),r=e.domRef.player;e.vrViewer.enableEffect(PANOLENS.MODES.NORMAL),e.vrViewer.onWindowResize(),e.vrMode=!1;const i=r.parentNode.getElementsByClassName("fluid_vr2_controls_container")[0];r.parentNode.removeChild(i),e.displayOptions.layoutControls.showCardBoardJoystick&&t&&(t.style.display="block"),n.classList.remove("fluid_vr_controls_container"),document.getElementById(e.videoPlayerId+"_fluid_control_volume_container").style.display="block";const o=document.getElementById("ad_countdown"+e.videoPlayerId),a=document.getElementById(e.videoPlayerId+"_fluid_cta"),s=document.getElementById(e.videoPlayerId+"_fluid_ad_playing"),l=document.getElementById("skip_button_"+e.videoPlayerId);o&&(o.style.display="block"),a&&(a.style.display="block"),s&&(s.style.display="block"),l&&(l.style.display="block")},e.cardBoardHideDefaultControls=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_vr_joystick_panel"),n=document.getElementById(e.videoPlayerId+"_fluid_initial_play"),r=document.getElementById(e.videoPlayerId+"_fluid_control_volume_container");e.displayOptions.layoutControls.showCardBoardJoystick&&t&&(t.style.display="none"),n&&(document.getElementById(e.videoPlayerId+"_fluid_initial_play").style.display="none",document.getElementById(e.videoPlayerId+"_fluid_initial_play_button").style.opacity="1"),r.style.display="none"},e.cardBoardCreateVRControls=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_controls_container").cloneNode(!0);t.removeAttribute("id"),t.querySelectorAll("*").forEach((function(e){e.removeAttribute("id")})),t.classList.add("fluid_vr2_controls_container"),e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),e.copyEvents(t)},e.cardBoardSwitchToVR=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_controls_container");e.vrViewer.enableEffect(PANOLENS.MODES.CARDBOARD),e.vrViewer.onWindowResize(),e.vrViewer.disableReticleControl(),e.vrMode=!0,t.classList.add("fluid_vr_controls_container"),e.cardBoardHideDefaultControls(),e.cardBoardCreateVRControls();const n=document.getElementById("ad_countdown"+e.videoPlayerId),r=document.getElementById(e.videoPlayerId+"_fluid_cta"),i=document.getElementById(e.videoPlayerId+"_fluid_ad_playing"),o=document.getElementById("skip_button_"+e.videoPlayerId);n&&(n.style.display="none"),r&&(r.style.display="none"),i&&(i.style.display="none"),o&&(o.style.display="none")},e.cardBoardMoveTimeInfo=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_duration"),n=document.getElementById(e.videoPlayerId+"_fluid_controls_container");t.classList.add("cardboard_time"),n.appendChild(t),e.controlDurationUpdate=function(){const t=e.formatTime(e.domRef.player.currentTime),n=e.formatTime(e.currentVideoDuration),r=e.domRef.player.parentNode.getElementsByClassName("fluid_control_duration");let i="";if(e.isCurrentlyPlayingAd){i="<span class='ad_timer_prefix'>AD : </span>"+t+" / "+n;for(let e=0;e<r.length;e++)r[e].classList.add("ad_timer_prefix")}else{i=t+" / "+n;for(let e=0;e<r.length;e++)r[e].classList.remove("ad_timer_prefix")}for(let e=0;e<r.length;e++)r[e].innerHTML=i}},e.cardBoardAlterDefaultControls=()=>{e.cardBoardMoveTimeInfo()},e.createCardboardView=()=>{const t=document.createElement("div");t.id=e.videoPlayerId+"_fluid_vr_container",t.className="fluid_vr_container",e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),PANOLENS.VideoPanorama.prototype.pauseVideo=function(){},PANOLENS.VideoPanorama.prototype.playVideo=function(){},e.vrPanorama=new PANOLENS.VideoPanorama("",{videoElement:e.domRef.player,autoplay:e.displayOptions.layoutControls.autoPlay,loop:!!e.displayOptions.layoutControls.loop}),e.vrViewer=new PANOLENS.Viewer({container:t,controlBar:!0,controlButtons:[],enableReticle:!1}),e.vrViewer.add(e.vrPanorama),e.vrViewer.enableEffect(PANOLENS.MODES.NORMAL),e.vrViewer.onWindowResize(),"Android"!==e.getMobileOs().userOs&&"iOS"!==e.getMobileOs().userOs||e.vrViewer.enableControl(1),e.cardBoardAlterDefaultControls(),e.cardBoardResize(),e.vrViewer.initialCameraPosition=JSON.parse(JSON.stringify(e.vrViewer.camera.position)),e.displayOptions.layoutControls.showCardBoardJoystick&&("Android"!==e.getMobileOs().userOs&&"iOS"!==e.getMobileOs().userOs&&e.createCardboardJoystick(),e.vrViewer.OrbitControls.noZoom=!0),e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_cardboard",(function(){e.vrMode?e.cardBoardSwitchToNormal():e.cardBoardSwitchToVR()}))},e.createCardboard=()=>{e.displayOptions.layoutControls.showCardBoardView&&(document.getElementById(e.videoPlayerId+"_fluid_control_cardboard").style.display="inline-block",window.PANOLENS?e.createCardboardView():n.e(216).then(n.bind(n,372)).then((t=>{window.PANOLENS=t,e.createCardboardView()})))}},function(e,t){e.subtitleFetchParse=t=>{e.sendRequest(t.url,!0,e.displayOptions.vastOptions.vastTimeout,(function(){const t=this;if(4===t.readyState&&200!==t.status)return;if(4!==t.readyState||200!==t.status)return;const n=t.responseText,r=new WebVTT.Parser(window,WebVTT.StringDecoder()),i=[],o=[];r.oncue=function(e){i.push(e)},r.onregion=function(e){o.push(e)},r.parse(n),r.flush(),e.subtitlesData=i}))},e.createSubtitlesSwitch=()=>{const t="OFF";if(e.subtitlesData=[],!e.displayOptions.layoutControls.subtitlesEnabled)return void(document.getElementById(e.videoPlayerId+"_fluid_control_subtitles").style.display="none");const n=[];n.push({label:t,url:"na",lang:t});const r=e.domRef.player.querySelectorAll("track");[].forEach.call(r,(function(e){"metadata"===e.kind&&e.src&&n.push({label:e.label,url:e.src,lang:e.srclang,default:e.default})})),e.subtitlesTracks=n;const i=document.getElementById(e.videoPlayerId+"_fluid_control_subtitles");i.style.display="inline-block";let o=!1;const a=document.createElement("div");a.id=e.videoPlayerId+"_fluid_control_subtitles_list",a.className="fluid_subtitles_list",a.style.display="none";let s=!1;const l=!!e.subtitlesTracks.find((e=>e.default));e.subtitlesTracks.forEach((function(n){let r="";const i=e.displayOptions.layoutControls.subtitlesOnByDefault;(!s&&(i&&n.default||!l&&n.label!==t||1===e.subtitlesTracks.length)||!i&&n.label===t)&&(r="subtitle_selected",e.subtitleFetchParse(n),s=!0);const u=document.createElement("div");u.id="subtitle_"+e.videoPlayerId+"_"+n.label,u.className="fluid_subtitle_list_item",u.innerHTML='<span class="subtitle_button_icon '+r+'"></span>'+n.label,u.addEventListener("click",(function(n){n.stopPropagation();const r=this,i=document.getElementsByClassName("subtitle_button_icon");for(let e=0;e<i.length;e++)i[e].className=i[e].className.replace("subtitle_selected","");r.firstChild.className+=" subtitle_selected",e.subtitlesTracks.forEach((function(n){n.label===r.innerText.replace(/(\r\n\t|\n|\r\t)/gm,"")&&(n.label===t?e.subtitlesData=[]:e.subtitleFetchParse(n))})),e.openCloseSubtitlesSwitch()})),a.appendChild(u),o=!0})),o?(i.appendChild(a),i.addEventListener("click",(function(){e.openCloseSubtitlesSwitch()}))):document.getElementById(e.videoPlayerId+"_fluid_control_subtitles").style.display="none",e.domRef.player.addEventListener("timeupdate",(function(){e.renderSubtitles()}))},e.renderSubtitles=()=>{const t=e.domRef.player;let n=Math.floor(t.currentTime),r=!1,i=document.getElementById(e.videoPlayerId+"_fluid_subtitles_container");if(e.isCurrentlyPlayingAd)i.innerHTML="";else{for(let t=0;t<e.subtitlesData.length;t++)n>=e.subtitlesData[t].startTime&&n<=e.subtitlesData[t].endTime&&(i.innerHTML="",i.appendChild(WebVTT.convertCueToDOMTree(window,e.subtitlesData[t].text)),r=!0);r||(i.innerHTML="")}},e.openCloseSubtitlesSwitch=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_subtitles_list");if(e.isCurrentlyPlayingAd)t.style.display="none";else if("none"===t.style.display){t.style.display="block";const e=function(n){t.removeEventListener("mouseleave",e),t.style.display="none"};t.addEventListener("mouseleave",e)}else t.style.display="none"},e.createSubtitles=()=>{const t=document.createElement("div");t.id=e.videoPlayerId+"_fluid_subtitles_container",t.className="fluid_subtitles_container",e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling),e.displayOptions.layoutControls.subtitlesEnabled&&Promise.all([n.e(216),n.e(721)]).then(n.t.bind(n,3407,23)).then((t=>{window.WebVTT=t.WebVTT,e.createSubtitlesSwitch()}))}},function(e,t){e.setupThumbnailPreviewVtt=()=>{e.sendRequest(e.displayOptions.layoutControls.timelinePreview.file,!0,e.displayOptions.vastOptions.vastTimeout,(function(){const t=this;if(4===t.readyState&&200!==t.status)return;if(4!==t.readyState||200!==t.status)return;const n=t.responseText,r=(new window.WebVTTParser).parse(n);e.timelinePreviewData=function(t){if(void 0===t.cues||!t.cues.length)return[];const n=[];let r=null,i=null;for(let o=0;o<t.cues.length;o++){r=t.cues[o].text.split("#");let a,s=0,l=0,u=122.5,c=69;2===r.length&&0===r[1].indexOf("xywh=")&&(i=r[1].substring(5),i=i.split(","),4===i.length&&(e.displayOptions.layoutControls.timelinePreview.spriteImage=!0,s=parseInt(i[0]),l=parseInt(i[1]),u=parseInt(i[2]),c=parseInt(i[3]))),!e.displayOptions.layoutControls.timelinePreview.spriteRelativePath||-1===e.displayOptions.layoutControls.timelinePreview.file.indexOf("/")||void 0!==e.displayOptions.layoutControls.timelinePreview.sprite&&""!==e.displayOptions.layoutControls.timelinePreview.sprite?a=e.displayOptions.layoutControls.timelinePreview.sprite?e.displayOptions.layoutControls.timelinePreview.sprite:r[0]:(a=e.displayOptions.layoutControls.timelinePreview.file.substring(0,e.displayOptions.layoutControls.timelinePreview.file.lastIndexOf("/")),a+="/"+r[0]),n.push({startTime:t.cues[o].startTime,endTime:t.cues[o].endTime,image:a,x:s,y:l,w:u,h:c})}return n}(r)}))},e.generateTimelinePreviewTags=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container"),n=document.createElement("div");n.id=e.videoPlayerId+"_fluid_timeline_preview_container",n.className="fluid_timeline_preview_container",n.style.display="none",n.style.position="absolute",t.appendChild(n);const r=document.createElement("div");r.id=e.videoPlayerId+"_fluid_timeline_preview_container_shadow",r.className="fluid_timeline_preview_container_shadow",r.style.position="absolute",r.style.display="none",r.style.opacity=1,t.appendChild(r)},e.getThumbnailCoordinates=t=>{if(e.timelinePreviewData.length)for(let n=0;n<e.timelinePreviewData.length;n++)if(t>=e.timelinePreviewData[n].startTime&&t<=e.timelinePreviewData[n].endTime)return e.timelinePreviewData[n];return!1},e.drawTimelinePreview=t=>{const n=document.getElementById(e.videoPlayerId+"_fluid_timeline_preview_container"),r=document.getElementById(e.videoPlayerId+"_fluid_timeline_preview_container_shadow"),i=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container"),o=i.clientWidth;if(e.isCurrentlyPlayingAd)return void("none"!==n.style.display&&(n.style.display="none"));const a=e.getEventOffsetX(t,i);let s=null;if(o){s=e.currentVideoDuration*a/o;const t=e.getThumbnailCoordinates(s);r.style.width=o+"px",r.style.display="block",!1!==t?(n.style.width=t.w+"px",n.style.height=t.h+"px",r.style.height=t.h+"px",n.style.background="url("+t.image+") no-repeat scroll -"+t.x+"px -"+t.y+"px",n.style.left=a-t.w/2+"px",n.style.display="block",e.displayOptions.layoutControls.timelinePreview.spriteImage||(n.style.backgroundSize="contain")):n.style.display="none"}},e.setupThumbnailPreview=()=>{let t=e.displayOptions.layoutControls.timelinePreview;if(!t||!t.type)return;let r="mousemove",i="mouseleave";if(e.mobileInfo.userOs&&(r="touchmove",i="touchend"),document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener(r,e.drawTimelinePreview.bind(e),!1),document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener(i,(function(t){const n=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container");void 0!==t.clientX&&n.contains(document.elementFromPoint(t.clientX,t.clientY))||(document.getElementById(e.videoPlayerId+"_fluid_timeline_preview_container").style.display="none",document.getElementById(e.videoPlayerId+"_fluid_timeline_preview_container_shadow").style.display="none")}),!1),e.generateTimelinePreviewTags(),"VTT"===t.type&&"string"==typeof t.file)n.e(216).then(n.bind(n,3751)).then((t=>{window.WebVTTParser=t.default,e.setupThumbnailPreviewVtt()}));else{if("static"!==t.type||"object"!=typeof t.frames)throw"Invalid thumbnail-preview - type must be VTT or static";t.spriteImage=!0,e.timelinePreviewData=t.frames}e.showTimeOnHover=!1}},function(e,t){const r="2.0";e.renderLinearAd=(t,i)=>{e.toggleLoader(!1),e.vastOptions=t,i&&e.backupMainVideoContentTime(t.rollListId);const o=()=>{if(e.adFinished)return void e.domRef.player.removeEventListener("timeupdate",o);const t=Math.floor(e.domRef.player.currentTime);0!==e.vastOptions.duration&&e.scheduleTrackingEvent(t,e.vastOptions.duration),t>=e.vastOptions.duration-1&&0!==e.vastOptions.duration&&(e.domRef.player.removeEventListener("timeupdate",o),e.adFinished=!0)};(t=>{e.switchPlayerToVpaidMode=t=>{e.debugMessage("starting function switchPlayerToVpaidMode");const n=e.videoPlayerId+"_"+t.id+"_fluid_vpaid_iframe",i={};i.AdParameters=t.adParameters;const o=document.createElement("div");o.id=e.videoPlayerId+"_fluid_vpaid_slot",o.className="fluid_vpaid_slot",o.setAttribute("adListId",t.id),e.domRef.player.parentNode.insertBefore(o,n.nextSibling);const a={slot:o,videoSlot:e.domRef.player,videoSlotCanAutoPlay:!0},s=e.vpaidAdUnit.handshakeVersion(r);if(1===e.compareVersion(r,s))return t.error=!0,e.playMainVideoWhenVpaidFails(403),!1;!1!==e.vastOptions.skipoffset&&e.addSkipButton(),e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls"),e.vpaidCallbackListenersAttach();const l=e.fullscreenMode?"fullscreen":"normal",u=e.domRef.player.offsetWidth,c=e.domRef.player.offsetHeight;e.vpaidAdUnit.initAd(u,c,l,3e3,i,a);const d=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let t=0;t<d.length;t++)d[t].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;e.toggleLoader(!1),t.played=!0,e.adFinished=!1},e.switchPlayerToVastMode=()=>{e.vastOptions.duration||(e.vastOptions.duration="streaming"===i.delivery?1/0:e.domRef.player.duration),e.displayOptions.layoutControls.showCardBoardView?t.landingPage?e.addCTAButton(t.landingPage):e.addCTAButton(t.clickthroughUrl):((void 0!==t.adClickable?t.adClickable:e.displayOptions.vastOptions.adClickable)&&e.addClickthroughLayer(e.videoPlayerId),e.addCTAButton(t.landingPage)),!1!==e.vastOptions.skipoffset&&e.addSkipButton(),e.domRef.player.loop=!1,e.addAdCountdown(),e.domRef.player.removeAttribute("controls"),e.vastLogoBehaviour(!0);const n=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let t=0;t<n.length;t++)n[t].style.backgroundColor=e.displayOptions.layoutControls.adProgressColor;if(e.rollsById[t.rollListId].adText||t.adText){const n=t.adText?t.adText:e.rollsById[t.rollListId].adText;e.addAdPlayingText(n)}if(e.positionTextElements(t),e.toggleLoader(!1),t.played=!0,e.adFinished=!1,e.domRef.player.play(),e.trackSingleEvent("impression"),e.domRef.player.removeEventListener("loadedmetadata",e.switchPlayerToVastMode),e.vrMode){const t=document.getElementById("ad_countdown"+e.videoPlayerId),n=document.getElementById(e.videoPlayerId+"_fluid_cta"),r=document.getElementById(e.videoPlayerId+"_fluid_ad_playing"),i=document.getElementById("skip_button_"+e.videoPlayerId);t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),i&&(i.style.display="none")}},e.domRef.player.pause(),e.detachStreamers();const i=e.getSupportedMediaFileObject(e.vastOptions.mediaFileList);if(e.displayOptions.layoutControls.showCardBoardView&&"360"!==t.mediaType)return t.error=!0,e.playMainVideoWhenVastFails(403),!1;const o=e.vastOptions.vpaid;if(!o&&i.isUnsuportedHls)n.e(216).then(n.bind(n,3041)).then((t=>{window.Hls=t.default;const n=new Hls({debug:"undefined"!=typeof FP_DEBUG&&!0===FP_DEBUG,p2pConfig:{logLevel:!1},enableWebVTT:!1,enableCEA708Captions:!1});n.attachMedia(e.domRef.player),n.loadSource(i.src),e.isCurrentlyPlayingAd=!0,e.hlsPlayer=n,e.domRef.player.addEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.addEventListener("ended",(()=>{n.detachMedia(),n.destroy(),e.hlsPlayer=!1,e.onVastAdEnded()})),e.domRef.player.play()}));else if(o)e.loadVpaid(t,i.src),e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarkers();else{if(!1===i.src)return t.error=!0,e.playMainVideoWhenVastFails(403),!1;e.domRef.player.addEventListener("loadedmetadata",e.switchPlayerToVastMode),e.domRef.player.src=i.src,e.isCurrentlyPlayingAd=!0,e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarkers(),e.domRef.player.load(),e.domRef.player.addEventListener("ended",e.onVastAdEnded)}})(t),e.domRef.player.addEventListener("timeupdate",o)},e.playRoll=t=>{for(let n=0;n<t.length;n++)e.temporaryAdPods.push(t[n]);if(null!==e.vastOptions&&"linear"===e.vastOptions.adType.toLowerCase())return;const n=e.getNextAdPod();null!==n&&e.renderLinearAd(n,!0)},e.backupMainVideoContentTime=t=>{switch(e.rollsById[t].roll){case"midRoll":e.domRef.player.mainVideoCurrentTime=e.domRef.player.currentTime-1;break;case"postRoll":e.domRef.player.mainVideoCurrentTime=e.mainVideoDuration,e.autoplayAfterAd=!1,e.domRef.player.currentTime=e.mainVideoDuration;break;case"preRoll":e.domRef.player.currentTime>0&&(e.domRef.player.mainVideoCurrentTime=e.domRef.player.currentTime-1)}},e.getSupportedMediaFileObject=t=>{let n=null,r=!1;if(t.length)for(let i=0;i<t.length;i++){if("VPAID"===t[i].apiFramework){n=t[i],r=!0;break}{const o=e.getMediaFileTypeSupportLevel(t[i].type);if("maybe"!==o&&"probably"!==o||(n=t[i],r=!0),"probably"===o)break;"no"!==o||"streaming"!==t[i].delivery||"application/vnd.apple.mpegurl"!==t[i].type&&"application/x-mpegURL"!==t[i].type||(n=t[i],n.isUnsuportedHls=!0,r=!0)}}return!1!==r&&n},e.getMediaFileTypeSupportLevel=e=>{if(null===e)return null;return document.createElement("video").canPlayType(e)||"no"},e.scheduleTrackingEvent=(t,n)=>{0===t&&e.trackSingleEvent("start"),void 0!==e.vastOptions.tracking.progress&&e.vastOptions.tracking.progress.length&&void 0!==e.vastOptions.tracking.progress[t]&&e.trackSingleEvent("progress",t),t===Math.floor(n/4)&&e.trackSingleEvent("firstQuartile"),t===Math.floor(n/2)&&e.trackSingleEvent("midpoint"),t===Math.floor(3*n/4)&&e.trackSingleEvent("thirdQuartile"),t>=n-1&&e.trackSingleEvent("complete")},e.trackSingleEvent=(t,n)=>{if(void 0===e.vastOptions||null===e.vastOptions)return;let r=[];switch(r.length=0,t){case"start":case"firstQuartile":case"midpoint":case"thirdQuartile":case"complete":!1===e.vastOptions.stopTracking[t]&&(null!==e.vastOptions.tracking[t]&&(r=e.vastOptions.tracking[t]),e.vastOptions.stopTracking[t]=!0);break;case"progress":e.vastOptions.tracking.progress[n].elements.forEach((function(t,i){!1===e.vastOptions.tracking.progress[n].stopTracking&&e.vastOptions.tracking.progress[n].elements.length&&(r=e.vastOptions.tracking.progress[n].elements),e.vastOptions.tracking.progress[n].stopTracking=!0}));break;case"impression":void 0!==e.vastOptions.impression&&null!==e.vastOptions.impression&&void 0!==e.vastOptions.impression.length&&(r=e.vastOptions.impression)}e.callUris(r)},e.completeNonLinearStatic=t=>{e.closeNonLinear(t.id),!1===e.adFinished&&(e.adFinished=!0,e.trackSingleEvent("complete")),clearInterval(e.nonLinearTracking)},e.createNonLinearStatic=t=>{if(e.vastOptions=t,e.createBoard(t),!0===e.rollsById[t.rollListId].error||!0===t.error)return void e.announceLocalError(101);e.adFinished=!1;let n=!!e.rollsById[t.rollListId].nonLinearDuration&&e.rollsById[t.rollListId].nonLinearDuration;e.vastOptions.vpaid||(e.trackSingleEvent("start"),n=n||e.vastOptions.duration,e.nonLinearTracking=setInterval((function(){if(!0===e.adFinished)return;const t=Math.floor(e.domRef.player.currentTime);e.scheduleTrackingEvent(t,n),t>=n-1&&(e.adFinished=!0)}),400));const r=parseInt(e.getCurrentTime())+parseInt(n);e.scheduleTask({time:r,closeStaticAd:t,rollListId:t.rollListId})},e.createVpaidNonLinearBoard=t=>{e.loadVpaidNonlinearAssets=function(t){e.debugMessage("starting function switchPlayerToVpaidMode");const n=t.vAlign?t.vAlign:e.nonLinearVerticalAlign,i=t.vpaidNonLinearCloseButton?t.vpaidNonLinearCloseButton:e.vpaidNonLinearCloseButton,o=e.videoPlayerId+"_"+t.id+"_fluid_vpaid_iframe",a={};a.AdParameters=t.adParameters;const s=document.createElement("div");s.id="fluid_vpaidNonLinear_"+t.id,s.className="fluid_vpaidNonLinear_"+n,s.className+=" fluid_vpaidNonLinear_ad",s.setAttribute("adListId",t.id);let l=Math.min(468,e.domRef.player.offsetWidth),u=Math.min(60,Math.floor(e.domRef.player.offsetHeight/4));if(void 0!==t.size){const e=t.size.split("x");l=e[0],u=e[1]}else t.dimension.width&&t.dimension.height&&(l=t.dimension.width,u=t.dimension.height);if(s.style.width="100%",s.style.height=u+"px",i){const n=document.createElement("div");n.className="fluid_vpaidNonLinear_frame",n.style.width=l+"px",n.style.height=u+"px",s.appendChild(n);const r=document.createElement("div");r.id="close_button_"+e.videoPlayerId,r.className="close_button",r.innerHTML="",r.title=e.displayOptions.layoutControls.closeButtonCaption;const[i]=t.id.split("_");r.onclick=function(t){if(e.hardStopVpaidAd(""),void 0!==t.stopImmediatePropagation&&t.stopImmediatePropagation(),e.adFinished=!0,"onPauseRoll"===e.rollsById[i].roll&&e.onPauseRollAdPods[0]){const t=e.onPauseRollAdPods[0];e.createBoard(t),e.currentOnPauseRollAd=e.onPauseRollAdPods[0],delete e.onPauseRollAdPods[0]}return!1},n.appendChild(r)}const c=document.createElement("iframe");c.id=e.videoPlayerId+"non_linear_vapid_slot_iframe",c.className="fluid_vpaid_nonlinear_slot_iframe",c.setAttribute("width",l+"px"),c.setAttribute("height",u+"px"),c.setAttribute("sandbox","allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"),c.setAttribute("frameborder","0"),c.setAttribute("scrolling","no"),c.setAttribute("marginwidth","0"),c.setAttribute("marginheight","0"),s.appendChild(c),e.domRef.player.parentNode.insertBefore(s,o.nextSibling);const d=c.contentWindow.document.createElement("div");c.contentWindow.document.body.appendChild(d),e.vastOptions.slotIframe=c,e.vastOptions.slotFrame=void 0;const h={slot:d,videoSlot:e.domRef.player,videoSlotCanAutoPlay:!0};e.debugMessage(t);const p=e.vpaidAdUnit.handshakeVersion(r);if(1===e.compareVersion(r,p))return t.error=!0,e.playMainVideoWhenVpaidFails(403),!1;e.domRef.player.loop=!1,e.domRef.player.removeAttribute("controls"),e.vpaidCallbackListenersAttach();const f=e.fullscreenMode?"fullscreen":"normal";e.vpaidAdUnit.initAd(l,u,f,3e3,a,h),e.toggleLoader(!1),t.played=!0,e.adFinished=!1},e.loadVpaid(t,t.staticResource),e.debugMessage("create non linear vpaid")},e.createNonLinearBoard=t=>{t.played=!0;const n=document.createElement("div"),r=e.rollsById[t.rollListId].vAlign?e.rollsById[t.rollListId].vAlign:e.nonLinearVerticalAlign,i=new Image;i.src=t.staticResource,i.id="fluid_nonLinear_imgCreative_"+t.id+"_"+e.videoPlayerId,i.onerror=function(){e.rollsById[t.rollListId].error=!0,e.announceError(500)},i.onload=function(){const n=e.domRef.player.clientWidth;let r,o,a,s;void 0!==e.rollsById[t.rollListId].size?(r=e.rollsById[t.rollListId].size.split("x")[0],o=e.rollsById[t.rollListId].size.split("x")[1]):t.dimension.width&&t.dimension.height?(r=t.dimension.width,o=t.dimension.height):(r=i.width,o=i.height),r>n?(a=n-5,s=o*a/r):(a=r,s=o),"onPauseRoll"!==e.rollsById[t.rollListId].roll&&(document.getElementById("fluid_nonLinear_"+t.id).style.display="");const l=document.getElementById(i.id);l.width=a,l.height=s,e.trackSingleEvent("impression")},n.id="fluid_nonLinear_"+t.id,n.className="fluid_nonLinear_"+r,n.className+=" fluid_nonLinear_ad",n.innerHTML=i.outerHTML,n.style.display="none",n.onclick=function(){void 0!==t.clickthroughUrl&&window.open(t.clickthroughUrl),void 0!==t.clicktracking&&e.callUris([t.clicktracking])},void 0!==t.clickthroughUrl&&(n.style.cursor="pointer");const o=document.createElement("div");o.id="close_button_"+e.videoPlayerId,o.className="close_button",o.innerHTML="",o.title=e.displayOptions.layoutControls.closeButtonCaption;const a=t.rollListId;o.onclick=function(t){if(this.parentElement.remove(),void 0!==t.stopImmediatePropagation&&t.stopImmediatePropagation(),e.adFinished=!0,clearInterval(e.nonLinearTracking),"onPauseRoll"===e.rollsById[a].roll&&e.onPauseRollAdPods[0]){const t=e.onPauseRollAdPods[0];e.createBoard(t),e.currentOnPauseRollAd=e.onPauseRollAdPods[0],delete e.onPauseRollAdPods[0]}return!1},n.appendChild(o),e.domRef.player.parentNode.insertBefore(n,e.domRef.player.nextSibling)},e.createBoard=t=>{if(t.vpaid)e.hardStopVpaidAd(""),e.createVpaidNonLinearBoard(t);else{if(void 0===t.staticResource||-1===e.supportedStaticTypes.indexOf(t.creativeType))return t.error=!0,void(e.vastOptions&&void 0!==e.vastOptions.errorUrl?e.announceError(503):e.announceLocalError(503));e.createNonLinearBoard(t)}},e.closeNonLinear=e=>{const t=document.querySelector("#fluid_nonLinear_"+e+", #fluid_vpaidNonLinear_"+e);t&&t.remove()},e.rollGroupContainsLinear=t=>{let n=!1;for(let r=0;r<t.length;r++)if(e.rollsById[t[r].id].adType&&"linear"===e.rollsById[t[r].id].adType){n=!0;break}return n},e.rollGroupContainsNonlinear=t=>{let n=!1;for(let r=0;r<t.length;r++)if("nonlinear"===e.rollsById[t[r].id].adType.toLowerCase()){n=!0;break}return n},e.preRollFail=()=>{const t=e.preRollAdPodsLength;e.preRollVastResolved++,e.preRollVastResolved===t&&e.preRollAdsPlay()},e.preRollSuccess=()=>{const t=e.preRollAdPodsLength;e.preRollVastResolved++,e.preRollVastResolved===t&&e.preRollAdsPlay()},e.preRollAdsPlay=()=>{const t=e.preRollAdPods,n={linear:[],nonLinear:[]};e.firstPlayLaunched=!0;for(let r=0;r<t.length;r++)e.rollsById[t[r]].ads.forEach((t=>{!0!==t.played&&("linear"===t.adType&&n.linear.push(t),"nonLinear"===t.adType&&(n.nonLinear.push(t),e.scheduleTask({time:0,playRoll:"midRoll",rollListId:t.rollListId})))}));n.linear.length>0?(e.toggleLoader(!1),e.playRoll(n.linear)):e.playMainVideoWhenVastFails(900)},e.preRoll=t=>{const n=t.vastObj;e.domRef.player.removeEventListener(t.type,e.preRoll);const r=[];r[0]=t.type.replace("adId_",""),!0!==e.rollsById[r[0]].played&&(e.preRollAdPods.push(r[0]),e.preRollSuccess(n))},e.createAdMarker=(t,n)=>{const r=document.getElementById(e.videoPlayerId+"_ad_markers_holder"),i=document.createElement("div");i.id="ad_marker_"+e.videoPlayerId+"_"+t,i.className="fluid_controls_ad_marker",i.style.left=n/e.mainVideoDuration*100+"%",e.isCurrentlyPlayingAd&&(i.style.display="none"),r.appendChild(i)},e.hideAdMarker=t=>{const n=document.getElementById("ad_marker_"+e.videoPlayerId+"_"+t);n&&(n.style.display="none")},e.showAdMarkers=()=>{const t=document.getElementById(e.videoPlayerId+"_ad_markers_holder").getElementsByClassName("fluid_controls_ad_marker"),n="ad_marker_"+e.videoPlayerId+"_";for(let r=0;r<t.length;++r){const i=t[r],o=i.id.replace(n,"");!1===e.rollsById[o].played&&(i.style.display="")}},e.hideAdMarkers=()=>{const t=document.getElementById(e.videoPlayerId+"_ad_markers_holder").getElementsByClassName("fluid_controls_ad_marker");for(let e=0;e<t.length;++e)t[e].style.display="none"},e.midRoll=t=>{e.domRef.player.removeEventListener(t.type,e.midRoll);const n=t.type.replace("adId_","");if(!0===e.rollsById[n].played)return;let r=e.rollsById[n].timer;"string"==typeof r&&-1!==r.indexOf("%")&&(r=r.replace("%",""),r=Math.floor(e.mainVideoDuration/100*r)),e.displayOptions.vastOptions.showProgressbarMarkers&&"nonLinear"===e.rollsById[n].adType&&e.createAdMarker(n,r),e.scheduleTask({time:r,playRoll:"midRoll",rollListId:n})},e.postRoll=t=>{e.domRef.player.removeEventListener(t.type,e.postRoll);const n=t.type.replace("adId_","");e.scheduleTask({time:Math.floor(e.mainVideoDuration),playRoll:"postRoll",rollListId:n})},e.onPauseRoll=t=>{e.domRef.player.removeEventListener(t.type,e.onPauseRoll);const n=t.type.replace("adId_","");e.rollsById[n].ads.forEach((t=>{if("nonLinear"===t.adType){if(!0===e.rollsById[t.rollListId].error||!0===t.error)return void e.announceLocalError(101);if(document.getElementsByClassName("fluid_nonLinear_ad")[0])e.onPauseRollAdPods.push(n);else{e.createBoard(t),e.currentOnPauseRollAd=n;let r=document.getElementById("fluid_nonLinear_"+n);r&&(r.style.display="none")}}}))},e.hasValidOnPauseAd=()=>{const t=e.findRoll("onPauseRoll");return 0!==t.length&&e.rollsById[t[0]]&&!1===e.rollsById[t[0]].error&&e.rollsById[t[0]].ads.length&&!0!==e.rollsById[t[0]].ads[0].error},e.toggleOnPauseAd=()=>{if(e.toggleLoader(!1),e.hasValidOnPauseAd()&&!e.isCurrentlyPlayingAd){const t=e.findRoll("onPauseRoll"),n=e.rollsById[t].ads[0];e.vastOptions=n;const r=document.getElementById("fluid_nonLinear_"+n.id);r&&e.domRef.player.paused?setTimeout((function(){r.style.display="flex",n.played=!1,e.trackingOnPauseNonLinearAd(n,"start")}),500):r&&!e.domRef.player.paused&&(r.style.display="none",e.adFinished=!0,e.trackingOnPauseNonLinearAd(n,"complete"))}},e.trackingOnPauseNonLinearAd=(t,n)=>{!0!==e.rollsById[t.rollListId].error&&!0!==t.error?(e.vastOptions=t,e.trackSingleEvent(n)):e.announceLocalError(101)},e.getLinearAdsFromKeyTime=t=>{const n=[];for(let r=0;r<t.length;r++)!1===e.rollsById[t[r].adListId].played&&n.push(t[r].adListId);return n},e.adKeytimePlay=t=>{if(!e.timerPool[t]||e.isCurrentlyPlayingAd)return;const n=e.timerPool[t].closeStaticAd.length,r=e.timerPool[t].linear.length,i=e.timerPool[t].nonLinear.length,o=e.timerPool[t].loadVast.length;if([n,r,i,o].every((e=>0===e)))delete e.timerPool[t];else{if(n>0){for(let r=0;r<n;r++){const n=e.timerPool[t].closeStaticAd[r];!0===n.played&&e.completeNonLinearStatic(n)}e.timerPool[t].closeStaticAd=[]}if(r>0&&e.timerPool[t].linear.length>0)return e.playRoll(e.timerPool[t].linear),void(e.timerPool[t].linear=[]);if(i>0)for(let n=0;n<i;n++){const r=e.timerPool[t].nonLinear[n],i=r.rollListId;if(e.adPool[i],!1===r.played&&!e.displayOptions.layoutControls.showCardBoardView)return e.createNonLinearStatic(r),e.displayOptions.vastOptions.showProgressbarMarkers&&e.hideAdMarker(r),void e.timerPool[t].nonLinear.splice(n,1)}o>0&&(e.timerPool[t].loadVast.forEach((t=>{"postRoll"===t.roll&&t.voidPostRollTasks||("postRoll"===t.roll&&(t.voidPostRollTasks=!0),e.debugMessage(`Handling on-demand VAST load for roll ${t.id}`),e.processVastWithRetries(t))})),e.timerPool[t].loadVast=[])}},e.adTimer=()=>{e.isTimer||(e.isTimer=!e.isTimer,e.timer=setInterval((function(){const t=Math.floor(e.getCurrentTime());e.adKeytimePlay(t)}),800))},e.scheduleTask=t=>{t.time>e.mainVideoDuration||t.time<0||Number.isNaN(t.time)?console.warn("Scheduled task has invalid time",t.time,". Check your configuration."):(e.debugMessage("Scheduling task",t),e.timerPool.hasOwnProperty(t.time)||(e.timerPool[t.time]={linear:[],nonLinear:[],closeStaticAd:[],loadVast:[]}),t.rollListId&&e.rollsById[t.rollListId].ads.filter((({adType:e})=>0!==t.time||"linear"!==e)).forEach((n=>{t.hasOwnProperty("playRoll")&&"linear"===n.adType?e.timerPool[t.time].linear.push(n):t.hasOwnProperty("playRoll")&&"nonLinear"===n.adType?e.timerPool[t.time].nonLinear.push(n):t.hasOwnProperty("closeStaticAd")&&e.timerPool[t.time].closeStaticAd.push(n)})),t.loadVast&&e.timerPool[t.time].loadVast.push(t.roll))},e.scheduleOnDemandRolls=()=>{[...e.findRoll("midRoll")||[],...e.findRoll("postRoll")||[]].map((t=>e.rollsById[t])).filter((e=>!0!==e.vastLoaded&&!0!==e.error)).forEach((t=>{if("midRoll"===t.roll){"string"==typeof t.timer&&(t.timer=Math.floor(e.mainVideoDuration/100*t.timer.replace("%","")),e.debugMessage(`Replaced midRoll from percentage to timer value ${t.timer} seconds`));const n=t.timer-e.displayOptions.vastOptions.vastTimeout/1e3;n<=Number(e.getCurrentTime())?(e.debugMessage("Loading Mid Roll VAST immediately as it needs to be played soon"),e.processVastWithRetries(t)):e.scheduleTask({loadVast:!0,time:n,roll:t})}else{const n=parseInt(e.mainVideoDuration),r=e.displayOptions.vastOptions.vastTimeout/1e3;t.voidPostRollTasks=!1;for(let i=1;i<=r;i++)e.scheduleTask({loadVast:!0,time:n-i,roll:t})}}))},e.switchToMainVideo=()=>{e.debugMessage("starting main video"),e.domRef.player.src=e.originalSrc,e.initialiseStreamers();const t=void 0!==e.domRef.player.mainVideoCurrentTime?Math.floor(e.domRef.player.mainVideoCurrentTime):0;if(e.domRef.player.hasOwnProperty("currentTime")&&(e.domRef.player.currentTime=t),e.displayOptions.layoutControls.loop&&(e.domRef.player.loop=!0),e.setCurrentTimeAndPlay(t,e.autoplayAfterAd),e.isCurrentlyPlayingAd=!1,e.deleteVastAdElements(),e.adFinished=!0,e.displayOptions.vastOptions.vastAdvanced.vastVideoEndedCallback(),e.vastOptions=null,e.setBuffering(),null!==document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container")){const t=e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"white",n=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let e=0;e<n.length;e++)n[e].style.backgroundColor=t}e.domRef.player.removeEventListener("ended",e.onVastAdEnded),e.displayOptions.vastOptions.showProgressbarMarkers&&e.showAdMarkers(),e.hasTitle()&&(document.getElementById(e.videoPlayerId+"_title").style.display="inline")},e.getNextAdPod=()=>e.temporaryAdPods.length>0?e.temporaryAdPods.shift():null,e.checkForNextAd=()=>{const t=e.getNextAdPod();null===t?(e.switchToMainVideo(),e.vastOptions=null,e.adFinished=!0):(e.domRef.player.removeEventListener("ended",e.onVastAdEnded),e.isCurrentlyPlayingAd=!1,e.vastOptions=null,e.adFinished=!0,e.renderLinearAd(t,!1))},e.addSkipButton=()=>{const t=document.createElement("div");t.id="skip_button_"+e.videoPlayerId,t.className="skip_button skip_button_disabled",e.vastOptions.skipoffset>0&&(t.innerHTML=e.displayOptions.vastOptions.skipButtonCaption.replace("[seconds]",e.vastOptions.skipoffset)),document.getElementById("fluid_video_wrapper_"+e.videoPlayerId).appendChild(t),0===e.vastOptions.skipoffset&&e.decreaseSkipOffset(),e.domRef.player.addEventListener("timeupdate",e.decreaseSkipOffset,!1)},e.addAdCountdown=()=>{if(e.isCurrentlyPlayingAd&&e.hlsPlayer||e.currentVideoDuration===1/0)return;const t=document.getElementById("fluid_video_wrapper_"+e.videoPlayerId),n=document.createElement("div"),r=e.pad(parseInt(e.currentVideoDuration/60))+":"+e.pad(parseInt(e.currentVideoDuration%60)),i=parseInt(r);n.id="ad_countdown"+e.videoPlayerId,n.className="ad_countdown",n.innerHTML="<span class='ad_timer_prefix'>Ad - </span>"+i,t.appendChild(n),e.domRef.player.addEventListener("timeupdate",e.decreaseAdCountdown,!1),t.addEventListener("mouseover",(function(){n.style.display="none"}),!1)},e.decreaseAdCountdown=function(){const t=parseInt(e.currentVideoDuration)-parseInt(e.domRef.player.currentTime),n=document.getElementById("ad_countdown"+e.videoPlayerId);n&&isNaN(t)?n.parentNode.removeChild(n):n?n.innerHTML="<span class='ad_timer_prefix'>Ad - </span> "+e.pad(parseInt(t/60))+":"+e.pad(parseInt(t%60)):e.domRef.player.removeEventListener("timeupdate",e.decreaseAdCountdown)},e.removeAdCountdown=()=>{const t=document.getElementById("ad_countdown"+e.videoPlayerId);t&&t.parentElement.removeChild(t)},e.toggleAdCountdown=t=>{const n=document.getElementById("ad_countdown"+e.videoPlayerId);n&&(n.style.display=t?"inline-block":"none")},e.addAdPlayingText=t=>{const n=document.createElement("div");n.id=e.videoPlayerId+"_fluid_ad_playing",e.displayOptions.layoutControls.primaryColor&&(n.style.backgroundColor=e.displayOptions.layoutControls.primaryColor,n.style.opacity=1),n.className="fluid_ad_playing",n.innerText=t,document.getElementById("fluid_video_wrapper_"+e.videoPlayerId).appendChild(n)},e.positionTextElements=t=>{const n=["top left","top right","bottom left","bottom right"],r=document.getElementById("skip_button_"+e.videoPlayerId),i=document.getElementById(e.videoPlayerId+"_fluid_ad_playing"),o=document.getElementById(e.videoPlayerId+"_fluid_cta");let a=0,s=0,l=!1,u=0,c=[];const d={top:{left:{h:34,v:34},right:{h:0,v:34}},bottom:{left:{h:34,v:50},right:{h:0,v:50}}};let h,p,f;null!==r&&(u=r.offsetHeight+8,e.domRef.wrapper.classList.contains("mobile")&&(d.top={left:{h:0,v:8},right:{h:0,v:8}},d.bottom={left:{h:0,v:50},right:{h:0,v:50}})),null!==o&&(h=e.rollsById[t.rollListId].adCTATextPosition?e.rollsById[t.rollListId].adCTATextPosition.toLowerCase():e.displayOptions.vastOptions.adCTATextPosition,-1===n.indexOf(h)&&(console.log('[FP Error] Invalid position for CTAText. Reverting to "bottom right"'),h="bottom right"),o.classList.add.apply(o.classList,h.split(" ")),c=h.split(" "),l="bottom"===c[0],o.style[c[0]]=d[c[0]][c[1]].v+"px",o.style[c[1]]=d[c[0]][c[1]].h+"px",l&&"right"===c[1]&&(o.style[c[0]]=d[c[0]][c[1]].v+u+"px"),a=o.offsetHeight+8+"px"),null!==i&&(p=e.rollsById[t.rollListId].adTextPosition?e.rollsById[t.rollListId].adTextPosition.toLowerCase():e.displayOptions.vastOptions.adTextPosition,-1===n.indexOf(p)&&(console.log('[FP Error] Invalid position for adText. Reverting to "top left"'),p="top left"),f=p.split(" "),i.style[f[0]]=d[f[0]][f[1]].v+"px",i.style[f[1]]=d[f[0]][f[1]].h+"px",s=i.offsetHeight+8+"px"),a>0&&s>0&&h===p&&(l?"right"===c[1]?i.style.bottom=d[f[0]][f[1]].v+u+a+"px":i.style.bottom=d[f[0]][f[1]].v+a+"px":o.style.top=d[c[0]][c[1]].v+s+"px")},e.removeAdPlayingText=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_ad_playing");t&&t.parentElement.removeChild(t)},e.addCTAButton=t=>{if(e.vastOptions.titleCTA){const{text:t,link:n,tracking:r}=e.vastOptions.titleCTA;return e.createAndAppendCTAButton(t,n,r)}if(t&&"string"==typeof e.displayOptions.vastOptions.adCTAText)return e.createAndAppendCTAButton(e.displayOptions.vastOptions.adCTAText,t,e.vastOptions.clickthroughUrl)},e.createAndAppendCTAButton=(t,n,r)=>{const i=document.createElement("div");i.id=e.videoPlayerId+"_fluid_cta",i.className="fluid_ad_cta";const o=document.createElement("span");let a=t;n&&(a+='<br/><span class="add_icon_clickthrough">'+n+"</span>"),o.innerHTML=a,i.addEventListener("click",(()=>(e.domRef.player.paused||e.domRef.player.pause(),window.open(r,"_blank").focus(),!0)),!1),i.appendChild(o),document.getElementById("fluid_video_wrapper_"+e.videoPlayerId).appendChild(i)},e.removeCTAButton=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_cta");t&&t.parentElement.removeChild(t)},e.decreaseSkipOffset=()=>{let t=e.vastOptions.skipoffset-Math.floor(e.domRef.player.currentTime);const n=document.getElementById("skip_button_"+e.videoPlayerId);if(!n)return void e.domRef.player.removeEventListener("timeupdate",e.decreaseSkipOffset);if(t>=1)return void(n.innerHTML=e.displayOptions.vastOptions.skipButtonCaption.replace("[seconds]",t));const r=document.createElement("a");r.href="#",r.id="skipHref_"+e.videoPlayerId,r.innerHTML=e.displayOptions.vastOptions.skipButtonClickCaption,r.onclick=t=>{t.preventDefault(),t.stopPropagation(),e.pressSkipButton()},n.innerHTML="",n.appendChild(r),n.className=n.className.replace(/\bskip_button_disabled\b/,""),e.domRef.player.removeEventListener("timeupdate",e.decreaseSkipOffset)},e.pressSkipButton=()=>{if(e.removeSkipButton(),e.removeAdPlayingText(),e.removeCTAButton(),e.vastOptions.vpaid)return void e.skipVpaidAd();e.displayOptions.vastOptions.vastAdvanced.vastVideoSkippedCallback();const t=document.createEvent("Event");t.initEvent("ended",!1,!0),e.domRef.player.dispatchEvent(t)},e.removeSkipButton=()=>{const t=document.getElementById("skip_button_"+e.videoPlayerId);t&&t.parentElement.removeChild(t)},e.addClickthroughLayer=()=>{const t=e.domRef.wrapper,n=document.createElement("div");n.className="vast_clickthrough_layer",n.id="vast_clickthrough_layer_"+e.videoPlayerId,n.setAttribute("style","position: absolute; cursor: pointer; top: 0; left: 0; width: "+e.domRef.player.offsetWidth+"px; height: "+e.domRef.player.offsetHeight+"px;"),t.appendChild(n);const r=function(){window.open(e.vastOptions.clickthroughUrl),void 0!==e.vastOptions.clicktracking&&e.callUris(e.vastOptions.clicktracking)},i=document.getElementById("vast_clickthrough_layer_"+e.videoPlayerId),o="iPhone"===e.mobileInfo.device&&!1!==e.mobileInfo.userOsMajor&&e.mobileInfo.userOsMajor<=9;i.onclick=()=>{e.domRef.player.paused?o&&!e.suppressClickthrough?(r(),e.suppressClickthrough=!0):e.domRef.player.play():(r(),e.domRef.player.pause())}},e.removeClickthrough=()=>{const t=document.getElementById("vast_clickthrough_layer_"+e.videoPlayerId);t&&t.parentNode.removeChild(t)}},function(e,t){e.initialiseStreamers=()=>{switch(e.detachStreamers(),e.displayOptions.layoutControls.mediaType){case"application/dash+xml":e.dashScriptLoaded||window.dashjs&&!window.dashjs.isDefaultSubject?e.initialiseDash():(e.dashScriptLoaded=!0,n.e(216).then(n.t.bind(n,5176,23)).then((t=>{window.dashjs=t.default,e.initialiseDash()})));break;case"application/x-mpegurl":if(e.domRef.player.canPlayType("application/x-mpegurl")){e.debugMessage("Native HLS support found, skipping hls.js");break}e.hlsScriptLoaded||window.Hls?e.initialiseHls():(e.hlsScriptLoaded=!0,n.e(216).then(n.bind(n,3041)).then((t=>{window.Hls=t.default,e.initialiseHls()})))}},e.initialiseDash=()=>{if("function"==typeof(window.MediaSource||window.WebKitMediaSource)){const t=e.autoplayAfterAd?e.displayOptions.layoutControls.autoPlay:e.autoplayAfterAd,n={debug:{logLevel:"undefined"!=typeof FP_DEBUG&&!0===FP_DEBUG?dashjs.Debug.LOG_LEVEL_DEBUG:dashjs.Debug.LOG_LEVEL_FATAL}},r=dashjs.MediaPlayer().create(),i=e.displayOptions.modules.configureDash(n);r.updateSettings(i),e.displayOptions.modules.onBeforeInitDash(r),r.initialize(e.domRef.player,e.originalSrc,t),r.on("streamInitializing",(()=>{e.toggleLoader(!0)})),r.on("canPlay",(()=>{e.toggleLoader(!1)})),r.on("playbackPlaying",(()=>{e.toggleLoader(!1)})),e.displayOptions.modules.onAfterInitDash(r),e.dashPlayer=r}else e.nextSource(),console.log("[FP_WARNING] Media type not supported by this browser using DASH.js. (application/dash+xml)")},e.initialiseHls=()=>{if(Hls.isSupported()){const t={debug:"undefined"!=typeof FP_DEBUG&&!0===FP_DEBUG,p2pConfig:{logLevel:!1},enableWebVTT:!1,enableCEA708Captions:!1},n=e.displayOptions.modules.configureHls(t),r=new Hls(n);e.displayOptions.modules.onBeforeInitHls(r),r.attachMedia(e.domRef.player),r.loadSource(e.originalSrc),e.displayOptions.modules.onAfterInitHls(r),e.hlsPlayer=r,!e.firstPlayLaunched&&e.displayOptions.layoutControls.autoPlay&&e.domRef.player.play()}else e.nextSource(),console.log("[FP_WARNING] Media type not supported by this browser using HLS.js. (application/x-mpegURL)")},e.detachStreamers=()=>{e.dashPlayer?(e.dashPlayer.reset(),e.dashPlayer=!1):e.hlsPlayer&&(e.hlsPlayer.detachMedia(),e.hlsPlayer=!1)}},function(e,t){e.isTouchDevice=()=>!(!("ontouchstart"in window)&&!navigator.maxTouchPoints),e.getMobileOs=()=>{const e=navigator.userAgent||"",t={device:!1,userOs:!1,userOsVer:!1,userOsMajor:!1};let n;if(e.match(/Android/i)?(t.userOs="Android",n=e.indexOf("Android ")):e.match(/iPhone/i)?(t.device="iPhone",t.userOs="iOS",n=e.indexOf("OS ")):e.match(/iPad/i)?(t.device="iPad",t.userOs="iOS",n=e.indexOf("OS ")):t.userOs=!1,"iOS"===t.userOs&&n>-1){const r=e.substr(n+3);-1!==r.indexOf(" ")&&(t.userOsVer=r.substring(0,r.indexOf(" ")).replace(/_/g,"."),t.userOsMajor=parseInt(t.userOsVer))}else"Android"===t.userOs&&n>-1?t.userOsVer=e.substr(n+8,3):t.userOsVer=!1;return t},e.getBrowserVersion=()=>{const e=navigator.userAgent||"",t={browserName:!1,fullVersion:!1,majorVersion:!1,userOsMajor:!1};let n,r;try{t.browserName=navigator.appName,-1!==(n=e.indexOf("OPR/"))?(t.browserName="Opera",t.fullVersion=e.substring(n+4)):-1!==(n=e.indexOf("Opera"))?(t.browserName="Opera",t.fullVersion=e.substring(n+6),-1!==(n=e.indexOf("Version"))&&(t.fullVersion=e.substring(n+8))):-1!==(n=e.indexOf("MSIE"))?(t.browserName="Microsoft Internet Explorer",t.fullVersion=e.substring(n+5)):-1!==(n=e.indexOf("Chrome"))?(t.browserName="Google Chrome",t.fullVersion=e.substring(n+7)):-1!==(n=e.indexOf("Safari"))?(t.browserName="Safari",t.fullVersion=e.substring(n+7),-1!==(n=e.indexOf("Version"))&&(t.fullVersion=e.substring(n+8))):-1!==(n=e.indexOf("Firefox"))?(t.browserName="Mozilla Firefox",t.fullVersion=e.substring(n+8)):(r=e.lastIndexOf(" ")+1)<(n=e.lastIndexOf("/"))&&(t.browserName=e.substring(r,n),t.fullVersion=e.substring(n+1),t.browserName.toLowerCase()===t.browserName.toUpperCase()&&(t.browserName=navigator.appName)),-1!==(r=t.fullVersion.indexOf(";"))&&(t.fullVersion=t.fullVersion.substring(0,r)),-1!==(r=t.fullVersion.indexOf(" "))&&(t.fullVersion=t.fullVersion.substring(0,r)),t.majorVersion=parseInt(""+t.fullVersion,10),isNaN(t.majorVersion)&&(t.fullVersion=""+parseFloat(navigator.appVersion),t.majorVersion=parseInt(navigator.appVersion,10))}catch(e){}return t},e.compareVersion=(e,t)=>{if("string"!=typeof e)return!1;if("string"!=typeof t)return!1;e=e.split("."),t=t.split(".");const n=Math.min(e.length,t.length);for(let r=0;r<n;++r){if(e[r]=parseInt(e[r],10),t[r]=parseInt(t[r],10),e[r]>t[r])return 1;if(e[r]<t[r])return-1}return e.length===t.length?0:e.length<t.length?-1:1},e.convertTimeStringToSeconds=e=>{if(!e||!e.match(/^(\d){2}(:[0-5][0-9]){2}(.(\d){1,3})?$/))return!1;const t=e.split(":");return 3600*parseInt(t[0],10)+60*parseInt(t[1],10)+parseInt(t[2],10)},e.formatTime=t=>{const n=new Date(1e3*t),r=e.pad(n.getUTCHours()),i=e.pad(n.getUTCMinutes()),o=e.pad(n.getSeconds());return r>=1?r+":"+i+":"+o:i+":"+o},e.pad=e=>e<10?"0"+e:e,e.isElementVisible=e=>{if(!e)return null;const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},e.throttle=function(e,t){let n=!1;return function(){n||(e.apply(this,arguments),n=!0,setTimeout((function(){n=!1}),t))}}},function(e){const t="fluid_mini_player_mode",n="mini-player-close-button",r="fluidplayer-miniplayer-player-placeholder",i=".vast_clickthrough_layer",o=".fluid_nonLinear_ad img, .fluid_vpaid_nonlinear_slot_iframe",a=".fluid_vpaidNonLinear_frame",s="miniPlayerToggle";let l=null,u=null,c=null,d=null,h=!1,p=null,f=!1,m=!1;function g(i,o=!1){e.debugMessage(`[MiniPlayer] Toggling MiniPlayer, forceToggle: ${i}`);const a=e.displayOptions.layoutControls.miniPlayer;a.enabled?"on"===i&&e.miniPlayerToggledOn||"off"===i&&!e.miniPlayerToggledOn?e.debugMessage("[MiniPlayer] Can't force toggle Mini Player to it's same state"):(o&&E(),window.matchMedia("(max-width: 768px)").matches&&(f=!0),e.resetDisplayMode("miniPlayer"),h||function(){if(!Boolean(e.domRef.player.parentNode.querySelector(`.${n}`))){const t=document.createElement("div");t.classList.add("mini-player-close-button-wrapper");const r=document.createElement("span");r.classList.add(n),r.addEventListener("click",(()=>{g("off",!0),e.domRef.player.paused||e.playPauseToggle()})),t.appendChild(r),e.domRef.player.parentNode.append(t)}f&&function(){const t=document.createElement("div");let n,r=0,i=0,o=0;t.classList.add("disable-mini-player-mobile"),t.ontouchstart=e=>{n=!1,i=e.timeStamp,o=e.changedTouches[0].screenX,e.preventDefault()},t.ontouchmove=t=>{r=Math.min(Math.max(o-t.changedTouches[0].screenX,-50),50),Math.abs(r)>5?(e.domRef.wrapper.style.transform=`translateX(${-1*r}px)`,n=!0):e.domRef.wrapper.style.transform="translateX(0px)"},t.ontouchend=t=>{Math.abs(r)>5?(g("off",!0),e.domRef.player.paused||e.playPauseToggle(),t.preventDefault()):n||(g("off",!0),setTimeout((()=>{e.domRef.wrapper.scrollIntoView({behavior:"smooth",block:"center"})}))),r=0,e.domRef.wrapper.style.transform=""},t.onmouseup=()=>g("off",!0),e.domRef.wrapper.insertBefore(t,e.domRef.player.nextSibling)}(),h=!0}(),"off"===i||e.miniPlayerToggledOn?function(){const n=e.domRef.wrapper;e.domRef.wrapper.parentElement.removeChild(p),p=null,n.classList.remove(t),n.style.width=`${l}px`,n.style.height=`${u}px`,l=null,u=null,b(),_(),e.miniPlayerToggledOn=!1,y()}():"on"!==i&&e.miniPlayerToggledOn||function(n,i,o,a){const s=e.domRef.wrapper,c=n>400?n:400,d=i>225?i:225,h=o>40?o:40;var m,E;l=v(s,"width","clientWidth"),u=v(s,"height","clientHeight"),s.classList.add(t,`${t}--${a.trim().replace(/\s/,"-")}`),f?(s.style.width=`${h}vw`,s.style.height="auto",s.style.aspectRatio="16 / 9"):(s.style.width=`${c}px`,s.style.height=`${d}px`),m=l,E=u,p=document.createElement("div"),p.classList.add(r),p.style.height=`${E}px`,p.style.width=`${m}px`,p.innerText=e.displayOptions.layoutControls.miniPlayer.placeholderText||"",p.onclick=()=>g("off",!0),e.domRef.wrapper.parentElement.insertBefore(p,e.domRef.wrapper),b(c,d,h),_(),e.miniPlayerToggledOn=!0,y()}(a.width,a.height,a.widthMobile,a.position)):e.debugMessage("[MiniPlayer] Prevent toggle MiniPlayer, it's currently disabled")}function y(){e.domRef.player.dispatchEvent(new CustomEvent(s,{detail:{isToggledOn:e.miniPlayerToggledOn}}))}function v(e,t,n){return t&&e.style[t]&&e.style[t].match("px")?parseInt(e.style[t]):String(e[n]).match("px")?parseInt(e[n]):e[n]}function b(t,n,r){const i=e.domRef.wrapper.querySelector(o),s=e.domRef.wrapper.querySelector(a);if(!i)return;f&&(t=window.innerWidth*r/100);const l=v(i,null,"width"),u=v(i,null,"height");if(c&&d)i.width=c,i.height=d,s&&(s.style.width=`${c}px`,s.style.height=`${d}px`),c=d=null;else if(l>t||u>n){const e=(t-(f?4:32))/l;c=l,d=u,i.width=Math.round(l*e),i.height=Math.round(u*e),s&&(s.style.width=`${Math.round(l*e)}px`,s.style.height=`${Math.round(u*e)}px`)}}function _(){const t=e.domRef.wrapper.querySelector(i);t&&(t.style.width=`${e.domRef.player.offsetWidth}px`,t.style.height=`${e.domRef.player.offsetHeight}px`)}function E(){const t=e.displayOptions.layoutControls.miniPlayer.autoToggle;!m&&t?(m=!0,document.addEventListener("scroll",w)):document.removeEventListener("scroll",w)}const w=e.throttle((function(){if(e.domRef.player.paused)return;const t=e.isElementVisible(e.domRef.player),n=e.isElementVisible(document.querySelector(`.${r}`));t||e.miniPlayerToggledOn?n&&e.miniPlayerToggledOn&&g("off"):g("on")}),1e3/60);e.toggleMiniPlayer=g,e.toggleMiniPlayerScreenDetection=E}],a="undefined"!=typeof FP_ENV&&"development"===FP_ENV,s="undefined"!=typeof FP_DEBUG&&!0===FP_DEBUG;let l=0;const u=function(){const e=this;e.domRef={player:null},e.version="undefined"!=typeof FP_BUILD_VERSION?FP_BUILD_VERSION:"",e.homepage="undefined"!=typeof FP_HOMEPAGE?FP_HOMEPAGE+"/?utm_source=player&utm_medium=context_menu&utm_campaign=organic":"",e.destructors=[],e.init=(t,n)=>{const r={development:a,debug:s};for(const t of o)t(e,r);let i;if(t instanceof HTMLVideoElement)i=t,t.id||(t.id="fluid_player_instance_"+(l++).toString());else{if(!("string"==typeof t||t instanceof String))throw"Invalid initializer - player target must be HTMLVideoElement or ID";i=document.getElementById(t)}if(!i)throw"Could not find a HTML node to attach to for target "+t+'"';i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),e.domRef.player=i,e.vrROTATION_POSITION=.1,e.vrROTATION_SPEED=80,e.vrMode=!1,e.vrPanorama=null,e.vrViewer=null,e.vpaidTimer=null,e.vpaidAdUnit=null,e.vastOptions=null,e.videoPlayerId=i.id,e.originalSrc=e.getCurrentSrc(),e.isCurrentlyPlayingAd=!1,e.recentWaiting=!1,e.latestVolume=1,e.currentVideoDuration=0,e.firstPlayLaunched=!1,e.suppressClickthrough=!1,e.timelinePreviewData=[],e.mainVideoCurrentTime=0,e.mainVideoDuration=0,e.isTimer=!1,e.timer=null,e.timerPool={},e.rollsById={},e.adPool={},e.adGroupedByRolls={},e.onPauseRollAdPods=[],e.currentOnPauseRollAd="",e.preRollAdsResolved=!1,e.preRollAdPods=[],e.preRollAdPodsLength=0,e.preRollVastResolved=0,e.temporaryAdPods=[],e.availableRolls=["preRoll","midRoll","postRoll","onPauseRoll"],e.supportedNonLinearAd=["300x250","468x60","728x90"],e.autoplayAfterAd=!0,e.nonLinearDuration=15,e.supportedStaticTypes=["image/gif","image/jpeg","image/png"],e.inactivityTimeout=null,e.isUserActive=null,e.nonLinearVerticalAlign="bottom",e.vpaidNonLinearCloseButton=!0,e.showTimeOnHover=!0,e.initialAnimationSet=!0,e.theatreMode=!1,e.theatreModeAdvanced=!1,e.fullscreenMode=!1,e.originalWidth=i.offsetWidth,e.originalHeight=i.offsetHeight,e.dashPlayer=!1,e.hlsPlayer=!1,e.dashScriptLoaded=!1,e.hlsScriptLoaded=!1,e.isPlayingMedia=!1,e.isSwitchingSource=!1,e.isLoading=!1,e.isInIframe=e.inIframe(),e.mainVideoReadyState=!1,e.xmlCollection=[],e.inLineFound=null,e.fluidStorage={},e.fluidPseudoPause=!1,e.mobileInfo=e.getMobileOs(),e.events={},e.timeSkipOffsetAmount=10,e.displayOptions={layoutControls:{mediaType:e.getCurrentSrcType(),primaryColor:!1,posterImage:!1,posterImageSize:"contain",adProgressColor:"#f9d300",playButtonShowing:!0,playPauseAnimation:!0,closeButtonCaption:"Close",fillToContainer:!1,autoPlay:!1,preload:"auto",mute:!1,loop:null,keyboardControl:!0,allowDownload:!1,playbackRateEnabled:!1,subtitlesEnabled:!1,subtitlesOnByDefault:!0,showCardBoardView:!1,showCardBoardJoystick:!1,allowTheatre:!0,doubleclickFullscreen:!0,theatreSettings:{width:"100%",height:"60%",marginTop:0,horizontalAlign:"center",keepPosition:!1},theatreAdvanced:!1,title:null,logo:{imageUrl:null,position:"top left",clickUrl:null,opacity:1,mouseOverImageUrl:null,imageMargin:"2px",hideWithControls:!1,showOverAds:!1},controlBar:{autoHide:!1,autoHideTimeout:3,animated:!0,playbackRates:["x2","x1.5","x1","x0.5"]},timelinePreview:{spriteImage:!1,spriteRelativePath:!1},htmlOnPauseBlock:{html:null,height:null,width:null},layout:"default",playerInitCallback:function(){},persistentSettings:{volume:!0,quality:!0,speed:!0,theatre:!0},controlForwardBackward:{show:!1,doubleTapMobile:!0},contextMenu:{controls:!0,links:[]},miniPlayer:{enabled:!0,width:400,height:225,widthMobile:50,placeholderText:"Playing in Miniplayer",position:"bottom right",autoToggle:!1}},vastOptions:{adList:{},skipButtonCaption:"Skip ad in [seconds]",skipButtonClickCaption:'Skip Ad <span class="skip_button_icon"></span>',adText:null,adTextPosition:"top left",adCTAText:"Visit now!",adCTATextPosition:"bottom right",adCTATextVast:!1,adClickable:!0,vastTimeout:5e3,showProgressbarMarkers:!1,allowVPAID:!1,showPlayButton:!1,maxAllowedVastTagRedirects:3,vpaidTimeout:3e3,vastAdvanced:{vastLoadedCallback:function(){},noVastVideoCallback:function(){},vastVideoSkippedCallback:function(){},vastVideoEndedCallback:function(){}}},captions:{play:"Play",pause:"Pause",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",subtitles:"Subtitles",exitFullscreen:"Exit Fullscreen"},debug:s,modules:{configureHls:e=>e,onBeforeInitHls:e=>{},onAfterInitHls:e=>{},configureDash:e=>e,onBeforeInitDash:e=>{},onAfterInitDash:e=>{}},onBeforeXMLHttpRequestOpen:e=>{},onBeforeXMLHttpRequest:e=>{(s||a)&&console.debug("[FP_DEBUG] Request made",e)}},n.hlsjsConfig&&console.error("[FP_ERROR] player option hlsjsConfig is removed and has no effect. Use module callbacks instead!"),function e(t,n){return Object.keys(n).forEach((r=>{"object"!=typeof n[r]||null===n[r]||Array.isArray(n[r])?void 0!==n[r]&&(t[r]=n[r]):e(t[r],n[r])})),t}(e.displayOptions,n),e.domRef.wrapper=e.setupPlayerWrapper(),i.addEventListener("webkitfullscreenchange",e.recalculateAdDimensions),i.addEventListener("fullscreenchange",e.recalculateAdDimensions),i.addEventListener("waiting",e.onRecentWaiting),i.addEventListener("pause",e.onFluidPlayerPause),i.addEventListener("error",e.onErrorDetection),i.addEventListener("ended",e.onMainVideoEnded),i.addEventListener("durationchange",(()=>{e.currentVideoDuration=e.getCurrentVideoDuration()})),i.readyState>0?e.mainVideoReady():i.addEventListener("loadedmetadata",e.mainVideoReady),e.displayOptions.layoutControls.showCardBoardView&&i.setAttribute("crossOrigin","anonymous"),e.currentVideoDuration=e.getCurrentVideoDuration(),!isNaN(e.currentVideoDuration)&&isFinite(e.currentVideoDuration)||(e.currentVideoDuration=0),e.setLayout(),e.latestVolume=i.volume,e.initialAnimationSet=e.displayOptions.layoutControls.playPauseAnimation,e.handleFullscreen(),e.initLogo(),e.initTitle(),e.initMute(),e.initLoop(),e.displayOptions.layoutControls.playerInitCallback(),e.createVideoSourceSwitch(),e.createSubtitles(),e.createCardboard(),e.userActivityChecker(),e.setVastList(),e.setPersistentSettings();const u=e.findRoll("preRoll");u&&0!==u.length||e.initialiseStreamers();const c=i.play;i.play=function(){let t=null;e.displayOptions.layoutControls.showCardBoardView&&"undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission&&DeviceOrientationEvent.requestPermission().then((function(t){"granted"===t&&e.debugMessage("DeviceOrientationEvent permission granted!")})).catch(console.error);try{return t=c.apply(this,arguments),null!=t&&(t.then((()=>{e.isPlayingMedia=!0,clearTimeout(e.promiseTimeout)})).catch((t=>{console.error("[FP_ERROR] Playback error",t),void 0!==t.name&&"AbortError"===t.name||e.announceLocalError(202,"Failed to play video."),clearTimeout(e.promiseTimeout)})),e.promiseTimeout=setTimeout((function(){!1===e.isPlayingMedia&&e.announceLocalError(204,"[FP_ERROR] Timeout error. Failed to play video?")}),5e3)),t}catch(t){console.error("[FP_ERROR] Playback error",t),e.announceLocalError(201,"Failed to play video.")}};const d=i.pause;if(i.pause=function(){if(!0===e.isPlayingMedia)return e.isPlayingMedia=!1,d.apply(this,arguments);if(e.isCurrentlyPlayingVideo(e.domRef.player))try{return e.isPlayingMedia=!1,d.apply(this,arguments)}catch(t){e.announceLocalError(203,"Failed to play video.")}},e.displayOptions.layoutControls.autoPlay&&!e.dashScriptLoaded&&!e.hlsScriptLoaded){if("Safari"===e.getBrowserVersion().browserName)return;i.play()}const h=document.getElementById("fluid_video_wrapper_"+i.id);e.mobileInfo.userOs?(e.hideControlBar(),h.addEventListener("touchstart",e.showControlBar,!1)):(e.displayOptions.layoutControls.controlBar.autoHide||h.addEventListener("mouseleave",e.handleMouseleave,!1),h.addEventListener("mouseenter",e.showControlBar,!1),h.addEventListener("mouseenter",e.showTitle,!1)),e.displayOptions.layoutControls.keyboardControl&&e.keyboardControl(),e.displayOptions.layoutControls.controlBar.autoHide&&e.linkControlBarUserActivity();try{if(e.domRef.player.textTracks)for(const t of e.domRef.player.textTracks)t.mode="hidden"}catch(e){}},e.getCurrentVideoDuration=()=>e.domRef.player?e.domRef.player.duration:0,e.toggleLoader=t=>{e.isLoading=!!t,document.getElementById("vast_video_loading_"+e.videoPlayerId).style.display=t?"table":"none"},e.sendRequest=(t,n,r,i)=>{const o=new XMLHttpRequest;o.onreadystatechange=i,e.displayOptions.onBeforeXMLHttpRequestOpen(o),o.open("GET",t,!0),o.withCredentials=n,o.timeout=r,e.displayOptions.onBeforeXMLHttpRequest(o),o.send()},e.sendRequestAsync=async(t,n,r)=>await new Promise(((i,o)=>{const a=new XMLHttpRequest;a.onreadystatechange=e=>{const t=e.target;4===t.readyState&&t.status>=200&&t.status<300?i(t):4===t.readyState&&o(t)},e.displayOptions.onBeforeXMLHttpRequestOpen(a),a.open("GET",t,!0),a.withCredentials=n,a.timeout=r,e.displayOptions.onBeforeXMLHttpRequest(a),a.send()})),e.announceLocalError=(e,t)=>{let n="[Error] ("+(void 0!==e?parseInt(e):900)+"): ";n+=t||"Failed to load Vast",console.warn(n)},e.debugMessage=(...t)=>{e.displayOptions.debug&&console.log("%cFP DEBUG","color: #fff; font-weight: bold; background-color: #1a5e87; padding: 3px 6px; border-radius: 3px;",...t)},e.onMainVideoEnded=t=>{e.debugMessage("onMainVideoEnded is called"),e.isCurrentlyPlayingAd&&e.autoplayAfterAd||(Math.floor(e.getCurrentTime())>=Math.floor(e.mainVideoDuration)&&(e.adKeytimePlay(Math.floor(e.mainVideoDuration)),clearInterval(e.timer)),e.displayOptions.layoutControls.loop&&(e.switchToMainVideo(),e.playPauseToggle()))},e.getCurrentTime=()=>e.isCurrentlyPlayingAd?e.mainVideoCurrentTime:e.domRef.player.currentTime,e.getCurrentSrc=()=>{const t=e.domRef.player.getElementsByTagName("source");return t.length?t[0].getAttribute("src"):null},e.getCurrentSrcType=()=>{const t=e.domRef.player.getElementsByTagName("source");if(!t.length)return null;for(let n=0;n<t.length;n++)if(t[n].getAttribute("src")===e.originalSrc)return t[n].getAttribute("type").toLowerCase();return null},e.onRecentWaiting=()=>{e.recentWaiting=!0,setTimeout((function(){e.recentWaiting=!1}),1e3)},e.onFluidPlayerPause=()=>{setTimeout((function(){if(e.recentWaiting)return;const t=document.createEvent("CustomEvent");t.initEvent("fluidplayerpause",!1,!0),e.domRef.player.dispatchEvent(t)}),100)},e.checkShouldDisplayVolumeBar=()=>"iOS"!==e.getMobileOs().userOs,e.generateCustomControlTags=t=>{const n={};return n.loader=document.createElement("div"),n.loader.className="vast_video_loading",n.loader.id="vast_video_loading_"+e.videoPlayerId,n.loader.style.display="none",n.root=document.createElement("div"),n.root.className="fluid_controls_container",n.root.id=e.videoPlayerId+"_fluid_controls_container",t.displayVolumeBar||(n.root.className=n.root.className+" no_volume_bar"),t.controlForwardBackward&&(n.root.className=n.root.className+" skip_controls"),n.leftContainer=document.createElement("div"),n.leftContainer.className="fluid_controls_left",n.root.appendChild(n.leftContainer),n.playPause=document.createElement("div"),n.playPause.className="fluid_button fluid_button_play fluid_control_playpause",n.playPause.id=e.videoPlayerId+"_fluid_control_playpause",n.leftContainer.appendChild(n.playPause),t.controlForwardBackward&&(n.skipBack=document.createElement("div"),n.skipBack.className="fluid_button fluid_button_skip_back",n.skipBack.id=e.videoPlayerId+"_fluid_control_skip_back",n.leftContainer.appendChild(n.skipBack),n.skipForward=document.createElement("div"),n.skipForward.className="fluid_button fluid_button_skip_forward",n.skipForward.id=e.videoPlayerId+"_fluid_control_skip_forward",n.leftContainer.appendChild(n.skipForward)),n.progressContainer=document.createElement("div"),n.progressContainer.className="fluid_controls_progress_container fluid_slider",n.progressContainer.id=e.videoPlayerId+"_fluid_controls_progress_container",n.root.appendChild(n.progressContainer),n.progressWrapper=document.createElement("div"),n.progressWrapper.className="fluid_controls_progress",n.progressContainer.appendChild(n.progressWrapper),n.progressCurrent=document.createElement("div"),n.progressCurrent.className="fluid_controls_currentprogress",n.progressCurrent.id=e.videoPlayerId+"_vast_control_currentprogress",n.progressCurrent.style.backgroundColor=t.primaryColor,n.progressWrapper.appendChild(n.progressCurrent),n.progress_current_marker=document.createElement("div"),n.progress_current_marker.className="fluid_controls_currentpos",n.progress_current_marker.id=e.videoPlayerId+"_vast_control_currentpos",n.progressCurrent.appendChild(n.progress_current_marker),n.bufferedIndicator=document.createElement("div"),n.bufferedIndicator.className="fluid_controls_buffered",n.bufferedIndicator.id=e.videoPlayerId+"_buffered_amount",n.progressContainer.appendChild(n.bufferedIndicator),n.adMarkers=document.createElement("div"),n.adMarkers.className="fluid_controls_ad_markers_holder",n.adMarkers.id=e.videoPlayerId+"_ad_markers_holder",n.progressContainer.appendChild(n.adMarkers),n.rightContainer=document.createElement("div"),n.rightContainer.className="fluid_controls_right",n.root.appendChild(n.rightContainer),n.fullscreen=document.createElement("div"),n.fullscreen.id=e.videoPlayerId+"_fluid_control_fullscreen",n.fullscreen.className="fluid_button fluid_control_fullscreen fluid_button_fullscreen",n.rightContainer.appendChild(n.fullscreen),t.miniPlayer.enabled&&(n.miniPlayer=document.createElement("div"),n.miniPlayer.id=e.videoPlayerId+"_fluid_control_mini_player",n.miniPlayer.className="fluid_button fluid_control_mini_player fluid_button_mini_player",n.rightContainer.appendChild(n.miniPlayer)),n.theatre=document.createElement("div"),n.theatre.id=e.videoPlayerId+"_fluid_control_theatre",n.theatre.className="fluid_button fluid_control_theatre fluid_button_theatre",n.rightContainer.appendChild(n.theatre),n.cardboard=document.createElement("div"),n.cardboard.id=e.videoPlayerId+"_fluid_control_cardboard",n.cardboard.className="fluid_button fluid_control_cardboard fluid_button_cardboard",n.rightContainer.appendChild(n.cardboard),n.subtitles=document.createElement("div"),n.subtitles.id=e.videoPlayerId+"_fluid_control_subtitles",n.subtitles.className="fluid_button fluid_button_subtitles",n.rightContainer.appendChild(n.subtitles),n.videoSource=document.createElement("div"),n.videoSource.id=e.videoPlayerId+"_fluid_control_video_source",n.videoSource.className="fluid_button fluid_button_video_source",n.rightContainer.appendChild(n.videoSource),n.playbackRate=document.createElement("div"),n.playbackRate.id=e.videoPlayerId+"_fluid_control_playback_rate",n.playbackRate.className="fluid_button fluid_button_playback_rate",n.rightContainer.appendChild(n.playbackRate),n.download=document.createElement("div"),n.download.id=e.videoPlayerId+"_fluid_control_download",n.download.className="fluid_button fluid_button_download",n.rightContainer.appendChild(n.download),n.volumeContainer=document.createElement("div"),n.volumeContainer.id=e.videoPlayerId+"_fluid_control_volume_container",n.volumeContainer.className="fluid_control_volume_container fluid_slider",n.rightContainer.appendChild(n.volumeContainer),n.volume=document.createElement("div"),n.volume.id=e.videoPlayerId+"_fluid_control_volume",n.volume.className="fluid_control_volume",n.volumeContainer.appendChild(n.volume),n.volumeCurrent=document.createElement("div"),n.volumeCurrent.id=e.videoPlayerId+"_fluid_control_currentvolume",n.volumeCurrent.className="fluid_control_currentvolume",n.volume.appendChild(n.volumeCurrent),n.volumeCurrentPos=document.createElement("div"),n.volumeCurrentPos.id=e.videoPlayerId+"_fluid_control_volume_currentpos",n.volumeCurrentPos.className="fluid_control_volume_currentpos",n.volumeCurrent.appendChild(n.volumeCurrentPos),n.mute=document.createElement("div"),n.mute.id=e.videoPlayerId+"_fluid_control_mute",n.mute.className="fluid_button fluid_button_volume fluid_control_mute",n.rightContainer.appendChild(n.mute),n.duration=document.createElement("div"),n.duration.id=e.videoPlayerId+"_fluid_control_duration",n.duration.className="fluid_control_duration fluid_fluid_control_duration",n.duration.innerText="00:00 / 00:00",n.rightContainer.appendChild(n.duration),n},e.controlPlayPauseToggle=()=>{const t=e.domRef.player.parentNode.getElementsByClassName("fluid_control_playpause"),n=document.getElementById(e.videoPlayerId+"context_option_play"),r=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),i=document.getElementById(e.videoPlayerId+"_logo");if(document.getElementById(e.videoPlayerId+"_fluid_initial_play")&&(document.getElementById(e.videoPlayerId+"_fluid_initial_play").style.display="none",document.getElementById(e.videoPlayerId+"_fluid_initial_play_button").style.opacity="1"),!e.domRef.player.paused){for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_play\b/g,"fluid_button_pause");for(let e=0;e<r.length;e++)r[e].classList.remove("initial_controls_show");return i&&i.classList.remove("initial_controls_show"),void(null!==n&&(n.innerHTML=e.displayOptions.captions.pause))}for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_pause\b/g,"fluid_button_play");for(let e=0;e<r.length;e++)r[e].classList.add("initial_controls_show");e.isCurrentlyPlayingAd&&e.displayOptions.vastOptions.showPlayButton&&(document.getElementById(e.videoPlayerId+"_fluid_initial_play").style.display="block",document.getElementById(e.videoPlayerId+"_fluid_initial_play_button").style.opacity="1"),i&&i.classList.add("initial_controls_show"),null!==n&&(n.innerHTML=e.displayOptions.captions.play)},e.playPauseAnimationToggle=t=>{e.isCurrentlyPlayingAd||!e.displayOptions.layoutControls.playPauseAnimation||e.isSwitchingSource||(t?(document.getElementById(e.videoPlayerId+"_fluid_state_button").classList.remove("fluid_initial_pause_button"),document.getElementById(e.videoPlayerId+"_fluid_state_button").classList.add("fluid_initial_play_button")):(document.getElementById(e.videoPlayerId+"_fluid_state_button").classList.remove("fluid_initial_play_button"),document.getElementById(e.videoPlayerId+"_fluid_state_button").classList.add("fluid_initial_pause_button")),document.getElementById(e.videoPlayerId+"_fluid_initial_play").classList.add("transform-active"),setTimeout((function(){document.getElementById(e.videoPlayerId+"_fluid_initial_play").classList.remove("transform-active")}),800))},e.contolProgressbarUpdate=()=>{const t=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_currentprogress");for(let n=0;n<t.length;n++)t[n].style.width=e.domRef.player.currentTime/e.currentVideoDuration*100+"%"},e.controlDurationUpdate=()=>{const t=e.formatTime(e.domRef.player.currentTime);let n,r=!1;e.hlsPlayer&&(r=e.hlsPlayer.levels&&e.hlsPlayer.levels[e.hlsPlayer.currentLevel]&&e.hlsPlayer.levels[e.hlsPlayer.currentLevel].details.live),n=isNaN(e.currentVideoDuration)||!isFinite(e.currentVideoDuration)||r?t:t+" / "+e.formatTime(e.currentVideoDuration);const i=e.domRef.player.parentNode.getElementsByClassName("fluid_control_duration");for(let e=0;e<i.length;e++)i[e].innerHTML=n},e.contolVolumebarUpdate=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_currentvolume"),n=document.getElementById(e.videoPlayerId+"_fluid_control_volume_currentpos"),r=document.getElementById(e.videoPlayerId+"_fluid_control_volume").clientWidth,i=n.clientWidth,o=e.domRef.player.parentNode.getElementsByClassName("fluid_control_mute"),a=document.getElementById(e.videoPlayerId+"context_option_mute");if(0!==e.domRef.player.volume?(e.latestVolume=e.domRef.player.volume,e.fluidStorage.fluidMute=!1):e.fluidStorage.fluidMute=!0,e.domRef.player.volume&&!e.domRef.player.muted){for(let e=0;e<o.length;e++)o[e].className=o[e].className.replace(/\bfluid_button_mute\b/g,"fluid_button_volume");null!==a&&(a.innerHTML=e.displayOptions.captions.mute)}else{for(let e=0;e<o.length;e++)o[e].className=o[e].className.replace(/\bfluid_button_volume\b/g,"fluid_button_mute");null!==a&&(a.innerHTML=e.displayOptions.captions.unmute)}t.style.width=e.domRef.player.volume*r+"px",n.style.left=e.domRef.player.volume*r-i/2+"px"},e.muteToggle=()=>{0===e.domRef.player.volume||e.domRef.player.muted?(e.domRef.player.volume=e.latestVolume,e.domRef.player.muted=!1):(e.domRef.player.volume=0,e.domRef.player.muted=!0),e.fluidStorage.fluidVolume=e.latestVolume,e.fluidStorage.fluidMute=e.domRef.player.muted},e.checkFullscreenSupport=t=>{const n=document.getElementById(t);return n.mozRequestFullScreen?{goFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen",isFullscreen:"mozFullScreenElement"}:n.webkitRequestFullscreen?{goFullscreen:"webkitRequestFullscreen",exitFullscreen:"webkitExitFullscreen",isFullscreen:"webkitFullscreenElement"}:n.msRequestFullscreen?{goFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen",isFullscreen:"msFullscreenElement"}:n.requestFullscreen?{goFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen",isFullscreen:"fullscreenElement"}:!!e.domRef.player.webkitSupportsFullscreen&&{goFullscreen:"webkitEnterFullscreen",exitFullscreen:"webkitExitFullscreen",isFullscreen:"webkitDisplayingFullscreen"}},e.fullscreenOff=(t,n)=>{for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_fullscreen_exit\b/g,"fluid_button_fullscreen");null!==n&&(n.innerHTML="Fullscreen"),e.fullscreenMode=!1},e.fullscreenOn=(t,n)=>{for(let e=0;e<t.length;e++)t[e].className=t[e].className.replace(/\bfluid_button_fullscreen\b/g,"fluid_button_fullscreen_exit");null!==n&&(n.innerHTML=e.displayOptions.captions.exitFullscreen),e.fullscreenMode=!0},e.fullscreenToggle=()=>{e.debugMessage("Toggling Full Screen");const t=e.domRef.player,n=document.getElementById("fluid_video_wrapper_"+e.videoPlayerId),r=e.checkFullscreenSupport("fluid_video_wrapper_"+e.videoPlayerId),i=t.parentNode.getElementsByClassName("fluid_control_fullscreen"),o=document.getElementById(e.videoPlayerId+"context_option_fullscreen");let a;e.resetDisplayMode("fullScreen"),r?"webkitEnterFullscreen"===r.goFullscreen?t[r.isFullscreen]||(a="videoPlayerTag."+r.goFullscreen+"();",e.fullscreenOn(i,o),new Function("videoPlayerTag",a)(t)):(null===document[r.isFullscreen]?(a="videoPlayerTag."+r.goFullscreen+"();",e.fullscreenOn(i,o)):(a="document."+r.exitFullscreen+"();",e.fullscreenOff(i,o)),new Function("videoPlayerTag",a)(n)):-1!==n.className.search(/\bpseudo_fullscreen\b/g)?(n.className=n.className.replace(/\bpseudo_fullscreen\b/g,""),e.fullscreenOff(i,o)):(n.className+=" pseudo_fullscreen",e.fullscreenOn(i,o)),e.resizeVpaidAuto(),e.domRef.player.addEventListener("webkitendfullscreen",(()=>{e.fullscreenOff(i,o)}))},e.findClosestParent=(e,t)=>{let n,r=null;if(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some((function(e){return"function"==typeof document.body[e]&&(r=e,!0)})),e[r](t))return e;for(;e;){if(n=e.parentElement,n&&n[r](t))return n;e=n}return null},e.getTranslateX=e=>{let t=null;try{const n=e.style.transform.match(/translate3d\((-?\d+px,\s?){2}-?\d+px\)/);n&&n.length&&(t=n[0].replace("translate3d(","").replace(")","").replace(/\s/g,"").replace(/px/g,"").split(","))}catch(e){t=null}return t&&3===t.length?parseInt(t[0]):0},e.getEventOffsetX=(t,n)=>{let r,i=0,o=0;for(;n&&!isNaN(n.offsetLeft);)o=e.getTranslateX(n),"BODY"===n.tagName?i+=n.offsetLeft+n.clientLeft+o-(n.scrollLeft||document.documentElement.scrollLeft):i+=n.offsetLeft+n.clientLeft+o-n.scrollLeft,n=n.offsetParent;return r=void 0!==t.touches&&void 0!==t.touches[0]?t.touches[0].clientX:t.clientX,r-i},e.getEventOffsetY=(t,n)=>{let r=1;const i=e.findClosestParent(n,'div[id^="fluid_video_wrapper_"]');if(i){const t=i.id.replace("fluid_video_wrapper_",""),n=e.checkFullscreenSupport("fluid_video_wrapper_"+t);n&&document[n.isFullscreen]&&(r=0)}let o=0;for(;n&&!isNaN(n.offsetTop);)"BODY"===n.tagName?o+=n.offsetTop-(n.scrollTop||document.documentElement.scrollTop)*r:o+=n.offsetTop-n.scrollTop*r,n=n.offsetParent;return t.clientY-o},e.onProgressbarMouseDown=t=>{let n;if(e.displayOptions.layoutControls.playPauseAnimation=!1,n=e.displayOptions.layoutControls.showCardBoardView?e.getEventOffsetX(t,t.target.parentNode):e.getEventOffsetX(t,document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container")),e.isCurrentlyPlayingAd)return;e.fluidPseudoPause=!0;const r=e.domRef.player.paused;r||e.domRef.player.pause();const i=t=>{const n=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").clientWidth;n&&(e.domRef.player.currentTime=e.currentVideoDuration*t/n)},o=t=>{const r=e.getEventOffsetX(t,t.target.parentNode);n=NaN,i(r),e.contolProgressbarUpdate(e.videoPlayerId),e.controlDurationUpdate(e.videoPlayerId)},a=t=>{document.removeEventListener("mousemove",o),document.removeEventListener("touchmove",o),document.removeEventListener("mouseup",a),document.removeEventListener("touchend",a);let s=e.getEventOffsetX(t,t.target.parentNode);isNaN(s)&&!isNaN(n)&&(s=n),isNaN(s)||i(s),r||e.play(),e.initialAnimationSet&&setTimeout((()=>{e.displayOptions.layoutControls.playPauseAnimation=e.initialAnimationSet}),200),e.fluidPseudoPause=!1};document.addEventListener("mouseup",a),document.addEventListener("touchend",a),document.addEventListener("mousemove",o),document.addEventListener("touchmove",o)},e.onVolumeBarMouseDown=()=>{const t=t=>{const n=e.domRef.controls.volumeContainer.clientWidth;if(n){let r=t/n;r<.05?(r=0,e.domRef.player.muted=!0):r>.95&&(r=1),e.domRef.player.muted&&r>0&&(e.domRef.player.muted=!1),e.setVolume(r)}},n=n=>{const r=e.getEventOffsetX(n,e.domRef.controls.volumeContainer);t(r)},r=i=>{document.removeEventListener("mousemove",n),document.removeEventListener("touchmove",n),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r);const o=e.getEventOffsetX(i,e.domRef.controls.volumeContainer);isNaN(o)||t(o)};document.addEventListener("mouseup",r),document.addEventListener("touchend",r),document.addEventListener("mousemove",n),document.addEventListener("touchmove",n)},e.findRoll=t=>{const n=[];if(n.length=0,t&&e.hasOwnProperty("rollsById")){for(let r in e.rollsById)e.rollsById.hasOwnProperty(r)&&e.rollsById[r].roll===t&&n.push(r);return n}},e.onKeyboardVolumeChange=t=>{let n=e.domRef.player.volume;"asc"===t?n+=.05:"desc"===t&&(n-=.05),n<.05?n=0:n>.95&&(n=1),e.setVolume(n)},e.onKeyboardSeekPosition=t=>{e.isCurrentlyPlayingAd||(e.domRef.player.currentTime=e.getNewCurrentTimeValueByKeyCode(t,e.domRef.player.currentTime,e.domRef.player.duration))},e.getNewCurrentTimeValueByKeyCode=(e,t,n)=>{let r=t;switch(e){case 35:r=n;break;case 36:r=0;break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e<58&&e>47&&(r=n*(10*(e-48))/100)}return r},e.handleMouseleave=t=>{void 0!==t.clientX&&e.domRef.wrapper.contains(document.elementFromPoint(t.clientX,t.clientY))||(e.hideControlBar(),e.hideTitle())},e.handleMouseenterForKeyboard=()=>{e.captureKey||(e.captureKey=t=>{t.stopPropagation();const n=t.keyCode;switch(n){case 70:e.fullscreenToggle(),t.preventDefault();break;case 13:case 32:e.playPauseToggle(),t.preventDefault();break;case 77:e.muteToggle(),t.preventDefault();break;case 38:e.onKeyboardVolumeChange("asc"),t.preventDefault();break;case 40:e.onKeyboardVolumeChange("desc"),t.preventDefault();break;case 37:e.skipRelative(-e.timeSkipOffsetAmount);break;case 39:e.skipRelative(e.timeSkipOffsetAmount);break;case 35:case 36:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.onKeyboardSeekPosition(n),t.preventDefault();break;case 73:e.toggleMiniPlayer(void 0,!0)}return!1},document.addEventListener("keydown",e.captureKey,!0))},e.keyboardControl=()=>{e.domRef.wrapper.addEventListener("click",e.handleMouseenterForKeyboard,!1);const t=e.handleWindowClick.bind(e);e.destructors.push((()=>{window.removeEventListener("click",t)})),window.addEventListener("click",t)},e.handleWindowClick=t=>{e.domRef.wrapper?e.domRef.wrapper.contains(t.target)||t.target.id==="skipHref_"+e.videoPlayerId||(document.removeEventListener("keydown",e.captureKey,!0),delete e.captureKey,e.theatreMode&&!e.theatreModeAdvanced&&e.theatreToggle()):console.warn("Dangling click event listener should be collected for unknown wrapper "+e.videoPlayerId+". Did you forget to call destroy on player instance?")},e.initialPlay=()=>{if(e.domRef.player.addEventListener("playing",(()=>{e.toggleLoader(!1)})),e.domRef.player.addEventListener("timeupdate",(()=>{e.toggleLoader(!1)})),e.domRef.player.addEventListener("waiting",(()=>{e.toggleLoader(!0)})),!e.displayOptions.layoutControls.playButtonShowing){document.getElementById(e.videoPlayerId+"_fluid_controls_container").classList.remove("initial_controls_show");const t=document.getElementById(e.videoPlayerId+"_logo");t&&t.classList.remove("initial_controls_show")}e.firstPlayLaunched||(e.playPauseToggle(),e.domRef.player.removeEventListener("play",e.initialPlay))},e.playPauseToggle=()=>{const t=!e.firstPlayLaunched,n=e.findRoll("preRoll");if(t&&0!==n.length){e.isCurrentlyPlayingAd=!0;const t=e.getBrowserVersion(),r=!1!==e.mobileInfo.userOs&&"Android"===e.mobileInfo.userOs&&"Google Chrome"===t.browserName;("Safari"===t.browserName||r)&&(e.domRef.player.src="https://cdn.fluidplayer.com/static/blank.mp4",e.domRef.player.play(),e.playPauseAnimationToggle(!0)),e.firstPlayLaunched=!0,e.prepareVast("preRoll"),e.preRollAdPodsLength=n.length}else t&&0===n.length&&(e.firstPlayLaunched=!0,e.displayOptions.vastOptions.vastAdvanced.noVastVideoCallback()),e.domRef.player.paused?(e.isCurrentlyPlayingAd&&null!==e.vastOptions&&e.vastOptions.vpaid?e.resumeVpaidAd():(Math.floor(e.currentVideoDuration)===Math.floor(e.domRef.player.currentTime)&&(e.initialiseStreamers(),e.domRef.player.currentTime=0),e.dashPlayer?e.dashPlayer.play():e.domRef.player.play()),e.playPauseAnimationToggle(!0)):t||(e.isCurrentlyPlayingAd&&null!==e.vastOptions&&e.vastOptions.vpaid?e.pauseVpaidAd():e.domRef.player.pause(),e.playPauseAnimationToggle(!1)),e.toggleOnPauseAd();const r=()=>{e.prepareVast("onPauseRoll"),e.scheduleOnDemandRolls()};if(t){const t=document.getElementById(e.videoPlayerId+"_fluid_pseudo_poster");t&&t.parentNode.removeChild(t),e.mainVideoDuration>0?r():e.domRef.player.addEventListener("mainVideoDurationSet",r)}e.adTimer();const i=document.getElementById(e.videoPlayerId+"_fluid_html_on_pause");i&&!e.isCurrentlyPlayingAd&&(e.domRef.player.paused?i.style.display="flex":i.style.display="none")},e.setCustomControls=()=>{e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_playpause",(()=>{e.firstPlayLaunched||e.domRef.player.removeEventListener("play",e.initialPlay),e.playPauseToggle()}),!1),e.domRef.player.addEventListener("play",(()=>{e.controlPlayPauseToggle(),e.contolVolumebarUpdate()}),!1),e.domRef.player.addEventListener("fluidplayerpause",(()=>{e.controlPlayPauseToggle()}),!1),e.domRef.player.addEventListener("timeupdate",(()=>{e.contolProgressbarUpdate(),e.controlDurationUpdate()}));const t=e.getMobileOs().userOs?"touchstart":"mousedown";e.displayOptions.layoutControls.showCardBoardView?e.trackEvent(e.domRef.player.parentNode,t,".fluid_controls_progress_container",(t=>e.onProgressbarMouseDown(t)),!1):document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener(t,(t=>e.onProgressbarMouseDown(t)),!1),document.getElementById(e.videoPlayerId+"_fluid_control_volume_container").addEventListener(t,(t=>e.onVolumeBarMouseDown()),!1),e.domRef.player.addEventListener("volumechange",(()=>e.contolVolumebarUpdate())),e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_mute",(()=>e.muteToggle())),e.setBuffering(),e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_fullscreen",(()=>e.fullscreenToggle())),e.displayOptions.layoutControls.allowTheatre&&!e.isInIframe?(document.getElementById(e.videoPlayerId+"_fluid_control_theatre").style.display="inline-block",e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_theatre",(()=>e.theatreToggle()))):document.getElementById(e.videoPlayerId+"_fluid_control_theatre").style.display="none",e.displayOptions.layoutControls.miniPlayer.enabled&&!e.isInIframe&&e.trackEvent(e.domRef.player.parentNode,"click",".fluid_control_mini_player",(()=>e.toggleMiniPlayer(void 0,!0))),e.domRef.player.addEventListener("ratechange",(()=>{e.isCurrentlyPlayingAd&&(e.playbackRate=1)}))},e.createTimePositionPreview=()=>{if(!e.showTimeOnHover)return;const t=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container"),n=document.createElement("div");n.id=e.videoPlayerId+"_fluid_timeline_preview",n.className="fluid_timeline_preview",n.style.display="none",n.style.position="absolute",t.appendChild(n),document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener("mousemove",(t=>{const n=document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container"),r=n.clientWidth,i=document.getElementById(e.videoPlayerId+"_fluid_timeline_preview"),o=e.getEventOffsetX(t,n),a=e.currentVideoDuration*o/r;i.innerText=e.formatTime(a),i.style.display="block",i.style.left=a/e.domRef.player.duration*100+"%"}),!1),document.getElementById(e.videoPlayerId+"_fluid_controls_progress_container").addEventListener("mouseout",(()=>{document.getElementById(e.videoPlayerId+"_fluid_timeline_preview").style.display="none"}),!1)},e.setCustomContextMenu=()=>{const t=e.domRef.wrapper,n=e.displayOptions.layoutControls.contextMenu.controls,r=e.displayOptions.layoutControls.contextMenu.links,i=document.createElement("div");i.id=e.videoPlayerId+"_fluid_context_menu",i.className="fluid_context_menu",i.style.display="none",i.style.position="absolute";const o=document.createElement("ul");if(i.appendChild(o),Array.isArray(r)&&r.forEach((function(t,n){const r=document.createElement("li");r.id=e.videoPlayerId+"_extra_link_"+n,r.innerHTML=t.label,r.addEventListener("click",(()=>window.open(t.href,"_blank")),!1),o.appendChild(r)})),n){const t=document.createElement("li");t.id=e.videoPlayerId+"context_option_play",t.innerHTML=e.displayOptions.captions.play,t.addEventListener("click",(()=>e.playPauseToggle()),!1),o.appendChild(t);const n=document.createElement("li");n.id=e.videoPlayerId+"context_option_mute",n.innerHTML=e.displayOptions.captions.mute,n.addEventListener("click",(()=>e.muteToggle()),!1),o.appendChild(n);const r=document.createElement("li");r.id=e.videoPlayerId+"context_option_fullscreen",r.innerHTML=e.displayOptions.captions.fullscreen,r.addEventListener("click",(()=>e.fullscreenToggle()),!1),o.appendChild(r)}const a=document.createElement("li");a.id=e.videoPlayerId+"context_option_homepage",a.innerHTML="Fluid Player "+e.version,a.addEventListener("click",(()=>window.open(e.homepage,"_blank")),!1),o.appendChild(a),e.domRef.player.parentNode.insertBefore(i,e.domRef.player.nextSibling),t.addEventListener("contextmenu",(t=>{t.preventDefault(),i.style.left=e.getEventOffsetX(t,e.domRef.player)+"px",i.style.top=e.getEventOffsetY(t,e.domRef.player)+"px",i.style.display="block"}),!1),document.addEventListener("click",(t=>{t.target===e.domRef.player&&2===t.button||(i.style.display="none")}),!1)},e.setDefaultLayout=()=>{e.domRef.wrapper.className+=" fluid_player_layout_"+e.displayOptions.layoutControls.layout,e.setCustomContextMenu();const t=e.generateCustomControlTags({displayVolumeBar:e.checkShouldDisplayVolumeBar(),primaryColor:e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"red",controlForwardBackward:!!e.displayOptions.layoutControls.controlForwardBackward.show,miniPlayer:e.displayOptions.layoutControls.miniPlayer});e.domRef.player.removeAttribute("controls"),e.domRef.player.parentNode.insertBefore(t.root,e.domRef.player.nextSibling),e.domRef.player.parentNode.insertBefore(t.loader,e.domRef.player.nextSibling),e.domRef.controls=t;let n=100,r=setInterval((function(){n?e.checkIfVolumebarIsRendered()?(clearInterval(r),e.contolVolumebarUpdate(e.videoPlayerId)):n--:clearInterval(r)}),100);!e.displayOptions.layoutControls.doubleclickFullscreen||e.isTouchDevice()||e.displayOptions.layoutControls.controlForwardBackward.doubleTapMobile||e.domRef.player.addEventListener("dblclick",e.fullscreenToggle),e.initHtmlOnPauseBlock(),e.setCustomControls(),e.setupThumbnailPreview(),e.createTimePositionPreview(),e.posterImage(),e.initPlayButton(),e.setVideoPreload(),e.createPlaybackList(),e.createDownload(),e.toggleMiniPlayerScreenDetection(),e.displayOptions.layoutControls.controlForwardBackward.show&&e.initSkipControls(),e.displayOptions.layoutControls.controlForwardBackward.doubleTapMobile&&e.initDoubleTapSkip(),e.initSkipAnimationElements()},e.initSkipControls=()=>{e.domRef.controls.skipBack.addEventListener("click",e.skipRelative.bind(this,-e.timeSkipOffsetAmount)),e.domRef.controls.skipForward.addEventListener("click",e.skipRelative.bind(this,e.timeSkipOffsetAmount))},e.initSkipAnimationElements=function(){const t=document.createElement("div");t.classList.add("fluid_player_skip_offset");const n=document.createElement("div");n.classList.add("fluid_player_skip_offset__backward"),t.appendChild(n);const r=document.createElement("div");r.classList.add("fluid_player_skip_offset__backward-icon"),r.ontransitionend=()=>r.classList.remove("animate"),n.appendChild(r);const i=document.createElement("div");i.classList.add("fluid_player_skip_offset__forward"),t.appendChild(i);const o=document.createElement("div");o.classList.add("fluid_player_skip_offset__forward-icon"),o.ontransitionend=()=>o.classList.remove("animate"),i.appendChild(o),e.domRef.player.parentNode.insertBefore(t,e.domRef.player.nextSibling)},e.initDoubleTapSkip=()=>{let t=!1,n=[];e.domRef.player.addEventListener("click",(r=>{if(!e.isTouchDevice())return;const{offsetX:i}=r,{clientWidth:o}=e.domRef.player;if(n.push(setTimeout((()=>{t=!1,e.playPauseToggle()}),300)),t)return n.forEach((e=>clearTimeout(e))),n=[],t=!1,e.skipRelative(i<o/2?-e.timeSkipOffsetAmount:e.timeSkipOffsetAmount);t=!0}))},e.skipRelative=function(t){if(e.debugMessage("skipping video time by ",t),e.isCurrentlyPlayingAd)return;let n=e.domRef.player.currentTime+t;n<0&&(n=0),e.domRef.player.currentTime=n,t>=0?e.domRef.wrapper.querySelector(".fluid_player_skip_offset__forward-icon").classList.add("animate"):e.domRef.wrapper.querySelector(".fluid_player_skip_offset__backward-icon").classList.add("animate")},e.checkIfVolumebarIsRendered=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_volume_currentpos"),n=document.getElementById(e.videoPlayerId+"_fluid_control_volume").clientWidth;return t.clientWidth!==n},e.setLayout=()=>{e.isTouchDevice()||e.domRef.player.addEventListener("click",(()=>e.playPauseToggle()),!1),e.domRef.player.addEventListener("play",e.initialPlay,!1),e.setDefaultLayout()},e.handleFullscreen=()=>{void 0===document.vastFullsreenChangeEventListenersAdded&&(["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach((t=>{"object"==typeof document["on"+t]&&document.addEventListener(t,(function(t){e.recalculateAdDimensions()}),!1)})),document.vastFullsreenChangeEventListenersAdded=!0)},e.setupPlayerWrapper=()=>{const t=document.createElement("div");return t.id="fluid_video_wrapper_"+e.videoPlayerId,t.className=e.isTouchDevice()?"fluid_video_wrapper mobile":"fluid_video_wrapper",e.displayOptions.layoutControls.fillToContainer?(t.style.width="100%",t.style.height="100%"):(t.style.height=e.domRef.player.clientHeight+"px",t.style.width=e.domRef.player.clientWidth+"px"),e.domRef.player.style.height="100%",e.domRef.player.style.width="100%",e.domRef.player.parentNode.insertBefore(t,e.domRef.player),t.appendChild(e.domRef.player),t},e.onErrorDetection=()=>{e.domRef.player.networkState===e.domRef.player.NETWORK_NO_SOURCE&&e.isCurrentlyPlayingAd&&e.playMainVideoWhenVastFails(401)},e.createVideoSourceSwitch=()=>{const t=[],n=e.domRef.player.querySelectorAll("source");if([].forEach.call(n,(e=>{e.title&&e.src&&t.push({title:e.title,url:e.src,isHD:null!=e.getAttribute("data-fluid-hd")})})),e.videoSources=t,e.videoSources.length<=1)return;const r=document.getElementById(e.videoPlayerId+"_fluid_control_video_source");r.style.display="inline-block";let i=!1;const o=document.createElement("div");o.id=e.videoPlayerId+"_fluid_control_video_source_list",o.className="fluid_video_sources_list",o.style.display="none";let a=!0;for(const t of e.videoSources){const n=t.url.split(".").pop();if("iOS"===e.mobileInfo.userOs&&"mkv"===n)continue;const r=a?"source_selected":"",s=t.isHD?'<sup style="color:'+e.displayOptions.layoutControls.primaryColor+'" class="fp_hd_source"></sup>':"";a=!1;const l=document.createElement("div");l.id="source_"+e.videoPlayerId+"_"+t.title,l.className="fluid_video_source_list_item",l.innerHTML='<span class="source_button_icon '+r+'"></span>'+t.title+s,l.addEventListener("click",(function(t){t.stopPropagation(),e.domRef.player.style.width=e.domRef.player.clientWidth+"px",e.domRef.player.style.height=e.domRef.player.clientHeight+"px";const n=this,r=document.getElementsByClassName("source_button_icon");for(let e=0;e<r.length;e++)r[e].className=r[e].className.replace("source_selected","");n.firstChild.className+=" source_selected",e.videoSources.forEach((t=>{t.title===n.innerText.replace(/(\r\n\t|\n|\r\t)/gm,"")&&(e.setBuffering(),e.setVideoSource(t.url),e.fluidStorage.fluidQuality=t.title)})),e.openCloseVideoSourceSwitch()})),o.appendChild(l),i=!0}i?(r.appendChild(o),r.addEventListener("click",(()=>{e.openCloseVideoSourceSwitch()}))):document.getElementById(e.videoPlayerId+"_fluid_control_video_source").style.display="none"},e.openCloseVideoSourceSwitch=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_video_source_list");if(e.isCurrentlyPlayingAd)return void(t.style.display="none");if("none"!==t.style.display)return void(t.style.display="none");t.style.display="block";const n=()=>{t.removeEventListener("mouseleave",n),t.style.display="none"};t.addEventListener("mouseleave",n)},e.setVideoSource=t=>{if("iOS"===e.mobileInfo.userOs&&t.indexOf(".mkv")>0)return console.log("[FP_ERROR] .mkv files not supported by iOS devices."),!1;if(e.isCurrentlyPlayingAd)return void(e.originalSrc=t);e.isSwitchingSource=!0;let n=!1;e.domRef.player.paused||(e.domRef.player.pause(),n=!0);const r=e.domRef.player.currentTime;e.setCurrentTimeAndPlay(r,n),e.domRef.player.src=t,e.originalSrc=t,e.displayOptions.layoutControls.mediaType=e.getCurrentSrcType(),e.initialiseStreamers()},e.setCurrentTimeAndPlay=(t,n)=>{const r=()=>{e.domRef.player.currentTime=t,e.domRef.player.removeEventListener("loadedmetadata",r),"iOS"!==e.mobileInfo.userOs&&"safari"!==e.getBrowserVersion().browserName.toLowerCase()||e.domRef.player.addEventListener("playing",i),n?e.domRef.player.play():(e.domRef.player.pause(),e.controlPlayPauseToggle(e.videoPlayerId)),e.isSwitchingSource=!1,e.domRef.player.style.width="100%",e.domRef.player.style.height="100%"};let i=()=>{e.currentTime=t,e.domRef.player.removeEventListener("playing",i)};e.domRef.player.addEventListener("loadedmetadata",r,!1),e.domRef.player.load()},e.initTitle=()=>{if(!e.displayOptions.layoutControls.title)return;const t=document.createElement("div");t.id=e.videoPlayerId+"_title",e.domRef.player.parentNode.insertBefore(t,null),t.innerHTML+=e.displayOptions.layoutControls.title,t.classList.add("fp_title")},e.hasTitle=()=>{const t=document.getElementById(e.videoPlayerId+"_title"),n=e.displayOptions.layoutControls.title;return t&&null!=n},e.hideTitle=()=>{const t=document.getElementById(e.videoPlayerId+"_title");e.hasTitle()&&t.classList.add("fade_out")},e.showTitle=()=>{const t=document.getElementById(e.videoPlayerId+"_title");e.hasTitle()&&t.classList.remove("fade_out")},e.initLogo=()=>{if(!e.displayOptions.layoutControls.logo.imageUrl)return;const t=document.createElement("div");t.id=e.videoPlayerId+"_logo",e.displayOptions.layoutControls.logo.hideWithControls?t.classList.add("initial_controls_show","fp_logo"):t.classList.add("logo_maintain_display");const n=document.createElement("img");n.id=e.videoPlayerId+"_logo_image",e.displayOptions.layoutControls.logo.imageUrl&&(n.src=e.displayOptions.layoutControls.logo.imageUrl),n.style.position="absolute",n.style.margin=e.displayOptions.layoutControls.logo.imageMargin;const r=e.displayOptions.layoutControls.logo.position.toLowerCase();-1!==r.indexOf("bottom")?n.style.bottom=0:n.style.top=0,-1!==r.indexOf("right")?n.style.right=0:n.style.left=0,e.displayOptions.layoutControls.logo.opacity&&(n.style.opacity=e.displayOptions.layoutControls.logo.opacity),null!==e.displayOptions.layoutControls.logo.clickUrl&&(n.style.cursor="pointer",n.addEventListener("click",(function(){window.open(e.displayOptions.layoutControls.logo.clickUrl,"_blank").focus()}))),e.displayOptions.layoutControls.logo.mouseOverImageUrl&&(n.addEventListener("mouseover",(function(){n.src=e.displayOptions.layoutControls.logo.mouseOverImageUrl}),!1),n.addEventListener("mouseout",(function(){n.src=e.displayOptions.layoutControls.logo.imageUrl}),!1)),e.domRef.player.parentNode.insertBefore(t,null),t.appendChild(n,null)},e.initHtmlOnPauseBlock=()=>{if(e.hasValidOnPauseAd())return;if(!e.displayOptions.layoutControls.htmlOnPauseBlock.html)return;const t=document.createElement("div");t.id=e.videoPlayerId+"_fluid_html_on_pause",t.className="fluid_html_on_pause",t.style.display="none",t.innerHTML=e.displayOptions.layoutControls.htmlOnPauseBlock.html,t.onclick=function(t){e.playPauseToggle()},e.displayOptions.layoutControls.htmlOnPauseBlock.width&&(t.style.width=e.displayOptions.layoutControls.htmlOnPauseBlock.width+"px"),e.displayOptions.layoutControls.htmlOnPauseBlock.height&&(t.style.height=e.displayOptions.layoutControls.htmlOnPauseBlock.height+"px"),e.domRef.player.parentNode.insertBefore(t,null)},e.initPlayButton=()=>{const t=document.createElement("div");t.id=e.videoPlayerId+"_fluid_initial_play_button",t.className="fluid_html_on_pause";const n=e.displayOptions.layoutControls.primaryColor?e.displayOptions.layoutControls.primaryColor:"#333333";t.innerHTML='<div id="'+e.videoPlayerId+'_fluid_initial_play" class="fluid_initial_play" style="background-color:'+n+'"><div id="'+e.videoPlayerId+'_fluid_state_button" class="fluid_initial_play_button"></div></div>';const r=["click","touchend"],i=function(){e.playPauseToggle(),r.forEach((e=>t.removeEventListener(e,i)))};r.forEach((e=>t.addEventListener(e,i))),e.displayOptions.layoutControls.playButtonShowing||(document.getElementById(e.videoPlayerId+"_fluid_controls_container").classList.add("initial_controls_show"),t.style.opacity="0"),e.domRef.player.parentNode.insertBefore(t,null)},e.mainVideoReady=()=>{if(0!==e.mainVideoDuration||e.isCurrentlyPlayingAd||!1!==e.mainVideoReadyState)return;const t=new CustomEvent("mainVideoDurationSet");e.mainVideoDuration=e.domRef.player.duration,e.mainVideoReadyState=!0,e.domRef.player.dispatchEvent(t),e.domRef.player.removeEventListener("loadedmetadata",e.mainVideoReady)},e.userActivityChecker=()=>{const t=e.domRef.wrapper;e.newActivity=null;let n=!1;const r=t=>{"touchstart"!==t.type&&"mousedown"!==t.type||(n=!0),"touchend"!==t.type&&"mouseup"!==t.type||(n=!1),e.newActivity=!0};setInterval((()=>{if(!0===e.newActivity){if(n||e.isLoading||(e.newActivity=!1),!1===e.isUserActive||!e.isControlBarVisible()){let t=new CustomEvent("userActive");e.domRef.player.dispatchEvent(t),e.isUserActive=!0}clearTimeout(e.inactivityTimeout),e.inactivityTimeout=setTimeout((()=>{if(!0===e.newActivity)return void clearTimeout(e.inactivityTimeout);e.isUserActive=!1;let t=new CustomEvent("userInactive");e.domRef.player.dispatchEvent(t)}),1e3*e.displayOptions.layoutControls.controlBar.autoHideTimeout)}}),300);const i=e.isTouchDevice()?["touchstart","touchmove","touchend"]:["mousemove","mousedown","mouseup"];for(let e=0;e<i.length;e++)t.addEventListener(i[e],r)},e.hasControlBar=()=>!!document.getElementById(e.videoPlayerId+"_fluid_controls_container"),e.isControlBarVisible=()=>{if(!1===e.hasControlBar())return!1;const t=document.getElementById(e.videoPlayerId+"_fluid_controls_container"),n=window.getComputedStyle(t,null);return!(0===n.opacity||"hidden"===n.visibility)},e.setVideoPreload=()=>{e.domRef.player.setAttribute("preload",e.displayOptions.layoutControls.preload)},e.hideControlBar=()=>{if(e.isCurrentlyPlayingAd&&!e.domRef.player.paused&&e.toggleAdCountdown(!0),e.domRef.player.style.cursor="none",!e.hasControlBar())return;const t=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),n=e.domRef.player.parentNode.getElementsByClassName("fp_logo");for(let n=0;n<t.length;n++)e.displayOptions.layoutControls.controlBar.animated?(t[n].classList.remove("fade_in"),t[n].classList.add("fade_out")):t[n].style.display="none";if(e.displayOptions.layoutControls.logo.hideWithControls)for(let t=0;t<n.length;t++)e.displayOptions.layoutControls.controlBar.animated?n[t]&&(n[t].classList.remove("fade_in"),n[t].classList.add("fade_out")):n[t]&&(n[t].style.display="none")},e.showControlBar=t=>{if(e.isCurrentlyPlayingAd&&!e.domRef.player.paused&&e.toggleAdCountdown(!1),"mouseenter"!==t.type&&"userActive"!==t.type||(e.domRef.player.style.cursor="default"),!e.hasControlBar())return;const n=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_container"),r=e.domRef.player.parentNode.getElementsByClassName("fp_logo");for(let t=0;t<n.length;t++)e.displayOptions.layoutControls.controlBar.animated?(n[t].classList.remove("fade_out"),n[t].classList.add("fade_in")):n[t].style.display="block";if(e.displayOptions.layoutControls.logo.hideWithControls)for(let t=0;t<r.length;t++)e.displayOptions.layoutControls.controlBar.animated?r[t]&&(r[t].classList.remove("fade_out"),r[t].classList.add("fade_in")):r[t]&&(r[t].style.display="block")},e.linkControlBarUserActivity=()=>{e.domRef.player.addEventListener("userInactive",e.hideControlBar),e.domRef.player.addEventListener("userInactive",e.hideTitle),e.domRef.player.addEventListener("userActive",e.showControlBar),e.domRef.player.addEventListener("userActive",e.showTitle)},e.initMute=()=>{!0===e.displayOptions.layoutControls.mute&&(e.domRef.player.volume=0)},e.initLoop=()=>{e.domRef.player.loop=!!e.displayOptions.layoutControls.loop},e.setBuffering=()=>{let t;const n=e.domRef.player.parentNode.getElementsByClassName("fluid_controls_buffered");for(let e=0;e<n.length;e++)n[e].style.width=0;t=setInterval((()=>{const r=e.domRef.player.duration;if(!(r<=0))for(let i=0;i<e.domRef.player.buffered.length;i++){if(e.domRef.player.buffered.start(e.domRef.player.buffered.length-1-i)>=e.domRef.player.currentTime)continue;const o=e.domRef.player.buffered.end(e.domRef.player.buffered.length-1-i)/r*100+"%";for(let e=0;e<n.length;e++)n[e].style.width=o;t&&1==e.domRef.player.buffered.end(e.domRef.player.buffered.length-1-i)/r&&clearInterval(t);break}}),500)},e.createPlaybackList=()=>{if(!e.displayOptions.layoutControls.playbackRateEnabled)return;document.getElementById(e.videoPlayerId+"_fluid_control_playback_rate").style.display="inline-block";const t=document.getElementById(e.videoPlayerId+"_fluid_control_playback_rate"),n=document.createElement("div");n.id=e.videoPlayerId+"_fluid_control_video_playback_rate",n.className="fluid_video_playback_rates",n.style.display="none",Array.isArray(e.displayOptions.layoutControls.controlBar.playbackRates)&&!e.displayOptions.layoutControls.controlBar.playbackRates.some((e=>"string"!=typeof e||Number.isNaN(Number(e.replace("x","")))))||(e.displayOptions.layoutControls.controlBar.playbackRates=["x2","x1.5","x1","x0.5"]),e.displayOptions.layoutControls.controlBar.playbackRates.forEach((function(t){const r=document.createElement("div");r.className="fluid_video_playback_rates_item",r.innerText=t,r.addEventListener("click",(function(t){t.stopPropagation();let n=this.innerText.replace("x","");e.setPlaybackSpeed(n),e.openCloseVideoPlaybackRate()})),n.appendChild(r)})),t.appendChild(n),t.addEventListener("click",(function(){e.openCloseVideoPlaybackRate()}))},e.openCloseVideoPlaybackRate=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_video_playback_rate");if(e.isCurrentlyPlayingAd||"none"!==t.style.display)return void(t.style.display="none");t.style.display="block";const n=function(){t.removeEventListener("mouseleave",n),t.style.display="none"};t.addEventListener("mouseleave",n)},e.createDownload=()=>{const t=document.getElementById(e.videoPlayerId+"_fluid_control_download");if(!e.displayOptions.layoutControls.allowDownload)return;t.style.display="inline-block";let n=document.createElement("a");n.id=e.videoPlayerId+"_download",n.onclick=function(e){const t=this;void 0!==e.stopImmediatePropagation&&e.stopImmediatePropagation(),setInterval((function(){t.download="",t.href=""}),100)},t.appendChild(n),t.addEventListener("click",(function(){const t=document.getElementById(e.videoPlayerId+"_download");t.download=e.originalSrc,t.href=e.originalSrc,n.click()}))},e.theatreToggle=()=>{if(e.debugMessage("Toggling Theater Mode"),e.isInIframe)return;if(this.resetDisplayMode("theaterMode"),e.displayOptions.layoutControls.theatreAdvanced){const t=document.getElementById(e.displayOptions.layoutControls.theatreAdvanced.theatreElement),n=e.displayOptions.layoutControls.theatreAdvanced.classToApply;null!=t&&null!=n?(e.theatreMode?t.classList.remove(n):t.classList.add(n),e.theatreModeAdvanced=!e.theatreModeAdvanced):(console.log("[FP_ERROR] Theatre mode elements could not be found, defaulting behaviour."),e.defaultTheatre())}else e.defaultTheatre();e.theatreMode=!e.theatreMode,e.fluidStorage.fluidTheatre=e.theatreMode;const t=e.theatreMode?"theatreModeOn":"theatreModeOff",n=document.createEvent("CustomEvent");n.initEvent(t,!1,!0),e.domRef.player.dispatchEvent(n),e.resizeVpaidAuto()},e.defaultTheatre=()=>{const t=document.getElementById("fluid_video_wrapper_"+e.videoPlayerId);if(e.theatreMode)return t.classList.remove("fluid_theatre_mode"),t.style.maxHeight="",t.style.marginTop="",t.style.left="",t.style.right="",t.style.position="",void(e.displayOptions.layoutControls.fillToContainer?(t.style.width="100%",t.style.height="100%"):(t.style.width=e.originalWidth+"px",t.style.height=e.originalHeight+"px"));t.classList.add("fluid_theatre_mode");const n=e.displayOptions.layoutControls.theatreSettings.width;let r="10px";switch(t.style.width=n,t.style.height=e.displayOptions.layoutControls.theatreSettings.height,t.style.maxHeight=screen.height+"px",t.style.marginTop=e.displayOptions.layoutControls.theatreSettings.marginTop+"px",e.displayOptions.layoutControls.theatreSettings.horizontalAlign){case"center":"string"==typeof n&&"%"===n.substr(n.length-1)?r=(100-parseInt(n.substring(0,n.length-1)))/2+"%":"string"==typeof n&&"px"===n.substr(n.length-2)?r=(screen.width-parseInt(n.substring(0,n.length-2)))/screen.width*100/2+"%":console.log("[FP_ERROR] Theatre width specified invalid."),t.style.left=r;break;case"right":t.style.right=r;break;default:t.style.left=r}},e.posterImage=()=>{if(!e.displayOptions.layoutControls.posterImage)return;const t=document.createElement("div");t.id=e.videoPlayerId+"_fluid_pseudo_poster",t.className="fluid_pseudo_poster",-1!==["auto","contain","cover"].indexOf(e.displayOptions.layoutControls.posterImageSize)?(t.style.background="url('"+e.displayOptions.layoutControls.posterImage+"') center center / "+e.displayOptions.layoutControls.posterImageSize+" no-repeat black",e.domRef.player.parentNode.insertBefore(t,null)):console.log("[FP_ERROR] Not allowed value in posterImageSize")},e.nextSource=()=>{const t=e.domRef.player.getElementsByTagName("source");if(!t.length)return null;for(let n=0;n<t.length-1;n++)if(t[n].getAttribute("src")===e.originalSrc&&t[n+1].getAttribute("src"))return void e.setVideoSource(t[n+1].getAttribute("src"))},e.inIframe=()=>{try{return window.self!==window.top}catch(e){return!0}},e.setPersistentSettings=()=>{try{if("undefined"==typeof Storage||"undefined"==typeof localStorage)return}catch(e){return}const t="_fp_storage_enabled",n=localStorage;try{n.setItem(t,"1"),n.removeItem(t)}catch(e){return!1}if(e.fluidStorage=localStorage,void 0!==e.fluidStorage.fluidVolume&&e.displayOptions.layoutControls.persistentSettings.volume&&(e.setVolume(e.fluidStorage.fluidVolume),void 0!==e.fluidStorage.fluidMute&&"true"===e.fluidStorage.fluidMute&&e.muteToggle()),void 0!==e.fluidStorage.fluidQuality&&e.displayOptions.layoutControls.persistentSettings.quality){const t=document.getElementById("source_"+e.videoPlayerId+"_"+e.fluidStorage.fluidQuality),n=document.getElementById(e.videoPlayerId+"_fluid_control_video_source");t&&(t.click(),n.click())}void 0!==e.fluidStorage.fluidSpeed&&e.displayOptions.layoutControls.persistentSettings.speed&&e.setPlaybackSpeed(e.fluidStorage.fluidSpeed),void 0!==e.fluidStorage.fluidTheatre&&"true"===e.fluidStorage.fluidTheatre&&e.displayOptions.layoutControls.persistentSettings.theatre&&e.theatreToggle()},e.play=()=>{if(e.domRef.player.paused)return e.playPauseToggle(),!0},e.pause=()=>(e.domRef.player.paused||e.playPauseToggle(),!0),e.skipTo=t=>{e.domRef.player.currentTime=t},e.setPlaybackSpeed=t=>{e.isCurrentlyPlayingAd||(e.domRef.player.playbackRate=t,e.fluidStorage.fluidSpeed=t)},e.setVolume=t=>{e.domRef.player.volume=t;const n=0===t?1:t;e.latestVolume=n,e.fluidStorage.fluidVolume=n},e.isCurrentlyPlayingVideo=e=>e&&e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2,e.setHtmlOnPauseBlock=t=>{if("object"!=typeof t||void 0===t.html)return!1;const n=document.getElementById(e.videoPlayerId+"_fluid_html_on_pause");if(!n){const n=document.createElement("div");return n.id=e.videoPlayerId+"_fluid_html_on_pause",n.className="fluid_html_on_pause",n.style.display="none",n.innerHTML=t.html,n.onclick=function(){e.playPauseToggle()},t.width&&(n.style.width=t.width+"px"),t.height&&(n.style.height=t.height+"px"),void e.domRef.player.parentNode.insertBefore(n,null)}n.innerHTML=t.html,t.width&&(n.style.width=t.width+"px"),t.height&&(n.style.height=t.height+"px")},e.toggleControlBar=t=>{const n=document.getElementById(e.videoPlayerId+"fluid_controls_container");t?n.className+=" initial_controls_show":n.className=n.className.replace(" initial_controls_show","")},e.on=(t,n)=>{switch(t){case"play":e.domRef.player.onplay=n;break;case"seeked":e.domRef.player.onseeked=n;break;case"ended":e.domRef.player.onended=n;break;case"pause":e.domRef.player.addEventListener("pause",(()=>{e.fluidPseudoPause||n()}));break;case"playing":e.domRef.player.addEventListener("playing",n);break;case"theatreModeOn":e.domRef.player.addEventListener("theatreModeOn",n);break;case"theatreModeOff":e.domRef.player.addEventListener("theatreModeOff",n);break;case"timeupdate":e.domRef.player.addEventListener("timeupdate",(()=>{n(e.getCurrentTime())}));break;case"miniPlayerToggle":e.domRef.player.addEventListener("miniPlayerToggle",n);break;default:console.log("[FP_ERROR] Event not recognised")}},e.toggleLogo=t=>{if("object"!=typeof t||!t.imageUrl)return!1;const n=document.getElementById(e.videoPlayerId+"_logo");e.displayOptions.layoutControls.logo.imageUrl=t.imageUrl?t.imageUrl:null,e.displayOptions.layoutControls.logo.position=t.position?t.position:"top left",e.displayOptions.layoutControls.logo.clickUrl=t.clickUrl?t.clickUrl:null,e.displayOptions.layoutControls.logo.opacity=t.opacity?t.opacity:1,e.displayOptions.layoutControls.logo.mouseOverImageUrl=t.mouseOverImageUrl?t.mouseOverImageUrl:null,e.displayOptions.layoutControls.logo.imageMargin=t.imageMargin?t.imageMargin:"2px",e.displayOptions.layoutControls.logo.hideWithControls=!!t.hideWithControls&&t.hideWithControls,e.displayOptions.layoutControls.logo.showOverAds=!!t.showOverAds&&t.showOverAds,n&&n.remove(),e.initLogo()},e.trackEvent=(t,n,r,i)=>{void 0===e.events[r]&&(e.events[r]={}),void 0===e.events[r][n]&&(e.events[r][n]=[]),e.events[r][n].push(i),e.registerListener(t,n,r,i)},e.registerListener=(e,t,n,r)=>{const i=e.querySelectorAll(n);for(let e=0;e<i.length;e++)i[e].addEventListener(t,r)},e.copyEvents=t=>{for(let n in e.events)if(e.events.hasOwnProperty(n))for(let r in e.events[n])if(e.events[n].hasOwnProperty(r))for(let i=0;i<e.events[n][r].length;i++)e.registerListener(t,r,n,e.events[n][r][i])},e.resetDisplayMode=t=>{e.fullscreenMode&&"fullScreen"!==t&&e.fullscreenToggle(),e.theatreMode&&"theaterMode"!==t&&e.theatreToggle(),e.miniPlayerToggledOn&&"miniPlayer"!==t&&e.toggleMiniPlayer("off")},e.destroy=()=>{const t=e.destructors.length;if(0===t)return;for(let n=0;n<t;++n)e.destructors[n].bind(this)();const n=document.getElementById("fluid_video_wrapper_"+e.videoPlayerId);n?"function"!=typeof n.remove?n.parentNode?n.parentNode.removeChild(n):console.error("Unable to remove wrapper element for Fluid Player instance - no parent"+e.videoPlayerId):n.remove():console.warn("Unable to remove wrapper element for Fluid Player instance - element not found "+e.videoPlayerId)}},c=function(e){this.play=()=>e.play(),this.pause=()=>e.pause(),this.skipTo=t=>e.skipTo(t),this.setPlaybackSpeed=t=>e.setPlaybackSpeed(t),this.setVolume=t=>e.setVolume(t),this.setHtmlOnPauseBlock=t=>e.setHtmlOnPauseBlock(t),this.toggleControlBar=t=>e.toggleControlBar(t),this.toggleFullScreen=t=>e.fullscreenToggle(t),this.toggleMiniPlayer=t=>(void 0===t&&(t=!e.miniPlayerToggledOn),e.toggleMiniPlayer(t?"on":"off",!0)),this.destroy=()=>e.destroy(),this.dashInstance=()=>e.dashPlayer?e.dashPlayer:null,this.hlsInstance=()=>e.hlsPlayer?e.hlsPlayer:null,this.on=(t,n)=>e.on(t,n),this.setDebug=t=>{e.displayOptions.debug=t}};a&&console.log("Fluid Player - Development Build"+(s?" (in debug mode)":""));if("undefined"==typeof FP_HOMEPAGE&&(globalThis.FP_HOMEPAGE="https://fluidplayer.com"),"undefined"==typeof FP_BUILD_VERSION&&(globalThis.FP_BUILD_VERSION="v3"),"undefined"==typeof FP_ENV){const e=window&&window.location&&("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||""===window.location.hostname);"undefined"!=typeof process&&process&&process.env||window&&!e?globalThis.FP_ENV="production":globalThis.FP_ENV="development"}"undefined"==typeof FP_DEBUG&&(globalThis.FP_DEBUG=!1);const d=function(e,t){const n=new u;t||(t={}),n.init(e,t);const r=new c(n);if(window&&a){const i={id:e,options:t,instance:r,internals:n};void 0===window.fluidPlayerDebug&&(window.fluidPlayerDebug=[]),window.fluidPlayerDebug.push(i),console.log("Created instance of Fluid Player. Debug API available at window.fluidPlayerDebug["+(window.fluidPlayerDebug.length-1)+"].",i)}return r}},3751:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var r=function(e,t){var n=/[\u0020\t\f]/,r=/[^\u0020\t\f]/,i=0,o=function(e){t(e,i+1)};function a(t){for(;null!=e[i]&&t.test(e[i]);)i++}function s(t){for(var n="";null!=e[i]&&t.test(e[i]);)n+=e[i],i++;return n}function l(){var t,n,r,a,l="minutes";if(null!=e[i])if(/\d/.test(e[i]))if(((t=s(/\d/)).length>2||parseInt(t,10)>59)&&(l="hours"),":"==e[i])if(i++,2==(n=s(/\d/)).length){if("hours"==l||":"==e[i]){if(":"!=e[i])return void o("No seconds found or minutes is greater than 59.");if(i++,2!=(r=s(/\d/)).length)return void o("Must be exactly two digits.")}else r=n,n=t,t="0";if("."==e[i])if(i++,3==(a=s(/\d/)).length)if(parseInt(n,10)>59)o("You cannot have more than 59 minutes.");else{if(!(parseInt(r,10)>59))return 60*parseInt(t,10)*60+60*parseInt(n,10)+parseInt(r,10)+parseInt(a,10)/1e3;o("You cannot have more than 59 seconds.")}else o("Milliseconds must be given in three digits.");else o('No decimal separator (".") found.')}else o("Must be exactly two digits.");else o("No time unit separator found.");else o("Timestamp must start with a character in the range 0-9.");else o("No timestamp found.")}this.parse=function(t,s){if(a(n),t.startTime=l(),null!=t.startTime)if(t.startTime<s&&o("Start timestamp is not greater than or equal to start timestamp of previous cue."),r.test(e[i])&&o("Timestamp not separated from '--\x3e' by whitespace."),a(n),"-"==e[i])if(i++,"-"==e[i])if(i++,">"==e[i]){if(i++,r.test(e[i])&&o("'--\x3e' not separated from timestamp by whitespace."),a(n),t.endTime=l(),null!=t.endTime)return t.endTime<=t.startTime&&o("End timestamp is not greater than start timestamp."),r.test(e[i]),a(n),function(e,t){for(var r=e.split(n),i=[],a=0;a<r.length;a++)if(""!=r[a]){var s=r[a].indexOf(":"),l=r[a].slice(0,s);if(value=r[a].slice(s+1),-1!=i.indexOf(l)&&o("Duplicate setting."),i.push(l),""==value)return void o("No value for setting defined.");if("vertical"==l){if("rl"!=value&&"lr"!=value){o("Writing direction can only be set to 'rl' or 'rl'.");continue}t.direction=value}else if("line"==l){if(!/\d/.test(value)){o("Line position takes a number or percentage.");continue}if(-1!=value.indexOf("-",1)){o("Line position can only have '-' at the start.");continue}if(-1!=value.indexOf("%")&&value.indexOf("%")!=value.length-1){o("Line position can only have '%' at the end.");continue}if("-"==value[0]&&"%"==value[value.length-1]){o("Line position cannot be a negative percentage.");continue}if("%"==value[value.length-1]){if(parseInt(value,10)>100){o("Line position cannot be >100%.");continue}t.snapToLines=!1}t.linePosition=parseInt(value,10)}else if("position"==l){if("%"!=value[value.length-1]){o("Text position must be a percentage.");continue}if(parseInt(value,10)>100){o("Size cannot be >100%.");continue}t.textPosition=parseInt(value,10)}else if("size"==l){if("%"!=value[value.length-1]){o("Size must be a percentage.");continue}if(parseInt(value,10)>100){o("Size cannot be >100%.");continue}t.size=parseInt(value,10)}else if("align"==l){var u=["start","middle","end","left","right"];if(-1==u.indexOf(value)){o("Alignment can only be set to one of "+u.join(", ")+".");continue}t.alignment=value}else o("Invalid setting.")}}(e.substring(i),t),!0}else o("No valid timestamp separator found.");else o("No valid timestamp separator found.");else o("No valid timestamp separator found.")},this.parseTimestamp=function(){var t=l();if(null==e[i])return t;o("Timestamp must not have trailing characters.")}},i=function(e,t,n){var i=0,o=function(e){"metadata"!=n&&t(e,i+1)};function a(){for(var t="data",n="",r="",a=[];null!=e[i-1]||0==i;){var s=e[i];if("data"==t)if("&"==s)r=s,t="escape";else if("<"==s&&""==n)t="tag";else{if("<"==s||null==s)return["text",n];n+=s}else if("escape"==t)if("&"==s)o("Incorrect escape."),n+=r,r=s;else if(/[abglmnsprt]/.test(s))r+=s;else if(";"==s)"&amp"==r?n+="&":"&lt"==r?n+="<":"&gt"==r?n+=">":"&lrm"==r?n+="â":"&rlm"==r?n+="â":"&nbsp"==r?n+="Â ":(o("Incorrect escape."),n+=r+";"),t="data";else{if("<"==s||null==s)return o("Incorrect escape."),["text",n+=r];o("Incorrect escape."),n+=r+s,t="data"}else if("tag"==t)if("\t"==s||"\n"==s||"\f"==s||" "==s)t="start tag annotation";else if("."==s)t="start tag class";else if("/"==s)t="end tag";else if(/\d/.test(s))n=s,t="timestamp tag";else{if(">"==s||null==s)return">"==s&&i++,["start tag","",[],""];n=s,t="start tag"}else if("start tag"==t)if("\t"==s||"\f"==s||" "==s)t="start tag annotation";else if("\n"==s)r=s,t="start tag annotation";else if("."==s)t="start tag class";else{if(">"==s||null==s)return">"==s&&i++,["start tag",n,[],""];n+=s}else if("start tag class"==t)if("\t"==s||"\f"==s||" "==s)a.push(r),r="",t="start tag annotation";else if("\n"==s)a.push(r),r=s,t="start tag annotation";else if("."==s)a.push(r),r="";else{if(">"==s||null==s)return">"==s&&i++,a.push(r),["start tag",n,a,""];r+=s}else if("start tag annotation"==t){if(">"==s||null==s)return">"==s&&i++,["start tag",n,a,r=r.split(/[\u0020\t\f\r\n]+/).filter((function(e){if(e)return!0})).join(" ")];r+=s}else if("end tag"==t){if(">"==s||null==s)return">"==s&&i++,["end tag",n];n+=s}else if("timestamp tag"==t){if(">"==s||null==s)return">"==s&&i++,["timestamp",n];n+=s}else o("Never happens.");i++}}this.parse=function(t,s){var l={children:[]},u=l,c=[];function d(e){u.children.push({type:"object",name:e[1],classes:e[2],children:[],parent:u}),u=u.children[u.children.length-1]}function h(e){for(var t=u;t;){if(t.name==e)return!0;t=t.parent}}for(;null!=e[i];){var p=a();if("text"==p[0])u.children.push({type:"text",value:p[1],parent:u});else if("start tag"==p[0]){"chapters"==n&&o("Start tags not allowed in chapter title text.");var f=p[1];"v"!=f&&"lang"!=f&&""!=p[3]&&o("Only <v> and <lang> can have an annotation."),"c"==f||"i"==f||"b"==f||"u"==f||"ruby"==f||"rt"==f&&"ruby"==u.name?d(p):"v"==f?(h("v")&&o("<v> cannot be nested inside itself."),d(p),u.value=p[3],p[3]||o("<v> requires an annotation.")):"lang"==f?(d(p),u.value=p[3]):o("Incorrect start tag.")}else if("end tag"==p[0])"chapters"==n&&o("End tags not allowed in chapter title text."),p[1]==u.name?u=u.parent:"ruby"==p[1]&&"rt"==u.name?u=u.parent.parent:o("Incorrect end tag.");else if("timestamp"==p[0]){"chapters"==n&&o("Timestamp not allowed in chapter title text.");var m=new r(p[1],o).parseTimestamp();null!=m&&((m<=t||m>=s)&&o("Timestamp must be between start timestamp and end timestamp."),c.length>0&&c[c.length-1]>=m&&o("Timestamp must be greater than any previous timestamp."),u.children.push({type:"timestamp",value:m,parent:u}),c.push(m))}}for(;u.parent;)"v"!=u.name&&o("Required end tag missing."),u=u.parent;return l}};const o=function(){this.parse=function(e,t){var n=Date.now(),o=0,a=e.split(/\r\n|\r|\n/),s=!1,l=[],u=[];function c(e,t){u.push({message:e,line:o+1,col:t})}var d=a[o],h=d.length,p=0,f=6;for("\ufeff"===d[0]&&(p=1,f+=1),(h<f||d.indexOf("WEBVTT")!==0+p||h>f&&" "!==d[f]&&"\t"!==d[f])&&c('No valid signature. (File needs to start with "WEBVTT".)'),o++;""!=a[o]&&null!=a[o];){if(c("No blank line after the signature."),-1!=a[o].indexOf("--\x3e")){s=!0;break}o++}for(;null!=a[o];){for(var m;!s&&""==a[o];)o++;if(!s&&null==a[o])break;m={id:"",startTime:0,endTime:0,pauseOnExit:!1,direction:"horizontal",snapToLines:!0,linePosition:"auto",textPosition:50,size:100,alignment:"middle",text:"",tree:null};var g=!0;if(-1==a[o].indexOf("--\x3e")){if(m.id=a[o],/^NOTE($|[ \t])/.test(m.id)){for(o++;""!=a[o]&&null!=a[o];)-1!=a[o].indexOf("--\x3e")&&c("Cannot have timestamp in a comment."),o++;continue}if(""==a[++o]||null==a[o]){c("Cue identifier cannot be standalone.");continue}-1==a[o].indexOf("--\x3e")&&(g=!1,c("Cue identifier needs to be followed by timestamp."))}s=!1;var y=new r(a[o],c),v=0;if(l.length>0&&(v=l[l.length-1].startTime),!g||y.parse(m,v)){for(o++;""!=a[o]&&null!=a[o];){if(-1!=a[o].indexOf("--\x3e")){c("Blank line missing before cue."),s=!0;break}""!=m.text&&(m.text+="\n"),m.text+=a[o],o++}var b=new i(m.text,c,t);m.tree=b.parse(m.startTime,m.endTime),l.push(m)}else for(m=null,o++;""!=a[o]&&null!=a[o];){if(-1!=a[o].indexOf("--\x3e")){s=!0;break}o++}}return l.sort((function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:e.endTime>t.endTime?-1:e.endTime<t.endTime?1:0})),{cues:l,errors:u,time:Date.now()-n}}}},9144:(e,t,n)=>{var r,i=void 0!==n.g?n.g:"undefined"!=typeof window?window:{},o=n(5893);"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=o),e.exports=r},8908:(e,t,n)=>{var r;r="undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},e.exports=r},81:e=>{e.exports=function(e,t){if(e===t)return!0;for(var n in e)if(!(n in t))return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0}},2705:(e,t,n)=>{var r=n(5639).Symbol;e.exports=r},4239:(e,t,n)=>{var r=n(2705),i=n(9607),o=n(2333),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},7561:(e,t,n)=>{var r=n(7990),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},1957:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},9607:(e,t,n)=>{var r=n(2705),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5639:(e,t,n)=>{var r=n(1957),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},7990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},3279:(e,t,n)=>{var r=n(3218),i=n(7771),o=n(4841),a=Math.max,s=Math.min;e.exports=function(e,t,n){var l,u,c,d,h,p,f=0,m=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=l,r=u;return l=u=void 0,f=t,d=e.apply(r,n)}function b(e){var n=e-p;return void 0===p||n>=t||n<0||g&&e-f>=c}function _(){var e=i();if(b(e))return E(e);h=setTimeout(_,function(e){var n=t-(e-p);return g?s(n,c-(e-f)):n}(e))}function E(e){return h=void 0,y&&l?v(e):(l=u=void 0,d)}function w(){var e=i(),n=b(e);if(l=arguments,u=this,p=e,n){if(void 0===h)return function(e){return f=e,h=setTimeout(_,t),m?v(e):d}(p);if(g)return clearTimeout(h),h=setTimeout(_,t),v(p)}return void 0===h&&(h=setTimeout(_,t)),d}return t=o(t)||0,r(n)&&(m=!!n.leading,c=(g="maxWait"in n)?a(o(n.maxWait)||0,t):c,y="trailing"in n?!!n.trailing:y),w.cancel=function(){void 0!==h&&clearTimeout(h),f=0,l=p=u=h=void 0},w.flush=function(){return void 0===h?d:E(i())},w}},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3448:(e,t,n)=>{var r=n(4239),i=n(7005);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},7771:(e,t,n)=>{var r=n(5639);e.exports=function(){return r.Date.now()}},3493:(e,t,n)=>{var r=n(3279),i=n(3218);e.exports=function(e,t,n){var o=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),r(e,t,{leading:o,maxWait:t,trailing:a})}},4841:(e,t,n)=>{var r=n(7561),i=n(3218),o=n(3448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||l.test(e)?u(e.slice(2),n?2:8):a.test(e)?NaN:+e}},9650:(e,t,n)=>{"use strict";function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:()=>d});var o,a,s,l,u,c=(o=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],a=function(){function e(t){var n=t.targetModal,i=t.triggers,o=void 0===i?[]:i,a=t.onShow,s=void 0===a?function(){}:a,l=t.onClose,u=void 0===l?function(){}:l,c=t.openTrigger,d=void 0===c?"data-micromodal-trigger":c,h=t.closeTrigger,p=void 0===h?"data-micromodal-close":h,f=t.openClass,m=void 0===f?"is-open":f,g=t.disableScroll,y=void 0!==g&&g,v=t.disableFocus,b=void 0!==v&&v,_=t.awaitCloseAnimation,E=void 0!==_&&_,w=t.awaitOpenAnimation,T=void 0!==w&&w,A=t.debugMode,S=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modal=document.getElementById(n),this.config={debugMode:S,disableScroll:y,openTrigger:d,closeTrigger:p,openClass:m,onShow:s,onClose:u,awaitCloseAnimation:E,awaitOpenAnimation:T,disableFocus:b},o.length>0&&this.registerTriggers.apply(this,r(o)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var t;return(t=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation?this.modal.addEventListener("animationend",(function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()}),!1):this.setFocusToFirstNode(),this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var n=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(n),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(o);return Array.apply(void 0,r(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var n=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));n.length>0&&n[0].focus(),0===n.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var n=t.indexOf(document.activeElement);e.shiftKey&&0===n&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&n===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}(),s=null,l=function(e){if(!document.getElementById(e))return console.warn("MicroModal: âSeems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},u=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: âPlease specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var n in t)l(n);return!0},{init:function(e){var t=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=r(document.querySelectorAll("[".concat(t.openTrigger,"]"))),i=function(e,t){var n=[];return e.forEach((function(e){var r=e.attributes[t].value;void 0===n[r]&&(n[r]=[]),n[r].push(e)})),n}(n,t.openTrigger);if(!0!==t.debugMode||!1!==u(n,i))for(var o in i){var l=i[o];t.targetModal=o,t.triggers=r(l),s=new a(t)}},show:function(e,t){var n=t||{};n.targetModal=e,!0===n.debugMode&&!1===l(e)||(s&&s.removeEventListeners(),(s=new a(n)).showModal())},close:function(e){e?s.closeModalById(e):s.closeModal()}});"undefined"!=typeof window&&(window.MicroModal=c);const d=c},4193:(e,t,n)=>{var r=n(1196),i=/[\/\+\.]/;e.exports=function(e,t){function n(t){var n=r(t,e,i);return n&&n.length>=2}return t?n(t.split(";")[0]):n}},4800:e=>{e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,n,r,i,o,a,s){var l=function(e){for(var n=t[e]?t[e]:[],r=e.indexOf(":"),i=-1===r?[e]:[e.substring(0,r),e.substring(r+1)],o=Object.keys(t),a=0,s=o.length;a<s;a++){var l=o[a];if("*"===l&&(n=n.concat(t[l])),2===i.length&&i[0]===l){n=n.concat(t[l]);break}}return n}(e);l.length&&function(e,t,n){for(var r=0,i=t.length;r<i&&t[r];r++)t[r].event=e,t[r].apply(t[r],n)}(e,l,[n,r,i,o,a,s])},e.on=function(e,n){t[e]||(t[e]=[]),t[e].push(n)},e.once=function(t,n){this.on(t,(function r(){n.apply(this,arguments),e.off(t,r)}))},e.off=function(e,t){var n=[];if(e&&t)for(var r=this._fns[e],i=0,o=r?r.length:0;i<o;i++)r[i]!==t&&n.push(r[i]);n.length?this._fns[e]=n:delete this._fns[e]},e}},9204:e=>{e.exports=function e(n,r){if(!n){var i=new t(r);throw Error.captureStackTrace&&Error.captureStackTrace(i,e),i}};class t extends Error{}t.prototype.name="AssertionError"},372:(e,t,n)=>{"use strict";function r(){}n.r(t),n.d(t,{BasicPanorama:()=>uc,CONTROLS:()=>qu,CameraPanorama:()=>gc,CubePanorama:()=>lc,CubeTextureLoader:()=>Xu,DataImage:()=>Yu,EmptyPanorama:()=>sc,GoogleStreetviewPanorama:()=>hc,ImageLittlePlanet:()=>mc,ImageLoader:()=>Ku,ImagePanorama:()=>ac,Infospot:()=>rc,LittlePlanet:()=>fc,MODES:()=>Wu,Media:()=>Qu,Panorama:()=>oc,REVISION:()=>Vu,Reticle:()=>Ju,THREE_REVISION:()=>Hu,THREE_VERSION:()=>Zu,TextureLoader:()=>$u,VERSION:()=>ju,VideoPanorama:()=>cc,Viewer:()=>Ec,Widget:()=>ic}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(r.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var i,o,a,s="105",l={LEFT:0,MIDDLE:1,RIGHT:2},u=0,c=1,d=2,h=1,p=2,f=0,m=1,g=2,y=0,v=0,b=1,_=2,E=3,w=4,T=5,A=100,S=101,x=102,I=103,R=104,C=200,M=201,L=202,P=203,D=204,O=205,N=206,k=207,F=208,B=209,U=210,z=0,G=1,V=2,j=3,H=4,Z=5,q=6,W=7,Y=0,K=1,$=2,X=0,Q=1,J=2,ee=3,te=4,ne=5,re=301,ie=302,oe=303,ae=304,se=305,le=306,ue=307,ce=1e3,de=1001,he=1002,pe=1003,fe=1004,me=1005,ge=1006,ye=1007,ve=1008,be=1009,_e=1010,Ee=1011,we=1012,Te=1013,Ae=1014,Se=1015,xe=1016,Ie=1017,Re=1018,Ce=1019,Me=1020,Le=1021,Pe=1022,De=1023,Oe=1024,Ne=1025,ke=1026,Fe=1027,Be=1028,Ue=33776,ze=33777,Ge=33778,Ve=33779,je=35840,He=35841,Ze=35842,qe=35843,We=36196,Ye=37808,Ke=37809,$e=37810,Xe=37811,Qe=37812,Je=37813,et=37814,tt=37815,nt=37816,rt=37817,it=37818,ot=37819,at=37820,st=37821,lt=2300,ut=2301,ct=2302,dt=2400,ht=2401,pt=2402,ft=0,mt=1,gt=2,yt=3e3,vt=3001,bt=3007,_t=3002,Et=3004,wt=3005,Tt=3006,At=3200,St=3201,xt=0,It=1,Rt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&n]+e[n>>8&255]+"-"+e[n>>16&15|64]+e[n>>24&255]+"-"+e[63&r|128]+e[r>>8&255]+"-"+e[r>>16&255]+e[r>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Rt.DEG2RAD},radToDeg:function(e){return e*Rt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Ct(e,t){this.x=e||0,this.y=t||0}function Mt(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function Lt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function Pt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ct.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Ct.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}}),Object.assign(Mt,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,o,a){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],d=i[o+0],h=i[o+1],p=i[o+2],f=i[o+3];if(c!==f||s!==d||l!==h||u!==p){var m=1-a,g=s*d+l*h+u*p+c*f,y=g>=0?1:-1,v=1-g*g;if(v>Number.EPSILON){var b=Math.sqrt(v),_=Math.atan2(b,g*y);m=Math.sin(m*_)/b,a=Math.sin(a*_)/b}var E=a*y;if(s=s*m+d*E,l=l*m+h*E,u=u*m+p*E,c=c*m+f*E,m===1-a){var w=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=w,l*=w,u*=w,c*=w}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(Mt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Mt.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,l=a(n/2),u=a(r/2),c=a(i/2),d=s(n/2),h=s(r/2),p=s(i/2);return"XYZ"===o?(this._x=d*u*c+l*h*p,this._y=l*h*c-d*u*p,this._z=l*u*p+d*h*c,this._w=l*u*c-d*h*p):"YXZ"===o?(this._x=d*u*c+l*h*p,this._y=l*h*c-d*u*p,this._z=l*u*p-d*h*c,this._w=l*u*c+d*h*p):"ZXY"===o?(this._x=d*u*c-l*h*p,this._y=l*h*c+d*u*p,this._z=l*u*p+d*h*c,this._w=l*u*c-d*h*p):"ZYX"===o?(this._x=d*u*c-l*h*p,this._y=l*h*c+d*u*p,this._z=l*u*p-d*h*c,this._w=l*u*c+d*h*p):"YZX"===o?(this._x=d*u*c+l*h*p,this._y=l*h*c+d*u*p,this._z=l*u*p-d*h*c,this._w=l*u*c-d*h*p):"XZY"===o&&(this._x=d*u*c-l*h*p,this._y=l*h*c-d*u*p,this._z=l*u*p+d*h*c,this._w=l*u*c+d*h*p),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],l=n[9],u=n[2],c=n[6],d=n[10],h=r+s+d;return h>0?(t=.5/Math.sqrt(h+1),this._w=.25/t,this._x=(c-l)*t,this._y=(o-u)*t,this._z=(a-i)*t):r>s&&r>d?(t=2*Math.sqrt(1+r-s-d),this._w=(c-l)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>d?(t=2*Math.sqrt(1+s-r-d),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+d-r-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Rt.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+o*a+r*l-i*s,this._y=r*u+o*s+i*a-n*l,this._z=i*u+o*l+n*s-r*a,this._w=o*u-n*a-r*s-i*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var l=1-t;return this._w=l*o+t*this._w,this._x=l*n+t*this._x,this._y=l*r+t*this._y,this._z=l*i+t*this._z,this.normalize()}var u=Math.sqrt(s),c=Math.atan2(u,a),d=Math.sin((1-t)*c)/u,h=Math.sin(t*c)/u;return this._w=o*d+this._w*h,this._x=n*d+this._x*h,this._y=r*d+this._y*h,this._z=i*d+this._z*h,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Lt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(o=new Mt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(o.setFromEuler(e))}),applyAxisAngle:function(){var e=new Mt;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*r-a*n,u=s*n+a*t-i*r,c=s*r+i*n-o*t,d=-i*t-o*n-a*r;return this.x=l*s+d*-i+u*-a-c*-o,this.y=u*s+d*-o+c*-i-l*-a,this.z=c*s+d*-a+l*-o-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(i=new Lt,function(e){return i.copy(this).projectOnVector(e),this.sub(i)}),reflect:function(){var e=new Lt;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Rt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Pt.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,o,a,s,l){var u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Lt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],u=n[4],c=n[7],d=n[2],h=n[5],p=n[8],f=r[0],m=r[3],g=r[6],y=r[1],v=r[4],b=r[7],_=r[2],E=r[5],w=r[8];return i[0]=o*f+a*y+s*_,i[3]=o*m+a*v+s*E,i[6]=o*g+a*b+s*w,i[1]=l*f+u*y+c*_,i[4]=l*m+u*v+c*E,i[7]=l*g+u*b+c*w,i[2]=d*f+h*y+p*_,i[5]=d*m+h*v+p*E,i[8]=d*g+h*b+p*w,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-n*i*u+n*a*s+r*i*l-r*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],c=n[6],d=n[7],h=n[8],p=h*l-u*d,f=u*c-h*s,m=d*s-l*c,g=i*p+o*f+a*m;if(0===g){var y="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(y);return console.warn(y),this.identity()}var v=1/g;return r[0]=p*v,r[1]=(a*d-h*o)*v,r[2]=(u*o-a*l)*v,r[3]=f*v,r[4]=(h*i-a*c)*v,r[5]=(a*s-u*i)*v,r[6]=m*v,r[7]=(o*c-d*i)*v,r[8]=(l*i-o*s)*v,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,o,a){var s=Math.cos(i),l=Math.sin(i);this.set(n*s,n*l,-n*(s*o+l*a)+o+e,-r*l,r*s,-r*(-l*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],l=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*l,r[6]=t*a+n*u,r[1]=-n*i+t*s,r[4]=-n*o+t*l,r[7]=-n*a+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Dt,Ot,Nt,kt,Ft,Bt,Ut,zt,Gt,Vt,jt,Ht,Zt,qt,Wt={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===a&&(a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),a.width=e.width,a.height=e.height;var n=a.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=a}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Yt=0;function Kt(e,t,n,r,i,o,a,s,l,u){Object.defineProperty(this,"id",{value:Yt++}),this.uuid=Rt.generateUUID(),this.name="",this.image=void 0!==e?e:Kt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Kt.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:de,this.wrapT=void 0!==r?r:de,this.magFilter=void 0!==i?i:ge,this.minFilter=void 0!==o?o:ve,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:De,this.type=void 0!==s?s:be,this.offset=new Ct(0,0),this.repeat=new Ct(1,1),this.center=new Ct(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:yt,this.version=0,this.onUpdate=null}function $t(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function Xt(e,t,n){this.width=e,this.height=t,this.scissor=new $t(0,0,e,t),this.scissorTest=!1,this.viewport=new $t(0,0,e,t),n=n||{},this.texture=new Kt(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:ge,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Qt(e,t,n){Xt.call(this,e,t,n),this.samples=4}function Jt(e,t,n){Xt.call(this,e,t,n)}function en(e,t,n,r,i,o,a,s,l,u,c,d){Kt.call(this,null,o,a,s,l,u,r,i,c,d),this.image={data:e,width:t,height:n},this.magFilter=void 0!==l?l:pe,this.minFilter=void 0!==u?u:pe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function tn(e,t){this.min=void 0!==e?e:new Lt(1/0,1/0,1/0),this.max=void 0!==t?t:new Lt(-1/0,-1/0,-1/0)}function nn(e,t){this.center=void 0!==e?e:new Lt,this.radius=void 0!==t?t:0}function rn(e,t){this.normal=void 0!==e?e:new Lt(1,0,0),this.constant=void 0!==t?t:0}function on(e,t,n,r,i,o){this.planes=[void 0!==e?e:new rn,void 0!==t?t:new rn,void 0!==n?n:new rn,void 0!==r?r:new rn,void 0!==i?i:new rn,void 0!==o?o:new rn]}function an(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Kt.DEFAULT_IMAGE=void 0,Kt.DEFAULT_MAPPING=300,Kt.prototype=Object.assign(Object.create(r.prototype),{constructor:Kt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Rt.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Wt.getDataURL(r[o]))}else i=Wt.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ce:e.x=e.x-Math.floor(e.x);break;case de:e.x=e.x<0?0:1;break;case he:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ce:e.y=e.y-Math.floor(e.y);break;case de:e.y=e.y<0?0:1;break;case he:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Kt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign($t.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,o=.01,a=.1,s=e.elements,l=s[0],u=s[4],c=s[8],d=s[1],h=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(u-d)<o&&Math.abs(c-f)<o&&Math.abs(p-m)<o){if(Math.abs(u+d)<a&&Math.abs(c+f)<a&&Math.abs(p+m)<a&&Math.abs(l+h+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var y=(l+1)/2,v=(h+1)/2,b=(g+1)/2,_=(u+d)/4,E=(c+f)/4,w=(p+m)/4;return y>v&&y>b?y<o?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(y)),i=E/n):v>b?v<o?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(v)),i=w/r):b<o?(n=.707106781,r=.707106781,i=0):(n=E/(i=Math.sqrt(b)),r=w/i),this.set(n,r,i,t),this}var T=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(d-u)*(d-u));return Math.abs(T)<.001&&(T=1),this.x=(m-p)/T,this.y=(c-f)/T,this.z=(d-u)/T,this.w=Math.acos((l+h+g-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===Dt&&(Dt=new $t,Ot=new $t),Dt.set(e,e,e,e),Ot.set(t,t,t,t),this.clamp(Dt,Ot)},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Xt.prototype=Object.assign(Object.create(r.prototype),{constructor:Xt,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Qt.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Qt,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Xt.prototype.copy.call(this,e),this.samples=e.samples,this}}),Jt.prototype=Object.create(Xt.prototype),Jt.prototype.constructor=Jt,Jt.prototype.isWebGLRenderTargetCube=!0,en.prototype=Object.create(Kt.prototype),en.prototype.constructor=en,en.prototype.isDataTexture=!0,Object.assign(tn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],d=e[s+2];u<t&&(t=u),c<n&&(n=c),d<r&&(r=d),u>i&&(i=u),c>o&&(o=c),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),d=e.getZ(s);u<t&&(t=u),c<n&&(n=c),d<r&&(r=d),u>i&&(i=u),c>o&&(o=c),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Lt;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Lt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Lt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,n,r=new Lt;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(t=0,n=a.length;t<n;t++)r.copy(a[t]),r.applyMatrix4(i.matrixWorld),e.expandByPoint(r)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(t=0,n=s.count;t<n;t++)r.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(r)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Lt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(kt=new Lt,function(e){return this.clampPoint(e.center,kt),kt.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(){var e=new Lt,t=new Lt,n=new Lt,r=new Lt,i=new Lt,o=new Lt,a=new Lt,s=new Lt,l=new Lt,u=new Lt;function c(r){var i,o;for(i=0,o=r.length-3;i<=o;i+=3){a.fromArray(r,i);var s=l.x*Math.abs(a.x)+l.y*Math.abs(a.y)+l.z*Math.abs(a.z),u=e.dot(a),c=t.dot(a),d=n.dot(a);if(Math.max(-Math.max(u,c,d),Math.min(u,c,d))>s)return!1}return!0}return function(a){if(this.isEmpty())return!1;this.getCenter(s),l.subVectors(this.max,s),e.subVectors(a.a,s),t.subVectors(a.b,s),n.subVectors(a.c,s),r.subVectors(t,e),i.subVectors(n,t),o.subVectors(e,n);var d=[0,-r.z,r.y,0,-i.z,i.y,0,-o.z,o.y,r.z,0,-r.x,i.z,0,-i.x,o.z,0,-o.x,-r.y,r.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!c(d)&&!!c(d=[1,0,0,0,1,0,0,0,1])&&(u.crossVectors(r,i),c(d=[u.x,u.y,u.z]))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Lt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Lt;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Lt;return function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(Nt=[new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt,new Lt],function(e){return this.isEmpty()||(Nt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Nt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Nt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Nt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Nt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Nt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Nt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Nt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Nt)),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(nn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(Ft=new tn,function(e,t){var n=this.center;void 0!==t?n.copy(t):Ft.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Lt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new tn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(rn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Lt,t=new Lt;return function(n,r,i){var o=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Lt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Lt;return function(t,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Lt);var r=t.delta(e),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Lt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Lt,t=new Pt;return function(n,r){var i=r||t.getNormalMatrix(n),o=this.coplanarPoint(e).applyMatrix4(n),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(on.prototype,{set:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],u=n[6],c=n[7],d=n[8],h=n[9],p=n[10],f=n[11],m=n[12],g=n[13],y=n[14],v=n[15];return t[0].setComponents(a-r,c-s,f-d,v-m).normalize(),t[1].setComponents(a+r,c+s,f+d,v+m).normalize(),t[2].setComponents(a+i,c+l,f+h,v+g).normalize(),t[3].setComponents(a-i,c-l,f-h,v-g).normalize(),t[4].setComponents(a-o,c-u,f-p,v-y).normalize(),t[5].setComponents(a+o,c+u,f+p,v+y).normalize(),this},intersectsObject:(Ut=new nn,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ut.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ut)}),intersectsSprite:function(){var e=new nn;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0},intersectsBox:(Bt=new Lt,function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Bt.x=r.normal.x>0?e.max.x:e.min.x,Bt.y=r.normal.y>0?e.max.y:e.min.y,Bt.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Bt)<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}}),Object.assign(an.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,l,u,c,d,h,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=d,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new an).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new Lt;return function(t){var n=this.elements,r=t.elements,i=1/e.setFromMatrixColumn(t,0).length(),o=1/e.setFromMatrixColumn(t,1).length(),a=1/e.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var d=o*u,h=o*c,p=a*u,f=a*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=h+p*l,t[5]=d-f*l,t[9]=-a*s,t[2]=f-d*l,t[6]=p+h*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,g=s*c,y=l*u,v=l*c;t[0]=m+v*a,t[4]=y*a-g,t[8]=o*l,t[1]=o*c,t[5]=o*u,t[9]=-a,t[2]=g*a-y,t[6]=v+m*a,t[10]=o*s}else if("ZXY"===e.order)m=s*u,g=s*c,y=l*u,v=l*c,t[0]=m-v*a,t[4]=-o*c,t[8]=y+g*a,t[1]=g+y*a,t[5]=o*u,t[9]=v-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s;else if("ZYX"===e.order)d=o*u,h=o*c,p=a*u,f=a*c,t[0]=s*u,t[4]=p*l-h,t[8]=d*l+f,t[1]=s*c,t[5]=f*l+d,t[9]=h*l-p,t[2]=-l,t[6]=a*s,t[10]=o*s;else if("YZX"===e.order){var b=o*s,_=o*l,E=a*s,w=a*l;t[0]=s*u,t[4]=w-b*c,t[8]=E*c+_,t[1]=c,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=_*c+E,t[10]=b-w*c}else"XZY"===e.order&&(b=o*s,_=o*l,E=a*s,w=a*l,t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=b*c+w,t[5]=o*u,t[9]=_*c-E,t[2]=E*c-_,t[6]=a*u,t[10]=w*c+b);return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:(Zt=new Lt(0,0,0),qt=new Lt(1,1,1),function(e){return this.compose(Zt,e,qt)}),lookAt:(Vt=new Lt,jt=new Lt,Ht=new Lt,function(e,t,n){var r=this.elements;return Ht.subVectors(e,t),0===Ht.lengthSq()&&(Ht.z=1),Ht.normalize(),Vt.crossVectors(n,Ht),0===Vt.lengthSq()&&(1===Math.abs(n.z)?Ht.x+=1e-4:Ht.z+=1e-4,Ht.normalize(),Vt.crossVectors(n,Ht)),Vt.normalize(),jt.crossVectors(Ht,Vt),r[0]=Vt.x,r[4]=jt.x,r[8]=Ht.x,r[1]=Vt.y,r[5]=jt.y,r[9]=Ht.y,r[2]=Vt.z,r[6]=jt.z,r[10]=Ht.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],u=n[1],c=n[5],d=n[9],h=n[13],p=n[2],f=n[6],m=n[10],g=n[14],y=n[3],v=n[7],b=n[11],_=n[15],E=r[0],w=r[4],T=r[8],A=r[12],S=r[1],x=r[5],I=r[9],R=r[13],C=r[2],M=r[6],L=r[10],P=r[14],D=r[3],O=r[7],N=r[11],k=r[15];return i[0]=o*E+a*S+s*C+l*D,i[4]=o*w+a*x+s*M+l*O,i[8]=o*T+a*I+s*L+l*N,i[12]=o*A+a*R+s*P+l*k,i[1]=u*E+c*S+d*C+h*D,i[5]=u*w+c*x+d*M+h*O,i[9]=u*T+c*I+d*L+h*N,i[13]=u*A+c*R+d*P+h*k,i[2]=p*E+f*S+m*C+g*D,i[6]=p*w+f*x+m*M+g*O,i[10]=p*T+f*I+m*L+g*N,i[14]=p*A+f*R+m*P+g*k,i[3]=y*E+v*S+b*C+_*D,i[7]=y*w+v*x+b*M+_*O,i[11]=y*T+v*I+b*L+_*N,i[15]=y*A+v*R+b*P+_*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Lt;return function(t){for(var n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],u=e[2],c=e[6],d=e[10],h=e[14];return e[3]*(+i*s*c-r*l*c-i*a*d+n*l*d+r*a*h-n*s*h)+e[7]*(+t*s*h-t*l*d+i*o*d-r*o*h+r*l*u-i*s*u)+e[11]*(+t*l*c-t*a*h-i*o*c+n*o*h+i*a*u-n*l*u)+e[15]*(-r*a*u-t*s*c+t*a*d+r*o*c-n*o*d+n*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],u=r[5],c=r[6],d=r[7],h=r[8],p=r[9],f=r[10],m=r[11],g=r[12],y=r[13],v=r[14],b=r[15],_=p*v*d-y*f*d+y*c*m-u*v*m-p*c*b+u*f*b,E=g*f*d-h*v*d-g*c*m+l*v*m+h*c*b-l*f*b,w=h*y*d-g*p*d+g*u*m-l*y*m-h*u*b+l*p*b,T=g*p*c-h*y*c-g*u*f+l*y*f+h*u*v-l*p*v,A=i*_+o*E+a*w+s*T;if(0===A){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(S);return console.warn(S),this.identity()}var x=1/A;return n[0]=_*x,n[1]=(y*f*s-p*v*s-y*a*m+o*v*m+p*a*b-o*f*b)*x,n[2]=(u*v*s-y*c*s+y*a*d-o*v*d-u*a*b+o*c*b)*x,n[3]=(p*c*s-u*f*s-p*a*d+o*f*d+u*a*m-o*c*m)*x,n[4]=E*x,n[5]=(h*v*s-g*f*s+g*a*m-i*v*m-h*a*b+i*f*b)*x,n[6]=(g*c*s-l*v*s-g*a*d+i*v*d+l*a*b-i*c*b)*x,n[7]=(l*f*s-h*c*s+h*a*d-i*f*d-l*a*m+i*c*m)*x,n[8]=w*x,n[9]=(g*p*s-h*y*s-g*o*m+i*y*m+h*o*b-i*p*b)*x,n[10]=(l*y*s-g*u*s+g*o*d-i*y*d-l*o*b+i*u*b)*x,n[11]=(h*u*s-l*p*s-h*o*d+i*p*d+l*o*m-i*u*m)*x,n[12]=T*x,n[13]=(h*y*a-g*p*a+g*o*f-i*y*f-h*o*v+i*p*v)*x,n[14]=(g*u*a-l*y*a-g*o*c+i*y*c+l*o*v-i*u*v)*x,n[15]=(l*p*a-h*u*a+h*o*c-i*p*c-l*o*f+i*u*f)*x,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,l=i*o,u=i*a;return this.set(l*o+n,l*a-r*s,l*s+r*a,0,l*a+r*s,u*a+n,u*s-r*o,0,l*s-r*a,u*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,l=i+i,u=o+o,c=a+a,d=i*l,h=i*u,p=i*c,f=o*u,m=o*c,g=a*c,y=s*l,v=s*u,b=s*c,_=n.x,E=n.y,w=n.z;return r[0]=(1-(f+g))*_,r[1]=(h+b)*_,r[2]=(p-v)*_,r[3]=0,r[4]=(h-b)*E,r[5]=(1-(d+g))*E,r[6]=(m+y)*E,r[7]=0,r[8]=(p+v)*w,r[9]=(m-y)*w,r[10]=(1-(d+f))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(zt=new Lt,Gt=new an,function(e,t,n){var r=this.elements,i=zt.set(r[0],r[1],r[2]).length(),o=zt.set(r[4],r[5],r[6]).length(),a=zt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Gt.copy(this);var s=1/i,l=1/o,u=1/a;return Gt.elements[0]*=s,Gt.elements[1]*=s,Gt.elements[2]*=s,Gt.elements[4]*=l,Gt.elements[5]*=l,Gt.elements[6]*=l,Gt.elements[8]*=u,Gt.elements[9]*=u,Gt.elements[10]*=u,t.setFromRotationMatrix(Gt),n.x=i,n.y=o,n.z=a,this}),makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),l=2*i/(n-r),u=(t+e)/(t-e),c=(n+r)/(n-r),d=-(o+i)/(o-i),h=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=l,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),l=1/(n-r),u=1/(o-i),c=(t+e)*s,d=(n+r)*l,h=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-h,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var sn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"};function ln(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function un(e){for(var t={},n=0;n<e.length;n++){var r=ln(e[n]);for(var i in r)t[i]=r[i]}return t}var cn,dn,hn,pn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function fn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}Object.assign(fn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,r){if(t=Rt.euclideanModulo(t,1),n=Rt.clamp(n,0,1),r=Rt.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=e(o,i,t+1/3),this.g=e(o,i,t),this.b=e(o,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(a,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u,c=(u=n[1]).length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0&&(void 0!==(u=pn[e])?this.setHex(u):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),l=(s+a)/2;if(s===a)t=0,n=0;else{var u=a-s;switch(n=l<=.5?u/(a+s):u/(2-a-s),a){case r:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-r)/u+2;break;case o:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(hn={},function(e,t,n){return this.getHSL(hn),hn.h+=e,hn.s+=t,hn.l+=n,this.setHSL(hn.h,hn.s,hn.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:(cn={h:0,s:0,l:0},dn={h:0,s:0,l:0},function(e,t){this.getHSL(cn),e.getHSL(dn);var n=Rt.lerp(cn.h,dn.h,t),r=Rt.lerp(cn.s,dn.s,t),i=Rt.lerp(cn.l,dn.l,t);return this.setHSL(n,r,i),this}),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var mn,gn={common:{diffuse:{value:new fn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Pt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ct(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new fn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Pt}},sprite:{diffuse:{value:new fn(15658734)},opacity:{value:1},center:{value:new Ct(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Pt}}},yn={basic:{uniforms:un([gn.common,gn.specularmap,gn.envmap,gn.aomap,gn.lightmap,gn.fog]),vertexShader:sn.meshbasic_vert,fragmentShader:sn.meshbasic_frag},lambert:{uniforms:un([gn.common,gn.specularmap,gn.envmap,gn.aomap,gn.lightmap,gn.emissivemap,gn.fog,gn.lights,{emissive:{value:new fn(0)}}]),vertexShader:sn.meshlambert_vert,fragmentShader:sn.meshlambert_frag},phong:{uniforms:un([gn.common,gn.specularmap,gn.envmap,gn.aomap,gn.lightmap,gn.emissivemap,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.gradientmap,gn.fog,gn.lights,{emissive:{value:new fn(0)},specular:{value:new fn(1118481)},shininess:{value:30}}]),vertexShader:sn.meshphong_vert,fragmentShader:sn.meshphong_frag},standard:{uniforms:un([gn.common,gn.envmap,gn.aomap,gn.lightmap,gn.emissivemap,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.roughnessmap,gn.metalnessmap,gn.fog,gn.lights,{emissive:{value:new fn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:sn.meshphysical_vert,fragmentShader:sn.meshphysical_frag},matcap:{uniforms:un([gn.common,gn.bumpmap,gn.normalmap,gn.displacementmap,gn.fog,{matcap:{value:null}}]),vertexShader:sn.meshmatcap_vert,fragmentShader:sn.meshmatcap_frag},points:{uniforms:un([gn.points,gn.fog]),vertexShader:sn.points_vert,fragmentShader:sn.points_frag},dashed:{uniforms:un([gn.common,gn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:sn.linedashed_vert,fragmentShader:sn.linedashed_frag},depth:{uniforms:un([gn.common,gn.displacementmap]),vertexShader:sn.depth_vert,fragmentShader:sn.depth_frag},normal:{uniforms:un([gn.common,gn.bumpmap,gn.normalmap,gn.displacementmap,{opacity:{value:1}}]),vertexShader:sn.normal_vert,fragmentShader:sn.normal_frag},sprite:{uniforms:un([gn.sprite,gn.fog]),vertexShader:sn.sprite_vert,fragmentShader:sn.sprite_frag},background:{uniforms:{uvTransform:{value:new Pt},t2D:{value:null}},vertexShader:sn.background_vert,fragmentShader:sn.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:sn.cube_vert,fragmentShader:sn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:sn.equirect_vert,fragmentShader:sn.equirect_frag},distanceRGBA:{uniforms:un([gn.common,gn.displacementmap,{referencePosition:{value:new Lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:sn.distanceRGBA_vert,fragmentShader:sn.distanceRGBA_frag},shadow:{uniforms:un([gn.lights,gn.fog,{color:{value:new fn(0)},opacity:{value:1}}]),vertexShader:sn.shadow_vert,fragmentShader:sn.shadow_frag}};function vn(){var e=null,t=!1,n=null;function r(i,o){!1!==t&&(n(i,o),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function bn(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=t.get(n);void 0===i?t.set(n,function(t,n){var r=t.array,i=t.dynamic?35048:35044,o=e.createBuffer();e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback();var a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(n,r)):i.version<n.version&&(function(t,n,r){var i=n.array,o=n.updateRange;e.bindBuffer(r,t),!1===n.dynamic?e.bufferData(r,i,35044):-1===o.count?e.bufferSubData(r,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function _n(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Lt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new fn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function En(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||En.DefaultOrder}function wn(){this.mask=1}yn.physical={uniforms:un([yn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:sn.meshphysical_vert,fragmentShader:sn.meshphysical_frag},Object.assign(_n.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),En.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],En.DefaultOrder="XYZ",Object.defineProperties(En.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(En.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Rt.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],l=i[1],u=i[5],c=i[9],d=i[2],h=i[6],p=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(h,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(h,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(h,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new an;return function(t,n,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(mn=new Mt,function(e){return mn.setFromEuler(this),this.setFromQuaternion(mn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Lt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(wn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Tn,An,Sn,xn,In,Rn=0;function Cn(){Object.defineProperty(this,"id",{value:Rn++}),this.uuid=Rt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Cn.DefaultUp.clone();var e=new Lt,t=new En,n=new Mt,r=new Lt(1,1,1);t.onChange((function(){n.setFromEuler(t,!1)})),n.onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new an},normalMatrix:{value:new Pt}}),this.matrix=new an,this.matrixWorld=new an,this.matrixAutoUpdate=Cn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new wn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Cn.DefaultUp=new Lt(0,1,0),Cn.DefaultMatrixAutoUpdate=!0,Cn.prototype=Object.assign(Object.create(r.prototype),{constructor:Cn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(In=new Mt,function(e,t){return In.setFromAxisAngle(e,t),this.quaternion.multiply(In),this}),rotateOnWorldAxis:function(){var e=new Mt;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Lt(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Lt(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Lt(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Lt;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new Lt(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Lt(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Lt(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(xn=new an,function(e){return e.applyMatrix4(xn.getInverse(this.matrixWorld))}),lookAt:function(){var e=new Mt,t=new an,n=new Lt,r=new Lt;return function(i,o,a){i.isVector3?n.copy(i):n.set(i,o,a);var s=this.parent;this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(r,n,this.up):t.lookAt(n,r,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},attach:(Sn=new an,function(e){return this.updateWorldMatrix(!0,!1),Sn.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Sn.multiply(e.parent.matrixWorld)),e.applyMatrix(Sn),e.updateWorldMatrix(!1,!1),this.add(e),this}),getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Lt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Tn=new Lt,An=new Lt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Mt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Tn,e,An),e}),getWorldScale:function(){var e=new Lt,t=new Mt;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Lt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Lt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==ft&&(r.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,l=a.length;s<l;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(i(e.materials,this.material[s]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0)for(r.children=[],s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object);if(t){var d=m(e.geometries),h=m(e.materials),p=m(e.textures),f=m(e.images);a=m(e.shapes),d.length>0&&(n.geometries=d),h.length>0&&(n.materials=h),p.length>0&&(n.textures=p),f.length>0&&(n.images=f),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Mn,Ln,Pn=0;function Dn(){Object.defineProperty(this,"id",{value:Pn+=2}),this.uuid=Rt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function On(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Nn(e,t,n){On.call(this,new Int8Array(e),t,n)}function kn(e,t,n){On.call(this,new Uint8Array(e),t,n)}function Fn(e,t,n){On.call(this,new Uint8ClampedArray(e),t,n)}function Bn(e,t,n){On.call(this,new Int16Array(e),t,n)}function Un(e,t,n){On.call(this,new Uint16Array(e),t,n)}function zn(e,t,n){On.call(this,new Int32Array(e),t,n)}function Gn(e,t,n){On.call(this,new Uint32Array(e),t,n)}function Vn(e,t,n){On.call(this,new Float32Array(e),t,n)}function jn(e,t,n){On.call(this,new Float64Array(e),t,n)}function Hn(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Zn(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Dn.prototype=Object.assign(Object.create(r.prototype),{constructor:Dn,isGeometry:!0,applyMatrix:function(e){for(var t=(new Pt).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new an;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new an;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new an;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new an;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new an;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:(Ln=new Cn,function(e){Ln.lookAt(e),Ln.updateMatrix(),this.applyMatrix(Ln.matrix)}),fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes,i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,l=void 0!==r.uv2?r.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=0;u<i.length;u+=3)t.vertices.push((new Lt).fromArray(i,u)),void 0!==a&&t.colors.push((new fn).fromArray(a,u));function c(e,n,r,i){var u=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],c=new _n(e,n,r,void 0===o?[]:[(new Lt).fromArray(o,3*e),(new Lt).fromArray(o,3*n),(new Lt).fromArray(o,3*r)],u,i);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([(new Ct).fromArray(s,2*e),(new Ct).fromArray(s,2*n),(new Ct).fromArray(s,2*r)]),void 0!==l&&t.faceVertexUvs[1].push([(new Ct).fromArray(l,2*e),(new Ct).fromArray(l,2*n),(new Ct).fromArray(l,2*r)])}var d=e.groups;if(d.length>0)for(u=0;u<d.length;u++)for(var h=d[u],p=h.start,f=p,m=p+h.count;f<m;f+=3)void 0!==n?c(n[f],n[f+1],n[f+2],h.materialIndex):c(f,f+1,f+2,h.materialIndex);else if(void 0!==n)for(u=0;u<n.length;u+=3)c(n[u],n[u+1],n[u+2]);else for(u=0;u<i.length/3;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(Mn=new Lt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mn).negate(),this.translate(Mn.x,Mn.y,Mn.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new an;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new Lt,t=new Lt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new Lt;if(e){var s,l,u,c=new Lt,d=new Lt;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c],c.subVectors(u,l),d.subVectors(s,l),c.cross(d),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var h=(o=this.faces[r]).vertexNormals;3===h.length?(h[0].copy(a[o.a]),h[1].copy(a[o.b]),h[2].copy(a[o.c])):(h[0]=a[o.a].clone(),h[1]=a[o.b].clone(),h[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new Dn;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)l=new Lt,u={a:new Lt,b:new Lt,c:new Lt},a.push(l),s.push(u)}var l,u,c=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new tn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new nn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0],d=this.colors,h=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new Pt).getNormalMatrix(t));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==t&&m.applyMatrix4(t),o.push(m)}for(p=0,f=h.length;p<f;p++)d.push(h[p].clone());for(p=0,f=l.length;p<f;p++){var g,y,v,b=l[p],_=b.vertexNormals,E=b.vertexColors;(g=new _n(b.a+i,b.b+i,b.c+i)).normal.copy(b.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var w=0,T=_.length;w<T;w++)y=_[w].clone(),void 0!==r&&y.applyMatrix3(r).normalize(),g.vertexNormals.push(y);for(g.color.copy(b.color),w=0,T=E.length;w<T;w++)v=E[w],g.vertexColors.push(v.clone());g.materialIndex=b.materialIndex+n,s.push(g)}for(p=0,f=c.length;p<f;p++){var A=c[p],S=[];if(void 0!==A){for(w=0,T=A.length;w<T;w++)S.push(A[w].clone());u.push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,o,a,s,l={},u=[],c=[],d=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===l[t=Math.round(e.x*d)+"_"+Math.round(e.y*d)+"_"+Math.round(e.z*d)]?(l[t]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[t]];var h=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){h.push(n);break}}for(n=h.length-1;n>=0;n--){var f=h[n];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Lt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===t&&(r=[]),a&&a.length===t&&(i=[]),n=0;n<t;n++){var s=e[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],l={},u=[],c={},d=[],h={};for(i=0;i<this.faces.length;i++){var p=this.faces[i],f=void 0!==this.faceVertexUvs[0][i],m=p.normal.length()>0,g=p.vertexNormals.length>0,y=1!==p.color.r||1!==p.color.g||1!==p.color.b,v=p.vertexColors.length>0,b=0;if(b=T(b,0,0),b=T(b,1,!0),b=T(b,2,!1),b=T(b,3,f),b=T(b,4,m),b=T(b,5,g),b=T(b,6,y),b=T(b,7,v),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var _=this.faceVertexUvs[0][i];a.push(x(_[0]),x(_[1]),x(_[2]))}if(m&&a.push(A(p.normal)),g){var E=p.vertexNormals;a.push(A(E[0]),A(E[1]),A(E[2]))}if(y&&a.push(S(p.color)),v){var w=p.vertexColors;a.push(S(w[0]),S(w[1]),S(w[2]))}}function T(e,t,n){return n?e|1<<t:e&~(1<<t)}function A(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function x(e){var t=e.x.toString()+e.y.toString();return void 0!==h[t]||(h[t]=d.length/2,d.push(e.x,e.y)),h[t]}return e.data={},e.data.vertices=r,e.data.normals=s,u.length>0&&(e.data.colors=u),d.length>0&&(e.data.uvs=[d]),e.data.faces=a,e},clone:function(){return(new Dn).copy(this)},copy:function(e){var t,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,n=l.length;t<n;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=c.length;r<i;r++){var d=c[r],h=[];for(o=0,a=d.length;o<a;o++){var p=d[o];h.push(p.clone())}this.faceVertexUvs[t].push(h)}}var f=e.morphTargets;for(t=0,n=f.length;t<n;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],r=0,i=f[t].vertices.length;r<i;r++)m.vertices.push(f[t].vertices[r].clone());if(void 0!==f[t].normals)for(m.normals=[],r=0,i=f[t].normals.length;r<i;r++)m.normals.push(f[t].normals[r].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var y={};if(void 0!==g[t].vertexNormals)for(y.vertexNormals=[],r=0,i=g[t].vertexNormals.length;r<i;r++){var v=g[t].vertexNormals[r],b={};b.a=v.a.clone(),b.b=v.b.clone(),b.c=v.c.clone(),y.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(y.faceNormals=[],r=0,i=g[t].faceNormals.length;r<i;r++)y.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(y)}var _=e.skinWeights;for(t=0,n=_.length;t<n;t++)this.skinWeights.push(_[t].clone());var E=e.skinIndices;for(t=0,n=E.length;t<n;t++)this.skinIndices.push(E[t].clone());var w=e.lineDistances;for(t=0,n=w.length;t<n;t++)this.lineDistances.push(w[t]);var T=e.boundingBox;null!==T&&(this.boundingBox=T.clone());var A=e.boundingSphere;return null!==A&&(this.boundingSphere=A.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(On.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(On.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new fn),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Ct),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Lt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new $t),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Nn.prototype=Object.create(On.prototype),Nn.prototype.constructor=Nn,kn.prototype=Object.create(On.prototype),kn.prototype.constructor=kn,Fn.prototype=Object.create(On.prototype),Fn.prototype.constructor=Fn,Bn.prototype=Object.create(On.prototype),Bn.prototype.constructor=Bn,Un.prototype=Object.create(On.prototype),Un.prototype.constructor=Un,zn.prototype=Object.create(On.prototype),zn.prototype.constructor=zn,Gn.prototype=Object.create(On.prototype),Gn.prototype.constructor=Gn,Vn.prototype=Object.create(On.prototype),Vn.prototype.constructor=Vn,jn.prototype=Object.create(On.prototype),jn.prototype.constructor=jn,Object.assign(Hn.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:r})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(var u=0;u<l;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var c,d=e.morphNormals,h=d.length;if(h>0){for(c=[],u=0;u<h;u++)c[u]={name:d[u].name,data:[]};this.morphTargets.normal=c}var p=e.skinIndices,f=e.skinWeights,m=p.length===r.length,g=f.length===r.length;for(r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),u=0;u<n.length;u++){var y=n[u];this.vertices.push(r[y.a],r[y.b],r[y.c]);var v=y.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{var b=y.normal;this.normals.push(b,b,b)}var _,E=y.vertexColors;if(3===E.length)this.colors.push(E[0],E[1],E[2]);else{var w=y.color;this.colors.push(w,w,w)}!0===o&&(void 0!==(_=i[0][u])?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Ct,new Ct,new Ct))),!0===a&&(void 0!==(_=i[1][u])?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Ct,new Ct,new Ct)));for(var T=0;T<l;T++){var A=s[T].vertices;t[T].data.push(A[y.a],A[y.b],A[y.c])}for(T=0;T<h;T++){var S=d[T].vertexNormals[u];c[T].data.push(S.a,S.b,S.c)}m&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),g&&this.skinWeights.push(f[y.a],f[y.b],f[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var qn=1;function Wn(){Object.defineProperty(this,"id",{value:qn+=2}),this.uuid=Rt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Yn(e,t,n,r,i,o){Dn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Kn(e,t,n,r,i,o)),this.mergeVertices()}function Kn(e,t,n,r,i,o){Wn.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var s=[],l=[],u=[],c=[],d=0,h=0;function p(e,t,n,r,i,o,p,f,m,g,y){var v,b,_=o/m,E=p/g,w=o/2,T=p/2,A=f/2,S=m+1,x=g+1,I=0,R=0,C=new Lt;for(b=0;b<x;b++){var M=b*E-T;for(v=0;v<S;v++){var L=v*_-w;C[e]=L*r,C[t]=M*i,C[n]=A,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=f>0?1:-1,u.push(C.x,C.y,C.z),c.push(v/m),c.push(1-b/g),I+=1}}for(b=0;b<g;b++)for(v=0;v<m;v++){var P=d+v+S*b,D=d+v+S*(b+1),O=d+(v+1)+S*(b+1),N=d+(v+1)+S*b;s.push(P,D,N),s.push(D,O,N),R+=6}a.addGroup(h,R,y),h+=R,d+=I}p("z","y","x",-1,-1,n,t,e,o,i,0),p("z","y","x",1,-1,n,t,-e,o,i,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new Vn(l,3)),this.addAttribute("normal",new Vn(u,3)),this.addAttribute("uv",new Vn(c,2))}function $n(e,t,n,r){Dn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Xn(e,t,n,r)),this.mergeVertices()}function Xn(e,t,n,r){Wn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,l=Math.floor(n)||1,u=Math.floor(r)||1,c=l+1,d=u+1,h=e/l,p=t/u,f=[],m=[],g=[],y=[];for(o=0;o<d;o++){var v=o*p-s;for(i=0;i<c;i++){var b=i*h-a;m.push(b,-v,0),g.push(0,0,1),y.push(i/l),y.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<l;i++){var _=i+c*o,E=i+c*(o+1),w=i+1+c*(o+1),T=i+1+c*o;f.push(_,E,T),f.push(E,w,T)}this.setIndex(f),this.addAttribute("position",new Vn(m,3)),this.addAttribute("normal",new Vn(g,3)),this.addAttribute("uv",new Vn(y,2))}Wn.prototype=Object.assign(Object.create(r.prototype),{constructor:Wn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Zn(e)>65535?Gn:Un)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new On(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new Pt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);var r=this.attributes.tangent;return void 0!==r&&((new Pt).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new an;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new an;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new an;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new an;return function(t,n,r){return e.makeTranslation(t,n,r),this.applyMatrix(e),this}}(),scale:function(){var e=new an;return function(t,n,r){return e.makeScale(t,n,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Cn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Lt;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new Vn(3*t.vertices.length,3),r=new Vn(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Vn(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Vn(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Hn).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new On(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new On(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new On(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new On(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new On(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[a],u=0,c=l.length;u<c;u++){var d=l[u],h=new Vn(3*d.data.length,3);h.name=d.name,s.push(h.copyVector3sArray(d.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var p=new Vn(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var f=new Vn(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){var e=new tn;return function(){null===this.boundingBox&&(this.boundingBox=new tn);var t=this.attributes.position,n=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),n)for(var r=0,i=n.length;r<i;r++){var o=n[r];e.setFromBufferAttribute(o),this.boundingBox.expandByPoint(e.min),this.boundingBox.expandByPoint(e.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new tn,t=new tn,n=new Lt;return function(){null===this.boundingSphere&&(this.boundingSphere=new nn);var r=this.attributes.position,i=this.morphAttributes.position;if(r){var o=this.boundingSphere.center;if(e.setFromBufferAttribute(r),i)for(var a=0,s=i.length;a<s;a++){var l=i[a];t.setFromBufferAttribute(l),e.expandByPoint(t.min),e.expandByPoint(t.max)}e.getCenter(o);var u=0;for(a=0,s=r.count;a<s;a++)n.fromBufferAttribute(r,a),u=Math.max(u,o.distanceToSquared(n));if(i)for(a=0,s=i.length;a<s;a++)for(var c=0,d=(l=i[a]).count;c<d;c++)n.fromBufferAttribute(l,c),u=Math.max(u,o.distanceToSquared(n));this.boundingSphere.radius=Math.sqrt(u),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new On(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,l,u=t.normal.array,c=new Lt,d=new Lt,h=new Lt,p=new Lt,f=new Lt;if(e){var m=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],l=3*m[i+2],c.fromArray(n,a),d.fromArray(n,s),h.fromArray(n,l),p.subVectors(h,d),f.subVectors(c,d),p.cross(f),u[a]+=p.x,u[a+1]+=p.y,u[a+2]+=p.z,u[s]+=p.x,u[s+1]+=p.y,u[s+2]+=p.z,u[l]+=p.x,u[l+1]+=p.y,u[l+2]+=p.z}else for(i=0,o=n.length;i<o;i+=9)c.fromArray(n,i),d.fromArray(n,i+3),h.fromArray(n,i+6),p.subVectors(h,d),f.subVectors(c,d),p.cross(f),u[i]=p.x,u[i+1]=p.y,u[i+2]=p.z,u[i+3]=p.x,u[i+4]=p.y,u[i+5]=p.z,u[i+6]=p.x,u[i+7]=p.y,u[i+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=o.itemSize*t,l=Math.min(a.length,i.length-s),u=0,c=s;u<l;u++,c++)i[c]=a[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Lt;return function(){for(var t=this.attributes.normal,n=0,r=t.count;n<r;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.normalize(),t.setXYZ(n,e.x,e.y,e.z)}}(),toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=new n.constructor(t.length*r),o=0,a=0,s=0,l=t.length;s<l;s++){o=t[s]*r;for(var u=0;u<r;u++)i[a++]=n[o++]}return new On(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Wn,n=this.index.array,r=this.attributes;for(var i in r){var o=e(r[i],n);t.addAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],l=a[i],u=0,c=l.length;u<c;u++)o=e(l[u],n),s.push(o);t.morphAttributes[i]=s}for(var d=this.groups,h=(u=0,d.length);u<h;u++){var p=d[u];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(h=i[n]).toJSON();""!==h.name&&(o.name=h.name),e.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var l=this.morphAttributes[n],u=[],c=0,d=l.length;c<d;c++){var h;o=(h=l[c]).toJSON(),""!==h.name&&(o.name=h.name),u.push(o)}u.length>0&&(a[n]=u,s=!0)}s&&(e.data.morphAttributes=a);var p=this.groups;p.length>0&&(e.data.groups=JSON.parse(JSON.stringify(p)));var f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e},clone:function(){return(new Wn).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var l=[],u=s[t];for(n=0,r=u.length;n<r;n++)l.push(u[n].clone());this.morphAttributes[t]=l}var c=e.groups;for(n=0,r=c.length;n<r;n++){var d=c[n];this.addGroup(d.start,d.count,d.materialIndex)}var h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Yn.prototype=Object.create(Dn.prototype),Yn.prototype.constructor=Yn,Kn.prototype=Object.create(Wn.prototype),Kn.prototype.constructor=Kn,$n.prototype=Object.create(Dn.prototype),$n.prototype.constructor=$n,Xn.prototype=Object.create(Wn.prototype),Xn.prototype.constructor=Xn;var Qn=0;function Jn(){Object.defineProperty(this,"id",{value:Qn++}),this.uuid=Rt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=b,this.side=f,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=y,this.opacity=1,this.transparent=!1,this.blendSrc=D,this.blendDst=O,this.blendEquation=A,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=j,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}Jn.prototype=Object.assign(Object.create(r.prototype),{constructor:Jn,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==b&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==f&&(n.side=this.side),this.vertexColors!==y&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var er,tr,nr,rr,ir,or,ar,sr,lr,ur,cr,dr,hr="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",pr="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function fr(e){Jn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=hr,this.fragmentShader=pr,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function mr(e,t){this.origin=void 0!==e?e:new Lt,this.direction=void 0!==t?t:new Lt}function gr(e,t,n){this.a=void 0!==e?e:new Lt,this.b=void 0!==t?t:new Lt,this.c=void 0!==n?n:new Lt}function yr(e){Jn.call(this),this.type="MeshBasicMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function vr(e,t){Cn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Wn,this.material=void 0!==t?t:new yr({color:16777215*Math.random()}),this.drawMode=ft,this.updateMorphTargets()}function br(e,t,n,r){var i,o,a=new fn(0),s=0,l=null,u=0;function c(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),c(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){c(a,s=e)},render:function(t,r,d,h){var p=r.background,g=e.vr,y=g.getSession&&g.getSession();if(y&&"additive"===y.environmentBlendMode&&(p=null),null===p?(c(a,s),l=null,u=0):p&&p.isColor&&(c(p,1),h=!0,l=null,u=0),(e.autoClear||h)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLRenderTargetCube)){void 0===o&&((o=new vr(new Kn(1,1,1),new fr({type:"BackgroundCubeMaterial",uniforms:ln(yn.cube.uniforms),vertexShader:yn.cube.vertexShader,fragmentShader:yn.cube.fragmentShader,side:m,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.tCube.value}}),n.update(o));var v=p.isWebGLRenderTargetCube?p.texture:p;o.material.uniforms.tCube.value=v,o.material.uniforms.tFlip.value=p.isWebGLRenderTargetCube?1:-1,l===p&&u===v.version||(o.material.needsUpdate=!0,l=p,u=v.version),t.unshift(o,o.geometry,o.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new vr(new Xn(2,2),new fr({type:"BackgroundMaterial",uniforms:ln(yn.background.uniforms),vertexShader:yn.background.vertexShader,fragmentShader:yn.background.fragmentShader,side:f,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&u===p.version||(i.material.needsUpdate=!0,l=p,u=p.version),t.unshift(i,i.geometry,i.material,0,0,null))}}}function _r(e,t,n,r){var i;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(o,a,s){var l;if(r.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](i,a,s,o.maxInstancedCount),n.update(s,i,o.maxInstancedCount)}}function Er(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var l=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),c=e.getParameter(35660),d=e.getParameter(3379),h=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),y=c>0,v=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:d,maxCubemapSize:h,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:v,floatVertexTextures:y&&v,maxSamples:o?e.getParameter(36183):0}}function wr(){var e=this,t=null,n=0,r=!1,i=!1,o=new rn,a=new Pt,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(t,n,r,i){var l=null!==t?t.length:0,u=null;if(0!==l){if(u=s.value,!0!==i||null===u){var c=r+4*l,d=n.matrixWorldInverse;a.getNormalMatrix(d),(null===u||u.length<c)&&(u=new Float32Array(c));for(var h=0,p=r;h!==l;++h,p+=4)o.copy(t[h]).applyMatrix4(d,a),o.normal.toArray(u,p),u[p+3]=o.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=l,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==n||r;return r=i,t=u(e,o,0),n=e.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,l()},this.setState=function(e,o,a,c,d,h){if(!r||null===e||0===e.length||i&&!a)i?u(null):l();else{var p=i?0:n,f=4*p,m=d.clippingState||null;s.value=m,m=u(e,c,f,h);for(var g=0;g!==f;++g)m[g]=t[g];d.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}}function Tr(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}function Ar(e,t,n){var r={},i={};function o(e){var a=e.target,s=r[a.id];for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);a.removeEventListener("dispose",o),delete r[a.id];var u=i[s.id];u&&(t.remove(u),delete i[s.id]),n.memory.geometries--}return{get:function(e,t){var i=r[t.id];return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Wn).setFromObject(e)),i=t._bufferGeometry),r[t.id]=i,n.memory.geometries++,i)},update:function(e){var n=e.index,r=e.attributes;for(var i in null!==n&&t.update(n,34963),r)t.update(r[i],34962);var o=e.morphAttributes;for(var i in o)for(var a=o[i],s=0,l=a.length;s<l;s++)t.update(a[s],34962)},getWireframeAttribute:function(e){var n=i[e.id];if(n)return n;var r,o=[],a=e.index,s=e.attributes;if(null!==a)for(var l=0,u=(r=a.array).length;l<u;l+=3){var c=r[l+0],d=r[l+1],h=r[l+2];o.push(c,d,d,h,h,c)}else for(l=0,u=(r=s.position.array).length/3-1;l<u;l+=3)c=l+0,d=l+1,h=l+2,o.push(c,d,d,h,h,c);return n=new(Zn(o)>65535?Gn:Un)(o,1),t.update(n,34963),i[e.id]=n,n}}}function Sr(e,t,n,r){var i,o,a;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i)},this.renderInstances=function(s,l,u){var c;if(r.isWebGL2)c=e;else if(null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](i,u,o,l*a,s.maxInstancedCount),n.update(u,i,s.maxInstancedCount)}}function xr(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(r=r||1,t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 5:case 6:t.triangles+=r*(e-2);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Ir(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Rr(e){var t={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,l=s.length,u=t[i.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];t[i.id]=u}var d=o.morphTargets&&i.morphAttributes.position,h=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<l;c++)0!==(p=u[c])[1]&&(d&&i.removeAttribute("morphTarget"+c),h&&i.removeAttribute("morphNormal"+c));for(c=0;c<l;c++)(p=u[c])[0]=c,p[1]=s[c];for(u.sort(Ir),c=0;c<8;c++){var p;if(p=u[c]){var f=p[0],m=p[1];if(m){d&&i.addAttribute("morphTarget"+c,d[f]),h&&i.addAttribute("morphNormal"+c,h[f]),n[c]=m;continue}}n[c]=0}a.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Cr(e,t){var n={};return{update:function(r){var i=t.render.frame,o=r.geometry,a=e.get(r,o);return n[a.id]!==i&&(o.isGeometry&&a.updateFromObject(r),e.update(a),n[a.id]=i),a},dispose:function(){n={}}}}function Mr(e,t,n,r,i,o,a,s,l,u){e=void 0!==e?e:[],t=void 0!==t?t:re,a=void 0!==a?a:Pe,Kt.call(this,e,t,n,r,i,o,a,s,l,u),this.flipY=!1}function Lr(e,t,n,r){Kt.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=pe,this.minFilter=pe,this.wrapR=de,this.generateMipmaps=!1,this.flipY=!1}function Pr(e,t,n,r){Kt.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=pe,this.minFilter=pe,this.wrapR=de,this.generateMipmaps=!1,this.flipY=!1}fr.prototype=Object.create(Jn.prototype),fr.prototype.constructor=fr,fr.prototype.isShaderMaterial=!0,fr.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ln(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},fr.prototype.toJSON=function(e){var t=Jn.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},Object.assign(mr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Lt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Lt;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Lt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Lt;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(tr=new Lt,nr=new Lt,rr=new Lt,function(e,t,n,r){tr.copy(e).add(t).multiplyScalar(.5),nr.copy(t).sub(e).normalize(),rr.copy(this.origin).sub(tr);var i,o,a,s,l=.5*e.distanceTo(t),u=-this.direction.dot(nr),c=rr.dot(this.direction),d=-rr.dot(nr),h=rr.lengthSq(),p=Math.abs(1-u*u);if(p>0)if(o=u*c-d,s=l*p,(i=u*d-c)>=0)if(o>=-s)if(o<=s){var f=1/p;a=(i*=f)*(i+u*(o*=f)+2*c)+o*(u*i+o+2*d)+h}else o=l,a=-(i=Math.max(0,-(u*o+c)))*i+o*(o+2*d)+h;else o=-l,a=-(i=Math.max(0,-(u*o+c)))*i+o*(o+2*d)+h;else o<=-s?a=-(i=Math.max(0,-(-u*l+c)))*i+(o=i>0?-l:Math.min(Math.max(-l,-d),l))*(o+2*d)+h:o<=s?(i=0,a=(o=Math.min(Math.max(-l,-d),l))*(o+2*d)+h):a=-(i=Math.max(0,-(u*l+c)))*i+(o=i>0?l:Math.min(Math.max(-l,-d),l))*(o+2*d)+h;else o=u>0?-l:l,a=-(i=Math.max(0,-(u*o+c)))*i+o*(o+2*d)+h;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(nr).multiplyScalar(o).add(tr),a}),intersectSphere:function(){var e=new Lt;return function(t,n){e.subVectors(t.center,this.origin);var r=e.dot(this.direction),i=e.dot(e)-r*r,o=t.radius*t.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,l=r+a;return s<0&&l<0?null:s<0?this.at(l,n):this.at(s,n)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,o,a,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(i=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(i=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),c>=0?(a=(e.min.z-d.z)*c,s=(e.max.z-d.z)*c):(a=(e.max.z-d.z)*c,s=(e.min.z-d.z)*c),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:(er=new Lt,function(e){return null!==this.intersectBox(e,er)}),intersectTriangle:function(){var e=new Lt,t=new Lt,n=new Lt,r=new Lt;return function(i,o,a,s,l){t.subVectors(o,i),n.subVectors(a,i),r.crossVectors(t,n);var u,c=this.direction.dot(r);if(c>0){if(s)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}e.subVectors(this.origin,i);var d=u*this.direction.dot(n.crossVectors(e,n));if(d<0)return null;var h=u*this.direction.dot(t.cross(e));if(h<0)return null;if(d+h>c)return null;var p=-u*e.dot(r);return p<0?null:this.at(p/c,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(gr,{getNormal:(or=new Lt,function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Lt),r.subVectors(n,t),or.subVectors(e,t),r.cross(or);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:function(){var e=new Lt,t=new Lt,n=new Lt;return function(r,i,o,a,s){e.subVectors(a,i),t.subVectors(o,i),n.subVectors(r,i);var l=e.dot(e),u=e.dot(t),c=e.dot(n),d=t.dot(t),h=t.dot(n),p=l*d-u*u;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Lt),0===p)return s.set(-2,-1,-1);var f=1/p,m=(d*c-u*h)*f,g=(l*h-u*c)*f;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var e=new Lt;return function(t,n,r,i){return gr.getBarycoord(t,n,r,i,e),e.x>=0&&e.y>=0&&e.x+e.y<=1}}(),getUV:(ir=new Lt,function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,ir),s.set(0,0),s.addScaledVector(i,ir.x),s.addScaledVector(o,ir.y),s.addScaledVector(a,ir.z),s}),isFrontFacing:function(){var e=new Lt,t=new Lt;return function(n,r,i,o){return e.subVectors(i,r),t.subVectors(n,r),e.cross(t).dot(o)<0}}()}),Object.assign(gr.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Lt,t=new Lt;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Lt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return gr.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Lt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return gr.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,r,i){return gr.getUV(e,this.a,this.b,this.c,t,n,r,i)},containsPoint:function(e){return gr.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return gr.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(ar=new Lt,sr=new Lt,lr=new Lt,ur=new Lt,cr=new Lt,dr=new Lt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Lt);var n,r,i=this.a,o=this.b,a=this.c;ar.subVectors(o,i),sr.subVectors(a,i),ur.subVectors(e,i);var s=ar.dot(ur),l=sr.dot(ur);if(s<=0&&l<=0)return t.copy(i);cr.subVectors(e,o);var u=ar.dot(cr),c=sr.dot(cr);if(u>=0&&c<=u)return t.copy(o);var d=s*c-u*l;if(d<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(ar,n);dr.subVectors(e,a);var h=ar.dot(dr),p=sr.dot(dr);if(p>=0&&h<=p)return t.copy(a);var f=h*l-s*p;if(f<=0&&l>=0&&p<=0)return r=l/(l-p),t.copy(i).addScaledVector(sr,r);var m=u*p-h*c;if(m<=0&&c-u>=0&&h-p>=0)return lr.subVectors(a,o),r=(c-u)/(c-u+(h-p)),t.copy(o).addScaledVector(lr,r);var g=1/(m+f+d);return n=f*g,r=d*g,t.copy(i).addScaledVector(ar,n).addScaledVector(sr,r)}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),yr.prototype=Object.create(Jn.prototype),yr.prototype.constructor=yr,yr.prototype.isMeshBasicMaterial=!0,yr.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},vr.prototype=Object.assign(Object.create(Cn.prototype),{constructor:vr,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Cn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(){var e=new an,t=new mr,n=new nn,r=new Lt,i=new Lt,o=new Lt,a=new Lt,s=new Lt,l=new Lt,u=new Lt,c=new Lt,d=new Lt,h=new Ct,p=new Ct,f=new Ct,y=new Lt,v=new Lt;function b(e,t,n,r,i,o,a,s){if(null===(t.side===m?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side!==g,s)))return null;v.copy(s),v.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(v);return l<n.near||l>n.far?null:{distance:l,point:v.clone(),object:e}}function _(e,t,n,m,g,v,_,E,w,T){r.fromBufferAttribute(g,E),i.fromBufferAttribute(g,w),o.fromBufferAttribute(g,T);var A=e.morphTargetInfluences;if(t.morphTargets&&v&&A){u.set(0,0,0),c.set(0,0,0),d.set(0,0,0);for(var S=0,x=v.length;S<x;S++){var I=A[S],R=v[S];0!==I&&(a.fromBufferAttribute(R,E),s.fromBufferAttribute(R,w),l.fromBufferAttribute(R,T),u.addScaledVector(a.sub(r),I),c.addScaledVector(s.sub(i),I),d.addScaledVector(l.sub(o),I))}r.add(u),i.add(c),o.add(d)}var C=b(e,t,n,m,r,i,o,y);if(C){_&&(h.fromBufferAttribute(_,E),p.fromBufferAttribute(_,w),f.fromBufferAttribute(_,T),C.uv=gr.getUV(y,r,i,o,h,p,f,new Ct));var M=new _n(E,w,T);gr.getNormal(r,i,o,M.normal),C.face=M}return C}return function(r,i){var o,a=this.geometry,s=this.material,l=this.matrixWorld;if(void 0!==s&&(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(l),!1!==r.ray.intersectsSphere(n)&&(e.getInverse(l),t.copy(r.ray).applyMatrix4(e),null===a.boundingBox||!1!==t.intersectsBox(a.boundingBox))))if(a.isBufferGeometry){var u,c,d,m,g,v,E,w,T,A=a.index,S=a.attributes.position,x=a.morphAttributes.position,I=a.attributes.uv,R=a.groups,C=a.drawRange;if(null!==A)if(Array.isArray(s))for(m=0,v=R.length;m<v;m++)for(T=s[(w=R[m]).materialIndex],g=Math.max(w.start,C.start),E=Math.min(w.start+w.count,C.start+C.count);g<E;g+=3)u=A.getX(g),c=A.getX(g+1),d=A.getX(g+2),(o=_(this,T,r,t,S,x,I,u,c,d))&&(o.faceIndex=Math.floor(g/3),o.face.materialIndex=w.materialIndex,i.push(o));else for(m=Math.max(0,C.start),v=Math.min(A.count,C.start+C.count);m<v;m+=3)u=A.getX(m),c=A.getX(m+1),d=A.getX(m+2),(o=_(this,s,r,t,S,x,I,u,c,d))&&(o.faceIndex=Math.floor(m/3),i.push(o));else if(void 0!==S)if(Array.isArray(s))for(m=0,v=R.length;m<v;m++)for(T=s[(w=R[m]).materialIndex],g=Math.max(w.start,C.start),E=Math.min(w.start+w.count,C.start+C.count);g<E;g+=3)(o=_(this,T,r,t,S,x,I,u=g,c=g+1,d=g+2))&&(o.faceIndex=Math.floor(g/3),o.face.materialIndex=w.materialIndex,i.push(o));else for(m=Math.max(0,C.start),v=Math.min(S.count,C.start+C.count);m<v;m+=3)(o=_(this,s,r,t,S,x,I,u=m,c=m+1,d=m+2))&&(o.faceIndex=Math.floor(m/3),i.push(o))}else if(a.isGeometry){var M,L,P,D,O=Array.isArray(s),N=a.vertices,k=a.faces,F=a.faceVertexUvs[0];F.length>0&&(D=F);for(var B=0,U=k.length;B<U;B++){var z=k[B],G=O?s[z.materialIndex]:s;if(void 0!==G&&(M=N[z.a],L=N[z.b],P=N[z.c],o=b(this,G,r,t,M,L,P,y))){if(D&&D[B]){var V=D[B];h.copy(V[0]),p.copy(V[1]),f.copy(V[2]),o.uv=gr.getUV(y,M,L,P,h,p,f,new Ct)}o.face=z,o.faceIndex=B,i.push(o)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Mr.prototype=Object.create(Kt.prototype),Mr.prototype.constructor=Mr,Mr.prototype.isCubeTexture=!0,Object.defineProperty(Mr.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Lr.prototype=Object.create(Kt.prototype),Lr.prototype.constructor=Lr,Lr.prototype.isDataTexture2DArray=!0,Pr.prototype=Object.create(Kt.prototype),Pr.prototype.constructor=Pr,Pr.prototype.isDataTexture3D=!0;var Dr=new Kt,Or=new Lr,Nr=new Pr,kr=new Mr,Fr=[],Br=[],Ur=new Float32Array(16),zr=new Float32Array(9),Gr=new Float32Array(4);function Vr(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=Fr[i];if(void 0===o&&(o=new Float32Array(i),Fr[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function jr(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Hr(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Zr(e,t){var n=Br[t];void 0===n&&(n=new Int32Array(t),Br[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function qr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Wr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(jr(n,t))return;e.uniform2fv(this.addr,t),Hr(n,t)}}function Yr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(jr(n,t))return;e.uniform3fv(this.addr,t),Hr(n,t)}}function Kr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(jr(n,t))return;e.uniform4fv(this.addr,t),Hr(n,t)}}function $r(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(jr(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Hr(n,t)}else{if(jr(n,r))return;Gr.set(r),e.uniformMatrix2fv(this.addr,!1,Gr),Hr(n,r)}}function Xr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(jr(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Hr(n,t)}else{if(jr(n,r))return;zr.set(r),e.uniformMatrix3fv(this.addr,!1,zr),Hr(n,r)}}function Qr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(jr(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Hr(n,t)}else{if(jr(n,r))return;Ur.set(r),e.uniformMatrix4fv(this.addr,!1,Ur),Hr(n,r)}}function Jr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Dr,i)}function ei(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Or,i)}function ti(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Nr,i)}function ni(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||kr,i)}function ri(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ii(e,t){var n=this.cache;jr(n,t)||(e.uniform2iv(this.addr,t),Hr(n,t))}function oi(e,t){var n=this.cache;jr(n,t)||(e.uniform3iv(this.addr,t),Hr(n,t))}function ai(e,t){var n=this.cache;jr(n,t)||(e.uniform4iv(this.addr,t),Hr(n,t))}function si(e,t){e.uniform1fv(this.addr,t)}function li(e,t){e.uniform1iv(this.addr,t)}function ui(e,t){e.uniform2iv(this.addr,t)}function ci(e,t){e.uniform3iv(this.addr,t)}function di(e,t){e.uniform4iv(this.addr,t)}function hi(e,t){var n=Vr(t,this.size,2);e.uniform2fv(this.addr,n)}function pi(e,t){var n=Vr(t,this.size,3);e.uniform3fv(this.addr,n)}function fi(e,t){var n=Vr(t,this.size,4);e.uniform4fv(this.addr,n)}function mi(e,t){var n=Vr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function gi(e,t){var n=Vr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function yi(e,t){var n=Vr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function vi(e,t,n){var r=t.length,i=Zr(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(t[o]||Dr,i[o])}function bi(e,t,n){var r=t.length,i=Zr(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(t[o]||kr,i[o])}function _i(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return qr;case 35664:return Wr;case 35665:return Yr;case 35666:return Kr;case 35674:return $r;case 35675:return Xr;case 35676:return Qr;case 35678:case 36198:return Jr;case 35679:return ti;case 35680:return ni;case 36289:return ei;case 5124:case 35670:return ri;case 35667:case 35671:return ii;case 35668:case 35672:return oi;case 35669:case 35673:return ai}}(t.type)}function Ei(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return si;case 35664:return hi;case 35665:return pi;case 35666:return fi;case 35674:return mi;case 35675:return gi;case 35676:return yi;case 35678:return vi;case 35680:return bi;case 5124:case 35670:return li;case 35667:case 35671:return ui;case 35668:case 35672:return ci;case 35669:case 35673:return di}}(t.type)}function wi(e){this.id=e,this.seq=[],this.map={}}Ei.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Hr(t,e)},wi.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var Ti=/([\w\d_]+)(\])?(\[|\.)?/g;function Ai(e,t){e.seq.push(t),e.map[t.id]=t}function Si(e,t,n){var r=e.name,i=r.length;for(Ti.lastIndex=0;;){var o=Ti.exec(r),a=Ti.lastIndex,s=o[1],l="]"===o[2],u=o[3];if(l&&(s|=0),void 0===u||"["===u&&a+2===i){Ai(n,void 0===u?new _i(s,e,t):new Ei(s,e,t));break}var c=n.map[s];void 0===c&&Ai(n,c=new wi(s)),n=c}}function xi(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Si(i,e.getUniformLocation(t,i.name),this)}}function Ii(e,t,n,r){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),!0===r&&(!1===e.getShaderParameter(i,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===t?"vertex":"fragment",e.getShaderInfoLog(i),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n))),i}xi.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},xi.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},xi.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},xi.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var Ri=0;function Ci(e){switch(e){case yt:return["Linear","( value )"];case vt:return["sRGB","( value )"];case _t:return["RGBE","( value )"];case Et:return["RGBM","( value, 7.0 )"];case wt:return["RGBM","( value, 16.0 )"];case Tt:return["RGBD","( value, 256.0 )"];case bt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function Mi(e,t){var n=Ci(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Li(e,t){var n;switch(t){case Q:n="Linear";break;case J:n="Reinhard";break;case ee:n="Uncharted2";break;case te:n="OptimizedCineon";break;case ne:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Pi(e){return""!==e}function Di(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function Oi(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Ni(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){var n=sn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ni(n)}))}function ki(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,(function(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i}))}function Fi(e,t,n,r,i,o,a,s){var l=e.context,u=r.defines,c=i.vertexShader,d=i.fragmentShader,f="SHADOWMAP_TYPE_BASIC";o.shadowMapType===h?f="SHADOWMAP_TYPE_PCF":o.shadowMapType===p&&(f="SHADOWMAP_TYPE_PCF_SOFT");var m="ENVMAP_TYPE_CUBE",g="ENVMAP_MODE_REFLECTION",y="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case re:case ie:m="ENVMAP_TYPE_CUBE";break;case le:case ue:m="ENVMAP_TYPE_CUBE_UV";break;case oe:case ae:m="ENVMAP_TYPE_EQUIREC";break;case se:m="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case ie:case ae:g="ENVMAP_MODE_REFRACTION"}switch(r.combine){case Y:y="ENVMAP_BLENDING_MULTIPLY";break;case K:y="ENVMAP_BLENDING_MIX";break;case $:y="ENVMAP_BLENDING_ADD"}}var v,b,_,E,w=e.gammaFactor>0?e.gammaFactor:1,T=a.isWebGL2?"":function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Pi).join("\n")}(r.extensions,o,t),A=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(u),S=l.createProgram();if(r.isRawShaderMaterial?((v=[A].filter(Pi).join("\n")).length>0&&(v+="\n"),(b=[T,A].filter(Pi).join("\n")).length>0&&(b+="\n")):(v=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,A,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+g:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+f:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Pi).join("\n"),b=[T,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,A,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+w,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+m:"",o.envMap?"#define "+g:"",o.envMap?"#define "+y:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+f:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(a.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&(a.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==X?"#define TONE_MAPPING":"",o.toneMapping!==X?sn.tonemapping_pars_fragment:"",o.toneMapping!==X?Li("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?sn.encodings_pars_fragment:"",o.mapEncoding?Mi("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?Mi("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?Mi("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Mi("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?("linearToOutputTexel",_=o.outputEncoding,E=Ci(_),"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+E[0]+E[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Pi).join("\n")),c=Oi(c=Di(c=Ni(c),o),o),d=Oi(d=Di(d=Ni(d),o),o),c=ki(c),d=ki(d),a.isWebGL2&&!r.isRawShaderMaterial){var x=!1,I=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==c.match(I)&&null!==d.match(I)&&(x=!0,c=c.replace(I,""),d=d.replace(I,"")),v=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,b=["#version 300 es\n","#define varying in",x?"":"out highp vec4 pc_fragColor;",x?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+b}var R,C,M=b+d,L=Ii(l,35633,v+c,e.debug.checkShaderErrors),P=Ii(l,35632,M,e.debug.checkShaderErrors);if(l.attachShader(S,L),l.attachShader(S,P),void 0!==r.index0AttributeName?l.bindAttribLocation(S,0,r.index0AttributeName):!0===o.morphTargets&&l.bindAttribLocation(S,0,"position"),l.linkProgram(S),e.debug.checkShaderErrors){var D=l.getProgramInfoLog(S).trim(),O=l.getShaderInfoLog(L).trim(),N=l.getShaderInfoLog(P).trim(),k=!0,F=!0;!1===l.getProgramParameter(S,35714)?(k=!1,console.error("THREE.WebGLProgram: shader error: ",l.getError(),"35715",l.getProgramParameter(S,35715),"gl.getProgramInfoLog",D,O,N)):""!==D?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",D):""!==O&&""!==N||(F=!1),F&&(this.diagnostics={runnable:k,material:r,programLog:D,vertexShader:{log:O,prefix:v},fragmentShader:{log:N,prefix:b}})}return l.deleteShader(L),l.deleteShader(P),this.getUniforms=function(){return void 0===R&&(R=new xi(l,S,s)),R},this.getAttributes=function(){return void 0===C&&(C=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n}(l,S)),C},this.destroy=function(){l.deleteProgram(S),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=Ri++,this.code=n,this.usedTimes=1,this.program=S,this.vertexShader=L,this.fragmentShader=P,this}function Bi(e,t,n,r){var i=[],o={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},a=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=yt,n===yt&&t&&(n=bt),n}this.getParameters=function(t,r,i,a,l,u,c){var d=o[t.type],h=c.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),o=Math.min(i,t.length);return o<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+o+"."),0):o}(c):0,p=n.precision;null!==t.precision&&(p=n.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",p,"instead.");var f=e.getRenderTarget();return{shaderID:d,precision:p,supportsVertexTextures:n.vertexTextures,outputEncoding:s(f?f.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:s(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:s(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:s(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===le||t.envMap.mapping===ue),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:s(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===It,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!a,useFog:t.fog,fogExp:a&&a.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&h>0,maxBones:h,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.receiveShadow&&i.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===g,flipSided:t.side===m,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)r.push(i),r.push(t.defines[i]);for(var o=0;o<a.length;o++)r.push(n[a[o]]);return r.push(t.onBeforeCompile.toString()),r.push(e.gammaOutput),r.push(e.gammaFactor),r.join()},this.acquireProgram=function(o,a,s,l){for(var u,c=0,d=i.length;c<d;c++){var h=i[c];if(h.code===l){++(u=h).usedTimes;break}}return void 0===u&&(u=new Fi(e,t,l,o,a,s,n,r),i.push(u)),u},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function Ui(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function zi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Gi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Vi(){var e=[],t=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,l){var u=e[t];return void 0===u?(u={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:l},e[t]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=o,u.program=o.program||i,u.groupOrder=a,u.renderOrder=n.renderOrder,u.z=s,u.group=l),t++,u}return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(e,t,i,a,s,l){var u=o(e,t,i,a,s,l);(!0===i.transparent?r:n).push(u)},unshift:function(e,t,i,a,s,l){var u=o(e,t,i,a,s,l);(!0===i.transparent?r:n).unshift(u)},sort:function(){n.length>1&&n.sort(zi),r.length>1&&r.sort(Gi)}}}function ji(){var e={};function t(n){var r=n.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(n,r){var i,o=e[n.id];return void 0===o?(i=new Vi,e[n.id]={},e[n.id][r.id]=i,n.addEventListener("dispose",t)):void 0===(i=o[r.id])&&(i=new Vi,o[r.id]=i),i},dispose:function(){e={}}}}function Hi(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Lt,color:new fn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ct};break;case"SpotLight":n={position:new Lt,direction:new Lt,color:new fn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ct};break;case"PointLight":n={position:new Lt,color:new fn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ct,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Lt,skyColor:new fn,groundColor:new fn};break;case"RectAreaLight":n={color:new fn,position:new Lt,halfWidth:new Lt,halfHeight:new Lt}}return e[t.id]=n,n}}}var Zi=0;function qi(){for(var e=new Hi,t={id:Zi++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=0;n<9;n++)t.probe.push(new Lt);var r=new Lt,i=new an,o=new an;return{setup:function(n,a,s){for(var l=0,u=0,c=0,d=0;d<9;d++)t.probe[d].set(0,0,0);for(var h=0,p=0,f=0,m=0,g=0,y=s.matrixWorldInverse,v=(d=0,n.length);d<v;d++){var b=n[d],_=b.color,E=b.intensity,w=b.distance,T=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)l+=_.r*E,u+=_.g*E,c+=_.b*E;else if(b.isLightProbe)for(var A=0;A<9;A++)t.probe[A].addScaledVector(b.sh.coefficients[A],E);else if(b.isDirectionalLight){if((x=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),x.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(y),x.shadow=b.castShadow,b.castShadow){var S=b.shadow;x.shadowBias=S.bias,x.shadowRadius=S.radius,x.shadowMapSize=S.mapSize}t.directionalShadowMap[h]=T,t.directionalShadowMatrix[h]=b.shadow.matrix,t.directional[h]=x,h++}else if(b.isSpotLight)(x=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(y),x.color.copy(_).multiplyScalar(E),x.distance=w,x.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(y),x.coneCos=Math.cos(b.angle),x.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),x.decay=b.decay,x.shadow=b.castShadow,b.castShadow&&(S=b.shadow,x.shadowBias=S.bias,x.shadowRadius=S.radius,x.shadowMapSize=S.mapSize),t.spotShadowMap[f]=T,t.spotShadowMatrix[f]=b.shadow.matrix,t.spot[f]=x,f++;else if(b.isRectAreaLight)(x=e.get(b)).color.copy(_).multiplyScalar(E),x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(y),o.identity(),i.copy(b.matrixWorld),i.premultiply(y),o.extractRotation(i),x.halfWidth.set(.5*b.width,0,0),x.halfHeight.set(0,.5*b.height,0),x.halfWidth.applyMatrix4(o),x.halfHeight.applyMatrix4(o),t.rectArea[m]=x,m++;else if(b.isPointLight)(x=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(y),x.color.copy(b.color).multiplyScalar(b.intensity),x.distance=b.distance,x.decay=b.decay,x.shadow=b.castShadow,b.castShadow&&(S=b.shadow,x.shadowBias=S.bias,x.shadowRadius=S.radius,x.shadowMapSize=S.mapSize,x.shadowCameraNear=S.camera.near,x.shadowCameraFar=S.camera.far),t.pointShadowMap[p]=T,t.pointShadowMatrix[p]=b.shadow.matrix,t.point[p]=x,p++;else if(b.isHemisphereLight){var x;(x=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),x.direction.transformDirection(y),x.direction.normalize(),x.skyColor.copy(b.color).multiplyScalar(E),x.groundColor.copy(b.groundColor).multiplyScalar(E),t.hemi[g]=x,g++}}t.ambient[0]=l,t.ambient[1]=u,t.ambient[2]=c,t.directional.length=h,t.spot.length=f,t.rectArea.length=m,t.point.length=p,t.hemi.length=g,t.hash.stateID=t.id,t.hash.directionalLength=h,t.hash.pointLength=p,t.hash.spotLength=f,t.hash.rectAreaLength=m,t.hash.hemiLength=g,t.hash.shadowsLength=a.length},state:t}}function Wi(){var e=new qi,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function Yi(){var e={};function t(n){var r=n.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(n,r){var i;return void 0===e[n.id]?(i=new Wi,e[n.id]={},e[n.id][r.id]=i,n.addEventListener("dispose",t)):void 0===e[n.id][r.id]?(i=new Wi,e[n.id][r.id]=i):i=e[n.id][r.id],i},dispose:function(){e={}}}}function Ki(e){Jn.call(this),this.type="MeshDepthMaterial",this.depthPacking=At,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function $i(e){Jn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Lt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Xi(e,t,n){for(var r=new on,i=new an,o=new Ct,a=new Ct(n,n),s=new Lt,l=new Lt,u=1,c=2,d=1+(u|c),p=new Array(d),y=new Array(d),b={},_={0:m,1:f,2:g},E=[new Lt(1,0,0),new Lt(-1,0,0),new Lt(0,0,1),new Lt(0,0,-1),new Lt(0,1,0),new Lt(0,-1,0)],w=[new Lt(0,1,0),new Lt(0,1,0),new Lt(0,1,0),new Lt(0,1,0),new Lt(0,0,1),new Lt(0,0,-1)],T=[new $t,new $t,new $t,new $t,new $t,new $t],A=0;A!==d;++A){var S=0!=(A&u),x=0!=(A&c),I=new Ki({depthPacking:St,morphTargets:S,skinning:x});p[A]=I;var R=new $i({morphTargets:S,skinning:x});y[A]=R}var C=this;function M(t,n,r,i,o,a){var s=t.geometry,l=null,d=p,h=t.customDepthMaterial;if(r&&(d=y,h=t.customDistanceMaterial),h)l=h;else{var f=!1;n.morphTargets&&(s&&s.isBufferGeometry?f=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(f=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var m=t.isSkinnedMesh&&n.skinning,g=0;f&&(g|=u),m&&(g|=c),l=d[g]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var v=l.uuid,E=n.uuid,w=b[v];void 0===w&&(w={},b[v]=w);var T=w[E];void 0===T&&(T=l.clone(),w[E]=T),l=T}return l.visible=n.visible,l.wireframe=n.wireframe,l.side=null!=n.shadowSide?n.shadowSide:_[n.side],l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,r&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(i),l.nearDistance=o,l.farDistance=a),l}function L(n,i,o,a){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var s=t.update(n),u=n.material;if(Array.isArray(u))for(var c=s.groups,d=0,h=c.length;d<h;d++){var p=c[d],f=u[p.materialIndex];if(f&&f.visible){var m=M(n,f,a,l,o.near,o.far);e.renderBufferDirect(o,null,s,m,n,p)}}else u.visible&&(m=M(n,u,a,l,o.near,o.far),e.renderBufferDirect(o,null,s,m,n,null))}for(var g=n.children,y=0,v=g.length;y<v;y++)L(g[y],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=h,this.render=function(t,n,u){if(!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)&&0!==t.length){var c,d=e.getRenderTarget(),h=e.getActiveCubeFace(),p=e.getActiveMipMapLevel(),f=e.state;f.setBlending(v),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var m=0,g=t.length;m<g;m++){var y=t[m],b=y.shadow,_=y&&y.isPointLight;if(void 0!==b){var A=b.camera;if(o.copy(b.mapSize),o.min(a),_){var S=o.x,x=o.y;T[0].set(2*S,x,S,x),T[1].set(0,x,S,x),T[2].set(3*S,x,S,x),T[3].set(S,x,S,x),T[4].set(3*S,0,S,x),T[5].set(S,0,S,x),o.x*=4,o.y*=2}if(null===b.map){var I={minFilter:pe,magFilter:pe,format:De};b.map=new Xt(o.x,o.y,I),b.map.texture.name=y.name+".shadowMap",A.updateProjectionMatrix()}b.isSpotLightShadow&&b.update(y);var R=b.map,M=b.matrix;l.setFromMatrixPosition(y.matrixWorld),A.position.copy(l),_?(c=6,M.makeTranslation(-l.x,-l.y,-l.z)):(c=1,s.setFromMatrixPosition(y.target.matrixWorld),A.lookAt(s),A.updateMatrixWorld(),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(A.projectionMatrix),M.multiply(A.matrixWorldInverse)),e.setRenderTarget(R),e.clear();for(var P=0;P<c;P++){if(_){s.copy(A.position),s.add(E[P]),A.up.copy(w[P]),A.lookAt(s),A.updateMatrixWorld();var D=T[P];f.viewport(D)}i.multiplyMatrices(A.projectionMatrix,A.matrixWorldInverse),r.setFromMatrix(i),L(n,u,A,_)}}else console.warn("THREE.WebGLShadowMap:",y,"has no shadow.")}C.needsUpdate=!1,e.setRenderTarget(d,h,p)}}}function Qi(e,t,n,r){var i=new function(){var t=!1,n=new $t,r=null,i=new $t(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?oe(2929):ae(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case z:e.depthFunc(512);break;case G:e.depthFunc(519);break;case V:e.depthFunc(513);break;case j:e.depthFunc(515);break;case H:e.depthFunc(514);break;case Z:e.depthFunc(518);break;case q:e.depthFunc(516);break;case W:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},a=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,u=null;return{setTest:function(e){e?oe(2960):ae(2960)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&l===r||(e.stencilOp(t,n,r),a=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,u=null}}},s=e.getParameter(34921),l=new Uint8Array(s),h=new Uint8Array(s),p=new Uint8Array(s),f={},y=null,S=null,x=null,I=null,R=null,C=null,M=null,L=null,P=null,D=null,O=!1,N=null,k=null,F=null,B=null,U=null,Y=e.getParameter(35661),K=!1,$=0,X=e.getParameter(7938);-1!==X.indexOf("WebGL")?($=parseFloat(/^WebGL\ ([0-9])/.exec(X)[1]),K=$>=1):-1!==X.indexOf("OpenGL ES")&&($=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(X)[1]),K=$>=2);var Q=null,J={},ee=new $t,te=new $t;function ne(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var a=0;a<r;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var re={};function ie(n,i){l[n]=1,0===h[n]&&(e.enableVertexAttribArray(n),h[n]=1),p[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),p[n]=i)}function oe(t){!0!==f[t]&&(e.enable(t),f[t]=!0)}function ae(t){!1!==f[t]&&(e.disable(t),f[t]=!1)}function se(t,r,i,o,a,s,l,u){if(t!==v){if(x||(oe(3042),x=!0),t===T)a=a||r,s=s||i,l=l||o,r===R&&a===L||(e.blendEquationSeparate(n.convert(r),n.convert(a)),R=r,L=a),i===C&&o===M&&s===P&&l===D||(e.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(l)),C=i,M=o,P=s,D=l),I=t,O=null;else if(t!==I||u!==O){if(R===A&&L===A||(e.blendEquation(32774),R=A,L=A),u)switch(t){case b:e.blendFuncSeparate(1,771,1,771);break;case _:e.blendFunc(1,1);break;case E:e.blendFuncSeparate(0,0,769,771);break;case w:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case b:e.blendFuncSeparate(770,771,1,771);break;case _:e.blendFunc(770,1);break;case E:e.blendFunc(0,769);break;case w:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}C=null,M=null,P=null,D=null,I=t,O=u}}else x&&(ae(3042),x=!1)}function le(t){N!==t&&(t?e.frontFace(2304):e.frontFace(2305),N=t)}function ue(t){t!==u?(oe(2884),t!==k&&(t===c?e.cullFace(1029):t===d?e.cullFace(1028):e.cullFace(1032))):ae(2884),k=t}function ce(t,n,r){t?(oe(32823),B===n&&U===r||(e.polygonOffset(n,r),B=n,U=r)):ae(32823)}function de(t){void 0===t&&(t=33984+Y-1),Q!==t&&(e.activeTexture(t),Q=t)}return re[3553]=ne(3553,3553,1),re[34067]=ne(34067,34069,6),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),oe(2929),o.setFunc(j),le(!1),ue(c),oe(2884),se(v),{buffers:{color:i,depth:o,stencil:a},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){ie(e,0)},enableAttributeAndDivisor:ie,disableUnusedAttributes:function(){for(var t=0,n=h.length;t!==n;++t)h[t]!==l[t]&&(e.disableVertexAttribArray(t),h[t]=0)},enable:oe,disable:ae,getCompressedTextureFormats:function(){if(null===y&&(y=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var n=e.getParameter(34467),r=0;r<n.length;r++)y.push(n[r]);return y},useProgram:function(t){return S!==t&&(e.useProgram(t),S=t,!0)},setBlending:se,setMaterial:function(e,t){e.side===g?ae(2884):oe(2884);var n=e.side===m;t&&(n=!n),le(n),e.blending===b&&!1===e.transparent?se(v):se(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),i.setMask(e.colorWrite),ce(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:le,setCullFace:ue,setLineWidth:function(t){t!==F&&(K&&e.lineWidth(t),F=t)},setPolygonOffset:ce,setScissorTest:function(e){e?oe(3089):ae(3089)},activeTexture:de,bindTexture:function(t,n){null===Q&&de();var r=J[Q];void 0===r&&(r={type:void 0,texture:void 0},J[Q]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||re[t]),r.type=t,r.texture=n)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===ee.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ee.copy(t))},viewport:function(t){!1===te.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),te.copy(t))},reset:function(){for(var t=0;t<h.length;t++)1===h[t]&&(e.disableVertexAttribArray(t),h[t]=0);f={},y=null,Q=null,J={},S=null,I=null,N=null,k=null,i.reset(),o.reset(),a.reset()}}}function Ji(e,t,n,r,i,o,a){var s,l={},u="undefined"!=typeof OffscreenCanvas;function c(e,t){return u?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function d(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var o=t?Rt.floorPowerOfTwo:Math.floor,a=o(i*e.width),l=o(i*e.height);void 0===s&&(s=c(a,l));var u=n?c(a,l):s;return u.width=a,u.height=l,u.getContext("2d").drawImage(e,0,0,a,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+l+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function h(e){return Rt.isPowerOfTwo(e.width)&&Rt.isPowerOfTwo(e.height)}function p(e,t){return e.generateMipmaps&&t&&e.minFilter!==pe&&e.minFilter!==ge}function f(t,n,i,o){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function m(e,n){if(!i.isWebGL2)return e;var r=e;return 6403===e&&(5126===n&&(r=33326),5131===n&&(r=33325),5121===n&&(r=33321)),6407===e&&(5126===n&&(r=34837),5131===n&&(r=34843),5121===n&&(r=32849)),6408===e&&(5126===n&&(r=34836),5131===n&&(r=34842),5121===n&&(r=32856)),33325===r||33326===r||34842===r||34836===r?t.get("EXT_color_buffer_float"):34843!==r&&34837!==r||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),r}function g(e){return e===pe||e===fe||e===me?9728:9729}function y(t){var n=t.target;n.removeEventListener("dispose",y),function(t){var n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(n),n.isVideoTexture&&delete l[n.id],a.memory.textures--}function v(t){var n=t.target;n.removeEventListener("dispose",v),function(t){var n=r.get(t),i=r.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}}(n),a.memory.textures--}var b=0;function _(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=e.id,n=a.render.frame;l[t]!==n&&(l[t]=n,e.update())}(e),e.version>0&&i.__version!==e.version){var o=e.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void S(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function E(t,a){var s=r.get(t);if(6===t.image.length)if(t.version>0&&s.__version!==t.version){A(s,t),n.activeTexture(33984+a),n.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,t.flipY);for(var l=t&&t.isCompressedTexture,u=t.image[0]&&t.image[0].isDataTexture,c=[],g=0;g<6;g++)c[g]=l||u?u?t.image[g].image:t.image[g]:d(t.image[g],!1,!0,i.maxCubemapSize);var y=c[0],v=h(y)||i.isWebGL2,b=o.convert(t.format),_=o.convert(t.type),E=m(b,_);for(T(34067,t,v),g=0;g<6;g++)if(l)for(var w,S=c[g].mipmaps,x=0,I=S.length;x<I;x++)w=S[x],t.format!==De&&t.format!==Pe?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(34069+g,x,E,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+g,x,E,w.width,w.height,0,b,_,w.data);else u?n.texImage2D(34069+g,0,E,c[g].width,c[g].height,0,b,_,c[g].data):n.texImage2D(34069+g,0,E,b,_,c[g]);s.__maxMipLevel=l?S.length-1:0,p(t,v)&&f(34067,t,y.width,y.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+a),n.bindTexture(34067,s.__webglTexture)}function w(e,t){n.activeTexture(33984+t),n.bindTexture(34067,r.get(e).__webglTexture)}function T(n,a,s){var l;if(s?(e.texParameteri(n,10242,o.convert(a.wrapS)),e.texParameteri(n,10243,o.convert(a.wrapT)),32879!==n&&35866!==n||e.texParameteri(n,32882,o.convert(a.wrapR)),e.texParameteri(n,10240,o.convert(a.magFilter)),e.texParameteri(n,10241,o.convert(a.minFilter))):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===de&&a.wrapT===de||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,g(a.magFilter)),e.texParameteri(n,10241,g(a.minFilter)),a.minFilter!==pe&&a.minFilter!==ge&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),l=t.get("EXT_texture_filter_anisotropic")){if(a.type===Se&&null===t.get("OES_texture_float_linear"))return;if(a.type===xe&&null===(i.isWebGL2||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function A(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",y),t.__webglTexture=e.createTexture(),a.memory.textures++)}function S(t,r,a){var s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),A(t,r),n.activeTexture(33984+a),n.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var l=function(e){return!i.isWebGL2&&(e.wrapS!==de||e.wrapT!==de||e.minFilter!==pe&&e.minFilter!==ge)}(r)&&!1===h(r.image),u=d(r.image,l,!1,i.maxTextureSize),c=h(u)||i.isWebGL2,g=o.convert(r.format),y=o.convert(r.type),v=m(g,y);T(s,r,c);var b,_=r.mipmaps;if(r.isDepthTexture){if(v=6402,r.type===Se){if(!i.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");v=36012}else i.isWebGL2&&(v=33189);r.format===ke&&6402===v&&r.type!==we&&r.type!==Ae&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=we,y=o.convert(r.type)),r.format===Fe&&(v=34041,r.type!==Me&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Me,y=o.convert(r.type))),n.texImage2D(3553,0,v,u.width,u.height,0,g,y,null)}else if(r.isDataTexture)if(_.length>0&&c){for(var E=0,w=_.length;E<w;E++)b=_[E],n.texImage2D(3553,E,v,b.width,b.height,0,g,y,b.data);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,v,u.width,u.height,0,g,y,u.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(E=0,w=_.length;E<w;E++)b=_[E],r.format!==De&&r.format!==Pe?n.getCompressedTextureFormats().indexOf(g)>-1?n.compressedTexImage2D(3553,E,v,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,E,v,b.width,b.height,0,g,y,b.data);t.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,v,u.width,u.height,u.depth,0,g,y,u.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,v,u.width,u.height,u.depth,0,g,y,u.data),t.__maxMipLevel=0;else if(_.length>0&&c){for(E=0,w=_.length;E<w;E++)b=_[E],n.texImage2D(3553,E,v,g,y,b);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,v,g,y,u),t.__maxMipLevel=0;p(r,c)&&f(3553,r,u.width,u.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function x(t,i,a,s){var l=o.convert(i.texture.format),u=o.convert(i.texture.type),c=m(l,u);n.texImage2D(s,0,c,i.width,i.height,0,l,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function I(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){if(r){var i=R(n);e.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else e.renderbufferStorage(36161,33189,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer)r?(i=R(n),e.renderbufferStorageMultisample(36161,i,34041,n.width,n.height)):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t);else{var a=m(o.convert(n.texture.format),o.convert(n.texture.type));r?(i=R(n),e.renderbufferStorageMultisample(36161,i,a,n.width,n.height)):e.renderbufferStorage(36161,a,n.width,n.height)}e.bindRenderbuffer(36161,null)}function R(e){return i.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(i.maxSamples,e.samples):0}var C=!1,M=!1;this.allocateTextureUnit=function(){var e=b;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),b+=1,e},this.resetTextureUnits=function(){b=0},this.setTexture2D=_,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?S(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?S(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=E,this.setTextureCubeDynamic=w,this.setupRenderTarget=function(t){var s=r.get(t),l=r.get(t.texture);t.addEventListener("dispose",v),l.__webglTexture=e.createTexture(),a.memory.textures++;var u=!0===t.isWebGLRenderTargetCube,c=!0===t.isWebGLMultisampleRenderTarget,d=h(t)||i.isWebGL2;if(u){s.__webglFramebuffer=[];for(var g=0;g<6;g++)s.__webglFramebuffer[g]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),c)if(i.isWebGL2){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var y=m(o.convert(t.texture.format),o.convert(t.texture.type)),b=R(t);e.renderbufferStorageMultisample(36161,b,y,t.width,t.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),I(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){for(n.bindTexture(34067,l.__webglTexture),T(34067,t.texture,d),g=0;g<6;g++)x(s.__webglFramebuffer[g],t,36064,34069+g);p(t.texture,d)&&f(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,l.__webglTexture),T(3553,t.texture,d),x(s.__webglFramebuffer,t,36064,3553),p(t.texture,d)&&f(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&function(t){var n=r.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),_(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===ke)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Fe)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),I(n.__webglDepthbuffer[o],t)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),I(n.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(p(t,h(e)||i.isWebGL2)){var o=e.isWebGLRenderTargetCube?34067:3553,a=r.get(t).__webglTexture;n.bindTexture(o,a),f(o,t,e.width,e.height),n.bindTexture(o,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(i.isWebGL2){var n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var o=t.width,a=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,o,a,0,0,o,a,s,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===C&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),C=!0),e=e.texture),_(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===M&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),M=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?E(e,t):w(e,t)}}function eo(e,t,n){return{convert:function(e){var r;if(e===ce)return 10497;if(e===de)return 33071;if(e===he)return 33648;if(e===pe)return 9728;if(e===fe)return 9984;if(e===me)return 9986;if(e===ge)return 9729;if(e===ye)return 9985;if(e===ve)return 9987;if(e===be)return 5121;if(e===Ie)return 32819;if(e===Re)return 32820;if(e===Ce)return 33635;if(e===_e)return 5120;if(e===Ee)return 5122;if(e===we)return 5123;if(e===Te)return 5124;if(e===Ae)return 5125;if(e===Se)return 5126;if(e===xe){if(n.isWebGL2)return 5131;if(null!==(r=t.get("OES_texture_half_float")))return r.HALF_FLOAT_OES}if(e===Le)return 6406;if(e===Pe)return 6407;if(e===De)return 6408;if(e===Oe)return 6409;if(e===Ne)return 6410;if(e===ke)return 6402;if(e===Fe)return 34041;if(e===Be)return 6403;if(e===A)return 32774;if(e===S)return 32778;if(e===x)return 32779;if(e===C)return 0;if(e===M)return 1;if(e===L)return 768;if(e===P)return 769;if(e===D)return 770;if(e===O)return 771;if(e===N)return 772;if(e===k)return 773;if(e===F)return 774;if(e===B)return 775;if(e===U)return 776;if((e===Ue||e===ze||e===Ge||e===Ve)&&null!==(r=t.get("WEBGL_compressed_texture_s3tc"))){if(e===Ue)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ze)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Ge)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ve)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===je||e===He||e===Ze||e===qe)&&null!==(r=t.get("WEBGL_compressed_texture_pvrtc"))){if(e===je)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===He)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ze)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===qe)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===We&&null!==(r=t.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((e===Ye||e===Ke||e===$e||e===Xe||e===Qe||e===Je||e===et||e===tt||e===nt||e===rt||e===it||e===ot||e===at||e===st)&&null!==(r=t.get("WEBGL_compressed_texture_astc")))return e;if(e===I||e===R){if(n.isWebGL2){if(e===I)return 32775;if(e===R)return 32776}if(null!==(r=t.get("EXT_blend_minmax"))){if(e===I)return r.MIN_EXT;if(e===R)return r.MAX_EXT}}if(e===Me){if(n.isWebGL2)return 34042;if(null!==(r=t.get("WEBGL_depth_texture")))return r.UNSIGNED_INT_24_8_WEBGL}return 0}}}function to(){Cn.call(this),this.type="Group"}function no(){Cn.call(this),this.type="Camera",this.matrixWorldInverse=new an,this.projectionMatrix=new an,this.projectionMatrixInverse=new an}function ro(e,t,n,r){no.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function io(e){ro.call(this),this.cameras=e||[]}Ki.prototype=Object.create(Jn.prototype),Ki.prototype.constructor=Ki,Ki.prototype.isMeshDepthMaterial=!0,Ki.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},$i.prototype=Object.create(Jn.prototype),$i.prototype.constructor=$i,$i.prototype.isMeshDistanceMaterial=!0,$i.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},to.prototype=Object.assign(Object.create(Cn.prototype),{constructor:to,isGroup:!0}),no.prototype=Object.assign(Object.create(Cn.prototype),{constructor:no,isCamera:!0,copy:function(e,t){return Cn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Lt),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Cn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),ro.prototype=Object.assign(Object.create(no.prototype),{constructor:ro,isPerspectiveCamera:!0,copy:function(e,t){return no.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Rt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Rt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Rt.RAD2DEG*Math.atan(Math.tan(.5*Rt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Rt.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Cn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),io.prototype=Object.assign(Object.create(ro.prototype),{constructor:io,isArrayCamera:!0});var oo,ao,so,lo,uo,co,ho=new Lt,po=new Lt;function fo(e,t,n){ho.setFromMatrixPosition(t.matrixWorld),po.setFromMatrixPosition(n.matrixWorld);var r=ho.distanceTo(po),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],d=(o[8]+1)/o[0],h=a*c,p=a*d,f=r/(-c+d),m=f*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=a+f,y=s+f,v=h-m,b=p+(r-m),_=l*s/y*g,E=u*s/y*g;e.projectionMatrix.makePerspective(v,b,_,E,g,y)}function mo(e){var t,n,r=this,i=null,o=null,a=null,s=[],l=new an,u=new an,c=1,d="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(o=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",E,!1));var h=new an,p=new Mt,f=new Lt,m=new ro;m.viewport=new $t,m.layers.enable(1);var g=new ro;g.viewport=new $t,g.layers.enable(2);var y=new io([m,g]);function v(){return null!==i&&!0===i.isPresenting}y.layers.enable(1),y.layers.enable(2);var b,_=new Ct;function E(){if(v()){var o=i.getEyeParameters("left");t=2*o.renderWidth*c,n=o.renderHeight*c,b=e.getPixelRatio(),e.getSize(_),e.setDrawingBufferSize(t,n,1),m.viewport.set(0,0,t/2,n),g.viewport.set(t/2,0,t/2,n),S.start()}else r.enabled&&e.setDrawingBufferSize(_.width,_.height,b),S.stop()}var w=[];function T(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0,i=t.length;n<i;n++){var o=t[n];if(o&&("Daydream Controller"===o.id||"Gear VR Controller"===o.id||"Oculus Go Controller"===o.id||"OpenVR Gamepad"===o.id||o.id.startsWith("Oculus Touch")||o.id.startsWith("Spatial Controller"))){if(r===e)return o;r++}}}function A(e,r){null!==r&&4===r.length&&e.set(r[0]*t,r[1]*n,r[2]*t,r[3]*n)}this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new to).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.getDevice=function(){return i},this.setDevice=function(e){void 0!==e&&(i=e),S.setContext(e)},this.setFramebufferScaleFactor=function(e){c=e},this.setReferenceSpaceType=function(e){d=e},this.setPoseTarget=function(e){void 0!==e&&(a=e)},this.getCamera=function(e){var t="local-floor"===d?1.6:0;if(!1===v())return e.position.set(0,t,0),e.rotation.set(0,0,0),e;if(i.depthNear=e.near,i.depthFar=e.far,i.getFrameData(o),"local-floor"===d){var n=i.stageParameters;n?l.fromArray(n.sittingToStandingTransform):l.makeTranslation(0,t,0)}var r=o.pose,c=null!==a?a:e;c.matrix.copy(l),c.matrix.decompose(c.position,c.quaternion,c.scale),null!==r.orientation&&(p.fromArray(r.orientation),c.quaternion.multiply(p)),null!==r.position&&(p.setFromRotationMatrix(l),f.fromArray(r.position),f.applyQuaternion(p),c.position.add(f)),c.updateMatrixWorld(),m.near=e.near,g.near=e.near,m.far=e.far,g.far=e.far,m.matrixWorldInverse.fromArray(o.leftViewMatrix),g.matrixWorldInverse.fromArray(o.rightViewMatrix),u.getInverse(l),"local-floor"===d&&(m.matrixWorldInverse.multiply(u),g.matrixWorldInverse.multiply(u));var b=c.parent;null!==b&&(h.getInverse(b.matrixWorld),m.matrixWorldInverse.multiply(h),g.matrixWorldInverse.multiply(h)),m.matrixWorld.getInverse(m.matrixWorldInverse),g.matrixWorld.getInverse(g.matrixWorldInverse),m.projectionMatrix.fromArray(o.leftProjectionMatrix),g.projectionMatrix.fromArray(o.rightProjectionMatrix),fo(y,m,g);var _=i.getLayers();if(_.length){var E=_[0];A(m.viewport,E.leftBounds),A(g.viewport,E.rightBounds)}return function(){for(var e=0;e<s.length;e++){var t=s[e],n=T(e);if(void 0!==n&&void 0!==n.pose){if(null===n.pose)return;var r=n.pose;!1===r.hasPosition&&t.position.set(.2,-.6,-.05),null!==r.position&&t.position.fromArray(r.position),null!==r.orientation&&t.quaternion.fromArray(r.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(l),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var i="Daydream Controller"===n.id?0:1;void 0===w[e]&&(w[e]=!1),w[e]!==n.buttons[i].pressed&&(w[e]=n.buttons[i].pressed,!0===w[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),y},this.getStandingMatrix=function(){return l},this.isPresenting=v;var S=new vn;this.setAnimationLoop=function(e){S.setAnimationLoop(e),v()&&S.start()},this.submitFrame=function(){v()&&i.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",E)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function go(e){var t=e.context,n=null,r=null,i="local-floor",o=null,a=[],s=[];function l(){return null!==n&&null!==r}var u=new ro;u.layers.enable(1),u.viewport=new $t;var c=new ro;c.layers.enable(2),c.viewport=new $t;var d=new io([u,c]);function h(e){for(var t=0;t<a.length;t++)s[t]===e.inputSource&&a[t].dispatchEvent({type:e.type})}function p(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),y.stop()}function f(e){r=e,y.setContext(n),y.start()}function m(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}d.layers.enable(1),d.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=a[e];return void 0===t&&((t=new to).matrixAutoUpdate=!1,t.visible=!1,a[e]=t),t},this.setFramebufferScaleFactor=function(e){},this.setReferenceSpaceType=function(e){i=e},this.getSession=function(){return n},this.setSession=function(e){null!==(n=e)&&(n.addEventListener("select",h),n.addEventListener("selectstart",h),n.addEventListener("selectend",h),n.addEventListener("end",p),n.updateRenderState({baseLayer:new XRWebGLLayer(n,t)}),n.requestReferenceSpace(i).then(f),s=n.inputSources,n.addEventListener("inputsourceschange",(function(){s=n.inputSources,console.log(s);for(var e=0;e<a.length;e++)a[e].userData.inputSource=s[e]})))},this.getCamera=function(e){if(l()){var t=e.parent,n=d.cameras;m(d,t);for(var r=0;r<n.length;r++)m(n[r],t);e.matrixWorld.copy(d.matrixWorld);for(var i=e.children,o=(r=0,i.length);r<o;r++)i[r].updateMatrixWorld(!0);return fo(d,u,c),d}return e},this.isPresenting=l;var g=null,y=new vn;y.setAnimationLoop((function(t,i){if(null!==(o=i.getViewerPose(r))){var l=o.views,u=n.renderState.baseLayer;e.setFramebuffer(u.framebuffer);for(var c=0;c<l.length;c++){var h=l[c],p=u.getViewport(h),f=h.transform.inverse.matrix,m=d.cameras[c];m.matrix.fromArray(f).getInverse(m.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(p.x,p.y,p.width,p.height),0===c&&d.matrix.copy(m.matrix)}}for(c=0;c<a.length;c++){var y=a[c],v=s[c];if(v){var b=i.getPose(v.targetRaySpace,r);if(null!==b){y.matrix.fromArray(b.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.visible=!0;continue}}y.visible=!1}g&&g(t)})),this.setAnimationLoop=function(e){g=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new an},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function yo(e){console.log("THREE.WebGLRenderer",s);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,l=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",d=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,p=null;this.domElement=t,this.context=null,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Q,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,g,y,v,b,_,E,w,T,A,S,x,I,R,C,M,L,P,D=this,O=!1,N=null,k=0,F=0,B=null,U=null,z=-1,G={geometry:null,program:null,wireframe:!1},V=null,j=null,H=new $t,Z=new $t,q=null,W=t.width,Y=t.height,K=1,$=new $t(0,0,W,Y),X=new $t(0,0,W,Y),J=!1,ee=new on,te=new wr,ne=!1,re=!1,ie=new an,oe=new Lt;function ae(){return null===B?K:1}try{var se={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:d,xrCompatible:!0};if(t.addEventListener("webglcontextlost",de,!1),t.addEventListener("webglcontextrestored",he,!1),null===(f=n||t.getContext("webgl",se)||t.getContext("experimental-webgl",se)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function le(){g=new Tr(f),(y=new Er(f,g,e)).isWebGL2||(g.get("WEBGL_depth_texture"),g.get("OES_texture_float"),g.get("OES_texture_half_float"),g.get("OES_texture_half_float_linear"),g.get("OES_standard_derivatives"),g.get("OES_element_index_uint"),g.get("ANGLE_instanced_arrays")),g.get("OES_texture_float_linear"),P=new eo(f,g,y),(v=new Qi(f,g,P,y)).scissor(Z.copy(X).multiplyScalar(K)),v.viewport(H.copy($).multiplyScalar(K)),b=new xr(f),_=new Ui,E=new Ji(f,g,v,_,y,P,b),w=new bn(f),T=new Ar(f,w,b),A=new Cr(T,b),C=new Rr(f),S=new Bi(D,g,y,E),x=new ji,I=new Yi,R=new br(D,v,A,l),M=new _r(f,g,b,y),L=new Sr(f,g,b,y),b.programs=S.programs,D.context=f,D.capabilities=y,D.extensions=g,D.properties=_,D.renderLists=x,D.state=v,D.info=b}le();var ue="undefined"!=typeof navigator&&"xr"in navigator&&"supportsSession"in navigator.xr?new go(D):new mo(D);this.vr=ue;var ce=new Xi(D,A,y.maxTextureSize);function de(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}function he(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1,le()}function pe(e){var t=e.target;t.removeEventListener("dispose",pe),function(e){fe(e),_.remove(e)}(t)}function fe(e){var t=_.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}this.shadowMap=ce,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var e=g.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=g.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(e){void 0!==e&&(K=e,this.setSize(W,Y,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Ct),e.set(W,Y)},this.setSize=function(e,n,r){ue.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=e,Y=n,t.width=e*K,t.height=n*K,!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Ct),e.set(W*K,Y*K)},this.setDrawingBufferSize=function(e,n,r){W=e,Y=n,K=r,t.width=e*r,t.height=n*r,this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new $t),e.copy(H)},this.getViewport=function(e){return e.copy($)},this.setViewport=function(e,t,n,r){e.isVector4?$.set(e.x,e.y,e.z,e.w):$.set(e,t,n,r),v.viewport(H.copy($).multiplyScalar(K))},this.getScissor=function(e){return e.copy(X)},this.setScissor=function(e,t,n,r){e.isVector4?X.set(e.x,e.y,e.z,e.w):X.set(e,t,n,r),v.scissor(Z.copy(X).multiplyScalar(K))},this.getScissorTest=function(){return J},this.setScissorTest=function(e){v.setScissorTest(J=e)},this.getClearColor=function(){return R.getClearColor()},this.setClearColor=function(){R.setClearColor.apply(R,arguments)},this.getClearAlpha=function(){return R.getClearAlpha()},this.setClearAlpha=function(){R.setClearAlpha.apply(R,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),f.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",de,!1),t.removeEventListener("webglcontextrestored",he,!1),x.dispose(),I.dispose(),_.dispose(),A.dispose(),ue.dispose(),ge.stop()},this.renderBufferImmediate=function(e,t){v.initAttributes();var n=_.get(e);e.hasPositions&&!n.position&&(n.position=f.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),e.hasColors&&!n.color&&(n.color=f.createBuffer());var r=t.getAttributes();e.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,e.positionArray,35048),v.enableAttribute(r.position),f.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,e.normalArray,35048),v.enableAttribute(r.normal),f.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,e.uvArray,35048),v.enableAttribute(r.uv),f.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,e.colorArray,35048),v.enableAttribute(r.color),f.vertexAttribPointer(r.color,3,5126,!1,0,0)),v.disableUnusedAttributes(),f.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){var a=i.isMesh&&i.matrixWorld.determinant()<0;v.setMaterial(r,a);var s=we(e,t,r,i),l=!1;G.geometry===n.id&&G.program===s.id&&G.wireframe===(!0===r.wireframe)||(G.geometry=n.id,G.program=s.id,G.wireframe=!0===r.wireframe,l=!0),i.morphTargetInfluences&&(C.update(i,n,r,s),l=!0);var u,c=n.index,d=n.attributes.position,h=1;!0===r.wireframe&&(c=T.getWireframeAttribute(n),h=2);var p=M;null!==c&&(u=w.get(c),(p=L).setIndex(u)),l&&(function(e,t,n){if(n&&n.isInstancedBufferGeometry&&!y.isWebGL2&&null===g.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{v.initAttributes();var r=n.attributes,i=t.getAttributes(),o=e.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var l=r[a];if(void 0!==l){var u=l.normalized,c=l.itemSize,d=w.get(l);if(void 0===d)continue;var h=d.buffer,p=d.type,m=d.bytesPerElement;if(l.isInterleavedBufferAttribute){var b=l.data,_=b.stride,E=l.offset;b&&b.isInstancedInterleavedBuffer?(v.enableAttributeAndDivisor(s,b.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=b.meshPerAttribute*b.count)):v.enableAttribute(s),f.bindBuffer(34962,h),f.vertexAttribPointer(s,c,p,u,_*m,E*m)}else l.isInstancedBufferAttribute?(v.enableAttributeAndDivisor(s,l.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)):v.enableAttribute(s),f.bindBuffer(34962,h),f.vertexAttribPointer(s,c,p,u,0,0)}else if(void 0!==o){var T=o[a];if(void 0!==T)switch(T.length){case 2:f.vertexAttrib2fv(s,T);break;case 3:f.vertexAttrib3fv(s,T);break;case 4:f.vertexAttrib4fv(s,T);break;default:f.vertexAttrib1fv(s,T)}}}}v.disableUnusedAttributes()}}(r,s,n),null!==c&&f.bindBuffer(34963,u.buffer));var m=1/0;null!==c?m=c.count:void 0!==d&&(m=d.count);var b=n.drawRange.start*h,_=n.drawRange.count*h,E=null!==o?o.start*h:0,A=null!==o?o.count*h:1/0,S=Math.max(b,E),x=Math.min(m,b+_,E+A)-1,I=Math.max(0,x-S+1);if(0!==I){if(i.isMesh)if(!0===r.wireframe)v.setLineWidth(r.wireframeLinewidth*ae()),p.setMode(1);else switch(i.drawMode){case ft:p.setMode(4);break;case mt:p.setMode(5);break;case gt:p.setMode(6)}else if(i.isLine){var R=r.linewidth;void 0===R&&(R=1),v.setLineWidth(R*ae()),i.isLineSegments?p.setMode(1):i.isLineLoop?p.setMode(2):p.setMode(3)}else i.isPoints?p.setMode(0):i.isSprite&&p.setMode(4);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&p.renderInstances(n,S,I):p.render(S,I)}},this.compile=function(e,t){(p=I.get(e,t)).init(),e.traverse((function(e){e.isLight&&(p.pushLight(e),e.castShadow&&p.pushShadow(e))})),p.setupLights(t),e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)Ee(t.material[n],e.fog,t);else Ee(t.material,e.fog,t)}))};var me=null,ge=new vn;function ye(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLight)p.pushLight(e),e.castShadow&&p.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||ee.intersectsSprite(e)){r&&oe.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ie);var i=A.update(e);(o=e.material).visible&&h.push(e,i,o,n,oe.z,null)}}else if(e.isImmediateRenderObject)r&&oe.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ie),h.push(e,null,e.material,n,oe.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||ee.intersectsObject(e))){r&&oe.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ie),i=A.update(e);var o=e.material;if(Array.isArray(o))for(var a=i.groups,s=0,l=a.length;s<l;s++){var u=a[s],c=o[u.materialIndex];c&&c.visible&&h.push(e,i,c,n,oe.z,u)}else o.visible&&h.push(e,i,o,n,oe.z,null)}var d=e.children;for(s=0,l=d.length;s<l;s++)ye(d[s],t,n,r)}}function ve(e,t,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,l=a.geometry,u=void 0===r?a.material:r,c=a.group;if(n.isArrayCamera){j=n;for(var d=n.cameras,h=0,f=d.length;h<f;h++){var m=d[h];s.layers.test(m.layers)&&(v.viewport(H.copy(m.viewport)),p.setupLights(m),_e(s,t,m,l,u,c))}}else j=null,_e(s,t,n,l,u,c)}}function _e(e,t,n,r,i,o){if(e.onBeforeRender(D,t,n,r,i,o),p=I.get(t,j||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){v.setMaterial(i);var a=we(n,t.fog,i,e);G.geometry=null,G.program=null,G.wireframe=!1,function(e,t){e.render((function(e){D.renderBufferImmediate(e,t)}))}(e,a)}else D.renderBufferDirect(n,t.fog,r,i,e,o);e.onAfterRender(D,t,n,r,i,o),p=I.get(t,j||n)}function Ee(e,t,n){var r=_.get(e),i=p.state.lights,o=p.state.shadowsArray,a=r.lightsHash,s=i.state.hash,l=S.getParameters(e,i.state,o,t,te.numPlanes,te.numIntersection,n),u=S.getProgramCode(e,l),c=r.program,d=!0;if(void 0===c)e.addEventListener("dispose",pe);else if(c.code!==u)fe(e);else if(a.stateID!==s.stateID||a.directionalLength!==s.directionalLength||a.pointLength!==s.pointLength||a.spotLength!==s.spotLength||a.rectAreaLength!==s.rectAreaLength||a.hemiLength!==s.hemiLength||a.shadowsLength!==s.shadowsLength)a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,d=!1;else{if(void 0!==l.shaderID)return;d=!1}if(d){if(l.shaderID){var h=yn[l.shaderID];r.shader={name:e.type,uniforms:ln(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,D),u=S.getProgramCode(e,l),c=S.acquireProgram(e,r.shader,l,u),r.program=c,e.program=c}var f=c.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var m=0;m<D.maxMorphTargets;m++)f["morphTarget"+m]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals)for(e.numSupportedMorphNormals=0,m=0;m<D.maxMorphNormals;m++)f["morphNormal"+m]>=0&&e.numSupportedMorphNormals++;var g=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=te.numPlanes,r.numIntersection=te.numIntersection,g.clippingPlanes=te.uniform),r.fog=t,void 0===a&&(r.lightsHash=a={}),a.stateID=s.stateID,a.directionalLength=s.directionalLength,a.pointLength=s.pointLength,a.spotLength=s.spotLength,a.rectAreaLength=s.rectAreaLength,a.hemiLength=s.hemiLength,a.shadowsLength=s.shadowsLength,e.lights&&(g.ambientLightColor.value=i.state.ambient,g.lightProbe.value=i.state.probe,g.directionalLights.value=i.state.directional,g.spotLights.value=i.state.spot,g.rectAreaLights.value=i.state.rectArea,g.pointLights.value=i.state.point,g.hemisphereLights.value=i.state.hemi,g.directionalShadowMap.value=i.state.directionalShadowMap,g.directionalShadowMatrix.value=i.state.directionalShadowMatrix,g.spotShadowMap.value=i.state.spotShadowMap,g.spotShadowMatrix.value=i.state.spotShadowMatrix,g.pointShadowMap.value=i.state.pointShadowMap,g.pointShadowMatrix.value=i.state.pointShadowMatrix);var y=r.program.getUniforms(),v=xi.seqWithValue(y.seq,g);r.uniformsList=v}function we(e,t,n,r){E.resetTextureUnits();var i=_.get(n),o=p.state.lights,a=i.lightsHash,s=o.state.hash;if(ne&&(re||e!==V)){var l=e===V&&n.id===z;te.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,i,l)}!1===n.needsUpdate&&(void 0===i.program||n.fog&&i.fog!==t?n.needsUpdate=!0:(!n.lights||a.stateID===s.stateID&&a.directionalLength===s.directionalLength&&a.pointLength===s.pointLength&&a.spotLength===s.spotLength&&a.rectAreaLength===s.rectAreaLength&&a.hemiLength===s.hemiLength&&a.shadowsLength===s.shadowsLength)&&(void 0===i.numClippingPlanes||i.numClippingPlanes===te.numPlanes&&i.numIntersection===te.numIntersection)||(n.needsUpdate=!0)),n.needsUpdate&&(Ee(n,t,r),n.needsUpdate=!1);var u=!1,c=!1,d=!1,h=i.program,g=h.getUniforms(),b=i.shader.uniforms;if(v.useProgram(h.program)&&(u=!0,c=!0,d=!0),n.id!==z&&(z=n.id,c=!0),u||V!==e){if(g.setValue(f,"projectionMatrix",e.projectionMatrix),y.logarithmicDepthBuffer&&g.setValue(f,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),V!==e&&(V=e,c=!0,d=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var w=g.map.cameraPosition;void 0!==w&&w.setValue(f,oe.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&g.setValue(f,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){g.setOptional(f,r,"bindMatrix"),g.setOptional(f,r,"bindMatrixInverse");var T=r.skeleton;if(T){var A=T.bones;if(y.floatVertexTextures){if(void 0===T.boneTexture){var S=Math.sqrt(4*A.length);S=Rt.ceilPowerOfTwo(S),S=Math.max(S,4);var x=new Float32Array(S*S*4);x.set(T.boneMatrices);var I=new en(x,S,S,De,Se);I.needsUpdate=!0,T.boneMatrices=x,T.boneTexture=I,T.boneTextureSize=S}g.setValue(f,"boneTexture",T.boneTexture,E),g.setValue(f,"boneTextureSize",T.boneTextureSize)}else g.setOptional(f,T,"boneMatrices")}}return c&&(g.setValue(f,"toneMappingExposure",D.toneMappingExposure),g.setValue(f,"toneMappingWhitePoint",D.toneMappingWhitePoint),n.lights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(b,d),t&&n.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(b,t),n.isMeshBasicMaterial?Te(b,n):n.isMeshLambertMaterial?(Te(b,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(b,n)):n.isMeshPhongMaterial?(Te(b,n),n.isMeshToonMaterial?function(e,t){Ae(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(b,n):Ae(b,n)):n.isMeshStandardMaterial?(Te(b,n),n.isMeshPhysicalMaterial?function(e,t){Ie(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(b,n):Ie(b,n)):n.isMeshMatcapMaterial?(Te(b,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(b,n)):n.isMeshDepthMaterial?(Te(b,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(b,n)):n.isMeshDistanceMaterial?(Te(b,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(b,n)):n.isMeshNormalMaterial?(Te(b,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(b,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(b,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(b,n)):n.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*K,e.scale.value=.5*Y,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(b,n):n.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(b,n):n.isShadowMaterial&&(b.color.value.copy(n.color),b.opacity.value=n.opacity),void 0!==b.ltc_1&&(b.ltc_1.value=gn.LTC_1),void 0!==b.ltc_2&&(b.ltc_2.value=gn.LTC_2),xi.upload(f,i.uniformsList,b,E)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(xi.upload(f,i.uniformsList,b,E),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&g.setValue(f,"center",r.center),g.setValue(f,"modelViewMatrix",r.modelViewMatrix),g.setValue(f,"normalMatrix",r.normalMatrix),g.setValue(f,"modelMatrix",r.matrixWorld),h}function Te(e,t){var n;e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=_.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function Ae(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Ie(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}ge.setAnimationLoop((function(e){ue.isPresenting()||me&&me(e)})),"undefined"!=typeof window&&ge.setContext(window),this.setAnimationLoop=function(e){me=e,ue.setAnimationLoop(e),ge.start()},this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),t&&t.isCamera){if(!O){G.geometry=null,G.program=null,G.wireframe=!1,z=-1,V=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ue.enabled&&(t=ue.getCamera(t)),(p=I.get(e,t)).init(),e.onBeforeRender(D,e,t,n||B),ie.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ee.setFromMatrix(ie),re=this.localClippingEnabled,ne=te.init(this.clippingPlanes,re,t),(h=x.get(e,t)).init(),ye(e,t,0,D.sortObjects),!0===D.sortObjects&&h.sort(),ne&&te.beginShadows();var i=p.state.shadowsArray;ce.render(i,e,t),p.setupLights(t),ne&&te.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),R.render(h,e,t,r);var o=h.opaque,a=h.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&ve(o,e,t,s),a.length&&ve(a,e,t,s)}else o.length&&ve(o,e,t),a.length&&ve(a,e,t);e.onAfterRender(D,e,t),null!==B&&(E.updateRenderTargetMipmap(B),E.updateMultisampleRenderTarget(B)),v.buffers.depth.setTest(!0),v.buffers.depth.setMask(!0),v.buffers.color.setMask(!0),v.setPolygonOffset(!1),ue.enabled&&ue.submitFrame(),h=null,p=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){N!==e&&f.bindFramebuffer(36160,e),N=e},this.getActiveCubeFace=function(){return k},this.getActiveMipMapLevel=function(){return F},this.getRenderTarget=function(){return B},this.setRenderTarget=function(e,t,n){B=e,k=t,F=n,e&&void 0===_.get(e).__webglFramebuffer&&E.setupRenderTarget(e);var r=N,i=!1;if(e){var o=_.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(r=o[t||0],i=!0):r=e.isWebGLMultisampleRenderTarget?_.get(e).__webglMultisampledFramebuffer:o,H.copy(e.viewport),Z.copy(e.scissor),q=e.scissorTest}else H.copy($).multiplyScalar(K),Z.copy(X).multiplyScalar(K),q=J;if(U!==r&&(f.bindFramebuffer(36160,r),U=r),v.viewport(H),v.scissor(Z),v.setScissorTest(q),i){var a=_.get(e.texture);f.framebufferTexture2D(36160,36064,34069+(t||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(e&&e.isWebGLRenderTarget){var s=_.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube&&void 0!==a&&(s=s[a]),s){var l=!1;s!==U&&(f.bindFramebuffer(36160,s),l=!0);try{var u=e.texture,c=u.format,d=u.type;if(c!==De&&P.convert(c)!==f.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(d===be||P.convert(d)===f.getParameter(35738)||d===Se&&(y.isWebGL2||g.get("OES_texture_float")||g.get("WEBGL_color_buffer_float"))||d===xe&&(y.isWebGL2?g.get("EXT_color_buffer_float"):g.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===f.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&f.readPixels(t,n,r,i,P.convert(c),P.convert(d),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&f.bindFramebuffer(36160,U)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var r=t.image.width,i=t.image.height,o=P.convert(t.format);E.setTexture2D(t,0),f.copyTexImage2D(3553,n||0,o,e.x,e.y,r,i,0)},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,o=t.image.height,a=P.convert(n.format),s=P.convert(n.type);E.setTexture2D(n,0),t.isDataTexture?f.texSubImage2D(3553,r||0,e.x,e.y,i,o,a,s,t.image.data):f.texSubImage2D(3553,r||0,e.x,e.y,a,s,t.image)}}function vo(e,t){this.name="",this.color=new fn(e),this.density=void 0!==t?t:25e-5}function bo(e,t,n){this.name="",this.color=new fn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function _o(){Cn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Eo(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function wo(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function To(e){Jn.call(this),this.type="SpriteMaterial",this.color=new fn(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function Ao(e){if(Cn.call(this),this.type="Sprite",void 0===oo){oo=new Wn;var t=new Eo(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);oo.setIndex([0,1,2,0,2,3]),oo.addAttribute("position",new wo(t,3,0,!1)),oo.addAttribute("uv",new wo(t,2,3,!1))}this.geometry=oo,this.material=void 0!==e?e:new To,this.center=new Ct(.5,.5)}function So(){Cn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function xo(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),vr.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new an,this.bindMatrixInverse=new an}function Io(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new an)}}function Ro(){Cn.call(this),this.type="Bone"}function Co(e){Jn.call(this),this.type="LineBasicMaterial",this.color=new fn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Mo(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Cn.call(this),this.type="Line",this.geometry=void 0!==e?e:new Wn,this.material=void 0!==t?t:new Co({color:16777215*Math.random()})}function Lo(e,t){Mo.call(this,e,t),this.type="LineSegments"}function Po(e,t){Mo.call(this,e,t),this.type="LineLoop"}function Do(e){Jn.call(this),this.type="PointsMaterial",this.color=new fn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Oo(e,t){Cn.call(this),this.type="Points",this.geometry=void 0!==e?e:new Wn,this.material=void 0!==t?t:new Do({color:16777215*Math.random()})}function No(e,t,n,r,i,o,a,s,l){Kt.call(this,e,t,n,r,i,o,a,s,l),this.format=void 0!==a?a:Pe,this.minFilter=void 0!==o?o:ge,this.magFilter=void 0!==i?i:ge,this.generateMipmaps=!1}function ko(e,t,n,r,i,o,a,s,l,u,c,d){Kt.call(this,null,o,a,s,l,u,r,i,c,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Fo(e,t,n,r,i,o,a,s,l){Kt.call(this,e,t,n,r,i,o,a,s,l),this.needsUpdate=!0}function Bo(e,t,n,r,i,o,a,s,l,u){if((u=void 0!==u?u:ke)!==ke&&u!==Fe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===ke&&(n=we),void 0===n&&u===Fe&&(n=Me),Kt.call(this,null,r,i,o,a,s,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:pe,this.minFilter=void 0!==s?s:pe,this.flipY=!1,this.generateMipmaps=!1}function Uo(e){Wn.call(this),this.type="WireframeGeometry";var t,n,r,i,o,a,s,l,u,c,d=[],h=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,r=m.length;t<r;t++){var g=m[t];for(n=0;n<3;n++)s=g[f[n]],l=g[f[(n+1)%3]],h[0]=Math.min(s,l),h[1]=Math.max(s,l),void 0===p[u=h[0]+","+h[1]]&&(p[u]={index1:h[0],index2:h[1]})}for(u in p)a=p[u],c=e.vertices[a.index1],d.push(c.x,c.y,c.z),c=e.vertices[a.index2],d.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var y,v,b,_,E,w,T;if(c=new Lt,null!==e.index){for(y=e.attributes.position,v=e.index,0===(b=e.groups).length&&(b=[{start:0,count:v.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(t=E=(_=b[i]).start,r=E+_.count;t<r;t+=3)for(n=0;n<3;n++)s=v.getX(t+n),l=v.getX(t+(n+1)%3),h[0]=Math.min(s,l),h[1]=Math.max(s,l),void 0===p[u=h[0]+","+h[1]]&&(p[u]={index1:h[0],index2:h[1]});for(u in p)a=p[u],c.fromBufferAttribute(y,a.index1),d.push(c.x,c.y,c.z),c.fromBufferAttribute(y,a.index2),d.push(c.x,c.y,c.z)}else for(t=0,r=(y=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)w=3*t+n,c.fromBufferAttribute(y,w),d.push(c.x,c.y,c.z),T=3*t+(n+1)%3,c.fromBufferAttribute(y,T),d.push(c.x,c.y,c.z)}this.addAttribute("position",new Vn(d,3))}function zo(e,t,n){Dn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Go(e,t,n)),this.mergeVertices()}function Go(e,t,n){Wn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,o=[],a=[],s=[],l=[],u=1e-5,c=new Lt,d=new Lt,h=new Lt,p=new Lt,f=new Lt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=t+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=t;i++){var y=i/t;e(y,g,d),a.push(d.x,d.y,d.z),y-u>=0?(e(y-u,g,h),p.subVectors(d,h)):(e(y+u,g,h),p.subVectors(h,d)),g-u>=0?(e(y,g-u,h),f.subVectors(d,h)):(e(y,g+u,h),f.subVectors(h,d)),c.crossVectors(p,f).normalize(),s.push(c.x,c.y,c.z),l.push(y,g)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var v=r*m+i,b=r*m+i+1,_=(r+1)*m+i+1,E=(r+1)*m+i;o.push(v,b,E),o.push(b,_,E)}this.setIndex(o),this.addAttribute("position",new Vn(a,3)),this.addAttribute("normal",new Vn(s,3)),this.addAttribute("uv",new Vn(l,2))}function Vo(e,t,n,r){Dn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new jo(e,t,n,r)),this.mergeVertices()}function jo(e,t,n,r){Wn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],o=[];function a(e,t,n,r){var i,o,a=Math.pow(2,r),l=[];for(i=0;i<=a;i++){l[i]=[];var u=e.clone().lerp(n,i/a),c=t.clone().lerp(n,i/a),d=a-i;for(o=0;o<=d;o++)l[i][o]=0===o&&i===a?u:u.clone().lerp(c,o/d)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var h=Math.floor(o/2);o%2==0?(s(l[i][h+1]),s(l[i+1][h]),s(l[i][h])):(s(l[i][h+1]),s(l[i+1][h+1]),s(l[i+1][h]))}}function s(e){i.push(e.x,e.y,e.z)}function l(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function u(e,t,n,r){r<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=r/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}function d(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){for(var n=new Lt,r=new Lt,i=new Lt,o=0;o<t.length;o+=3)l(t[o+0],n),l(t[o+1],r),l(t[o+2],i),a(n,r,i,e)}(r=r||0),function(e){for(var t=new Lt,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new Lt,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=c(e)/2/Math.PI+.5,r=d(e)/Math.PI+.5;o.push(n,1-r)}(function(){for(var e=new Lt,t=new Lt,n=new Lt,r=new Lt,a=new Ct,s=new Ct,l=new Ct,d=0,h=0;d<i.length;d+=9,h+=6){e.set(i[d+0],i[d+1],i[d+2]),t.set(i[d+3],i[d+4],i[d+5]),n.set(i[d+6],i[d+7],i[d+8]),a.set(o[h+0],o[h+1]),s.set(o[h+2],o[h+3]),l.set(o[h+4],o[h+5]),r.copy(e).add(t).add(n).divideScalar(3);var p=c(r);u(a,h+0,e,p),u(s,h+2,t,p),u(l,h+4,n,p)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],n=o[e+2],r=o[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),r<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new Vn(i,3)),this.addAttribute("normal",new Vn(i.slice(),3)),this.addAttribute("uv",new Vn(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Ho(e,t){Dn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Zo(e,t)),this.mergeVertices()}function Zo(e,t){jo.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function qo(e,t){Dn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Wo(e,t)),this.mergeVertices()}function Wo(e,t){jo.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Yo(e,t){Dn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ko(e,t)),this.mergeVertices()}function Ko(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];jo.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function $o(e,t){Dn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Xo(e,t)),this.mergeVertices()}function Xo(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];jo.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Qo(e,t,n,r,i,o){Dn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Jo(e,t,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Jo(e,t,n,r,i){Wn.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,l=new Lt,u=new Lt,c=new Ct,d=new Lt,h=[],p=[],f=[],m=[];function g(i){d=e.getPointAt(i/t,d);var a=o.normals[i],c=o.binormals[i];for(s=0;s<=r;s++){var f=s/r*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);u.x=g*a.x+m*c.x,u.y=g*a.y+m*c.y,u.z=g*a.z+m*c.z,u.normalize(),p.push(u.x,u.y,u.z),l.x=d.x+n*u.x,l.y=d.y+n*u.y,l.z=d.z+n*u.z,h.push(l.x,l.y,l.z)}}!function(){for(a=0;a<t;a++)g(a);g(!1===i?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=r;s++)c.x=a/t,c.y=s/r,f.push(c.x,c.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=r;a++){var e=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(e,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new Vn(h,3)),this.addAttribute("normal",new Vn(p,3)),this.addAttribute("uv",new Vn(f,2))}function ea(e,t,n,r,i,o,a){Dn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ta(e,t,n,r,i,o)),this.mergeVertices()}function ta(e,t,n,r,i,o){Wn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,l=[],u=[],c=[],d=[],h=new Lt,p=new Lt,f=new Lt,m=new Lt,g=new Lt,y=new Lt,v=new Lt;for(a=0;a<=n;++a){var b=a/n*i*Math.PI*2;for(I(b,i,o,e,f),I(b+.01,i,o,e,m),y.subVectors(m,f),v.addVectors(m,f),g.crossVectors(y,v),v.crossVectors(g,y),g.normalize(),v.normalize(),s=0;s<=r;++s){var _=s/r*Math.PI*2,E=-t*Math.cos(_),w=t*Math.sin(_);h.x=f.x+(E*v.x+w*g.x),h.y=f.y+(E*v.y+w*g.y),h.z=f.z+(E*v.z+w*g.z),u.push(h.x,h.y,h.z),p.subVectors(h,f).normalize(),c.push(p.x,p.y,p.z),d.push(a/n),d.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var T=(r+1)*(s-1)+(a-1),A=(r+1)*s+(a-1),S=(r+1)*s+a,x=(r+1)*(s-1)+a;l.push(T,A,x),l.push(A,S,x)}function I(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new Vn(u,3)),this.addAttribute("normal",new Vn(c,3)),this.addAttribute("uv",new Vn(d,2))}function na(e,t,n,r,i){Dn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new ra(e,t,n,r,i)),this.mergeVertices()}function ra(e,t,n,r,i){Wn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],l=[],u=[],c=[],d=new Lt,h=new Lt,p=new Lt;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var f=a/r*i,m=o/n*Math.PI*2;h.x=(e+t*Math.cos(m))*Math.cos(f),h.y=(e+t*Math.cos(m))*Math.sin(f),h.z=t*Math.sin(m),l.push(h.x,h.y,h.z),d.x=e*Math.cos(f),d.y=e*Math.sin(f),p.subVectors(h,d).normalize(),u.push(p.x,p.y,p.z),c.push(a/r),c.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var g=(r+1)*o+a-1,y=(r+1)*(o-1)+a-1,v=(r+1)*(o-1)+a,b=(r+1)*o+a;s.push(g,y,b),s.push(y,v,b)}this.setIndex(s),this.addAttribute("position",new Vn(l,3)),this.addAttribute("normal",new Vn(u,3)),this.addAttribute("uv",new Vn(c,2))}Object.assign(vo.prototype,{isFogExp2:!0,clone:function(){return new vo(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(bo.prototype,{isFog:!0,clone:function(){return new bo(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),_o.prototype=Object.assign(Object.create(Cn.prototype),{constructor:_o,isScene:!0,copy:function(e,t){return Cn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Cn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Eo.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Eo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(wo.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(wo.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),To.prototype=Object.create(Jn.prototype),To.prototype.constructor=To,To.prototype.isSpriteMaterial=!0,To.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},Ao.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Ao,isSprite:!0,raycast:function(){var e=new Lt,t=new Lt,n=new Lt,r=new Ct,i=new Ct,o=new an,a=new Lt,s=new Lt,l=new Lt,u=new Ct,c=new Ct,d=new Ct;function h(e,t,n,a,s,l){r.subVectors(e,n).addScalar(.5).multiply(a),void 0!==s?(i.x=l*r.x-s*r.y,i.y=s*r.x+l*r.y):i.copy(r),e.copy(t),e.x+=i.x,e.y+=i.y,e.applyMatrix4(o)}return function(r,i){t.setFromMatrixScale(this.matrixWorld),o.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),n.setFromMatrixPosition(this.modelViewMatrix);var p,f,m=this.material.rotation;0!==m&&(f=Math.cos(m),p=Math.sin(m));var g=this.center;h(a.set(-.5,-.5,0),n,g,t,p,f),h(s.set(.5,-.5,0),n,g,t,p,f),h(l.set(.5,.5,0),n,g,t,p,f),u.set(0,0),c.set(1,0),d.set(1,1);var y=r.ray.intersectTriangle(a,s,l,!1,e);if(null!==y||(h(s.set(-.5,.5,0),n,g,t,p,f),c.set(0,1),null!==(y=r.ray.intersectTriangle(a,l,s,!1,e)))){var v=r.ray.origin.distanceTo(e);v<r.near||v>r.far||i.push({distance:v,point:e.clone(),uv:gr.getUV(e,a,s,l,u,c,d,new Ct),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Cn.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),So.prototype=Object.assign(Object.create(Cn.prototype),{constructor:So,isLOD:!0,copy:function(e){Cn.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(ao=new Lt,function(e,t){ao.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(ao);this.getObjectForDistance(n).raycast(e,t)}),update:function(){var e=new Lt,t=new Lt;return function(n){var r=this.levels;if(r.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);r[0].object.visible=!0;for(var o=1,a=r.length;o<a&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<a;o++)r[o].object.visible=!1}}}(),toJSON:function(e){var t=Cn.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),xo.prototype=Object.assign(Object.create(vr.prototype),{constructor:xo,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new $t,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){vr.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(Io.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new an;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(so=new an,lo=new an,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:lo;so.multiplyMatrices(a,t[i]),so.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new Io(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),Ro.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Ro,isBone:!0}),Co.prototype=Object.create(Jn.prototype),Co.prototype.constructor=Co,Co.prototype.isLineBasicMaterial=!0,Co.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Mo.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Mo,isLine:!0,computeLineDistances:(uo=new Lt,co=new Lt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)uo.fromBufferAttribute(t,r-1),co.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=uo.distanceTo(co);e.addAttribute("lineDistance",new Vn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for((n=e.lineDistances)[0]=0,r=1,i=o.length;r<i;r++)n[r]=n[r-1],n[r]+=o[r-1].distanceTo(o[r])}return this}),raycast:function(){var e=new an,t=new mr,n=new nn;return function(r,i){var o=r.linePrecision,a=this.geometry,s=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=o,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var l=o/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,c=new Lt,d=new Lt,h=new Lt,p=new Lt,f=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var m=a.index,g=a.attributes.position.array;if(null!==m)for(var y=m.array,v=0,b=y.length-1;v<b;v+=f){var _=y[v],E=y[v+1];c.fromArray(g,3*_),d.fromArray(g,3*E),t.distanceSqToSegment(c,d,p,h)>u||(p.applyMatrix4(this.matrixWorld),(A=r.ray.origin.distanceTo(p))<r.near||A>r.far||i.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else for(v=0,b=g.length/3-1;v<b;v+=f)c.fromArray(g,3*v),d.fromArray(g,3*v+3),t.distanceSqToSegment(c,d,p,h)>u||(p.applyMatrix4(this.matrixWorld),(A=r.ray.origin.distanceTo(p))<r.near||A>r.far||i.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else if(a.isGeometry){var w=a.vertices,T=w.length;for(v=0;v<T-1;v+=f){var A;t.distanceSqToSegment(w[v],w[v+1],p,h)>u||(p.applyMatrix4(this.matrixWorld),(A=r.ray.origin.distanceTo(p))<r.near||A>r.far||i.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Lo.prototype=Object.assign(Object.create(Mo.prototype),{constructor:Lo,isLineSegments:!0,computeLineDistances:function(){var e=new Lt,t=new Lt;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],o=0,a=r.count;o<a;o+=2)e.fromBufferAttribute(r,o),t.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t);n.addAttribute("lineDistance",new Vn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,o=0,a=s.length;o<a;o+=2)e.copy(s[o]),t.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+e.distanceTo(t)}return this}}()}),Po.prototype=Object.assign(Object.create(Mo.prototype),{constructor:Po,isLineLoop:!0}),Do.prototype=Object.create(Jn.prototype),Do.prototype.constructor=Do,Do.prototype.isPointsMaterial=!0,Do.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Oo.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Oo,isPoints:!0,raycast:function(){var e=new an,t=new mr,n=new nn;return function(r,i){var o=this,a=this.geometry,s=this.matrixWorld,l=r.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),n.radius+=l,!1!==r.ray.intersectsSphere(n)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var u=l/((this.scale.x+this.scale.y+this.scale.z)/3),c=u*u,d=new Lt,h=new Lt;if(a.isBufferGeometry){var p=a.index,f=a.attributes.position.array;if(null!==p)for(var m=p.array,g=0,y=m.length;g<y;g++){var v=m[g];d.fromArray(f,3*v),E(d,v)}else{g=0;for(var b=f.length/3;g<b;g++)d.fromArray(f,3*g),E(d,g)}}else{var _=a.vertices;for(g=0,b=_.length;g<b;g++)E(_[g],g)}}function E(e,n){var a=t.distanceSqToPoint(e);if(a<c){t.closestPointToPoint(e,h),h.applyMatrix4(s);var l=r.ray.origin.distanceTo(h);if(l<r.near||l>r.far)return;i.push({distance:l,distanceToRay:Math.sqrt(a),point:h.clone(),index:n,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),No.prototype=Object.assign(Object.create(Kt.prototype),{constructor:No,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ko.prototype=Object.create(Kt.prototype),ko.prototype.constructor=ko,ko.prototype.isCompressedTexture=!0,Fo.prototype=Object.create(Kt.prototype),Fo.prototype.constructor=Fo,Fo.prototype.isCanvasTexture=!0,Bo.prototype=Object.create(Kt.prototype),Bo.prototype.constructor=Bo,Bo.prototype.isDepthTexture=!0,Uo.prototype=Object.create(Wn.prototype),Uo.prototype.constructor=Uo,zo.prototype=Object.create(Dn.prototype),zo.prototype.constructor=zo,Go.prototype=Object.create(Wn.prototype),Go.prototype.constructor=Go,Vo.prototype=Object.create(Dn.prototype),Vo.prototype.constructor=Vo,jo.prototype=Object.create(Wn.prototype),jo.prototype.constructor=jo,Ho.prototype=Object.create(Dn.prototype),Ho.prototype.constructor=Ho,Zo.prototype=Object.create(jo.prototype),Zo.prototype.constructor=Zo,qo.prototype=Object.create(Dn.prototype),qo.prototype.constructor=qo,Wo.prototype=Object.create(jo.prototype),Wo.prototype.constructor=Wo,Yo.prototype=Object.create(Dn.prototype),Yo.prototype.constructor=Yo,Ko.prototype=Object.create(jo.prototype),Ko.prototype.constructor=Ko,$o.prototype=Object.create(Dn.prototype),$o.prototype.constructor=$o,Xo.prototype=Object.create(jo.prototype),Xo.prototype.constructor=Xo,Qo.prototype=Object.create(Dn.prototype),Qo.prototype.constructor=Qo,Jo.prototype=Object.create(Wn.prototype),Jo.prototype.constructor=Jo,Jo.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},ea.prototype=Object.create(Dn.prototype),ea.prototype.constructor=ea,ta.prototype=Object.create(Wn.prototype),ta.prototype.constructor=ta,na.prototype=Object.create(Dn.prototype),na.prototype.constructor=na,ra.prototype=Object.create(Wn.prototype),ra.prototype.constructor=ra;function ia(e,t,n,r,i){var o,a;if(i===function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)a=wa(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=wa(o,e[o],e[o+1],a);return a&&va(a,a.next)&&(Ta(a),a=a.next),a}function oa(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!va(r,r.next)&&0!==ya(r.prev,r,r.next))r=r.next;else{if(Ta(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function aa(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=pa(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,l,u=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(e,r,i,o);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,o?la(e,r,i,o):sa(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),Ta(e),e=l.next,u=l.next;else if((e=l)===u){a?1===a?aa(e=ua(e,t,n),t,n,r,i,o,2):2===a&&ca(e,t,n,r,i,o):aa(oa(e),t,n,r,i,o,1);break}}}function sa(e){var t=e.prev,n=e,r=e.next;if(ya(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(ma(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&ya(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function la(e,t,n,r){var i=e.prev,o=e,a=e.next;if(ya(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,l=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,u=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=pa(s,l,t,n,r),h=pa(u,c,t,n,r),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&ma(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ya(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&ma(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&ya(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function ua(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!va(i,o)&&ba(i,r,r.next,o)&&_a(i,o)&&_a(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),Ta(r),Ta(r.next),r=e=o),r=r.next}while(r!==e);return r}function ca(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&ga(a,s)){var l=Ea(a,s);return a=oa(a,a.next),l=oa(l,l.next),aa(a,t,n,r,i,o),void aa(l,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function da(e,t){return e.x-t.x}function ha(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n.prev;var l,u=n,c=n.x,d=n.y,h=1/0;for(r=n.next;r!==u;)i>=r.x&&r.x>=c&&i!==r.x&&ma(o<d?i:a,o,c,d,o<d?a:i,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(i-r.x))<h||l===h&&r.x>n.x)&&_a(r,e)&&(n=r,h=l),r=r.next;return n}(e,t),t){var n=Ea(t,e);oa(n,n.next)}}function pa(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function fa(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function ma(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function ga(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&ba(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&_a(e,t)&&_a(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)}function ya(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function va(e,t){return e.x===t.x&&e.y===t.y}function ba(e,t,n,r){return!!(va(e,t)&&va(n,r)||va(e,r)&&va(n,t))||ya(e,t,n)>0!=ya(e,t,r)>0&&ya(n,r,e)>0!=ya(n,r,t)>0}function _a(e,t){return ya(e.prev,e,e.next)<0?ya(e,t,e.next)>=0&&ya(e,e.prev,t)>=0:ya(e,t,e.prev)<0||ya(e,e.next,t)<0}function Ea(e,t){var n=new Aa(e.i,e.x,e.y),r=new Aa(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function wa(e,t,n,r){var i=new Aa(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ta(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Aa(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Sa={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return Sa.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];xa(e),Ia(n,e);var o=e.length;t.forEach(xa);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,Ia(n,t[a]);var s=function(e,t,n){n=n||2;var r,i,o,a,s,l,u,c=t&&t.length,d=c?t[0]*n:e.length,h=ia(e,0,d,n,!0),p=[];if(!h)return p;if(c&&(h=function(e,t,n,r){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=ia(e,t[i]*r,i<o-1?t[i+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(fa(a));for(s.sort(da),i=0;i<s.length;i++)ha(s[i],n),n=oa(n,n.next);return n}(e,t,h,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var f=n;f<d;f+=n)(s=e[f])<r&&(r=s),(l=e[f+1])<i&&(i=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-r,a-i))?1/u:0}return aa(h,p,n,r,i,u),p}(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};function xa(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Ia(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Ra(e,t){Dn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Ca(e,t)),this.mergeVertices()}function Ca(e,t){Wn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,r=[],i=[],o=0,a=e.length;o<a;o++)s(e[o]);function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:100,u=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:c-2,h=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3,f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Ma;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);var g,y,v,b,_,E,w,T,A=!1;f&&(g=f.getSpacedPoints(s),A=!0,u=!1,y=f.computeFrenetFrames(s,!1),v=new Lt,b=new Lt,_=new Lt),u||(p=0,c=0,d=0,h=0);var S=e.extractPoints(a),x=S.shape,I=S.holes;if(!Sa.isClockWise(x))for(x=x.reverse(),w=0,T=I.length;w<T;w++)E=I[w],Sa.isClockWise(E)&&(I[w]=E.reverse());var R=Sa.triangulateShape(x,I),C=x;for(w=0,T=I.length;w<T;w++)E=I[w],x=x.concat(E);function M(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var L,P,D,O,N,k,F=x.length,B=R.length;function U(e,t,n){var r,i,o,a=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=a*a+s*s,d=a*u-s*l;if(Math.abs(d)>Number.EPSILON){var h=Math.sqrt(c),p=Math.sqrt(l*l+u*u),f=t.x-s/h,m=t.y+a/h,g=((n.x-u/p-f)*u-(n.y+l/p-m)*l)/(a*u-s*l),y=(r=f+a*g-e.x)*r+(i=m+s*g-e.y)*i;if(y<=2)return new Ct(r,i);o=Math.sqrt(y/2)}else{var v=!1;a>Number.EPSILON?l>Number.EPSILON&&(v=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(v=!0):Math.sign(s)===Math.sign(u)&&(v=!0),v?(r=-s,i=a,o=Math.sqrt(c)):(r=a,i=s,o=Math.sqrt(c/2))}return new Ct(r/o,i/o)}for(var z=[],G=0,V=C.length,j=V-1,H=G+1;G<V;G++,j++,H++)j===V&&(j=0),H===V&&(H=0),z[G]=U(C[G],C[j],C[H]);var Z,q,W=[],Y=z.concat();for(w=0,T=I.length;w<T;w++){for(E=I[w],Z=[],G=0,j=(V=E.length)-1,H=G+1;G<V;G++,j++,H++)j===V&&(j=0),H===V&&(H=0),Z[G]=U(E[G],E[j],E[H]);W.push(Z),Y=Y.concat(Z)}for(L=0;L<p;L++){for(D=L/p,O=c*Math.cos(D*Math.PI/2),P=d*Math.sin(D*Math.PI/2)+h,G=0,V=C.length;G<V;G++)$((N=M(C[G],z[G],P)).x,N.y,-O);for(w=0,T=I.length;w<T;w++)for(E=I[w],Z=W[w],G=0,V=E.length;G<V;G++)$((N=M(E[G],Z[G],P)).x,N.y,-O)}for(P=d+h,G=0;G<F;G++)N=u?M(x[G],Y[G],P):x[G],A?(b.copy(y.normals[0]).multiplyScalar(N.x),v.copy(y.binormals[0]).multiplyScalar(N.y),_.copy(g[0]).add(b).add(v),$(_.x,_.y,_.z)):$(N.x,N.y,0);for(q=1;q<=s;q++)for(G=0;G<F;G++)N=u?M(x[G],Y[G],P):x[G],A?(b.copy(y.normals[q]).multiplyScalar(N.x),v.copy(y.binormals[q]).multiplyScalar(N.y),_.copy(g[q]).add(b).add(v),$(_.x,_.y,_.z)):$(N.x,N.y,l/s*q);for(L=p-1;L>=0;L--){for(D=L/p,O=c*Math.cos(D*Math.PI/2),P=d*Math.sin(D*Math.PI/2)+h,G=0,V=C.length;G<V;G++)$((N=M(C[G],z[G],P)).x,N.y,l+O);for(w=0,T=I.length;w<T;w++)for(E=I[w],Z=W[w],G=0,V=E.length;G<V;G++)N=M(E[G],Z[G],P),A?$(N.x,N.y+g[s-1].y,g[s-1].x+O):$(N.x,N.y,l+O)}function K(e,t){var n,r;for(G=e.length;--G>=0;){n=G,(r=G-1)<0&&(r=e.length-1);var i=0,o=s+2*p;for(i=0;i<o;i++){var a=F*i,l=F*(i+1);Q(t+n+a,t+r+a,t+r+l,t+n+l)}}}function $(e,t,n){o.push(e),o.push(t),o.push(n)}function X(e,t,i){J(e),J(t),J(i);var o=r.length/3,a=m.generateTopUV(n,r,o-3,o-2,o-1);ee(a[0]),ee(a[1]),ee(a[2])}function Q(e,t,i,o){J(e),J(t),J(o),J(t),J(i),J(o);var a=r.length/3,s=m.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);ee(s[0]),ee(s[1]),ee(s[3]),ee(s[1]),ee(s[2]),ee(s[3])}function J(e){r.push(o[3*e+0]),r.push(o[3*e+1]),r.push(o[3*e+2])}function ee(e){i.push(e.x),i.push(e.y)}!function(){var e=r.length/3;if(u){var t=0,i=F*t;for(G=0;G<B;G++)X((k=R[G])[2]+i,k[1]+i,k[0]+i);for(i=F*(t=s+2*p),G=0;G<B;G++)X((k=R[G])[0]+i,k[1]+i,k[2]+i)}else{for(G=0;G<B;G++)X((k=R[G])[2],k[1],k[0]);for(G=0;G<B;G++)X((k=R[G])[0]+F*s,k[1]+F*s,k[2]+F*s)}n.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(K(C,t),t+=C.length,w=0,T=I.length;w<T;w++)K(E=I[w],t),t+=E.length;n.addGroup(e,r.length/3-e,1)}()}this.addAttribute("position",new Vn(r,3)),this.addAttribute("uv",new Vn(i,2)),this.computeVertexNormals()}Ra.prototype=Object.create(Dn.prototype),Ra.prototype.constructor=Ra,Ra.prototype.toJSON=function(){var e=Dn.prototype.toJSON.call(this);return La(this.parameters.shapes,this.parameters.options,e)},Ca.prototype=Object.create(Wn.prototype),Ca.prototype.constructor=Ca,Ca.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return La(this.parameters.shapes,this.parameters.options,e)};var Ma={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r],l=t[3*r+1],u=t[3*i],c=t[3*i+1];return[new Ct(o,a),new Ct(s,l),new Ct(u,c)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*r],c=t[3*r+1],d=t[3*r+2],h=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*o],g=t[3*o+1],y=t[3*o+2];return Math.abs(s-c)<.01?[new Ct(a,1-l),new Ct(u,1-d),new Ct(h,1-f),new Ct(m,1-y)]:[new Ct(s,1-l),new Ct(c,1-d),new Ct(p,1-f),new Ct(g,1-y)]}};function La(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Pa(e,t){Dn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Da(e,t)),this.mergeVertices()}function Da(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Dn;var r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Ca.call(this,r,t),this.type="TextBufferGeometry"}function Oa(e,t,n,r,i,o,a){Dn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Na(e,t,n,r,i,o,a)),this.mergeVertices()}function Na(e,t,n,r,i,o,a){Wn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,l,u=Math.min(o+a,Math.PI),c=0,d=[],h=new Lt,p=new Lt,f=[],m=[],g=[],y=[];for(l=0;l<=n;l++){var v=[],b=l/n,_=0;for(0==l&&0==o?_=.5/t:l==n&&u==Math.PI&&(_=-.5/t),s=0;s<=t;s++){var E=s/t;h.x=-e*Math.cos(r+E*i)*Math.sin(o+b*a),h.y=e*Math.cos(o+b*a),h.z=e*Math.sin(r+E*i)*Math.sin(o+b*a),m.push(h.x,h.y,h.z),p.copy(h).normalize(),g.push(p.x,p.y,p.z),y.push(E+_,1-b),v.push(c++)}d.push(v)}for(l=0;l<n;l++)for(s=0;s<t;s++){var w=d[l][s+1],T=d[l][s],A=d[l+1][s],S=d[l+1][s+1];(0!==l||o>0)&&f.push(w,T,S),(l!==n-1||u<Math.PI)&&f.push(T,A,S)}this.setIndex(f),this.addAttribute("position",new Vn(m,3)),this.addAttribute("normal",new Vn(g,3)),this.addAttribute("uv",new Vn(y,2))}function ka(e,t,n,r,i,o){Dn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Fa(e,t,n,r,i,o)),this.mergeVertices()}function Fa(e,t,n,r,i,o){Wn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},e=e||.5,t=t||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,l,u=[],c=[],d=[],h=[],p=e,f=(t-e)/(r=void 0!==r?Math.max(1,r):1),m=new Lt,g=new Ct;for(s=0;s<=r;s++){for(l=0;l<=n;l++)a=i+l/n*o,m.x=p*Math.cos(a),m.y=p*Math.sin(a),c.push(m.x,m.y,m.z),d.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,h.push(g.x,g.y);p+=f}for(s=0;s<r;s++){var y=s*(n+1);for(l=0;l<n;l++){var v=a=l+y,b=a+n+1,_=a+n+2,E=a+1;u.push(v,b,E),u.push(b,_,E)}}this.setIndex(u),this.addAttribute("position",new Vn(c,3)),this.addAttribute("normal",new Vn(d,3)),this.addAttribute("uv",new Vn(h,2))}function Ba(e,t,n,r){Dn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new Ua(e,t,n,r)),this.mergeVertices()}function Ua(e,t,n,r){Wn.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Rt.clamp(r,0,2*Math.PI);var i,o,a,s=[],l=[],u=[],c=1/t,d=new Lt,h=new Ct;for(o=0;o<=t;o++){var p=n+o*c*r,f=Math.sin(p),m=Math.cos(p);for(a=0;a<=e.length-1;a++)d.x=e[a].x*f,d.y=e[a].y,d.z=e[a].x*m,l.push(d.x,d.y,d.z),h.x=o/t,h.y=a/(e.length-1),u.push(h.x,h.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var g=i=a+o*e.length,y=i+e.length,v=i+e.length+1,b=i+1;s.push(g,y,b),s.push(y,v,b)}if(this.setIndex(s),this.addAttribute("position",new Vn(l,3)),this.addAttribute("uv",new Vn(u,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,E=new Lt,w=new Lt,T=new Lt;for(i=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)E.x=_[a+0],E.y=_[a+1],E.z=_[a+2],w.x=_[i+a+0],w.y=_[i+a+1],w.z=_[i+a+2],T.addVectors(E,w).normalize(),_[a+0]=_[i+a+0]=T.x,_[a+1]=_[i+a+1]=T.y,_[a+2]=_[i+a+2]=T.z}}function za(e,t){Dn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Ga(e,t)),this.mergeVertices()}function Ga(e,t){Wn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(e))u(e);else for(var l=0;l<e.length;l++)u(e[l]),this.addGroup(a,s,l),a+=s,s=0;function u(e){var a,l,u,c=r.length/3,d=e.extractPoints(t),h=d.shape,p=d.holes;for(!1===Sa.isClockWise(h)&&(h=h.reverse()),a=0,l=p.length;a<l;a++)u=p[a],!0===Sa.isClockWise(u)&&(p[a]=u.reverse());var f=Sa.triangulateShape(h,p);for(a=0,l=p.length;a<l;a++)u=p[a],h=h.concat(u);for(a=0,l=h.length;a<l;a++){var m=h[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,l=f.length;a<l;a++){var g=f[a],y=g[0]+c,v=g[1]+c,b=g[2]+c;n.push(y,v,b),s+=3}}this.setIndex(n),this.addAttribute("position",new Vn(r,3)),this.addAttribute("normal",new Vn(i,3)),this.addAttribute("uv",new Vn(o,2))}function Va(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function ja(e,t){Wn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,o,a=[],s=Math.cos(Rt.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(o=new Dn).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var d=o.vertices,h=o.faces,p=0,f=h.length;p<f;p++)for(var m=h[p],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],l[0]=Math.min(n,r),l[1]=Math.max(n,r),void 0===u[i=l[0]+","+l[1]]?u[i]={index1:l[0],index2:l[1],face1:p,face2:void 0}:u[i].face2=p;for(i in u){var y=u[i];if(void 0===y.face2||h[y.face1].normal.dot(h[y.face2].normal)<=s){var v=d[y.index1];a.push(v.x,v.y,v.z),v=d[y.index2],a.push(v.x,v.y,v.z)}}this.addAttribute("position",new Vn(a,3))}function Ha(e,t,n,r,i,o,a,s){Dn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Za(e,t,n,r,i,o,a,s)),this.mergeVertices()}function Za(e,t,n,r,i,o,a,s){Wn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var u=[],c=[],d=[],h=[],p=0,f=[],m=n/2,g=0;function y(n){var i,o,f,y=new Ct,v=new Lt,b=0,_=!0===n?e:t,E=!0===n?1:-1;for(o=p,i=1;i<=r;i++)c.push(0,m*E,0),d.push(0,E,0),h.push(.5,.5),p++;for(f=p,i=0;i<=r;i++){var w=i/r*s+a,T=Math.cos(w),A=Math.sin(w);v.x=_*A,v.y=m*E,v.z=_*T,c.push(v.x,v.y,v.z),d.push(0,E,0),y.x=.5*T+.5,y.y=.5*A*E+.5,h.push(y.x,y.y),p++}for(i=0;i<r;i++){var S=o+i,x=f+i;!0===n?u.push(x,x+1,S):u.push(x+1,x,S),b+=3}l.addGroup(g,b,!0===n?1:2),g+=b}!function(){var o,y,v=new Lt,b=new Lt,_=0,E=(t-e)/n;for(y=0;y<=i;y++){var w=[],T=y/i,A=T*(t-e)+e;for(o=0;o<=r;o++){var S=o/r,x=S*s+a,I=Math.sin(x),R=Math.cos(x);b.x=A*I,b.y=-T*n+m,b.z=A*R,c.push(b.x,b.y,b.z),v.set(I,E,R).normalize(),d.push(v.x,v.y,v.z),h.push(S,1-T),w.push(p++)}f.push(w)}for(o=0;o<r;o++)for(y=0;y<i;y++){var C=f[y][o],M=f[y+1][o],L=f[y+1][o+1],P=f[y][o+1];u.push(C,M,P),u.push(M,L,P),_+=6}l.addGroup(g,_,0),g+=_}(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.addAttribute("position",new Vn(c,3)),this.addAttribute("normal",new Vn(d,3)),this.addAttribute("uv",new Vn(h,2))}function qa(e,t,n,r,i,o,a){Ha.call(this,0,e,t,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Wa(e,t,n,r,i,o,a){Za.call(this,0,e,t,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Ya(e,t,n,r){Dn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Ka(e,t,n,r)),this.mergeVertices()}function Ka(e,t,n,r){Wn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],l=[],u=[],c=new Lt,d=new Ct;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var h=n+o/t*r;c.x=e*Math.cos(h),c.y=e*Math.sin(h),s.push(c.x,c.y,c.z),l.push(0,0,1),d.x=(s[i]/e+1)/2,d.y=(s[i+1]/e+1)/2,u.push(d.x,d.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new Vn(s,3)),this.addAttribute("normal",new Vn(l,3)),this.addAttribute("uv",new Vn(u,2))}Pa.prototype=Object.create(Dn.prototype),Pa.prototype.constructor=Pa,Da.prototype=Object.create(Ca.prototype),Da.prototype.constructor=Da,Oa.prototype=Object.create(Dn.prototype),Oa.prototype.constructor=Oa,Na.prototype=Object.create(Wn.prototype),Na.prototype.constructor=Na,ka.prototype=Object.create(Dn.prototype),ka.prototype.constructor=ka,Fa.prototype=Object.create(Wn.prototype),Fa.prototype.constructor=Fa,Ba.prototype=Object.create(Dn.prototype),Ba.prototype.constructor=Ba,Ua.prototype=Object.create(Wn.prototype),Ua.prototype.constructor=Ua,za.prototype=Object.create(Dn.prototype),za.prototype.constructor=za,za.prototype.toJSON=function(){var e=Dn.prototype.toJSON.call(this);return Va(this.parameters.shapes,e)},Ga.prototype=Object.create(Wn.prototype),Ga.prototype.constructor=Ga,Ga.prototype.toJSON=function(){var e=Wn.prototype.toJSON.call(this);return Va(this.parameters.shapes,e)},ja.prototype=Object.create(Wn.prototype),ja.prototype.constructor=ja,Ha.prototype=Object.create(Dn.prototype),Ha.prototype.constructor=Ha,Za.prototype=Object.create(Wn.prototype),Za.prototype.constructor=Za,qa.prototype=Object.create(Ha.prototype),qa.prototype.constructor=qa,Wa.prototype=Object.create(Za.prototype),Wa.prototype.constructor=Wa,Ya.prototype=Object.create(Dn.prototype),Ya.prototype.constructor=Ya,Ka.prototype=Object.create(Wn.prototype),Ka.prototype.constructor=Ka;var $a=Object.freeze({WireframeGeometry:Uo,ParametricGeometry:zo,ParametricBufferGeometry:Go,TetrahedronGeometry:Ho,TetrahedronBufferGeometry:Zo,OctahedronGeometry:qo,OctahedronBufferGeometry:Wo,IcosahedronGeometry:Yo,IcosahedronBufferGeometry:Ko,DodecahedronGeometry:$o,DodecahedronBufferGeometry:Xo,PolyhedronGeometry:Vo,PolyhedronBufferGeometry:jo,TubeGeometry:Qo,TubeBufferGeometry:Jo,TorusKnotGeometry:ea,TorusKnotBufferGeometry:ta,TorusGeometry:na,TorusBufferGeometry:ra,TextGeometry:Pa,TextBufferGeometry:Da,SphereGeometry:Oa,SphereBufferGeometry:Na,RingGeometry:ka,RingBufferGeometry:Fa,PlaneGeometry:$n,PlaneBufferGeometry:Xn,LatheGeometry:Ba,LatheBufferGeometry:Ua,ShapeGeometry:za,ShapeBufferGeometry:Ga,ExtrudeGeometry:Ra,ExtrudeBufferGeometry:Ca,EdgesGeometry:ja,ConeGeometry:qa,ConeBufferGeometry:Wa,CylinderGeometry:Ha,CylinderBufferGeometry:Za,CircleGeometry:Ya,CircleBufferGeometry:Ka,BoxGeometry:Yn,BoxBufferGeometry:Kn});function Xa(e){Jn.call(this),this.type="ShadowMaterial",this.color=new fn(0),this.transparent=!0,this.setValues(e)}function Qa(e){fr.call(this,e),this.type="RawShaderMaterial"}function Ja(e){Jn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xt,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function es(e){Ja.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function ts(e){Jn.call(this),this.type="MeshPhongMaterial",this.color=new fn(16777215),this.specular=new fn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xt,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ns(e){ts.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function rs(e){Jn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xt,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function is(e){Jn.call(this),this.type="MeshLambertMaterial",this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Y,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function os(e){Jn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=xt,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function as(e){Co.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Xa.prototype=Object.create(Jn.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isShadowMaterial=!0,Xa.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this},Qa.prototype=Object.create(fr.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isRawShaderMaterial=!0,Ja.prototype=Object.create(Jn.prototype),Ja.prototype.constructor=Ja,Ja.prototype.isMeshStandardMaterial=!0,Ja.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},es.prototype=Object.create(Ja.prototype),es.prototype.constructor=es,es.prototype.isMeshPhysicalMaterial=!0,es.prototype.copy=function(e){return Ja.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},ts.prototype=Object.create(Jn.prototype),ts.prototype.constructor=ts,ts.prototype.isMeshPhongMaterial=!0,ts.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ns.prototype=Object.create(ts.prototype),ns.prototype.constructor=ns,ns.prototype.isMeshToonMaterial=!0,ns.prototype.copy=function(e){return ts.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},rs.prototype=Object.create(Jn.prototype),rs.prototype.constructor=rs,rs.prototype.isMeshNormalMaterial=!0,rs.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},is.prototype=Object.create(Jn.prototype),is.prototype.constructor=is,is.prototype.isMeshLambertMaterial=!0,is.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},os.prototype=Object.create(Jn.prototype),os.prototype.constructor=os,os.prototype.isMeshMatcapMaterial=!0,os.prototype.copy=function(e){return Jn.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},as.prototype=Object.create(Co.prototype),as.prototype.constructor=as,as.prototype.isLineDashedMaterial=!0,as.prototype.copy=function(e){return Co.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var ss=Object.freeze({ShadowMaterial:Xa,SpriteMaterial:To,RawShaderMaterial:Qa,ShaderMaterial:fr,PointsMaterial:Do,MeshPhysicalMaterial:es,MeshStandardMaterial:Ja,MeshPhongMaterial:ts,MeshToonMaterial:ns,MeshNormalMaterial:rs,MeshLambertMaterial:is,MeshDepthMaterial:Ki,MeshDistanceMaterial:$i,MeshBasicMaterial:yr,MeshMatcapMaterial:os,LineDashedMaterial:as,LineBasicMaterial:Co,Material:Jn}),ls={arraySlice:function(e,t,n){return ls.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,l=0;l!==t;++l)i[a++]=e[s+l];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),o=e[i++]}while(void 0!==o)}}};function us(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function cs(e,t,n,r){us.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ds(e,t,n,r){us.call(this,e,t,n,r)}function hs(e,t,n,r){us.call(this,e,t,n,r)}function ps(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ls.convertArray(t,this.TimeBufferType),this.values=ls.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function fs(e,t,n){ps.call(this,e,t,n)}function ms(e,t,n,r){ps.call(this,e,t,n,r)}function gs(e,t,n,r){ps.call(this,e,t,n,r)}function ys(e,t,n,r){us.call(this,e,t,n,r)}function vs(e,t,n,r){ps.call(this,e,t,n,r)}function bs(e,t,n,r){ps.call(this,e,t,n,r)}function _s(e,t,n,r){ps.call(this,e,t,n,r)}function Es(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Rt.generateUUID(),this.duration<0&&this.resetDuration()}function ws(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return gs;case"vector":case"vector2":case"vector3":case"vector4":return _s;case"color":return ms;case"quaternion":return vs;case"bool":case"boolean":return fs;case"string":return bs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];ls.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(us.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var o;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}o=t.length;break n}if(e>=i)break e;var s=t[1];for(e<s&&(n=2,i=s),a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===a)break;if(r=i,e>=(i=t[--n-1]))break t}o=n,n=0}for(;n<o;){var l=n+o>>>1;e<t[l]?o=l:n=l+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(us.prototype,{beforeStart_:us.prototype.copySampleValue_,afterEnd_:us.prototype.copySampleValue_}),cs.prototype=Object.assign(Object.create(us.prototype),{constructor:cs,DefaultSettings_:{endingStart:dt,endingEnd:dt},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case ht:i=e,a=2*t-n;break;case pt:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case ht:o=e,s=2*n-t;break;case pt:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,h=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,g=-d*m+2*d*f-d*p,y=(1+d)*m+(-1.5-2*d)*f+(-.5+d)*p+1,v=(-1-h)*m+(1.5+h)*f+.5*p,b=h*m-h*f,_=0;_!==a;++_)i[_]=g*o[u+_]+y*o[l+_]+v*o[s+_]+b*o[c+_];return i}}),ds.prototype=Object.assign(Object.create(us.prototype),{constructor:ds,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,u=(n-t)/(r-t),c=1-u,d=0;d!==a;++d)i[d]=o[l+d]*c+o[s+d]*u;return i}}),hs.prototype=Object.assign(Object.create(us.prototype),{constructor:hs,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(ps,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:ls.convertArray(e.times,Array),values:ls.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(ps.prototype,{constructor:ps,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ut,InterpolantFactoryMethodDiscrete:function(e){return new hs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new ds(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new cs(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case lt:t=this.InterpolantFactoryMethodDiscrete;break;case ut:t=this.InterpolantFactoryMethodLinear;break;case ct:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return lt;case this.InterpolantFactoryMethodLinear:return ut;case this.InterpolantFactoryMethodSmooth:return ct}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=ls.arraySlice(n,i,o),this.values=ls.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&ls.isTypedArray(r)){a=0;for(var l=r.length;a!==l;++a){var u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=this.getInterpolation()===ct,i=1,o=e.length-1,a=1;a<o;++a){var s=!1,l=e[a];if(l!==e[a+1]&&(1!==a||l!==l[0]))if(r)s=!0;else for(var u=a*n,c=u-n,d=u+n,h=0;h!==n;++h){var p=t[u+h];if(p!==t[c+h]||p!==t[d+h]){s=!0;break}}if(s){if(a!==i){e[i]=e[a];var f=a*n,m=i*n;for(h=0;h!==n;++h)t[m+h]=t[f+h]}++i}}if(o>0){for(e[i]=e[o],f=o*n,m=i*n,h=0;h!==n;++h)t[m+h]=t[f+h];++i}return i!==e.length&&(this.times=ls.arraySlice(e,0,i),this.values=ls.arraySlice(t,0,i*n)),this},clone:function(){var e=ls.arraySlice(this.times,0),t=ls.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),fs.prototype=Object.assign(Object.create(ps.prototype),{constructor:fs,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:lt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ms.prototype=Object.assign(Object.create(ps.prototype),{constructor:ms,ValueTypeName:"color"}),gs.prototype=Object.assign(Object.create(ps.prototype),{constructor:gs,ValueTypeName:"number"}),ys.prototype=Object.assign(Object.create(us.prototype),{constructor:ys,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=(n-t)/(r-t),u=s+a;s!==u;s+=4)Mt.slerpFlat(i,0,o,s-a,o,s,l);return i}}),vs.prototype=Object.assign(Object.create(ps.prototype),{constructor:vs,ValueTypeName:"quaternion",DefaultInterpolation:ut,InterpolantFactoryMethodLinear:function(e){return new ys(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),bs.prototype=Object.assign(Object.create(ps.prototype),{constructor:bs,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:lt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),_s.prototype=Object.assign(Object.create(ps.prototype),{constructor:_s,ValueTypeName:"vector"}),Object.assign(Es,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(ws(n[i]).scale(r));return new Es(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,o=n.length;i!==o;++i)t.push(ps.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],l=[];s.push((a+i-1)%i,a,(a+1)%i),l.push(0,1,0);var u=ls.getKeyframeOrder(s);s=ls.sortedArray(s,1,u),l=ls.sortedArray(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),o.push(new gs(".morphTargetInfluences["+t[a].name+"]",s,l).scale(1/n))}return new Es(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],l=s.name.match(i);if(l&&l.length>1){var u=r[d=l[1]];u||(r[d]=u=[]),u.push(s)}}var c=[];for(var d in r)c.push(Es.CreateFromMorphTargetSequence(d,r[d],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var o=[],a=[];ls.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a))}},r=[],i=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},d=0;d<u.length;d++)if(u[d].morphTargets)for(var h=0;h<u[d].morphTargets.length;h++)c[u[d].morphTargets[h]]=-1;for(var p in c){var f=[],m=[];for(h=0;h!==u[d].morphTargets.length;++h){var g=u[d];f.push(g.time),m.push(g.morphTarget===p?1:0)}r.push(new gs(".morphTargetInfluence["+p+"]",f,m))}o=c.length*(a||1)}else{var y=".bones["+t[l].name+"]";n(_s,y+".position",u,"pos",r),n(vs,y+".quaternion",u,"rot",r),n(_s,y+".scale",u,"scl",r)}}return 0===r.length?null:new Es(i,o,r)}}),Object.assign(Es.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Es(this.name,this.duration,e)}});var Ts={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function As(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var Ss=new As,xs={};function Is(e){this.manager=void 0!==e?e:Ss}function Rs(e){this.manager=void 0!==e?e:Ss}function Cs(e){this.manager=void 0!==e?e:Ss}function Ms(e){this.manager=void 0!==e?e:Ss}function Ls(){this.type="Curve",this.arcLengthDivisions=200}function Ps(e,t,n,r,i,o,a,s){Ls.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Ds(e,t,n,r,i,o){Ps.call(this,e,t,n,n,r,i,o),this.type="ArcCurve"}function Os(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){var l=(t-e)/o-(n-e)/(o+a)+(n-t)/a,u=(n-t)/a-(r-t)/(a+s)+(r-n)/s;i(t,n,l*=a,u*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}Object.assign(Is.prototype,{load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ts.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;if(void 0===xs[e]){var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],l=!!a[2],u=a[3];u=decodeURIComponent(u),l&&(u=atob(u));try{var c,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var h=new Uint8Array(u.length),p=0;p<u.length;p++)h[p]=u.charCodeAt(p);c="blob"===d?new Blob([h.buffer],{type:s}):h.buffer;break;case"document":var f=new DOMParser;c=f.parseFromString(u,s);break;case"json":c=JSON.parse(u);break;default:c=u}setTimeout((function(){t&&t(c),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{xs[e]=[],xs[e].push({onLoad:t,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",(function(t){var n=this.response;Ts.add(e,n);var r=xs[e];if(delete xs[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,a=r.length;o<a;o++)(s=r[o]).onLoad&&s.onLoad(n);i.manager.itemEnd(e)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),m.addEventListener("progress",(function(t){for(var n=xs[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}}),!1),m.addEventListener("error",(function(t){var n=xs[e];delete xs[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),m.addEventListener("abort",(function(t){var n=xs[e];delete xs[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}xs[e].push({onLoad:t,onProgress:n,onError:r})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(function(e){this.manager=void 0!==e?e:Ss}.prototype,{load:function(e,t,n,r){var i=this,o=new Is(i.manager);o.setPath(i.path),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=Es.parse(e[n]);t.push(r)}return t},setPath:function(e){return this.path=e,this}}),Object.assign(function(e){this.manager=void 0!==e?e:Ss,this._parser=null}.prototype,{load:function(e,t,n,r){var i=this,o=[],a=new ko;a.image=o;var s=new Is(this.manager);function l(l){s.load(e[l],(function(e){var n=i._parser(e,!0);o[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(a.minFilter=ge),a.format=n.format,a.needsUpdate=!0,t&&t(a))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,c=0,d=e.length;c<d;++c)l(c);else s.load(e,(function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=ge),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,r);return a},setPath:function(e){return this.path=e,this}}),Object.assign(function(e){this.manager=void 0!==e?e:Ss,this._parser=null}.prototype,{load:function(e,t,n,r){var i=this,o=new en,a=new Is(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,(function(e){var n=i._parser(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:de,o.wrapT=void 0!==n.wrapT?n.wrapT:de,o.magFilter=void 0!==n.magFilter?n.magFilter:ge,o.minFilter=void 0!==n.minFilter?n.minFilter:ve,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=ge),o.needsUpdate=!0,t&&t(o,n))}),n,r),o},setPath:function(e){return this.path=e,this}}),Object.assign(Rs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ts.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),Ts.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Cs.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new Mr,o=new Rs(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],(function(e){i.images[n]=e,6==++a&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var l=0;l<e.length;++l)s(l);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ms.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=new Kt,o=new Rs(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?Pe:De,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Ls.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(i),r.push(o),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,o=r.length;n=t||e*r[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(o-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(o-1)},getTangent:function(e){var t=1e-4,n=e-t,r=e+t;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n);return this.getPoint(r).clone().sub(i).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,o=new Lt,a=[],s=[],l=[],u=new Lt,c=new an;for(n=0;n<=e;n++)r=n/e,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new Lt,l[0]=new Lt;var d=Number.MAX_VALUE,h=Math.abs(a[0].x),p=Math.abs(a[0].y),f=Math.abs(a[0].z);for(h<=d&&(d=h,o.set(1,0,0)),p<=d&&(d=p,o.set(0,1,0)),f<=d&&o.set(0,0,1),u.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],u),l[0].crossVectors(a[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(a[n-1],a[n]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(Rt.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,i))),l[n].crossVectors(a[n],s[n]);if(!0===t)for(i=Math.acos(Rt.clamp(s[0].dot(s[e]),-1,1)),i/=e,a[0].dot(u.crossVectors(s[0],s[e]))>0&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(c.makeRotationAxis(a[n],i*n)),l[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Ps.prototype=Object.create(Ls.prototype),Ps.prototype.constructor=Ps,Ps.prototype.isEllipseCurve=!0,Ps.prototype.getPoint=function(e,t){for(var n=t||new Ct,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),d=s-this.aX,h=l-this.aY;s=d*u-h*c+this.aX,l=d*c+h*u+this.aY}return n.set(s,l)},Ps.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ps.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Ps.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ds.prototype=Object.create(Ps.prototype),Ds.prototype.constructor=Ds,Ds.prototype.isArcCurve=!0;var Ns=new Lt,ks=new Os,Fs=new Os,Bs=new Os;function Us(e,t,n,r){Ls.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function zs(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n),s=e*e;return(2*n-2*r+o+a)*(e*s)+(-3*n+3*r-2*o-a)*s+o*e+n}function Gs(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Vs(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function js(e,t,n,r){Ls.call(this),this.type="CubicBezierCurve",this.v0=e||new Ct,this.v1=t||new Ct,this.v2=n||new Ct,this.v3=r||new Ct}function Hs(e,t,n,r){Ls.call(this),this.type="CubicBezierCurve3",this.v0=e||new Lt,this.v1=t||new Lt,this.v2=n||new Lt,this.v3=r||new Lt}function Zs(e,t){Ls.call(this),this.type="LineCurve",this.v1=e||new Ct,this.v2=t||new Ct}function qs(e,t){Ls.call(this),this.type="LineCurve3",this.v1=e||new Lt,this.v2=t||new Lt}function Ws(e,t,n){Ls.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Ct,this.v1=t||new Ct,this.v2=n||new Ct}function Ys(e,t,n){Ls.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Lt,this.v1=t||new Lt,this.v2=n||new Lt}function Ks(e){Ls.call(this),this.type="SplineCurve",this.points=e||[]}Us.prototype=Object.create(Ls.prototype),Us.prototype.constructor=Us,Us.prototype.isCatmullRomCurve3=!0,Us.prototype.getPoint=function(e,t){var n,r,i,o,a=t||new Lt,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e,c=Math.floor(u),d=u-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/l)+1)*l:0===d&&c===l-1&&(c=l-2,d=1),this.closed||c>0?n=s[(c-1)%l]:(Ns.subVectors(s[0],s[1]).add(s[0]),n=Ns),r=s[c%l],i=s[(c+1)%l],this.closed||c+2<l?o=s[(c+2)%l]:(Ns.subVectors(s[l-1],s[l-2]).add(s[l-1]),o=Ns),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(r),h),f=Math.pow(r.distanceToSquared(i),h),m=Math.pow(i.distanceToSquared(o),h);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),ks.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,p,f,m),Fs.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,p,f,m),Bs.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(ks.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),Fs.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Bs.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(ks.calc(d),Fs.calc(d),Bs.calc(d)),a},Us.prototype.copy=function(e){Ls.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Us.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Us.prototype.fromJSON=function(e){Ls.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Lt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},js.prototype=Object.create(Ls.prototype),js.prototype.constructor=js,js.prototype.isCubicBezierCurve=!0,js.prototype.getPoint=function(e,t){var n=t||new Ct,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Vs(e,r.x,i.x,o.x,a.x),Vs(e,r.y,i.y,o.y,a.y)),n},js.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},js.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},js.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Hs.prototype=Object.create(Ls.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isCubicBezierCurve3=!0,Hs.prototype.getPoint=function(e,t){var n=t||new Lt,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Vs(e,r.x,i.x,o.x,a.x),Vs(e,r.y,i.y,o.y,a.y),Vs(e,r.z,i.z,o.z,a.z)),n},Hs.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Hs.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Hs.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Zs.prototype=Object.create(Ls.prototype),Zs.prototype.constructor=Zs,Zs.prototype.isLineCurve=!0,Zs.prototype.getPoint=function(e,t){var n=t||new Ct;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Zs.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Zs.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Zs.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Zs.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Zs.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},qs.prototype=Object.create(Ls.prototype),qs.prototype.constructor=qs,qs.prototype.isLineCurve3=!0,qs.prototype.getPoint=function(e,t){var n=t||new Lt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},qs.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},qs.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},qs.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},qs.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ws.prototype=Object.create(Ls.prototype),Ws.prototype.constructor=Ws,Ws.prototype.isQuadraticBezierCurve=!0,Ws.prototype.getPoint=function(e,t){var n=t||new Ct,r=this.v0,i=this.v1,o=this.v2;return n.set(Gs(e,r.x,i.x,o.x),Gs(e,r.y,i.y,o.y)),n},Ws.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ws.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ws.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ys.prototype=Object.create(Ls.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isQuadraticBezierCurve3=!0,Ys.prototype.getPoint=function(e,t){var n=t||new Lt,r=this.v0,i=this.v1,o=this.v2;return n.set(Gs(e,r.x,i.x,o.x),Gs(e,r.y,i.y,o.y),Gs(e,r.z,i.z,o.z)),n},Ys.prototype.copy=function(e){return Ls.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ys.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ys.prototype.fromJSON=function(e){return Ls.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ks.prototype=Object.create(Ls.prototype),Ks.prototype.constructor=Ks,Ks.prototype.isSplineCurve=!0,Ks.prototype.getPoint=function(e,t){var n=t||new Ct,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set(zs(a,s.x,l.x,u.x,c.x),zs(a,s.y,l.y,u.y,c.y)),n},Ks.prototype.copy=function(e){Ls.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},Ks.prototype.toJSON=function(){var e=Ls.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},Ks.prototype.fromJSON=function(e){Ls.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Ct).fromArray(r))}return this};var $s=Object.freeze({ArcCurve:Ds,CatmullRomCurve3:Us,CubicBezierCurve:js,CubicBezierCurve3:Hs,EllipseCurve:Ps,LineCurve:Zs,LineCurve3:qs,QuadraticBezierCurve:Ws,QuadraticBezierCurve3:Ys,SplineCurve:Ks});function Xs(){Ls.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Qs(e){Xs.call(this),this.type="Path",this.currentPoint=new Ct,e&&this.setFromPoints(e)}function Js(e){Qs.call(this,e),this.uuid=Rt.generateUUID(),this.type="Shape",this.holes=[]}function el(e,t){Cn.call(this),this.type="Light",this.color=new fn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function tl(e,t,n){el.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Cn.DefaultUp),this.updateMatrix(),this.groundColor=new fn(t)}function nl(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Ct(512,512),this.map=null,this.matrix=new an}function rl(){nl.call(this,new ro(50,1,.5,500))}function il(e,t,n,r,i,o){el.call(this,e,t),this.type="SpotLight",this.position.copy(Cn.DefaultUp),this.updateMatrix(),this.target=new Cn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new rl}function ol(e,t,n,r){el.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new nl(new ro(90,1,.5,500))}function al(e,t,n,r,i,o){no.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function sl(){nl.call(this,new al(-5,5,5,-5,.5,500))}function ll(e,t){el.call(this,e,t),this.type="DirectionalLight",this.position.copy(Cn.DefaultUp),this.updateMatrix(),this.target=new Cn,this.shadow=new sl}function ul(e,t){el.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function cl(e,t,n,r){el.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function dl(e){this.manager=void 0!==e?e:Ss,this.textures={}}Xs.prototype=Object.assign(Object.create(Ls.prototype),{constructor:Xs,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Zs(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){Ls.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Ls.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){Ls.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new $s[r.type]).fromJSON(r))}return this}}),Qs.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Qs,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new Zs(this.currentPoint.clone(),new Ct(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var i=new Ws(this.currentPoint.clone(),new Ct(e,t),new Ct(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,o){var a=new js(this.currentPoint.clone(),new Ct(e,t),new Ct(n,r),new Ct(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(e){var t=new Ks([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,n,r,i,o)},absarc:function(e,t,n,r,i,o){this.absellipse(e,t,n,n,r,i,o)},ellipse:function(e,t,n,r,i,o,a,s){var l=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+l,t+u,n,r,i,o,a,s)},absellipse:function(e,t,n,r,i,o,a,s){var l=new Ps(e,t,n,r,i,o,a,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(e){return Xs.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Xs.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Xs.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Js.prototype=Object.assign(Object.create(Qs.prototype),{constructor:Js,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Qs.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=Qs.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){Qs.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new Qs).fromJSON(r))}return this}}),el.prototype=Object.assign(Object.create(Cn.prototype),{constructor:el,isLight:!0,copy:function(e){return Cn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Cn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),tl.prototype=Object.assign(Object.create(el.prototype),{constructor:tl,isHemisphereLight:!0,copy:function(e){return el.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(nl.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),rl.prototype=Object.assign(Object.create(nl.prototype),{constructor:rl,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Rt.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix())}}),il.prototype=Object.assign(Object.create(el.prototype),{constructor:il,isSpotLight:!0,copy:function(e){return el.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ol.prototype=Object.assign(Object.create(el.prototype),{constructor:ol,isPointLight:!0,copy:function(e){return el.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),al.prototype=Object.assign(Object.create(no.prototype),{constructor:al,isOrthographicCamera:!0,copy:function(e,t){return no.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,d=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/l))+c*(this.view.width/l),s=(a-=d*(this.view.offsetY/u))-d*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Cn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),sl.prototype=Object.assign(Object.create(nl.prototype),{constructor:sl}),ll.prototype=Object.assign(Object.create(el.prototype),{constructor:ll,isDirectionalLight:!0,copy:function(e){return el.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ul.prototype=Object.assign(Object.create(el.prototype),{constructor:ul,isAmbientLight:!0}),cl.prototype=Object.assign(Object.create(el.prototype),{constructor:cl,isRectAreaLight:!0,copy:function(e){return el.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=el.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(dl.prototype,{load:function(e,t,n,r){var i=this,o=new Is(i.manager);o.setPath(i.path),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new ss[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new fn).setHex(o.value);break;case"v2":r.uniforms[i].value=(new Ct).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new Lt).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new $t).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new Pt).fromArray(o.value);case"m4":r.uniforms[i].value=(new an).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)r.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Ct).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),r},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var hl=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function pl(){Wn.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function fl(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),On.call(this,e,t,n),this.meshPerAttribute=r||1}function ml(e){this.manager=void 0!==e?e:Ss}pl.prototype=Object.assign(Object.create(Wn.prototype),{constructor:pl,isInstancedBufferGeometry:!0,copy:function(e){return Wn.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=Wn.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),fl.prototype=Object.assign(Object.create(On.prototype),{constructor:fl,isInstancedBufferAttribute:!0,copy:function(e){return On.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=On.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Object.assign(ml.prototype,{load:function(e,t,n,r){var i=this,o=new Is(i.manager);o.setPath(i.path),o.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=e.isInstancedBufferGeometry?new pl:new Wn,n=e.data.index;if(void 0!==n){var r=new gl[n.type](n.array);t.setIndex(new On(r,1))}var i=e.data.attributes;for(var o in i){var a=i[o],s=(r=new gl[a.type](a.array),new(a.isInstancedBufferAttribute?fl:On)(r,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),t.addAttribute(o,s)}var l=e.data.morphAttributes;if(l)for(var o in l){for(var u=l[o],c=[],d=0,h=u.length;d<h;d++)a=u[d],s=new On(r=new gl[a.type](a.array),a.itemSize,a.normalized),void 0!==a.name&&(s.name=a.name),c.push(s);t.morphAttributes[o]=c}var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==p){d=0;for(var f=p.length;d!==f;++d){var m=p[d];t.addGroup(m.start,m.count,m.materialIndex)}}var g=e.data.boundingSphere;if(void 0!==g){var y=new Lt;void 0!==g.center&&y.fromArray(g.center),t.boundingSphere=new nn(y,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var gl={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function yl(e){this.manager=void 0!==e?e:Ss,this.resourcePath=""}Object.assign(yl.prototype,{crossOrigin:"anonymous",load:function(e,t,n,r){var i=this,o=void 0===this.path?hl(e):this.path;this.resourcePath=this.resourcePath||o;var a=new Is(i.manager);a.setPath(this.path),a.load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,r,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Js).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new ml,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new $a[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new $a[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new $a[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new $a[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new $a[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new $a[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new $a[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new $a[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new $a[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new $a[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new $a[s.type]((new $s[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new $a[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new $a[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],u=0,c=s.shapes.length;u<c;u++){var d=t[s.shapes[u]];l.push(d)}a=new $a[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(l=[],u=0,c=s.shapes.length;u<c;u++)d=t[s.shapes[u]],l.push(d);var h=s.options.extrudePath;void 0!==h&&(s.options.extrudePath=(new $s[h.type]).fromJSON(h)),a=new $a[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?a=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(e,t){var n={},r={};if(void 0!==e){var i=new dl;i.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),l.push(n[c.uuid])}r[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=Es.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),o.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var o=new Rs(new As(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var l=e[a],u=l.url;if(Array.isArray(u)){r[l.uuid]=[];for(var c=0,d=u.length;c<d;c++){var h=u[c],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;r[l.uuid].push(i(p))}}else p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.resourcePath+l.url,r[l.uuid]=i(p)}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new Mr(t[s.image]):new Kt(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=n(s.mapping,Tl)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=n(s.wrap[0],Al),a.wrapT=n(s.wrap[1],Al)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=n(s.minFilter,Sl)),void 0!==s.magFilter&&(a.magFilter=n(s.magFilter,Sl)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),r[s.uuid]=a}return r},parseObject:function(e,t,n){var r;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new _o,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new fn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new bo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new vo(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new ro(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new al(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new ul(e.color,e.intensity);break;case"DirectionalLight":r=new ll(e.color,e.intensity);break;case"PointLight":r=new ol(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new cl(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new il(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new tl(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(e.geometry),s=o(e.material);r=a.bones&&a.bones.length>0?new xo(a,s):new vr(a,s),void 0!==e.drawMode&&r.setDrawMode(e.drawMode);break;case"LOD":r=new So;break;case"Line":r=new Mo(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":r=new Po(i(e.geometry),o(e.material));break;case"LineSegments":r=new Lo(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":r=new Oo(i(e.geometry),o(e.material));break;case"Sprite":r=new Ao(o(e.material));break;case"Group":r=new to;break;default:r=new Cn}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var l=e.children,u=0;u<l.length;u++)r.add(this.parseObject(l[u],t,n));if("LOD"===e.type)for(var c=e.levels,d=0;d<c.length;d++){var h=c[d],p=r.getObjectByProperty("uuid",h.object);void 0!==p&&r.addLevel(p,h.distance)}return r}});var vl,bl,_l,El,wl,Tl={UVMapping:300,CubeReflectionMapping:re,CubeRefractionMapping:ie,EquirectangularReflectionMapping:oe,EquirectangularRefractionMapping:ae,SphericalReflectionMapping:se,CubeUVReflectionMapping:le,CubeUVRefractionMapping:ue},Al={RepeatWrapping:ce,ClampToEdgeWrapping:de,MirroredRepeatWrapping:he},Sl={NearestFilter:pe,NearestMipMapNearestFilter:fe,NearestMipMapLinearFilter:me,LinearFilter:ge,LinearMipMapNearestFilter:ye,LinearMipMapLinearFilter:ve};function xl(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:Ss,this.options=void 0}function Il(){this.type="ShapePath",this.color=new fn,this.subPaths=[],this.currentPath=null}function Rl(e){this.type="Font",this.data=e}function Cl(e,t,n,r,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,l,u,c,d,h,p,f=new Il;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),g=0,y=m.length;g<y;)switch(m[g++]){case"m":a=m[g++]*t+n,s=m[g++]*t+r,f.moveTo(a,s);break;case"l":a=m[g++]*t+n,s=m[g++]*t+r,f.lineTo(a,s);break;case"q":l=m[g++]*t+n,u=m[g++]*t+r,c=m[g++]*t+n,d=m[g++]*t+r,f.quadraticCurveTo(c,d,l,u);break;case"b":l=m[g++]*t+n,u=m[g++]*t+r,c=m[g++]*t+n,d=m[g++]*t+r,h=m[g++]*t+n,p=m[g++]*t+r,f.bezierCurveTo(c,d,h,p,l,u)}return{offsetX:o.ha*t,path:f}}}function Ml(){}xl.prototype={constructor:xl,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ts.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)})).then((function(n){Ts.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Il.prototype,{moveTo:function(e,t){this.currentPath=new Qs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,o){this.currentPath.bezierCurveTo(e,t,n,r,i,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new Js;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=t[o],l=-l,s=t[i],u=-u),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var c=u*(e.x-a.x)-l*(e.y-a.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return r}var i=Sa.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);var a,s,l,u=[];if(1===o.length)return s=o[0],(l=new Js).curves=s.curves,u.push(l),u;var c=!i(o[0].getPoints());c=e?!c:c;var d,h,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var y=0,v=o.length;y<v;y++)a=i(d=(s=o[y]).getPoints()),(a=e?!a:a)?(!c&&f[g]&&g++,f[g]={s:new Js,p:d},f[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:d[0]});if(!f[0])return n(o);if(f.length>1){for(var b=!1,_=[],E=0,w=f.length;E<w;E++)p[E]=[];for(E=0,w=f.length;E<w;E++)for(var T=m[E],A=0;A<T.length;A++){for(var S=T[A],x=!0,I=0;I<f.length;I++)r(S.p,f[I].p)&&(E!==I&&_.push({froms:E,tos:I,hole:A}),x?(x=!1,p[I].push(S)):b=!0);x&&p[E].push(S)}_.length>0&&(b||(m=p))}y=0;for(var R=f.length;y<R;y++){l=f[y].s,u.push(l);for(var C=0,M=(h=m[y]).length;C<M;C++)l.holes.push(h[C].h)}return u}}),Object.assign(Rl.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,l=0,u=0;u<r.length;u++){var c=r[u];if("\n"===c)s=0,l-=o;else{var d=Cl(c,i,s,l,n);s+=d.offsetX,a.push(d.path)}}return a}(e,t,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),Object.assign(function(e){this.manager=void 0!==e?e:Ss}.prototype,{load:function(e,t,n,r){var i=this,o=new Is(this.manager);o.setPath(this.path),o.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new Rl(e)},setPath:function(e){return this.path=e,this}}),Ml.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],o=t[n+1];if(i.test(e))return o}return null}},Object.assign(Ml.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(vl={NoBlending:v,NormalBlending:b,AdditiveBlending:_,SubtractiveBlending:E,MultiplyBlending:w,CustomBlending:T},bl=new fn,_l=new Ms,El=new dl,function(e,t,n){var r={};function i(e,i,o,a,s){var l,u=t+e,c=Ml.Handlers.get(u);null!==c?l=c.load(u):(_l.setCrossOrigin(n),l=_l.load(u)),void 0!==i&&(l.repeat.fromArray(i),1!==i[0]&&(l.wrapS=ce),1!==i[1]&&(l.wrapT=ce)),void 0!==o&&l.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(l.wrapS=ce),"mirror"===a[0]&&(l.wrapS=he),"repeat"===a[1]&&(l.wrapT=ce),"mirror"===a[1]&&(l.wrapT=he)),void 0!==s&&(l.anisotropy=s);var d=Rt.generateUUID();return r[d]=l,d}var o={uuid:Rt.generateUUID(),type:"MeshLambertMaterial"};for(var a in e){var s=e[a];switch(a){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"DbgName":o.name=s;break;case"blending":o.blending=vl[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",a,"is no longer supported.");break;case"colorDiffuse":o.color=bl.fromArray(s).getHex();break;case"colorSpecular":o.specular=bl.fromArray(s).getHex();break;case"colorEmissive":o.emissive=bl.fromArray(s).getHex();break;case"specularCoef":o.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(o.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(o.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(o.type="MeshStandardMaterial");break;case"mapDiffuse":o.map=i(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapEmissive":o.emissiveMap=i(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapLight":o.lightMap=i(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapAO":o.aoMap=i(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapBump":o.bumpMap=i(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":o.bumpScale=s;break;case"mapNormal":o.normalMap=i(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":o.normalScale=s;break;case"mapSpecular":o.specularMap=i(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapMetalness":o.metalnessMap=i(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapRoughness":o.roughnessMap=i(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapAlpha":o.alphaMap=i(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"flipSided":o.side=m;break;case"doubleSided":o.side=g;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),o.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":o[a]=s;break;case"vertexColors":!0===s&&(o.vertexColors=2),"face"===s&&(o.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",a,s)}}return"MeshBasicMaterial"===o.type&&delete o.emissive,"MeshPhongMaterial"!==o.type&&delete o.specular,o.opacity<1&&(o.transparent=!0),El.setTextures(r),El.parse(o)})});var Ll=function(){return void 0===wl&&(wl=new(window.AudioContext||window.webkitAudioContext)),wl};function Pl(e){this.manager=void 0!==e?e:Ss}function Dl(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new Lt)}function Ol(e,t){el.call(this,void 0,t),this.sh=void 0!==e?e:new Dl}function Nl(e,t,n){Ol.call(this,void 0,n);var r=(new fn).set(e),i=(new fn).set(t),o=new Lt(r.r,r.g,r.b),a=new Lt(i.r,i.g,i.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(l)}function kl(e,t){Ol.call(this,void 0,t);var n=(new fn).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Fl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ro,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ro,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}Object.assign(Pl.prototype,{load:function(e,t,n,r){var i=new Is(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,(function(e){var n=e.slice(0);Ll().decodeAudioData(n,(function(e){t(e)}))}),n,r)},setPath:function(e){return this.path=e,this}}),Object.assign(Dl.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t=.282095*o[0],t+=.488603*o[1]*r,t+=.488603*o[2]*i,t+=.488603*o[3]*n,t+=1.092548*o[4]*(n*r),t+=1.092548*o[5]*(r*i),t+=.315392*o[6]*(3*i*i-1),(t+=1.092548*o[7]*(n*i))+.546274*o[8]*(n*n-r*r)},getIrradianceAt:function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t=.886227*o[0],t+=2*o[1]*.511664*r,t+=2*o[2]*.511664*i,t+=2*o[3]*.511664*n,t+=2*o[4]*.429043*n*r,t+=2*o[5]*.429043*r*i,t+=o[6]*(.743125*i*i-.247708),(t+=2*o[7]*.429043*n*i)+.429043*o[8]*(n*n-r*r)},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e){for(var t=this.coefficients,n=0;n<9;n++)t[n].fromArray(e,3*n);return this},toArray:function(){for(var e=[],t=this.coefficients,n=0;n<9;n++)t[n].toArray(e,3*n);return e}}),Object.assign(Dl,{getBasisAt:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}),Ol.prototype=Object.assign(Object.create(el.prototype),{constructor:Ol,isLightProbe:!0,copy:function(e){return el.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return el.prototype.toJSON.call(this,e)}}),Nl.prototype=Object.assign(Object.create(Ol.prototype),{constructor:Nl,isHemisphereLightProbe:!0,copy:function(e){return Ol.prototype.copy.call(this,e),this},toJSON:function(e){return Ol.prototype.toJSON.call(this,e)}}),kl.prototype=Object.assign(Object.create(Ol.prototype),{constructor:kl,isAmbientLightProbe:!0,copy:function(e){return Ol.prototype.copy.call(this,e),this},toJSON:function(e){return Ol.prototype.toJSON.call(this,e)}}),Object.assign(Fl.prototype,{update:function(){var e,t,n,r,i,o,a,s,l=new an,u=new an;return function(c){if(e!==this||t!==c.focus||n!==c.fov||r!==c.aspect*this.aspect||i!==c.near||o!==c.far||a!==c.zoom||s!==this.eyeSep){e=this,t=c.focus,n=c.fov,r=c.aspect*this.aspect,i=c.near,o=c.far,a=c.zoom;var d,h,p=c.projectionMatrix.clone(),f=(s=this.eyeSep/2)*i/t,m=i*Math.tan(Rt.DEG2RAD*n*.5)/a;u.elements[12]=-s,l.elements[12]=s,d=-m*r+f,h=m*r+f,p.elements[0]=2*i/(h-d),p.elements[8]=(h+d)/(h-d),this.cameraL.projectionMatrix.copy(p),d=-m*r-f,h=m*r-f,p.elements[0]=2*i/(h-d),p.elements[8]=(h+d)/(h-d),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(l)}}()});var Bl=90;function Ul(e,t,n,r){Cn.call(this),this.type="CubeCamera";var i=new ro(Bl,1,e,t);i.up.set(0,-1,0),i.lookAt(new Lt(1,0,0)),this.add(i);var o=new ro(Bl,1,e,t);o.up.set(0,-1,0),o.lookAt(new Lt(-1,0,0)),this.add(o);var a=new ro(Bl,1,e,t);a.up.set(0,0,1),a.lookAt(new Lt(0,1,0)),this.add(a);var s=new ro(Bl,1,e,t);s.up.set(0,0,-1),s.lookAt(new Lt(0,-1,0)),this.add(s);var l=new ro(Bl,1,e,t);l.up.set(0,-1,0),l.lookAt(new Lt(0,0,1)),this.add(l);var u=new ro(Bl,1,e,t);u.up.set(0,-1,0),u.lookAt(new Lt(0,0,-1)),this.add(u),r=r||{format:Pe,magFilter:ge,minFilter:ge},this.renderTarget=new Jt(n,n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,o),e.setRenderTarget(r,2),e.render(t,a),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,l),r.texture.generateMipmaps=c,e.setRenderTarget(r,5),e.render(t,u),e.setRenderTarget(n)},this.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)e.setRenderTarget(o,a),e.clear(t,n,r);e.setRenderTarget(i)}}function zl(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Gl(){Cn.call(this),this.type="AudioListener",this.context=Ll(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Vl(e){Cn.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function jl(e){Vl.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Hl(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Zl(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Ul.prototype=Object.create(Cn.prototype),Ul.prototype.constructor=Ul,Object.assign(zl.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Gl.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Gl,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Lt,t=new Mt,n=new Lt,r=new Lt,i=new zl;return function(o){Cn.prototype.updateMatrixWorld.call(this,o);var a=this.context.listener,s=this.up;if(this.timeDelta=i.getDelta(),this.matrixWorld.decompose(e,t,n),r.set(0,0,-1).applyQuaternion(t),a.positionX){var l=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(e.x,l),a.positionY.linearRampToValueAtTime(e.y,l),a.positionZ.linearRampToValueAtTime(e.z,l),a.forwardX.linearRampToValueAtTime(r.x,l),a.forwardY.linearRampToValueAtTime(r.y,l),a.forwardZ.linearRampToValueAtTime(r.z,l),a.upX.linearRampToValueAtTime(s.x,l),a.upY.linearRampToValueAtTime(s.y,l),a.upZ.linearRampToValueAtTime(s.z,l)}else a.setPosition(e.x,e.y,e.z),a.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z)}}()}),Vl.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Vl,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),jl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:jl,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(){var e=new Lt,t=new Mt,n=new Lt,r=new Lt;return function(i){if(Cn.prototype.updateMatrixWorld.call(this,i),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(e,t,n),r.set(0,0,1).applyQuaternion(t);var o=this.panner;if(o.positionX){var a=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(e.x,a),o.positionY.linearRampToValueAtTime(e.y,a),o.positionZ.linearRampToValueAtTime(e.z,a),o.orientationX.linearRampToValueAtTime(r.x,a),o.orientationY.linearRampToValueAtTime(r.y,a),o.orientationZ.linearRampToValueAtTime(r.z,a)}else o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z)}}}()}),Object.assign(Hl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(Zl.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*t;this._mixBufferRegion(n,r,a,1-i,t)}for(var s=t,l=t+t;s!==l;++s)if(n[s]!==n[s+t]){o.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,r){Mt.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}}});var ql,Wl,Yl,Kl,$l,Xl,Ql,Jl,eu,tu,nu,ru,iu,ou,au,su="\\[\\]\\.:\\/";function lu(e,t,n){var r=n||uu.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function uu(e,t,n){this.path=t,this.parsedPath=n||uu.parseTrackName(t),this.node=uu.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function cu(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,o=new Array(i),a={endingStart:dt,endingEnd:dt},s=0;s!==i;++s){var l=r[s].createInterpolant(null);o[s]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function du(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function hu(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function pu(e,t,n){Eo.call(this,e,t),this.meshPerAttribute=n||1}function fu(e,t,n,r){this.ray=new mr(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function mu(e,t){return e.distance-t.distance}function gu(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,o=0,a=i.length;o<a;o++)gu(i[o],t,n,!0)}function yu(e,t){this.min=void 0!==e?e:new Ct(1/0,1/0),this.max=void 0!==t?t:new Ct(-1/0,-1/0)}function vu(e,t){this.start=void 0!==e?e:new Lt,this.end=void 0!==t?t:new Lt}function bu(e){Cn.call(this),this.material=e,this.render=function(){}}function _u(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new Wn,u=new Vn(2*a*3,3);l.addAttribute("position",u),Lo.call(this,l,new Co({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Eu(e,t){Cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Wn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new Vn(r,3));var l=new Co({fog:!1});this.cone=new Lo(n,l),this.add(this.cone),this.update()}function wu(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,wu(e.children[n]));return t}function Tu(e){for(var t=wu(e),n=new Wn,r=[],i=[],o=new fn(0,0,1),a=new fn(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new Vn(r,3)),n.addAttribute("color",new Vn(i,3));var u=new Co({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});Lo.call(this,n,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Au(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new Na(t,4,2),i=new yr({wireframe:!0,fog:!1});vr.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Su(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var n=new Wn;n.addAttribute("position",new Vn([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),n.computeBoundingSphere();var r=new Co({fog:!1});Mo.call(this,n,r);var i=new Wn;i.addAttribute("position",new Vn([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new vr(i,new yr({side:m,fog:!1}))),this.update()}function xu(e,t,n){Cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Wo(t);r.rotateY(.5*Math.PI),this.material=new yr({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new On(o,3)),this.add(new vr(r,this.material)),this.update()}function Iu(e,t){this.lightProbe=e,this.size=t;var n=new fr({defines:{GAMMA_OUTPUT:""},uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")}),r=new Na(1,32,16);vr.call(this,r,n),this.onBeforeRender()}function Ru(e,t,n,r){e=e||10,t=t||10,n=new fn(void 0!==n?n:4473924),r=new fn(void 0!==r?r:8947848);for(var i=t/2,o=e/t,a=e/2,s=[],l=[],u=0,c=0,d=-a;u<=t;u++,d+=o){s.push(-a,0,d,a,0,d),s.push(d,0,-a,d,0,a);var h=u===i?n:r;h.toArray(l,c),c+=3,h.toArray(l,c),c+=3,h.toArray(l,c),c+=3,h.toArray(l,c),c+=3}var p=new Wn;p.addAttribute("position",new Vn(s,3)),p.addAttribute("color",new Vn(l,3));var f=new Co({vertexColors:2});Lo.call(this,p,f)}function Cu(e,t,n,r,i,o){e=e||10,t=t||16,n=n||8,r=r||64,i=new fn(void 0!==i?i:4473924),o=new fn(void 0!==o?o:8947848);var a,s,l,u,c,d,h,p=[],f=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),a=Math.sin(l)*e,s=Math.cos(l)*e,p.push(0,0,0),p.push(a,0,s),h=1&u?i:o,f.push(h.r,h.g,h.b),f.push(h.r,h.g,h.b);for(u=0;u<=n;u++)for(h=1&u?i:o,d=e-e/n*u,c=0;c<r;c++)l=c/r*(2*Math.PI),a=Math.sin(l)*d,s=Math.cos(l)*d,p.push(a,0,s),f.push(h.r,h.g,h.b),l=(c+1)/r*(2*Math.PI),a=Math.sin(l)*d,s=Math.cos(l)*d,p.push(a,0,s),f.push(h.r,h.g,h.b);var m=new Wn;m.addAttribute("position",new Vn(p,3)),m.addAttribute("color",new Vn(f,3));var g=new Co({vertexColors:2});Lo.call(this,m,g)}function Mu(e,t,n,r){this.audio=e,this.range=t||1,this.divisionsInnerAngle=n||16,this.divisionsOuterAngle=r||2;var i=new Wn,o=this.divisionsInnerAngle+2*this.divisionsOuterAngle,a=new Float32Array(3*(3*o+3));i.addAttribute("position",new On(a,3));var s=new Co({color:65280}),l=new Co({color:16776960});Mo.call(this,i,[l,s]),this.update()}function Lu(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new Wn,u=new Vn(2*a*3,3);l.addAttribute("position",u),Lo.call(this,l,new Co({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Pu(e,t,n){Cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new Wn;r.addAttribute("position",new Vn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new Co({fog:!1});this.lightPlane=new Mo(r,i),this.add(this.lightPlane),(r=new Wn).addAttribute("position",new Vn([0,0,0,0,0,1],3)),this.targetLine=new Mo(r,i),this.add(this.targetLine),this.update()}function Du(e){var t=new Wn,n=new Co({color:16777215,vertexColors:1}),r=[],i=[],o={},a=new fn(16755200),s=new fn(16711680),l=new fn(43775),u=new fn(16777215),c=new fn(3355443);function d(e,t,n){h(e,n),h(t,n)}function h(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(r.length/3-1)}d("n1","n2",a),d("n2","n4",a),d("n4","n3",a),d("n3","n1",a),d("f1","f2",a),d("f2","f4",a),d("f4","f3",a),d("f3","f1",a),d("n1","f1",a),d("n2","f2",a),d("n3","f3",a),d("n4","f4",a),d("p","n1",s),d("p","n2",s),d("p","n3",s),d("p","n4",s),d("u1","u2",l),d("u2","u3",l),d("u3","u1",l),d("c","t",u),d("p","c",c),d("cn1","cn2",c),d("cn3","cn4",c),d("cf1","cf2",c),d("cf3","cf4",c),t.addAttribute("position",new Vn(r,3)),t.addAttribute("color",new Vn(i,3)),Lo.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Ou(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Wn;i.setIndex(new On(n,1)),i.addAttribute("position",new On(r,3)),Lo.call(this,i,new Co({color:t})),this.matrixAutoUpdate=!1,this.update()}function Nu(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Wn;i.setIndex(new On(r,1)),i.addAttribute("position",new Vn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Lo.call(this,i,new Co({color:n})),this.geometry.computeBoundingSphere()}function ku(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new Wn;i.addAttribute("position",new Vn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Mo.call(this,i,new Co({color:r}));var o=new Wn;o.addAttribute("position",new Vn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new vr(o,new yr({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function Fu(e,t,n,r,i,o){Cn.call(this),void 0===e&&(e=new Lt(0,0,1)),void 0===t&&(t=new Lt(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===ru&&((ru=new Wn).addAttribute("position",new Vn([0,0,0,0,1,0],3)),(iu=new Za(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Mo(ru,new Co({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new vr(iu,new yr({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}function Bu(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Wn;n.addAttribute("position",new Vn(t,3)),n.addAttribute("color",new Vn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Co({vertexColors:2});Lo.call(this,n,r)}function Uu(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Us.call(this,e),this.type="catmullrom"}Object.assign(lu.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(uu,{Composite:lu,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new uu.Composite(e,t,n):new uu(e,t,n)},sanitizeNodeName:(eu=new RegExp("["+su+"]","g"),function(e){return e.replace(/\s/g,"_").replace(eu,"")}),parseTrackName:(ql="[^"+su+"]",Wl="[^"+su.replace("\\.","")+"]",Yl=/((?:WC+[\/:])*)/.source.replace("WC",ql),Kl=/(WCOD+)?/.source.replace("WCOD",Wl),$l=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ql),Xl=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ql),Ql=new RegExp("^"+Yl+Kl+$l+Xl+"$"),Jl=["material","materials","bones"],function(e){var t=Ql.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Jl.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function(e){for(var n=0;n<e.length;n++){var i=e[n];if(i.name===t||i.uuid===t)return i;var o=r(i.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}}),Object.assign(uu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=uu.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[r];if(void 0!==s){var l=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(uu.prototype,{_getValue_unbound:uu.prototype.getValue,_setValue_unbound:uu.prototype.setValue}),Object.assign(function(){this.uuid=Rt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var d=arguments[u],h=d.uuid,p=r[h];if(void 0===p){p=t++,r[h]=p,e.push(d);for(var f=0,m=s;f!==m;++f)a[f].push(new uu(d,i[f],o[f]))}else if(p<n){l=e[p];var g=--n,y=e[g];for(r[y.uuid]=p,e[p]=y,r[h]=g,e[g]=d,f=0,m=s;f!==m;++f){var v=a[f],b=v[g],_=v[p];v[p]=b,void 0===_&&(_=new uu(d,i[f],o[f])),v[g]=_}}else e[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],l=s.uuid,u=n[l];if(void 0!==u&&u>=t){var c=t++,d=e[c];n[d.uuid]=u,e[u]=d,n[l]=c,e[c]=s;for(var h=0,p=i;h!==p;++h){var f=r[h],m=f[c],g=f[u];f[u]=m,f[c]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a].uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var c=--n,d=e[c],h=e[y=--t];r[d.uuid]=u,e[u]=d,r[h.uuid]=c,e[c]=h,e.pop();for(var p=0,f=o;p!==f;++p){var m=(v=i[p])[c],g=v[y];v[u]=m,v[c]=g,v.pop()}}else{var y;for(r[(h=e[y=--t]).uuid]=u,e[u]=h,e.pop(),p=0,f=o;p!==f;++p){var v;(v=i[p])[u]=v[y],v.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(c);for(var d=u,h=s.length;d!==h;++d){var p=s[d];c[d]=new uu(p,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(cu.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,o=i/r,a=r/i;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/a,l[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,d=l.length;c!==d;++c)l[c].evaluate(a),u[c].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,r=this.loop,i=this._loopCount,o=2202===r;if(0===e)return-1===i?t:o&&1==(1&i)?n-t:t;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=n||t<0){var a=Math.floor(t/n);t-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=t;if(o&&1==(1&i))return n-t}return t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=ht,r.endingEnd=ht):(r.endingStart=e?this.zeroSlopeAtStart?ht:dt:pt,r.endingEnd=t?this.zeroSlopeAtEnd?ht:dt:pt)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=n,this}}),du.prototype=Object.assign(Object.create(r.prototype),{constructor:du,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var d=r[c],h=d.name,p=u[h];if(void 0!==p)o[c]=p;else{if(void 0!==(p=o[c])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,h));continue}var f=t&&t._propertyBindings[c].binding.parsedPath;++(p=new Zl(uu.create(n,h,f),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(p,s,h),o[c]=p}a[c].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],o=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete a[i];e:{for(var u in a)break e;delete o[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new ds(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Es.findByName(n,e):e,o=null!==i?i.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[r];if(void 0!==l)return l;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new cu(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,o,r),u},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Es.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a)t[a]._update(r,e,i,o);var s=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),hu.prototype.clone=function(){return new hu(void 0===this.value.clone?this.value:this.value.clone())},pu.prototype=Object.assign(Object.create(Eo.prototype),{constructor:pu,isInstancedInterleavedBuffer:!0,copy:function(e){return Eo.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(fu.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return gu(e,this,r,t),r.sort(mu),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=e.length;i<o;i++)gu(e[i],this,r,t);return r.sort(mu),r}}),Object.assign(function(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Rt.clamp(t/this.radius,-1,1))),this}}),Object.assign(function(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}}),Object.assign(yu.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Ct;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Ct),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Ct),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Ct),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Ct),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Ct;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(vu.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Lt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Lt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Lt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(tu=new Lt,nu=new Lt,function(e,t){tu.subVectors(e,this.start),nu.subVectors(this.end,this.start);var n=nu.dot(nu),r=nu.dot(tu)/n;return t&&(r=Rt.clamp(r,0,1)),r}),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Lt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),bu.prototype=Object.create(Cn.prototype),bu.prototype.constructor=bu,bu.prototype.isImmediateRenderObject=!0,_u.prototype=Object.create(Lo.prototype),_u.prototype.constructor=_u,_u.prototype.update=function(){var e=new Lt,t=new Lt,n=new Pt;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,l=a.faces,u=0,c=0,d=l.length;c<d;c++)for(var h=l[c],p=0,f=h.vertexNormals.length;p<f;p++){var m=s[h[r[p]]],g=h.vertexNormals[p];e.copy(m).applyMatrix4(i),t.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}else if(a&&a.isBufferGeometry){var y=a.attributes.position,v=a.attributes.normal;for(u=0,p=0,f=y.count;p<f;p++)e.set(y.getX(p),y.getY(p),y.getZ(p)).applyMatrix4(i),t.set(v.getX(p),v.getY(p),v.getZ(p)),t.applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),o.setXYZ(u,e.x,e.y,e.z),u+=1,o.setXYZ(u,t.x,t.y,t.z),u+=1}o.needsUpdate=!0}}(),Eu.prototype=Object.create(Cn.prototype),Eu.prototype.constructor=Eu,Eu.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Eu.prototype.update=function(){var e=new Lt;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Tu.prototype=Object.create(Lo.prototype),Tu.prototype.constructor=Tu,Tu.prototype.updateMatrixWorld=function(){var e=new Lt,t=new an,n=new an;return function(r){var i=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,l=0;s<i.length;s++){var u=i[s];u.parent&&u.parent.isBone&&(t.multiplyMatrices(n,u.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(l,e.x,e.y,e.z),t.multiplyMatrices(n,u.parent.matrixWorld),e.setFromMatrixPosition(t),a.setXYZ(l+1,e.x,e.y,e.z),l+=2)}o.getAttribute("position").needsUpdate=!0,Cn.prototype.updateMatrixWorld.call(this,r)}}(),Au.prototype=Object.create(vr.prototype),Au.prototype.constructor=Au,Au.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Au.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Su.prototype=Object.create(Mo.prototype),Su.prototype.constructor=Su,Su.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},Su.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},xu.prototype=Object.create(Cn.prototype),xu.prototype.constructor=xu,xu.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},xu.prototype.update=function(){var e=new Lt,t=new fn,n=new fn;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");t.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?t:n;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Iu.prototype=Object.create(vr.prototype),Iu.prototype.constructor=Iu,Iu.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Iu.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},Ru.prototype=Object.assign(Object.create(Lo.prototype),{constructor:Ru,copy:function(e){return Lo.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),Cu.prototype=Object.create(Lo.prototype),Cu.prototype.constructor=Cu,Mu.prototype=Object.create(Mo.prototype),Mu.prototype.constructor=Mu,Mu.prototype.update=function(){var e,t,n=this.audio,r=this.range,i=this.divisionsInnerAngle,o=this.divisionsOuterAngle,a=Rt.degToRad(n.panner.coneInnerAngle),s=Rt.degToRad(n.panner.coneOuterAngle),l=a/2,u=s/2,c=0,d=0,h=this.geometry,p=h.attributes.position;function f(n,i,o,a){var s=(i-n)/o;for(p.setXYZ(c,0,0,0),d++,e=n;e<i;e+=s)t=c+d,p.setXYZ(t,Math.sin(e)*r,0,Math.cos(e)*r),p.setXYZ(t+1,Math.sin(Math.min(e+s,i))*r,0,Math.cos(Math.min(e+s,i))*r),p.setXYZ(t+2,0,0,0),d+=3;h.addGroup(c,d,a),c+=d,d=0}h.clearGroups(),f(-u,-l,o,0),f(-l,l,i,1),f(l,u,o,0),p.needsUpdate=!0,a===s&&(this.material[0].visible=!1)},Mu.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},Lu.prototype=Object.create(Lo.prototype),Lu.prototype.constructor=Lu,Lu.prototype.update=function(){var e=new Lt,t=new Lt,n=new Pt;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,l=0,u=0,c=s.length;u<c;u++){var d=s[u],h=d.normal;e.copy(a[d.a]).add(a[d.b]).add(a[d.c]).divideScalar(3).applyMatrix4(r),t.copy(h).applyMatrix3(n).normalize().multiplyScalar(this.size).add(e),i.setXYZ(l,e.x,e.y,e.z),l+=1,i.setXYZ(l,t.x,t.y,t.z),l+=1}i.needsUpdate=!0}}(),Pu.prototype=Object.create(Cn.prototype),Pu.prototype.constructor=Pu,Pu.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Pu.prototype.update=function(){var e=new Lt,t=new Lt,n=new Lt;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(t),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=n.length()}}(),Du.prototype=Object.create(Lo.prototype),Du.prototype.constructor=Du,Du.prototype.update=function(){var e,t,n=new Lt,r=new no;function i(i,o,a,s){n.set(o,a,s).unproject(r);var l=t[i];if(void 0!==l)for(var u=e.getAttribute("position"),c=0,d=l.length;c<d;c++)u.setXYZ(l[c],n.x,n.y,n.z)}return function(){e=this.geometry,t=this.pointMap,r.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Ou.prototype=Object.create(Lo.prototype),Ou.prototype.constructor=Ou,Ou.prototype.update=function(){var e=new tn;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var n=e.min,r=e.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Ou.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Ou.prototype.copy=function(e){return Lo.prototype.copy.call(this,e),this.object=e.object,this},Ou.prototype.clone=function(){return(new this.constructor).copy(this)},Nu.prototype=Object.create(Lo.prototype),Nu.prototype.constructor=Nu,Nu.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Cn.prototype.updateMatrixWorld.call(this,e))},ku.prototype=Object.create(Mo.prototype),ku.prototype.constructor=ku,ku.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?m:f,this.lookAt(this.plane.normal),Cn.prototype.updateMatrixWorld.call(this,e)},Fu.prototype=Object.create(Cn.prototype),Fu.prototype.constructor=Fu,Fu.prototype.setDirection=(au=new Lt,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(au.set(e.z,0,-e.x).normalize(),ou=Math.acos(e.y),this.quaternion.setFromAxisAngle(au,ou))}),Fu.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},Fu.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Fu.prototype.copy=function(e){return Cn.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Fu.prototype.clone=function(){return(new this.constructor).copy(this)},Bu.prototype=Object.create(Lo.prototype),Bu.prototype.constructor=Bu,Ls.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Ls.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Xs.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Dn,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Lt(i.x,i.y,i.z||0))}return t}}),Object.assign(Qs.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Object.create(Us.prototype),Object.create(Us.prototype),Uu.prototype=Object.create(Us.prototype),Object.assign(Uu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Ru.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Tu.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ml.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),hl(e)}}),Object.assign(yl.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(yu.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(tn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),vu.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Rt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Rt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Rt.ceilPowerOfTwo(e)}}),Object.assign(Pt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(an.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Lt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)}}),rn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Mt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(mr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(gr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(gr,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),gr.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),gr.getNormal(e,t,n,r)}}),Object.assign(Js.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ra(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new za(this,e)}}),Object.assign(Ct.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Lt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign($t.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Dn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Cn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Cn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(So.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Io.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),xo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ls.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),ro.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(el.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(On.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Wn.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Wn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Ca.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(hu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Jn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new fn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(ts.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(fr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(yo.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(yo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Xi.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Jt.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(Xt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(mo.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Vl.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Pl).load(e,(function(e){t.setBuffer(e)})),this},Hl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ul.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Wt.crossOrigin=void 0,Wt.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Ms;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},Wt.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Cs;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},Wt.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Wt.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const zu="0.12.1",Gu={three:"^0.105.2"},Vu=zu.split(".")[1],ju=zu,Hu=Gu.three.split(".")[1],Zu=Gu.three.replace(/[^0-9.]/g,""),qu={ORBIT:0,DEVICEORIENTATION:1},Wu={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3},Yu={Info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC",Arrow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADPklEQVR42u2bMUscQRiG30/SRaJEI1ZKUiRErNIELRUbQYSAnX8hpVUgkDYp0wgWVjYW+QcJaQzYpLojJIXhtDDEKBpj65ti58ixmdmb2ZvZ7+T2AUHudmfmeXf2bnb3O6CmpqZmgJGqOiI5AWAWwEMA0wDuArht3r4CcAagBeAbgIaI/NQOp1fhIZKLJN+SbDKcptl3keSQtk+I+BjJVyRbJaRdtEybY9p+ReKjJN+QvIwonufS9DGq7ZuXXyd5nFA8zzHJdW1vkLxDcrdC8Ty7JO9oyc+QPFCUb3NAcqZq+TmSp9rmHZySnCvjErwOIPkUwHv8+w7vF64ALIrIfrIASM4C+ADgnratgxMACyLSiB4AyREAnwE80LbswgGAJyJy4bNxyApr6wbIw4xxy3djrwCYfeeuaZsFsEbPdULXU4DZqusLgMkEA21P05EEbf8A8FhEzos28pkBLxLKL5s/r/M1kEkz9vKQHGeatf05yfmOfubNa7G5JDle5NhtBjwHMBz5yFwAWBaRT+0XzP8pZsKwcQiH2fX8Ycojb+kzxUw4ZJn7CSQXqpRPHMKCq7+iZJ71Mvdy/DftXSQ6HcJdSDaqPPKW/mPOBO+lcbvzCU35RCFM2PpwnQKzZQfdgfe0dxH5dLA6uQJ4pC2fIASrkyuA6X6QjxyC1ckVQNn7bNHlI4ZgdXIFUObiJJl8pBCsTjGfuIwA2Cv4FN7xbYjkjqsRAHuIePXoCiDF1Zk2VidXAL+1R5sAq5MrgJb2aBNgdXIF8FV7tAmwOrkCCFs73wysTtYATHFCU3vEEWm6Ci6KvgY/ao86Ik6XogDeaY86Ik6XbjPgSHvkEThCwQy45XpDRK5JbgN4GWkgUyR9H65MRQxgW0SunZ5FezK7pfwd8e8MV8UfAPdF5Jdrg8JrAbPjprZFD2wWyQP6j8ZSEufRmGlgQ9umBBvd5IOgbjFUKLu+XnWBhG+rpsFVZGUo/coJgFVf+aAATAgNACvICpL6jSsAKyH1QcEBmBD2ASwhq+7uF84ALIVWiPUEB7lQsiOEwS2VzQUxmMXSuRCqKpd/zX4rl88FMZg/mLAEcSN+MlP/aKqmpqZmkPkL0hSjwOpNKxwAAAAASUVORK5CYII=",FullscreenEnter:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik03IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eiIvPgo8L3N2Zz4=",FullscreenLeave:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE0SDE5VjE2SDE2VjE5SDE0VjE0TTUsMTRIMTBWMTlIOFYxNkg1VjE0TTgsNUgxMFYxMEg1VjhIOFY1TTE5LDhWMTBIMTRWNUgxNlY4SDE5WiIgLz48L3N2Zz4=",VideoPlay:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTgsNS4xNFYxOS4xNEwxOSwxMi4xNEw4LDUuMTRaIiAvPjwvc3ZnPg==",VideoPause:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE5LjE0SDE4VjUuMTRIMTRNNiwxOS4xNEgxMFY1LjE0SDZWMTkuMTRaIiAvPjwvc3ZnPg==",WhiteTile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==",Setting:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADn0lEQVR42u2bzUsVURjGnyO6CPzAMnTjppAo3LTwH1CqTfaxbeOiRS37A0wXtROFVi1aRBs3LWohSIGbQAQXViBGRhG0UIRKUCpK7q/FnOB2uc6cOXNmRnGe3eW+H8/7zLln3vNxpQoVKlQ4wjBFJAFOSRqX1O7osivpvjHmU1nChBZglvSYLYJbS0EanCvIJzWK+gnsyH34/8OuMaYjb265jwCgz6N4SWq3vodbAEmnS/KtBDgoAgyU5BteAOAkMAPcBroc7PskDWfgN+wyDwBdltMMcDI3tYBnde/pHeARMNTErgd4APzweP834oeN1dMkz5DlsFNn/yyv4kdiSK4At4AO4CqwGaDwRmza2B0210qM7YhrXU59ANAq6bWkwQTTn5KO5fIE0uVYlXTeGLOXFMx1DrjlULwKKN41x6DlnIjEEQCckPRe0okCiguJr5LOGGO+xhm5jICJQ1i8LOeJJKPYEQAMKvrtt5ZdjSf2FM0Fq/sZJI2A6UNcvCz36TiDfUcAcE1SPu/U6Mm8k/TFfu6XdFb5iX3dGPM8lQfwNod3+TowBnQ3yddtv1vPIe+b1JIBiwEJ1IAJ208k5W21trWA+V/5CHAcmAtU/A2P/DcCiTAHHE8tgCVhgLvAXgYCk17Jo/yTGfLuWe7Zd72AC8CWB4n3OAz7mLytNkZabAEXMhfeQKYfWEpJZCxA3rGUOZeA/qDF15FpAz47EvlNk9neI2e3jeWCz0BbmvipNkSMMX8kuSZYM8Z8zyqAjbHmaN5mOeYjgIXrU93MWrxHrNQjrqiDkQMLHwG+OdqF3NN3jeXKzU8AoF1SzdH8XKhJUO7HZDXLMbwAwICkJUULFxe0SbqSVQAbw3Xi7Ze0ZLmGAzAKbHs0JGU1QtvAaIjCW4B7ZOvJy2qFa5a730RPtBiaz0CgnkiZi6F5fBZDVMvho7EhcuS3xJJ2hV9IupgTqaLw0hhzab8vq23xOG/r+LDsKjLgYVzxUnU0ltwK2wDezUyJmEwqXgp/PL4rvxthaeCSI+zxuA10J8ZkWdJNSb2SLkvayKHwDRu71+ZajrG941J8agALDQ3GU/a/IvMkYCPzmCbtLNEVmacNtgs5iP9fYVNEV1Q6Hez7yNZSL+J2SarTcpqiyV2iUkG0IvPFvbz5FbEn+KEk3wMjwMeSfCsBXFBdly9CAPk9ydyffpECuB5tZfVJjaKWueOSfinln6YK4lahQoUKRxd/AcRPGTcQCAUQAAAAAElFTkSuQmCC",ChevronRight:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTguNTksMTYuNThMMTMuMTcsMTJMOC41OSw3LjQxTDEwLDZMMTYsMTJMMTAsMThMOC41OSwxNi41OFoiIC8+PC9zdmc+",Check:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=",ViewIndicator:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+"},Ku={load:function(e,t=(()=>{}),n=(()=>{}),r=(()=>{})){let i,o,a,s,l,u,c;Ts.enabled=!0;for(let t in Yu)Yu.hasOwnProperty(t)&&e===Yu[t]&&(c=t);if(i=Ts.get(c||e),void 0!==i)return t&&setTimeout((function(){n({loaded:1,total:1}),t(i)}),0),i;l=window.URL||window.webkitURL,u=document.createElementNS("http://www.w3.org/1999/xhtml","img"),Ts.add(c||e,u);const d=()=>{l.revokeObjectURL(u.src),t(u)};if(0===e.indexOf("data:"))return u.addEventListener("load",d,!1),u.src=e,u;u.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"",o=new window.XMLHttpRequest,o.open("GET",e,!0),"test"!==process.env.npm_lifecycle_event&&(o.onreadystatechange=function(){4===this.readyState&&this.status>=400&&r()}),o.responseType="arraybuffer",o.addEventListener("error",r),o.addEventListener("progress",(e=>{if(!e)return;const{loaded:t,total:r,lengthComputable:i}=e;i&&n({loaded:t,total:r})})),o.addEventListener("loadend",(e=>{if(!e)return;const{currentTarget:{response:t}}=e;a=new Uint8Array(t),s=new window.Blob([a]),u.addEventListener("load",d,!1),u.src=l.createObjectURL(s)})),o.send(null)}},$u={load:function(e,t=(()=>{}),n,r){var i=new Kt;return Ku.load(e,(function(n){i.image=n;const r=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?Pe:De,i.needsUpdate=!0,t(i)}),n,r),i}},Xu={load:function(e,t=(()=>{}),n=(()=>{}),r){var i,o,a,s,l;return i=new Mr([]),o=0,a={},s={},e.map((function(e,u){Ku.load(e,(function(e){i.images[u]=e,6==++o&&(i.needsUpdate=!0,t(i))}),(function(e){for(var t in a[u]={loaded:e.loaded,total:e.total},s.loaded=0,s.total=0,l=0,a)l++,s.loaded+=a[t].loaded,s.total+=a[t].total;l<6&&(s.total=s.total/l*6),n(s)}),r)})),i}};function Qu(e){this.constraints=Object.assign({video:{width:{ideal:1920},height:{ideal:1080},facingMode:{exact:"environment"}},audio:!1},e),this.container=null,this.scene=null,this.element=null,this.devices=[],this.stream=null,this.ratioScalar=1,this.videoDeviceIndex=0}function Ju(e=16777215,t=!0,n=1500){this.dpr=window.devicePixelRatio;const{canvas:r,context:i}=this.createCanvas(),o=new To({color:e,map:this.createCanvasTexture(r)});Ao.call(this,o),this.canvasWidth=r.width,this.canvasHeight=r.height,this.context=i,this.color=e instanceof fn?e:new fn(e),this.autoSelect=t,this.dwellTime=n,this.rippleDuration=500,this.position.z=-10,this.center.set(.5,.5),this.scale.set(.5,.5,1),this.startTimestamp=null,this.timerId=null,this.callback=null,this.frustumCulled=!1,this.updateCanvasArcByProgress(0)}Qu.prototype=Object.assign(Object.create(r.prototype),{setContainer:function(e){this.container=e},setScene:function(e){this.scene=e},enumerateDevices:function(){const e=this.devices,t=new Promise((t=>{t(e)}));return e.length>0?t:window.navigator.mediaDevices.enumerateDevices()},switchNextVideoDevice:function(){const e=this.stop.bind(this),t=this.start.bind(this),n=this.setVideDeviceIndex.bind(this);let r=this.videoDeviceIndex;this.getDevices("video").then((i=>{e(),r++,r>=i.length?(n(0),r--):n(r),t(i[r])}))},getDevices:function(e="video"){const t=this.devices;return this.enumerateDevices().then((e=>e.map((e=>(t.includes(e)||t.push(e),e))))).then((t=>{const n=new RegExp(e,"i");return t.filter((e=>n.test(e.kind)))}))},getUserMedia:function(e){const t=this.setMediaStream.bind(this),n=this.playVideo.bind(this);return window.navigator.mediaDevices.getUserMedia(e).then(t).then(n).catch((e=>{console.warn(`PANOLENS.Media: ${e}`)}))},setVideDeviceIndex:function(e){this.videoDeviceIndex=e},start:function(e){const t=this.constraints,n=this.getUserMedia.bind(this);return this.element=this.createVideoElement(),this.getDevices().then((r=>{if(!r||0===r.length)throw Error("no video device found");const i=e||r[0];return t.video.deviceId=i.deviceId,n(t)}))},stop:function(){const e=this.stream;e&&e.active&&(e.getTracks()[0].stop(),window.removeEventListener("resize",this.onWindowResize.bind(this)),this.element=null,this.stream=null)},setMediaStream:function(e){this.stream=e,this.element.srcObject=e,this.scene&&(this.scene.background=this.createVideoTexture()),window.addEventListener("resize",this.onWindowResize.bind(this))},playVideo:function(){const{element:e}=this;e&&(e.play(),this.dispatchEvent({type:"play"}))},pauseVideo:function(){const{element:e}=this;e&&(e.pause(),this.dispatchEvent({type:"pause"}))},createVideoTexture:function(){const e=this.element,t=new No(e);return t.generateMipmaps=!1,t.minFilter=ge,t.magFilter=ge,t.format=Pe,t.center.set(.5,.5),e.addEventListener("canplay",this.onWindowResize.bind(this)),t},createVideoElement:function(){const e=this.dispatchEvent.bind(this),t=document.createElement("video");return t.setAttribute("autoplay",""),t.setAttribute("muted",""),t.setAttribute("playsinline",""),t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.objectPosition="center",t.style.objectFit="cover",t.style.display=this.scene?"none":"",t.addEventListener("canplay",(()=>e({type:"canplay"}))),t},onWindowResize:function(){if(this.element&&this.element.videoWidth&&this.element.videoHeight&&this.scene){const{clientWidth:e,clientHeight:t}=this.container,n=this.scene.background,{videoWidth:r,videoHeight:i}=this.element,o=i/r*(this.container?e/t:1)*this.ratioScalar;e>t?n.repeat.set(o,1):n.repeat.set(1,1/o)}}}),Ju.prototype=Object.assign(Object.create(Ao.prototype),{constructor:Ju,setColor:function(e){this.material.color.copy(e instanceof fn?e:new fn(e))},createCanvasTexture:function(e){const t=new Fo(e);return t.minFilter=ge,t.magFilter=ge,t.generateMipmaps=!1,t},createCanvas:function(){const e=document.createElement("canvas"),t=e.getContext("2d"),n=this.dpr;return e.width=32*n,e.height=32*n,t.scale(n,n),t.shadowBlur=5,t.shadowColor="rgba(200,200,200,0.9)",{canvas:e,context:t}},updateCanvasArcByProgress:function(e){const t=this.context,{canvasWidth:n,canvasHeight:r,material:i}=this,o=this.dpr,a=e*Math.PI*2,s=this.color.getStyle(),l=.5*n/o,u=.5*r/o;t.clearRect(0,0,n,r),t.beginPath(),0===e?(t.arc(l,u,n/16,0,2*Math.PI),t.fillStyle=s,t.fill()):(t.arc(l,u,n/4-3,-Math.PI/2,-Math.PI/2+a),t.strokeStyle=s,t.lineWidth=3,t.stroke()),t.closePath(),i.map.needsUpdate=!0},ripple:function(){const e=this.context,{canvasWidth:t,canvasHeight:n,material:r}=this,i=this.rippleDuration,o=performance.now(),a=this.color,s=this.dpr,l=.5*t/s,u=.5*n/s,c=()=>{const d=window.requestAnimationFrame(c),h=(performance.now()-o)/i,p=1-h>0?1-h:0,f=h*t*.5/s;e.clearRect(0,0,t,n),e.beginPath(),e.arc(l,u,f,0,2*Math.PI),e.fillStyle=`rgba(${255*a.r}, ${255*a.g}, ${255*a.b}, ${p})`,e.fill(),e.closePath(),h>=1&&(window.cancelAnimationFrame(d),this.updateCanvasArcByProgress(0),this.dispatchEvent({type:"reticle-ripple-end"})),r.map.needsUpdate=!0};this.dispatchEvent({type:"reticle-ripple-start"}),c()},show:function(){this.visible=!0},hide:function(){this.visible=!1},start:function(e){this.autoSelect&&(this.dispatchEvent({type:"reticle-start"}),this.startTimestamp=performance.now(),this.callback=e,this.update())},end:function(){this.startTimestamp&&(window.cancelAnimationFrame(this.timerId),this.updateCanvasArcByProgress(0),this.callback=null,this.timerId=null,this.startTimestamp=null,this.dispatchEvent({type:"reticle-end"}))},update:function(){this.timerId=window.requestAnimationFrame(this.update.bind(this));const e=(performance.now()-this.startTimestamp)/this.dwellTime;this.updateCanvasArcByProgress(e),this.dispatchEvent({type:"reticle-update",progress:e}),e>=1&&(window.cancelAnimationFrame(this.timerId),this.callback&&this.callback(),this.end(),this.ripple())}});var ec,tc,nc=(ec=function(e,t){var n=function(){this._tweens={},this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(e=void 0!==e?e:r.now();n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var o=this._tweens[n[i]];o&&!1===o.update(e)&&(o._isPlaying=!1,t||delete this._tweens[n[i]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var r=new n;r.Group=n,r._nextId=0,r.nextId=function(){return r._nextId++},"undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?r.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?r.now=self.performance.now.bind(self.performance):void 0!==Date.now?r.now=Date.now:r.now=function(){return(new Date).getTime()},r.Tween=function(e,t){this._object=e,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=r.Easing.Linear.None,this._interpolationFunction=r.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=t||r,this._id=r.nextId()},r.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},duration:function(e){return this._duration=e,this},start:function(e){for(var t in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==e?"string"==typeof e?r.now()+parseFloat(e):e:r.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}void 0!==this._object[t]&&(this._valuesStart[t]=this._object[t],this._valuesStart[t]instanceof Array==0&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop()},group:function(e){return this._group=e,this},delay:function(e){return this._delayTime=e,this},repeat:function(e){return this._repeat=e,this},repeatDelay:function(e){return this._repeatDelayTime=e,this},yoyo:function(e){return this._yoyo=e,this},easing:function(e){return this._easingFunction=e,this},interpolation:function(e){return this._interpolationFunction=e,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(e){return this._onStartCallback=e,this},onUpdate:function(e){return this._onUpdateCallback=e,this},onRepeat:function(e){return this._onRepeatCallback=e,this},onComplete:function(e){return this._onCompleteCallback=e,this},onStop:function(e){return this._onStopCallback=e,this},update:function(e){var t,n,r;if(e<this._startTime)return!0;for(t in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||n>1?1:n,r=this._easingFunction(n),this._valuesEnd)if(void 0!==this._valuesStart[t]){var i=this._valuesStart[t]||0,o=this._valuesEnd[t];o instanceof Array?this._object[t]=this._interpolationFunction(o,r):("string"==typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?i+parseFloat(o):parseFloat(o)),"number"==typeof o&&(this._object[t]=i+(o-i)*r))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(t in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[t]&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo){var a=this._valuesStartRepeat[t];this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=a}this._valuesStart[t]=this._valuesStartRepeat[t]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,l=this._chainedTweens.length;s<l;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}return!0}},r.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-r.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*r.Easing.Bounce.In(2*e):.5*r.Easing.Bounce.Out(2*e-1)+.5}}},r.Interpolation={Linear:function(e,t){var n=e.length-1,i=n*t,o=Math.floor(i),a=r.Interpolation.Utils.Linear;return t<0?a(e[0],e[1],i):t>1?a(e[n],e[n-1],n-i):a(e[o],e[o+1>n?n:o+1],i-o)},Bezier:function(e,t){for(var n=0,i=e.length-1,o=Math.pow,a=r.Interpolation.Utils.Bernstein,s=0;s<=i;s++)n+=o(1-t,i-s)*o(t,s)*e[s]*a(i,s);return n},CatmullRom:function(e,t){var n=e.length-1,i=n*t,o=Math.floor(i),a=r.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(o=Math.floor(i=n*(1+t))),a(e[(o-1+n)%n],e[o],e[(o+1)%n],e[(o+2)%n],i-o)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(a(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):a(e[o?o-1:0],e[o],e[n<o+1?n:o+1],e[n<o+2?n:o+2],i-o)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=r.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var r=t;r>1;r--)n*=r;return e[t]=n,n}}(),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),a=.5*(r-t),s=i*i;return(2*t-2*n+o+a)*(i*s)+(-3*t+3*n-2*o-a)*s+o*i+t}}},e.exports=r},ec(tc={exports:{}}),tc.exports);function rc(e=300,t,n){const r=500;t=t||Yu.Info,Ao.call(this),this.type="infospot",this.animated=void 0===n||n,this.isHovering=!1,this.frustumCulled=!1,this.element=null,this.toPanorama=null,this.cursorStyle=null,this.mode=Wu.NORMAL,this.scale.set(e,e,1),this.rotation.y=Math.PI,this.container=null,this.originalRaycast=this.raycast,this.HANDLER_FOCUS=null,this.material.side=g,this.material.depthTest=!1,this.material.transparent=!0,this.material.opacity=0,this.scaleUpAnimation=new nc.Tween,this.scaleDownAnimation=new nc.Tween;const i=function(t){if(!this.material)return;const n=t.image.width/t.image.height,i=new Lt;t.image.width=t.image.naturalWidth||64,t.image.height=t.image.naturalHeight||64,this.scale.set(n*e,e,1),i.copy(this.scale),this.scaleUpAnimation=new nc.Tween(this.scale).to({x:1.3*i.x,y:1.3*i.y},r).easing(nc.Easing.Elastic.Out),this.scaleDownAnimation=new nc.Tween(this.scale).to({x:i.x,y:i.y},r).easing(nc.Easing.Elastic.Out),this.material.map=t,this.material.needsUpdate=!0}.bind(this);this.showAnimation=new nc.Tween(this.material).to({opacity:1},r).onStart(this.enableRaycast.bind(this,!0)).easing(nc.Easing.Quartic.Out),this.hideAnimation=new nc.Tween(this.material).to({opacity:0},r).onStart(this.enableRaycast.bind(this,!1)).easing(nc.Easing.Quartic.Out),this.addEventListener("click",this.onClick),this.addEventListener("hover",this.onHover),this.addEventListener("hoverenter",this.onHoverStart),this.addEventListener("hoverleave",this.onHoverEnd),this.addEventListener("panolens-dual-eye-effect",this.onDualEyeEffect),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("dismiss",this.onDismiss),this.addEventListener("panolens-infospot-focus",this.setFocusMethod),$u.load(t,i)}function ic(e){e||console.warn("PANOLENS.Widget: No container specified"),r.call(this),this.DEFAULT_TRANSITION="all 0.27s ease",this.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),this.PREVENT_EVENT_HANDLER=function(e){e.preventDefault(),e.stopPropagation()},this.container=e,this.barElement=null,this.fullscreenElement=null,this.videoElement=null,this.settingElement=null,this.mainMenu=null,this.activeMainItem=null,this.activeSubMenu=null,this.mask=null}function oc(e,t){vr.call(this,e,t),this.type="panorama",this.ImageQualityLow=1,this.ImageQualityFair=2,this.ImageQualityMedium=3,this.ImageQualityHigh=4,this.ImageQualitySuperHigh=5,this.animationDuration=1e3,this.defaultInfospotSize=350,this.container=void 0,this.loaded=!1,this.linkedSpots=[],this.isInfospotVisible=!1,this.linkingImageURL=void 0,this.linkingImageScale=void 0,this.material.side=m,this.material.opacity=0,this.scale.x*=-1,this.renderOrder=-1,this.active=!1,this.infospotAnimation=new nc.Tween(this).to({},this.animationDuration/2),this.addEventListener("load",this.fadeIn.bind(this)),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("click",this.onClick.bind(this)),this.setupTransitions()}function ac(e,t,n){const r=t||new Na(5e3,60,40),i=n||new yr({opacity:0,transparent:!0});oc.call(this,r,i),this.src=e,this.radius=5e3}function sc(){const e=new Wn,t=new yr({color:0,opacity:0,transparent:!0});e.addAttribute("position",new On(new Float32Array,1)),oc.call(this,e,t)}function lc(e=[]){const t=1e4,n=Object.assign({},yn.cube),r=new Kn(t,t,t),i=new fr({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:n.uniforms,side:m,transparent:!0});oc.call(this,r,i),this.images=e,this.edgeLength=t,this.material.uniforms.opacity.value=0}function uc(){const e=[];for(let t=0;t<6;t++)e.push(Yu.WhiteTile);lc.call(this,e)}function cc(e,t={}){const n=new Na(5e3,60,40),r=new yr({opacity:0,transparent:!0});oc.call(this,n,r),this.src=e,this.options={videoElement:document.createElement("video"),loop:!0,muted:!0,autoplay:!1,playsinline:!0,crossOrigin:"anonymous"},Object.assign(this.options,t),this.videoElement=this.options.videoElement,this.videoProgress=0,this.radius=5e3,this.addEventListener("leave",this.pauseVideo.bind(this)),this.addEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.addEventListener("video-toggle",this.toggleVideo.bind(this)),this.addEventListener("video-time",this.setVideoCurrentTime.bind(this))}function dc(e={}){let t;this._parameters=e,this._zoom=null,this._panoId=null,this._panoClient=new google.maps.StreetViewService,this._count=0,this._total=0,this._canvas=[],this._ctx=[],this._wc=0,this._hc=0,this.result=null,this.rotation=0,this.copyright="",this.onSizeChange=null,this.onPanoramaLoad=null,this.levelsW=[1,2,4,7,13,26],this.levelsH=[1,1,2,4,7,13],this.widths=[416,832,1664,3328,6656,13312],this.heights=[416,416,832,1664,3328,6656],this.maxW=6656,this.maxH=6656;try{const e=document.createElement("canvas");t=e.getContext("experimental-webgl"),t||(t=e.getContext("webgl"))}catch(e){}this.maxW=Math.max(t.getParameter(t.MAX_TEXTURE_SIZE),this.maxW),this.maxH=Math.max(t.getParameter(t.MAX_TEXTURE_SIZE),this.maxH)}function hc(e,t){ac.call(this),this.panoId=e,this.gsvLoader=null,this.loadRequested=!1,this.setupGoogleMapAPI(t)}rc.prototype=Object.assign(Object.create(Ao.prototype),{constructor:rc,setContainer:function(e){let t;e instanceof HTMLElement?t=e:e&&e.container&&(t=e.container),t&&this.element&&t.appendChild(this.element),this.container=t},getContainer:function(){return this.container},onClick:function(e){this.element&&this.getContainer()&&(this.onHoverStart(e),this.lockHoverElement())},onDismiss:function(){this.element&&(this.unlockHoverElement(),this.onHoverEnd())},onHover:function(){},onHoverStart:function(e){if(!this.getContainer())return;const t=this.cursorStyle||(this.mode===Wu.NORMAL?"pointer":"default"),{scaleDownAnimation:n,scaleUpAnimation:r,element:i}=this;if(this.isHovering=!0,this.container.style.cursor=t,this.animated&&(n.stop(),r.start()),i&&e.mouseEvent.clientX>=0&&e.mouseEvent.clientY>=0){const{left:e,right:t,style:n}=i;this.mode===Wu.CARDBOARD||this.mode===Wu.STEREO?(n.display="none",e.style.display="block",t.style.display="block",i._width=e.clientWidth,i._height=e.clientHeight):(n.display="block",e&&(e.style.display="none"),t&&(t.style.display="none"),i._width=i.clientWidth,i._height=i.clientHeight)}},onHoverEnd:function(){if(!this.getContainer())return;const{scaleDownAnimation:e,scaleUpAnimation:t,element:n}=this;if(this.isHovering=!1,this.container.style.cursor="default",this.animated&&(t.stop(),e.start()),n&&!this.element.locked){const{left:e,right:t,style:r}=n;r.display="none",e&&(e.style.display="none"),t&&(t.style.display="none"),this.unlockHoverElement()}},onDualEyeEffect:function(e){if(!this.getContainer())return;let t,n,r;this.mode=e.mode,t=this.element,n=this.container.clientWidth/2,r=this.container.clientHeight/2,t&&(t.left||t.right||(t.left=t.cloneNode(!0),t.right=t.cloneNode(!0)),this.mode===Wu.CARDBOARD||this.mode===Wu.STEREO?(t.left.style.display=t.style.display,t.right.style.display=t.style.display,t.style.display="none"):(t.style.display=t.left.style.display,t.left.style.display="none",t.right.style.display="none"),this.translateElement(n,r),this.container.appendChild(t.left),this.container.appendChild(t.right))},translateElement:function(e,t){if(!this.element._width||!this.element._height||!this.getContainer())return;let n,r,i,o,a,s,l;l=this.container,i=this.element,o=i._width/2,a=i._height/2,s=void 0!==i.verticalDelta?i.verticalDelta:40,n=e-o,r=t-a-s,this.mode!==Wu.CARDBOARD&&this.mode!==Wu.STEREO||!i.left||!i.right||e===l.clientWidth/2&&t===l.clientHeight/2?this.setElementStyle("transform",i,"translate("+n+"px, "+r+"px)"):(n=l.clientWidth/4-o+(e-l.clientWidth/2),r=l.clientHeight/2-a-s+(t-l.clientHeight/2),this.setElementStyle("transform",i.left,"translate("+n+"px, "+r+"px)"),n+=l.clientWidth/2,this.setElementStyle("transform",i.right,"translate("+n+"px, "+r+"px)"))},setElementStyle:function(e,t,n){const r=t.style;"transform"===e&&(r.webkitTransform=r.msTransform=r.transform=n)},setText:function(e){this.element&&(this.element.textContent=e)},setCursorHoverStyle:function(e){this.cursorStyle=e},addHoverText:function(e,t=40){this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=t),this.setText(e)},addHoverElement:function(e,t=40){this.element||(this.element=e.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=t)},removeHoverElement:function(){this.element&&(this.element.left&&(this.container.removeChild(this.element.left),this.element.left=null),this.element.right&&(this.container.removeChild(this.element.right),this.element.right=null),this.container.removeChild(this.element),this.element=null)},lockHoverElement:function(){this.element&&(this.element.locked=!0)},unlockHoverElement:function(){this.element&&(this.element.locked=!1)},enableRaycast:function(e=!0){this.raycast=e?this.originalRaycast:()=>{}},show:function(e=0){const{animated:t,hideAnimation:n,showAnimation:r,material:i}=this;t?(n.stop(),r.delay(e).start()):(this.enableRaycast(!0),i.opacity=1)},hide:function(e=0){const{animated:t,hideAnimation:n,showAnimation:r,material:i,element:o}=this;if(o){const{style:e}=o;e.display="none"}t?(r.stop(),n.delay(e).start()):(this.enableRaycast(!1),i.opacity=0)},setFocusMethod:function(e){e&&(this.HANDLER_FOCUS=e.method)},focus:function(e,t){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,e,t),this.onDismiss())},dispose:function(){const{geometry:e,material:t}=this,{map:n}=t;this.removeHoverElement(),this.parent&&this.parent.remove(this),n&&(n.dispose(),t.map=null),e&&(e.dispose(),this.geometry=null),t&&(t.dispose(),this.material=null)}}),ic.prototype=Object.assign(Object.create(r.prototype),{constructor:ic,addControlBar:function(){if(this.container){var e,t,n,r,i=this;r="linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",(e=document.createElement("div")).style.width="100%",e.style.height="44px",e.style.float="left",e.style.transform=e.style.webkitTransform=e.style.msTransform="translateY(-100%)",e.style.background="-webkit-"+r,e.style.background="-moz-"+r,e.style.background="-o-"+r,e.style.background="-ms-"+r,e.style.background=r,e.style.transition=this.DEFAULT_TRANSITION,e.style.pointerEvents="none",e.isHidden=!1,e.toggle=function(){e.isHidden=!e.isHidden,t=e.isHidden?"translateY(0)":"translateY(-100%)",n=e.isHidden?0:1,e.style.transform=e.style.webkitTransform=e.style.msTransform=t,e.style.opacity=n};var o=this.createDefaultMenu();this.mainMenu=this.createMainMenu(o),e.appendChild(this.mainMenu);var a=this.createMask();this.mask=a,this.container.appendChild(a),e.dispose=function(){i.fullscreenElement&&(e.removeChild(i.fullscreenElement),i.fullscreenElement.dispose(),i.fullscreenElement=null),i.settingElement&&(e.removeChild(i.settingElement),i.settingElement.dispose(),i.settingElement=null),i.videoElement&&(e.removeChild(i.videoElement),i.videoElement.dispose(),i.videoElement=null)},this.container.appendChild(e),this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener(i.TOUCH_ENABLED?"touchend":"click",(function(e){e.preventDefault(),e.stopPropagation(),i.mask.hide(),i.settingElement.deactivate()}),!1),this.addEventListener("control-bar-toggle",e.toggle),this.barElement=e}else console.warn("Widget container not set")},createDefaultMenu:function(){var e,t=this;return e=function(e,n){return function(){t.dispatchEvent({type:"panolens-viewer-handler",method:e,data:n})}},[{title:"Control",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:e("enableControl",qu.ORBIT)},{title:"Sensor",handler:e("enableControl",qu.DEVICEORIENTATION)}]},{title:"Mode",subMenu:[{title:"Normal",handler:e("disableEffect")},{title:"Cardboard",handler:e("enableEffect",Wu.CARDBOARD)},{title:"Stereoscopic",handler:e("enableEffect",Wu.STEREO)}]}]},addControlButton:function(e){let t;switch(e){case"fullscreen":t=this.createFullscreenButton(),this.fullscreenElement=t;break;case"setting":t=this.createSettingButton(),this.settingElement=t;break;case"video":t=this.createVideoControl(),this.videoElement=t;break;default:return}t&&this.barElement.appendChild(t)},createMask:function(){const e=document.createElement("div");return e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.width="100%",e.style.height="100%",e.style.background="transparent",e.style.display="none",e.show=function(){this.style.display="block"},e.hide=function(){this.style.display="none"},e},createSettingButton:function(){let e,t=this;return e=this.createCustomItem({style:{backgroundImage:'url("'+Yu.Setting+'")',webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:function(e){e.preventDefault(),e.stopPropagation(),t.mainMenu.toggle(),this.activated?this.deactivate():this.activate()}}),e.activate=function(){this.style.transform="rotate3d(0,0,1,90deg)",this.activated=!0,t.mask.show()},e.deactivate=function(){this.style.transform="rotate3d(0,0,0,0)",this.activated=!1,t.mask.hide(),t.mainMenu&&t.mainMenu.visible&&t.mainMenu.hide(),t.activeSubMenu&&t.activeSubMenu.visible&&t.activeSubMenu.hide(),t.mainMenu&&t.mainMenu._width&&(t.mainMenu.changeSize(t.mainMenu._width),t.mainMenu.unslideAll())},e.activated=!1,e},createFullscreenButton:function(){let e,t,n=this,r=!1,i=!0;const{container:o}=this;if(t="panolens-style-addon",document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){if(document.addEventListener("fullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1),document.addEventListener("MSFullscreenChange",a,!1),e=this.createCustomItem({style:{backgroundImage:'url("'+Yu.FullscreenEnter+'")'},onTap:function(e){e.preventDefault(),e.stopPropagation(),i=!1,r?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),r=!1):(o.requestFullscreen&&o.requestFullscreen(),o.msRequestFullscreen&&o.msRequestFullscreen(),o.mozRequestFullScreen&&o.mozRequestFullScreen(),o.webkitRequestFullscreen&&o.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),r=!0),this.style.backgroundImage=r?'url("'+Yu.FullscreenLeave+'")':'url("'+Yu.FullscreenEnter+'")'}}),!document.querySelector(t)){const e=document.createElement("style");e.id=t,e.innerHTML=":-webkit-full-screen { width: 100% !important; height: 100% !important }",document.body.appendChild(e)}return e}function a(){i&&(r=!r,e.style.backgroundImage=r?'url("'+Yu.FullscreenLeave+'")':'url("'+Yu.FullscreenEnter+'")'),n.dispatchEvent({type:"panolens-viewer-handler",method:"onWindowResize"}),i=!0}},createVideoControl:function(){const e=document.createElement("span");return e.style.display="none",e.show=function(){e.style.display=""},e.hide=function(){e.style.display="none",e.controlButton.paused=!0,e.controlButton.update()},e.controlButton=this.createVideoControlButton(),e.seekBar=this.createVideoControlSeekbar(),e.appendChild(e.controlButton),e.appendChild(e.seekBar),e.dispose=function(){e.removeChild(e.controlButton),e.removeChild(e.seekBar),e.controlButton.dispose(),e.controlButton=null,e.seekBar.dispose(),e.seekBar=null},this.addEventListener("video-control-show",e.show),this.addEventListener("video-control-hide",e.hide),e},createVideoControlButton:function(){const e=this,t=this.createCustomItem({style:{float:"left",backgroundImage:'url("'+Yu.VideoPlay+'")'},onTap:function(n){n.preventDefault(),n.stopPropagation(),e.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoPlay",data:!this.paused}),this.paused=!this.paused,t.update()}});return t.paused=!0,t.update=function(e){this.paused=void 0!==e?e:this.paused,this.style.backgroundImage='url("'+(this.paused?Yu.VideoPlay:Yu.VideoPause)+'")'},t},createVideoControlSeekbar:function(){let e,t,n,r,i,o,a=this,s=!1;function l(e){e.stopPropagation(),s=!0,r=e.clientX||e.changedTouches&&e.changedTouches[0].clientX,i=parseInt(t.style.width)/100,a.container.addEventListener("mousemove",u,{passive:!0}),a.container.addEventListener("mouseup",c,{passive:!0}),a.container.addEventListener("touchmove",u,{passive:!0}),a.container.addEventListener("touchend",c,{passive:!0})}function u(t){if(s){const n=t.clientX||t.changedTouches&&t.changedTouches[0].clientX;o=(n-r)/e.clientWidth,o=i+o,o=o>1?1:o<0?0:o,e.setProgress(o),a.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:o})}}function c(e){e.stopPropagation(),s=!1,d()}function d(){a.container.removeEventListener("mousemove",u,!1),a.container.removeEventListener("mouseup",c,!1),a.container.removeEventListener("touchmove",u,!1),a.container.removeEventListener("touchend",c,!1)}return t=document.createElement("div"),t.style.width="0%",t.style.height="100%",t.style.backgroundColor="#fff",n=document.createElement("div"),n.style.float="right",n.style.width="14px",n.style.height="14px",n.style.transform="translate(7px, -5px)",n.style.borderRadius="50%",n.style.backgroundColor="#ddd",n.addEventListener("mousedown",l,{passive:!0}),n.addEventListener("touchstart",l,{passive:!0}),t.appendChild(n),e=this.createCustomItem({style:{float:"left",width:"30%",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},onTap:function(t){if(t.preventDefault(),t.stopPropagation(),t.target===n)return;const r=t.changedTouches&&t.changedTouches.length>0?(t.changedTouches[0].pageX-t.target.getBoundingClientRect().left)/this.clientWidth:t.offsetX/this.clientWidth;a.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:r}),e.setProgress(t.offsetX/this.clientWidth)},onDispose:function(){d(),t=null,n=null}}),e.appendChild(t),e.setProgress=function(e){t.style.width=100*e+"%"},this.addEventListener("video-update",(function(t){e.setProgress(t.percentage)})),e.progressElement=t,e.progressElementControl=n,e},createMenuItem:function(e){const t=this,n=document.createElement("a");return n.textContent=e,n.style.display="block",n.style.padding="10px",n.style.textDecoration="none",n.style.cursor="pointer",n.style.pointerEvents="auto",n.style.transition=this.DEFAULT_TRANSITION,n.slide=function(e){this.style.transform="translateX("+(e?"":"-")+"100%)"},n.unslide=function(){this.style.transform="translateX(0)"},n.setIcon=function(e){this.icon&&(this.icon.style.backgroundImage="url("+e+")")},n.setSelectionTitle=function(e){this.selection&&(this.selection.textContent=e)},n.addSelection=function(e){const t=document.createElement("span");return t.style.fontSize="13px",t.style.fontWeight="300",t.style.float="right",this.selection=t,this.setSelectionTitle(e),this.appendChild(t),this},n.addIcon=function(e=Yu.ChevronRight,t=!1,n=!1){const r=document.createElement("span");return r.style.float=t?"left":"right",r.style.width="17px",r.style.height="17px",r.style["margin"+(t?"Right":"Left")]="12px",r.style.backgroundSize="cover",n&&(r.style.transform="rotateZ(180deg)"),this.icon=r,this.setIcon(e),this.appendChild(r),this},n.addSubMenu=function(e,n){return this.subMenu=t.createSubMenu(e,n),this},n.addEventListener("mouseenter",(function(){this.style.backgroundColor="#e0e0e0"}),!1),n.addEventListener("mouseleave",(function(){this.style.backgroundColor="#fafafa"}),!1),n},createMenuItemHeader:function(e){const t=this.createMenuItem(e);return t.style.borderBottom="1px solid #333",t.style.paddingBottom="15px",t},createMainMenu:function(e){let t=this,n=this.createMenu();function r(e){e.preventDefault(),e.stopPropagation();let n=t.mainMenu,r=this.subMenu;n.hide(),n.slideAll(),n.parentElement.appendChild(r),t.activeMainItem=this,t.activeSubMenu=r,window.requestAnimationFrame((function(){n.changeSize(r.clientWidth),r.show(),r.unslideAll()}))}n._width=200,n.changeSize(n._width);for(var i=0;i<e.length;i++){var o=n.addItem(e[i].title);if(o.style.paddingLeft="20px",o.addIcon().addEventListener(t.TOUCH_ENABLED?"touchend":"click",r,!1),e[i].subMenu&&e[i].subMenu.length>0){var a=e[i].subMenu[0].title;o.addSelection(a).addSubMenu(e[i].title,e[i].subMenu)}}return n},createSubMenu:function(e,t){let n,r=this,i=this.createMenu();function o(e){e.preventDefault(),e.stopPropagation(),n=r.mainMenu,n.changeSize(n._width),n.unslideAll(),n.show(),i.slideAll(!0),i.hide(),"header"!==this.type&&(i.setActiveItem(this),r.activeMainItem.setSelectionTitle(this.textContent),this.handler&&this.handler())}i.items=t,i.activeItem=null,i.addHeader(e).addIcon(void 0,!0,!0).addEventListener(r.TOUCH_ENABLED?"touchend":"click",o,!1);for(let e=0;e<t.length;e++){const n=i.addItem(t[e].title);n.style.fontWeight=300,n.handler=t[e].handler,n.addIcon(" ",!0),n.addEventListener(r.TOUCH_ENABLED?"touchend":"click",o,!1),i.activeItem||i.setActiveItem(n)}return i.slideAll(!0),i},createMenu:function(){const e=this,t=document.createElement("span"),n=t.style;return n.padding="5px 0",n.position="fixed",n.bottom="100%",n.right="14px",n.backgroundColor="#fafafa",n.fontFamily="Helvetica Neue",n.fontSize="14px",n.visibility="hidden",n.opacity=0,n.boxShadow="0 0 12pt rgba(0,0,0,0.25)",n.borderRadius="2px",n.overflow="hidden",n.willChange="width, height, opacity",n.pointerEvents="auto",n.transition=this.DEFAULT_TRANSITION,t.visible=!1,t.changeSize=function(e,t){e&&(this.style.width=e+"px"),t&&(this.style.height=t+"px")},t.show=function(){this.style.opacity=1,this.style.visibility="visible",this.visible=!0},t.hide=function(){this.style.opacity=0,this.style.visibility="hidden",this.visible=!1},t.toggle=function(){this.visible?this.hide():this.show()},t.slideAll=function(e){for(let n=0;n<t.children.length;n++)t.children[n].slide&&t.children[n].slide(e)},t.unslideAll=function(){for(let e=0;e<t.children.length;e++)t.children[e].unslide&&t.children[e].unslide()},t.addHeader=function(t){const n=e.createMenuItemHeader(t);return n.type="header",this.appendChild(n),n},t.addItem=function(t){const n=e.createMenuItem(t);return n.type="item",this.appendChild(n),n},t.setActiveItem=function(e){this.activeItem&&this.activeItem.setIcon(" "),e.setIcon(Yu.Check),this.activeItem=e},t.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),t.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),t.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),t},createCustomItem:function(e={}){const t=this,n=e.element||document.createElement("span"),{onDispose:r}=e;return n.style.cursor="pointer",n.style.float="right",n.style.width="44px",n.style.height="100%",n.style.backgroundSize="60%",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="center",n.style.webkitUserSelect=n.style.MozUserSelect=n.style.userSelect="none",n.style.position="relative",n.style.pointerEvents="auto",n.addEventListener(t.TOUCH_ENABLED?"touchstart":"mouseenter",(function(){n.style.filter=n.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"}),{passive:!0}),n.addEventListener(t.TOUCH_ENABLED?"touchend":"mouseleave",(function(){n.style.filter=n.style.webkitFilter=""}),{passive:!0}),this.mergeStyleOptions(n,e.style),e.onTap&&n.addEventListener(t.TOUCH_ENABLED?"touchend":"click",e.onTap,!1),n.dispose=function(){n.removeEventListener(t.TOUCH_ENABLED?"touchend":"click",e.onTap,!1),r&&e.onDispose()},n},mergeStyleOptions:function(e,t={}){for(let n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n]);return e},dispose:function(){this.barElement&&(this.container.removeChild(this.barElement),this.barElement.dispose(),this.barElement=null)}}),oc.prototype=Object.assign(Object.create(vr.prototype),{constructor:oc,add:function(e){let t;if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}if(e instanceof rc){if(t=e,e.dispatchEvent){const{container:t}=this;t&&e.dispatchEvent({type:"panolens-container",container:t}),e.dispatchEvent({type:"panolens-infospot-focus",method:function(e,t,n){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[e,t,n]})}.bind(this)})}}else t=new Cn,t.scale.x=-1,t.scalePlaceHolder=!0,t.add(e);Cn.prototype.add.call(this,t)},load:function(){this.onLoad()},onClick:function(e){e.intersects&&0===e.intersects.length&&this.traverse((function(e){e.dispatchEvent({type:"dismiss"})}))},setContainer:function(e){let t;e instanceof HTMLElement?t=e:e&&e.container&&(t=e.container),t&&(this.children.forEach((function(e){e instanceof rc&&e.dispatchEvent&&e.dispatchEvent({type:"panolens-container",container:t})})),this.container=t)},onLoad:function(){this.loaded=!0,this.dispatchEvent({type:"load"})},onProgress:function(e){this.dispatchEvent({type:"progress",progress:e})},onError:function(){this.dispatchEvent({type:"error"})},getZoomLevel:function(){let e;return e=window.innerWidth<=800?this.ImageQualityFair:window.innerWidth>800&&window.innerWidth<=1280?this.ImageQualityMedium:window.innerWidth>1280&&window.innerWidth<=1920?this.ImageQualityHigh:window.innerWidth>1920?this.ImageQualitySuperHigh:this.ImageQualityLow,e},updateTexture:function(e){this.material.map=e,this.material.needsUpdate=!0},toggleInfospotVisibility:function(e,t){t=void 0!==t?t:0;const n=void 0!==e?e:!this.isInfospotVisible;this.traverse((function(e){e instanceof rc&&(n?e.show(t):e.hide(t))})),this.isInfospotVisible=n,this.infospotAnimation.onComplete(function(){this.dispatchEvent({type:"infospot-animation-complete",visible:n})}.bind(this)).delay(t).start()},setLinkingImage:function(e,t){this.linkingImageURL=e,this.linkingImageScale=t},link:function(e,t,n,r){let i,o;if(this.visible=!0,!t)return void console.warn("Please specify infospot position for linking");i=void 0!==n?n:void 0!==e.linkingImageScale?e.linkingImageScale:300,o=r||(e.linkingImageURL?e.linkingImageURL:Yu.Arrow);const a=new rc(i,o);a.position.copy(t),a.toPanorama=e,a.addEventListener("click",function(){this.dispatchEvent({type:"panolens-viewer-handler",method:"setPanorama",data:e})}.bind(this)),this.linkedSpots.push(a),this.add(a),this.visible=!1},reset:function(){this.children.length=0},setupTransitions:function(){this.fadeInAnimation=new nc.Tween(this.material).easing(nc.Easing.Quartic.Out).onStart(function(){this.visible=!0,this.dispatchEvent({type:"enter-fade-start"})}.bind(this)),this.fadeOutAnimation=new nc.Tween(this.material).easing(nc.Easing.Quartic.Out).onComplete(function(){this.visible=!1,this.dispatchEvent({type:"leave-complete"})}.bind(this)),this.enterTransition=new nc.Tween(this).easing(nc.Easing.Quartic.Out).onComplete(function(){this.dispatchEvent({type:"enter-complete"})}.bind(this)).start(),this.leaveTransition=new nc.Tween(this).easing(nc.Easing.Quartic.Out)},onFadeAnimationUpdate:function(){const e=this.material.opacity,{uniforms:t}=this.material;t&&t.opacity&&(t.opacity.value=e)},fadeIn:function(e){e=e>=0?e:this.animationDuration,this.fadeOutAnimation.stop(),this.fadeInAnimation.to({opacity:1},e).onUpdate(this.onFadeAnimationUpdate.bind(this)).onComplete(function(){this.toggleInfospotVisibility(!0,e/2),this.dispatchEvent({type:"enter-fade-complete"})}.bind(this)).start()},fadeOut:function(e){e=e>=0?e:this.animationDuration,this.fadeInAnimation.stop(),this.fadeOutAnimation.to({opacity:0},e).onUpdate(this.onFadeAnimationUpdate.bind(this)).start()},onEnter:function(){const e=this.animationDuration;this.leaveTransition.stop(),this.enterTransition.to({},e).onStart(function(){this.dispatchEvent({type:"enter-start"}),this.loaded?this.fadeIn(e):this.load()}.bind(this)).start(),this.dispatchEvent({type:"enter"}),this.children.forEach((e=>{e.dispatchEvent({type:"panorama-enter"})})),this.active=!0},onLeave:function(){const e=this.animationDuration;this.enterTransition.stop(),this.leaveTransition.to({},e).onStart(function(){this.dispatchEvent({type:"leave-start"}),this.fadeOut(e),this.toggleInfospotVisibility(!1)}.bind(this)).start(),this.dispatchEvent({type:"leave"}),this.children.forEach((e=>{e.dispatchEvent({type:"panorama-leave"})})),this.active=!1},dispose:function(){this.infospotAnimation.stop(),this.fadeInAnimation.stop(),this.fadeOutAnimation.stop(),this.enterTransition.stop(),this.leaveTransition.stop(),this.dispatchEvent({type:"panolens-viewer-handler",method:"onPanoramaDispose",data:this}),function e(t){const{geometry:n,material:r}=t;for(var i=t.children.length-1;i>=0;i--)e(t.children[i]),t.remove(t.children[i]);t instanceof rc&&t.dispose(),n&&(n.dispose(),t.geometry=null),r&&(r.dispose(),t.material=null)}(this),this.parent&&this.parent.remove(this)}}),ac.prototype=Object.assign(Object.create(oc.prototype),{constructor:ac,load:function(e){(e=e||this.src)?"string"==typeof e?$u.load(e,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this)):e instanceof HTMLImageElement&&this.onLoad(new Kt(e)):console.warn("Image source undefined")},onLoad:function(e){e.minFilter=e.magFilter=ge,e.needsUpdate=!0,this.updateTexture(e),window.requestAnimationFrame(oc.prototype.onLoad.bind(this))},reset:function(){oc.prototype.reset.call(this)},dispose:function(){const{material:{map:e}}=this;Ts.remove(this.src),e&&e.dispose(),oc.prototype.dispose.call(this)}}),sc.prototype=Object.assign(Object.create(oc.prototype),{constructor:sc}),lc.prototype=Object.assign(Object.create(oc.prototype),{constructor:lc,load:function(){Xu.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))},onLoad:function(e){this.material.uniforms.tCube.value=e,oc.prototype.onLoad.call(this)},dispose:function(){const{value:e}=this.material.uniforms.tCube;this.images.forEach((e=>{Ts.remove(e)})),e instanceof Mr&&e.dispose(),oc.prototype.dispose.call(this)}}),uc.prototype=Object.assign(Object.create(lc.prototype),{constructor:uc}),cc.prototype=Object.assign(Object.create(oc.prototype),{constructor:cc,isMobile:function(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(window.navigator.userAgent||window.navigator.vendor||window.opera),e},load:function(){const{muted:e,loop:t,autoplay:n,playsinline:r,crossOrigin:i}=this.options,o=this.videoElement,a=this.material,s=this.onProgress.bind(this),l=this.onLoad.bind(this);o.loop=t,o.autoplay=n,o.playsinline=r,o.crossOrigin=i,o.muted=e,r&&(o.setAttribute("playsinline",""),o.setAttribute("webkit-playsinline",""));const u=function(){this.setVideoTexture(o),n&&this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}),this.isMobile()&&(o.pause(),n&&e?this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),window.requestAnimationFrame((()=>{a.map.needsUpdate=!0,s({loaded:1,total:1}),l()}))};if(o.readyState>2)u.call(this);else{if(0===o.querySelectorAll("source").length){const e=document.createElement("source");e.src=this.src,o.appendChild(e)}o.load()}o.addEventListener("loadeddata",u.bind(this)),o.addEventListener("timeupdate",function(){this.videoProgress=o.duration>=0?o.currentTime/o.duration:0,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:this.videoProgress})}.bind(this)),o.addEventListener("ended",function(){t||(this.resetVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}))}.bind(this),!1)},setVideoTexture:function(e){if(!e)return;const t=new No(e);t.minFilter=ge,t.magFilter=ge,t.format=Pe,this.updateTexture(t)},reset:function(){this.videoElement=void 0,oc.prototype.reset.call(this)},isVideoPaused:function(){return this.videoElement.paused},toggleVideo:function(){const e=this.videoElement;e&&e[e.paused?"play":"pause"]()},setVideoCurrentTime:function({percentage:e}){const t=this.videoElement;t&&!Number.isNaN(e)&&1!==e&&(t.currentTime=t.duration*e,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:e}))},playVideo:function(){const e=this.videoElement,t=this.playVideo.bind(this),n=this.dispatchEvent.bind(this);e&&e.paused&&e.play().then((()=>{n({type:"play"})})).catch((e=>{window.requestAnimationFrame(t),n({type:"play-error",error:e})}))},pauseVideo:function(){const e=this.videoElement;e&&!e.paused&&e.pause(),this.dispatchEvent({type:"pause"})},resumeVideoProgress:function(){const e=this.videoElement;e.readyState>=4&&e.autoplay&&!this.isMobile()?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),this.setVideoCurrentTime({percentage:this.videoProgress})},resetVideo:function(){this.videoElement&&this.setVideoCurrentTime({percentage:0})},isVideoMuted:function(){return this.videoElement.muted},muteVideo:function(){const e=this.videoElement;e&&!e.muted&&(e.muted=!0),this.dispatchEvent({type:"volumechange"})},unmuteVideo:function(){const e=this.videoElement;e&&this.isVideoMuted()&&(e.muted=!1),this.dispatchEvent({type:"volumechange"})},getVideoElement:function(){return this.videoElement},dispose:function(){const{material:{map:e}}=this;this.pauseVideo(),this.removeEventListener("leave",this.pauseVideo.bind(this)),this.removeEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.removeEventListener("video-toggle",this.toggleVideo.bind(this)),this.removeEventListener("video-time",this.setVideoCurrentTime.bind(this)),e&&e.dispose(),oc.prototype.dispose.call(this)}}),Object.assign(dc.prototype,{constructor:dc,setProgress:function(e,t){this.onProgress&&this.onProgress({loaded:e,total:t})},adaptTextureToZoom:function(){const e=this.widths[this._zoom],t=this.heights[this._zoom],n=this.maxW,r=this.maxH;this._wc=Math.ceil(e/n),this._hc=Math.ceil(t/r);for(let i=0;i<this._hc;i++)for(let o=0;o<this._wc;o++){const a=document.createElement("canvas");o<this._wc-1?a.width=n:a.width=e-n*o,i<this._hc-1?a.height=r:a.height=t-r*i,this._canvas.push(a),this._ctx.push(a.getContext("2d"))}},composeFromTile:function(e,t,n){const r=this.maxW,i=this.maxH;e*=512,t*=512;const o=Math.floor(e/r),a=Math.floor(t/i);e-=o*r,t-=a*i,this._ctx[a*this._wc+o].drawImage(n,0,0,n.width,n.height,e,t,512,512),this.progress()},progress:function(){this._count++,this.setProgress(this._count,this._total),this._count===this._total&&(this.canvas=this._canvas,this.panoId=this._panoId,this.zoom=this._zoom,this.onPanoramaLoad&&this.onPanoramaLoad(this._canvas[0]))},composePanorama:function(){this.setProgress(0,1);const e=this.levelsW[this._zoom],t=this.levelsH[this._zoom],n=this;this._count=0,this._total=e*t;const{useWebGL:r}=this._parameters;for(let i=0;i<t;i++)for(let t=0;t<e;t++){const e="https://geo0.ggpht.com/cbk?cb_client=maps_sv.tactile&authuser=0&hl=en&output=tile&zoom="+this._zoom+"&x="+t+"&y="+i+"&panoid="+this._panoId+"&nbt&fover=2";!function(t,i){if(r){const r=$u.load(e,null,(function(){n.composeFromTile(t,i,r)}))}else{const r=new Image;r.addEventListener("load",(function(){n.composeFromTile(t,i,this)})),r.crossOrigin="",r.src=e}}(t,i)}},load:function(e){this.loadPano(e)},loadPano:function(e){const t=this;this._panoClient.getPanoramaById(e,(function(e,n){n===google.maps.StreetViewStatus.OK&&(t.result=e,t.copyright=e.copyright,t._panoId=e.location.pano,t.composePanorama())}))},setZoom:function(e){this._zoom=e,this.adaptTextureToZoom()}}),hc.prototype=Object.assign(Object.create(ac.prototype),{constructor:hc,load:function(e){this.loadRequested=!0,(e=e||this.panoId||{})&&this.gsvLoader&&this.loadGSVLoader(e)},setupGoogleMapAPI:function(e){const t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?",t.src+=e?"key="+e:"",t.onreadystatechange=this.setGSVLoader.bind(this),t.onload=this.setGSVLoader.bind(this),document.querySelector("head").appendChild(t)},setGSVLoader:function(){this.gsvLoader=new dc,this.loadRequested&&this.load()},getGSVLoader:function(){return this.gsvLoader},loadGSVLoader:function(e){this.loadRequested=!1,this.gsvLoader.onProgress=this.onProgress.bind(this),this.gsvLoader.onPanoramaLoad=this.onLoad.bind(this),this.gsvLoader.setZoom(this.getZoomLevel()),this.gsvLoader.load(e),this.gsvLoader.loaded=!0},onLoad:function(e){ac.prototype.onLoad.call(this,new Kt(e))},reset:function(){this.gsvLoader=void 0,ac.prototype.reset.call(this)}});const pc={uniforms:{tDiffuse:{value:new Kt},resolution:{value:1},transform:{value:new an},zoom:{value:1},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float resolution;","uniform mat4 transform;","uniform float zoom;","uniform float opacity;","varying vec2 vUv;","const float PI = 3.141592653589793;","void main(){","vec2 position = -1.0 +  2.0 * vUv;","position *= vec2( zoom * resolution, zoom * 0.5 );","float x2y2 = position.x * position.x + position.y * position.y;","vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );","sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );","vec2 sampleUV = vec2(","(atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,","(asin(sphere_pnt.z) / PI + 0.5)",");","gl_FragColor = texture2D( tDiffuse, sampleUV );","gl_FragColor.a *= opacity;","}"].join("\n")};function fc(e="image",t,n=1e4,r=.5){"image"===e&&ac.call(this,t,this.createGeometry(n,r),this.createMaterial(n)),this.size=n,this.ratio=r,this.EPS=1e-6,this.frameId=null,this.dragging=!1,this.userMouse=new Ct,this.quatA=new Mt,this.quatB=new Mt,this.quatCur=new Mt,this.quatSlerp=new Mt,this.vectorX=new Lt(1,0,0),this.vectorY=new Lt(0,1,0),this.addEventListener("window-resize",this.onWindowResize)}function mc(e,t,n){fc.call(this,"image",e,t,n)}function gc(e){const t=new Na(5e3,60,40),n=new yr({visible:!1});oc.call(this,t,n),this.media=new Qu(e),this.radius=5e3,this.addEventListener("enter",this.start.bind(this)),this.addEventListener("leave",this.stop.bind(this)),this.addEventListener("panolens-container",this.onPanolensContainer.bind(this)),this.addEventListener("panolens-scene",this.onPanolensScene.bind(this))}function yc(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.frameId=null,this.enabled=!0,this.target=new Lt,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=-.15,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.momentumDampingFactor=.9,this.momentumScalingFactor=-.005,this.momentumKeydownFactor=20,this.minFov=30,this.maxFov=120,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:l.LEFT,ZOOM:l.MIDDLE,PAN:l.RIGHT};var n,r,i,o,a,s=this,u=1e-7,c=1e-4,d=new Ct,h=new Ct,p=new Ct,f=new Ct,m=new Ct,g=new Ct,y=new Lt,v=new Lt,b=new Ct,_=new Ct,E=new Ct,w=0,T=0,A=0,S=0,x=1,I=new Lt,R=new Lt,C=new Mt,M=0,L=0,P=!1,D={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},O=D.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var N=(new Mt).setFromUnitVectors(e.up,new Lt(0,1,0)),k=N.clone().inverse(),F={type:"change"},B={type:"start"},U={type:"end"};function z(){return 2*Math.PI/60/60*s.autoRotateSpeed}function G(){return Math.pow(.95,s.zoomSpeed)}function V(e){if(P=!1,M=L=0,!1!==s.enabled){if(e.preventDefault(),e.button===s.mouseButtons.ORBIT){if(!0===s.noRotate)return;O=D.ROTATE,d.set(e.clientX,e.clientY)}else if(e.button===s.mouseButtons.ZOOM){if(!0===s.noZoom)return;O=D.DOLLY,b.set(e.clientX,e.clientY)}else if(e.button===s.mouseButtons.PAN){if(!0===s.noPan)return;O=D.PAN,f.set(e.clientX,e.clientY)}O!==D.NONE&&(document.addEventListener("mousemove",j,!1),document.addEventListener("mouseup",H,!1),s.dispatchEvent(B)),s.update()}}function j(e){if(!1!==s.enabled){e.preventDefault();var t=s.domElement===document?s.domElement.body:s.domElement;if(O===D.ROTATE){if(!0===s.noRotate)return;h.set(e.clientX,e.clientY),p.subVectors(h,d),s.rotateLeft(2*Math.PI*p.x/t.clientWidth*s.rotateSpeed),s.rotateUp(2*Math.PI*p.y/t.clientHeight*s.rotateSpeed),d.copy(h),n&&(M=e.clientX-n.clientX,L=e.clientY-n.clientY),n=e}else if(O===D.DOLLY){if(!0===s.noZoom)return;_.set(e.clientX,e.clientY),E.subVectors(_,b),E.y>0?s.dollyIn():E.y<0&&s.dollyOut(),b.copy(_)}else if(O===D.PAN){if(!0===s.noPan)return;m.set(e.clientX,e.clientY),g.subVectors(m,f),s.pan(g.x,g.y),f.copy(m)}O!==D.NONE&&s.update()}}function H(){P=!0,n=void 0,!1!==s.enabled&&(document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",H,!1),s.dispatchEvent(U),O=D.NONE)}function Z(e){if(!1!==s.enabled&&!0!==s.noZoom&&O===D.NONE){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?(s.object.fov=s.object.fov<s.maxFov?s.object.fov+1:s.maxFov,s.object.updateProjectionMatrix()):t<0&&(s.object.fov=s.object.fov>s.minFov?s.object.fov-1:s.minFov,s.object.updateProjectionMatrix()),s.update(),s.dispatchEvent(F),s.dispatchEvent(B),s.dispatchEvent(U)}}function q(e){switch(e.keyCode){case s.keys.UP:r=!1;break;case s.keys.BOTTOM:i=!1;break;case s.keys.LEFT:o=!1;break;case s.keys.RIGHT:a=!1}}function W(e){if(!1!==s.enabled&&!0!==s.noKeys&&!0!==s.noRotate){switch(e.keyCode){case s.keys.UP:r=!0;break;case s.keys.BOTTOM:i=!0;break;case s.keys.LEFT:o=!0;break;case s.keys.RIGHT:a=!0}(r||i||o||a)&&(P=!0,r&&(L=-s.rotateSpeed*s.momentumKeydownFactor),i&&(L=s.rotateSpeed*s.momentumKeydownFactor),o&&(M=-s.rotateSpeed*s.momentumKeydownFactor),a&&(M=s.rotateSpeed*s.momentumKeydownFactor))}}function Y(e){if(P=!1,M=L=0,!1!==s.enabled){switch(e.touches.length){case 1:if(!0===s.noRotate)return;O=D.TOUCH_ROTATE,d.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!0===s.noZoom)return;O=D.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);b.set(0,r);break;case 3:if(!0===s.noPan)return;O=D.TOUCH_PAN,f.set(e.touches[0].pageX,e.touches[0].pageY);break;default:O=D.NONE}O!==D.NONE&&s.dispatchEvent(B)}}function K(e){if(!1!==s.enabled){e.preventDefault(),e.stopPropagation();var t=s.domElement===document?s.domElement.body:s.domElement;switch(e.touches.length){case 1:if(!0===s.noRotate)return;if(O!==D.TOUCH_ROTATE)return;h.set(e.touches[0].pageX,e.touches[0].pageY),p.subVectors(h,d),s.rotateLeft(2*Math.PI*p.x/t.clientWidth*s.rotateSpeed),s.rotateUp(2*Math.PI*p.y/t.clientHeight*s.rotateSpeed),d.copy(h),n&&(M=e.touches[0].pageX-n.pageX,L=e.touches[0].pageY-n.pageY),n={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY},s.update();break;case 2:if(!0===s.noZoom)return;if(O!==D.TOUCH_DOLLY)return;var r=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(r*r+i*i);_.set(0,o),E.subVectors(_,b),E.y<0?(s.object.fov=s.object.fov<s.maxFov?s.object.fov+1:s.maxFov,s.object.updateProjectionMatrix()):E.y>0&&(s.object.fov=s.object.fov>s.minFov?s.object.fov-1:s.minFov,s.object.updateProjectionMatrix()),b.copy(_),s.update(),s.dispatchEvent(F);break;case 3:if(!0===s.noPan)return;if(O!==D.TOUCH_PAN)return;m.set(e.touches[0].pageX,e.touches[0].pageY),g.subVectors(m,f),s.pan(g.x,g.y),f.copy(m),s.update();break;default:O=D.NONE}}}function $(){P=!0,n=void 0,!1!==s.enabled&&(s.dispatchEvent(U),O=D.NONE)}this.setLastQuaternion=function(e){C.copy(e),s.object.quaternion.copy(e)},this.getLastPosition=function(){return R},this.rotateLeft=function(e){void 0===e&&(e=z()),S-=e},this.rotateUp=function(e){void 0===e&&(e=z()),A-=e},this.panLeft=function(e){var t=this.object.matrix.elements;y.set(t[0],t[1],t[2]),y.multiplyScalar(-e),I.add(y)},this.panUp=function(e){var t=this.object.matrix.elements;y.set(t[4],t[5],t[6]),y.multiplyScalar(e),I.add(y)},this.pan=function(e,t){var n=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof ro){var r=s.object.position.clone().sub(s.target).length();r*=Math.tan(s.object.fov/2*Math.PI/180),s.panLeft(2*e*r/n.clientHeight),s.panUp(2*t*r/n.clientHeight)}else s.object instanceof al?(s.panLeft(e*(s.object.right-s.object.left)/n.clientWidth),s.panUp(t*(s.object.top-s.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.momentum=function(){P&&(Math.abs(M)<c&&Math.abs(L)<c?P=!1:(L*=this.momentumDampingFactor,M*=this.momentumDampingFactor,S-=this.momentumScalingFactor*M,A-=this.momentumScalingFactor*L))},this.dollyIn=function(e){void 0===e&&(e=G()),s.object instanceof ro?x/=e:s.object instanceof al?(s.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*e)),s.object.updateProjectionMatrix(),s.dispatchEvent(F)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(e){void 0===e&&(e=G()),s.object instanceof ro?x*=e:s.object instanceof al?(s.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/e)),s.object.updateProjectionMatrix(),s.dispatchEvent(F)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(e){var t=this.object.position;v.copy(t).sub(this.target),v.applyQuaternion(N),w=Math.atan2(v.x,v.z),T=Math.atan2(Math.sqrt(v.x*v.x+v.z*v.z),v.y),this.autoRotate&&O===D.NONE&&this.rotateLeft(z()),this.momentum(),w+=S,T+=A,w=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,w)),T=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,T)),T=Math.max(u,Math.min(Math.PI-u,T));var n=v.length()*x;n=Math.max(this.minDistance,Math.min(this.maxDistance,n)),this.target.add(I),v.x=n*Math.sin(T)*Math.sin(w),v.y=n*Math.cos(T),v.z=n*Math.sin(T)*Math.cos(w),v.applyQuaternion(k),t.copy(this.target).add(v),this.object.lookAt(this.target),S=0,A=0,x=1,I.set(0,0,0),(R.distanceToSquared(this.object.position)>u||8*(1-C.dot(this.object.quaternion))>u)&&(!0!==e&&this.dispatchEvent(F),R.copy(this.object.position),C.copy(this.object.quaternion))},this.reset=function(){O=D.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(F),this.update()},this.getPolarAngle=function(){return T},this.getAzimuthalAngle=function(){return w},this.dispose=function(){this.domElement.removeEventListener("mousedown",V),this.domElement.removeEventListener("mousewheel",Z),this.domElement.removeEventListener("DOMMouseScroll",Z),this.domElement.removeEventListener("touchstart",Y),this.domElement.removeEventListener("touchend",$),this.domElement.removeEventListener("touchmove",K),window.removeEventListener("keyup",q),window.removeEventListener("keydown",W)},this.domElement.addEventListener("mousedown",V,{passive:!1}),this.domElement.addEventListener("mousewheel",Z,{passive:!1}),this.domElement.addEventListener("DOMMouseScroll",Z,{passive:!1}),this.domElement.addEventListener("touchstart",Y,{passive:!1}),this.domElement.addEventListener("touchend",$,{passive:!1}),this.domElement.addEventListener("touchmove",K,{passive:!1}),window.addEventListener("keyup",q,{passive:!1}),window.addEventListener("keydown",W,{passive:!1}),this.update()}function vc(e,t){var n=this,r={type:"change"},i=0,o=0,a=0,s=0;this.camera=e,this.camera.rotation.reorder("YXZ"),this.domElement=void 0!==t?t:document,this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var l=function(e){n.deviceOrientation=e},u=function(){n.screenOrientation=window.orientation||0},c=function(e){e.preventDefault(),e.stopPropagation(),a=e.touches[0].pageX,s=e.touches[0].pageY},d=function(e){e.preventDefault(),e.stopPropagation(),i+=Rt.degToRad((e.touches[0].pageX-a)/4),o+=Rt.degToRad((s-e.touches[0].pageY)/4),n.updateAlphaOffsetAngle(i),a=e.touches[0].pageX,s=e.touches[0].pageY};this.connect=function(){u(),window.addEventListener("orientationchange",u,{passive:!0}),window.addEventListener("deviceorientation",l,{passive:!0}),window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0}),n.domElement.addEventListener("touchstart",c,{passive:!1}),n.domElement.addEventListener("touchmove",d,{passive:!1}),n.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",u,!1),window.removeEventListener("deviceorientation",l,!1),window.removeEventListener("deviceorientation",this.update.bind(this),!1),n.domElement.removeEventListener("touchstart",c,!1),n.domElement.removeEventListener("touchmove",d,!1),n.enabled=!1},this.update=function(e){if(!1!==n.enabled){var t=n.deviceOrientation.alpha?Rt.degToRad(n.deviceOrientation.alpha)+n.alphaOffsetAngle:0,i=n.deviceOrientation.beta?Rt.degToRad(n.deviceOrientation.beta):0,a=n.deviceOrientation.gamma?Rt.degToRad(n.deviceOrientation.gamma):0,s=n.screenOrientation?Rt.degToRad(n.screenOrientation):0;!function(e,t,r,i,a){var s,l=new Lt(0,0,1),u=new En,c=new Mt,d=new Mt(-Math.sqrt(.5),0,0,Math.sqrt(.5)),h=new Mt,p=new Mt;0==n.screenOrientation?(s=new Lt(1,0,0),h.setFromAxisAngle(s,-o)):180==n.screenOrientation?(s=new Lt(1,0,0),h.setFromAxisAngle(s,o)):90==n.screenOrientation?(s=new Lt(0,1,0),h.setFromAxisAngle(s,o)):-90==n.screenOrientation&&(s=new Lt(0,1,0),h.setFromAxisAngle(s,-o)),d.multiply(h),d.multiply(p),u.set(r,t,-i,"YXZ"),e.setFromEuler(u),e.multiply(d),e.multiply(c.setFromAxisAngle(l,-a))}(n.camera.quaternion,t,i,a,s),n.alpha=t,!0!==e&&n.dispatchEvent(r)}},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},this.dispose=function(){this.disconnect()},this.connect()}function bc(e){var t=new al(-1,1,1,-1,0,1),n=new _o,r=new Fl;r.aspect=.5;var i=new Xt(512,512,{minFilter:ge,magFilter:pe,format:De});i.scissorTest=!0,i.texture.generateMipmaps=!1;var o=new Ct(.441,.156),a=new Xn(1,1,10,20).removeAttribute("normal").toNonIndexed(),s=a.attributes.position.array,l=a.attributes.uv.array;a.attributes.position.count*=2,a.attributes.uv.count*=2;var u=new Float32Array(2*s.length);u.set(s),u.set(s,s.length);var c=new Float32Array(2*l.length);c.set(l),c.set(l,l.length);for(var d=new Ct,h=s.length/3,p=0,f=u.length/3;p<f;p++){d.x=u[3*p+0],d.y=u[3*p+1];var m=d.dot(d),g=1.5+(o.x+o.y*m)*m,y=p<h?0:1;u[3*p+0]=d.x/g*1.5-.5+y,u[3*p+1]=d.y/g*3,c[2*p]=.5*(c[2*p]+y)}a.attributes.position.array=u,a.attributes.uv.array=c;var v=new vr(a,new yr({map:i.texture}));n.add(v),this.setSize=function(t,n){e.setSize(t,n);var r=e.getPixelRatio();i.setSize(t*r,n*r)},this.render=function(o,a){o.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),r.update(a);var s=i.width/2,l=i.height;e.autoClear&&e.clear(),i.scissor.set(0,0,s,l),i.viewport.set(0,0,s,l),e.setRenderTarget(i),e.render(o,r.cameraL),e.clearDepth(),i.scissor.set(s,0,s,l),i.viewport.set(s,0,s,l),e.setRenderTarget(i),e.render(o,r.cameraR),e.clearDepth(),e.setRenderTarget(null),e.render(n,t)}}fc.prototype=Object.assign(Object.create(ac.prototype),{constructor:fc,add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}e instanceof rc&&(e.material.depthTest=!1),ac.prototype.add.call(this,e)},createGeometry:function(e,t){return new Xn(e,e*t)},createMaterial:function(e){const t=Object.assign({},pc),n=t.uniforms;return n.zoom.value=e,n.opacity.value=0,new fr({uniforms:n,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,side:m,transparent:!0})},registerMouseEvents:function(){this.container.addEventListener("mousedown",this.onMouseDown.bind(this),{passive:!0}),this.container.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0}),this.container.addEventListener("mouseup",this.onMouseUp.bind(this),{passive:!0}),this.container.addEventListener("touchstart",this.onMouseDown.bind(this),{passive:!0}),this.container.addEventListener("touchmove",this.onMouseMove.bind(this),{passive:!0}),this.container.addEventListener("touchend",this.onMouseUp.bind(this),{passive:!0}),this.container.addEventListener("mousewheel",this.onMouseWheel.bind(this),{passive:!1}),this.container.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),{passive:!1}),this.container.addEventListener("contextmenu",this.onContextMenu.bind(this),{passive:!0})},unregisterMouseEvents:function(){this.container.removeEventListener("mousedown",this.onMouseDown.bind(this),!1),this.container.removeEventListener("mousemove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("mouseup",this.onMouseUp.bind(this),!1),this.container.removeEventListener("touchstart",this.onMouseDown.bind(this),!1),this.container.removeEventListener("touchmove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("touchend",this.onMouseUp.bind(this),!1),this.container.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("contextmenu",this.onContextMenu.bind(this),!1)},onMouseDown:function(e){switch(e.touches&&e.touches.length||1){case 1:const t=e.clientX>=0?e.clientX:e.touches[0].clientX,n=e.clientY>=0?e.clientY:e.touches[0].clientY;this.dragging=!0,this.userMouse.set(t,n);break;case 2:const r=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(r*r+i*i);this.userMouse.pinchDistance=o}this.onUpdateCallback()},onMouseMove:function(e){switch(e.touches&&e.touches.length||1){case 1:const t=e.clientX>=0?e.clientX:e.touches[0].clientX,n=e.clientY>=0?e.clientY:e.touches[0].clientY,r=.4*Rt.degToRad(t-this.userMouse.x),i=.4*Rt.degToRad(n-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,r),this.quatB.setFromAxisAngle(this.vectorX,i),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(t,n));break;case 2:const o=e.touches[0].pageX-e.touches[1].pageX,a=e.touches[0].pageY-e.touches[1].pageY,s=Math.sqrt(o*o+a*a);this.addZoomDelta(this.userMouse.pinchDistance-s)}},onMouseUp:function(){this.dragging=!1},onMouseWheel:function(e){e.preventDefault(),e.stopPropagation();let t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),this.addZoomDelta(t),this.onUpdateCallback()},addZoomDelta:function(e){const t=this.material.uniforms,n=.1*this.size,r=10*this.size;t.zoom.value+=e,t.zoom.value<=n?t.zoom.value=n:t.zoom.value>=r&&(t.zoom.value=r)},onUpdateCallback:function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this)),this.quatSlerp.slerp(this.quatCur,.1),this.material&&this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp),!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<this.EPS&&window.cancelAnimationFrame(this.frameId)},reset:function(){this.quatCur.set(0,0,0,1),this.quatSlerp.set(0,0,0,1),this.onUpdateCallback()},onLoad:function(e){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight,this.registerMouseEvents(),this.onUpdateCallback(),this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"}),ac.prototype.onLoad.call(this,e)},onLeave:function(){this.unregisterMouseEvents(),this.dispatchEvent({type:"panolens-viewer-handler",method:"enableControl",data:qu.ORBIT}),window.cancelAnimationFrame(this.frameId),ac.prototype.onLeave.call(this)},onWindowResize:function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight},onContextMenu:function(){this.dragging=!1},dispose:function(){this.unregisterMouseEvents(),ac.prototype.dispose.call(this)}}),mc.prototype=Object.assign(Object.create(fc.prototype),{constructor:mc,onLoad:function(e){this.updateTexture(e),fc.prototype.onLoad.call(this,e)},updateTexture:function(e){e.minFilter=e.magFilter=ge,this.material.uniforms.tDiffuse.value=e},dispose:function(){const e=this.material.uniforms.tDiffuse;e&&e.value&&e.value.dispose(),fc.prototype.dispose.call(this)}}),gc.prototype=Object.assign(Object.create(oc.prototype),{constructor:gc,onPanolensContainer:function({container:e}){this.media.setContainer(e)},onPanolensScene:function({scene:e}){this.media.setScene(e)},start:function(){return this.media.start()},stop:function(){this.media.stop()}}),yc.prototype=Object.assign(Object.create(r.prototype),{constructor:yc}),vc.prototype=Object.assign(Object.create(r.prototype),{constructor:vc});const _c=function(e){var t=new Fl;t.aspect=.5;var n=new Ct;this.setEyeSeparation=function(e){t.eyeSep=e},this.setSize=function(t,n){e.setSize(t,n)},this.render=function(r,i){r.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld(),t.update(i),e.getSize(n),e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,n.width/2,n.height),e.setViewport(0,0,n.width/2,n.height),e.render(r,t.cameraL),e.setScissor(n.width/2,0,n.width/2,n.height),e.setViewport(n.width/2,0,n.width/2,n.height),e.render(r,t.cameraR),e.setScissorTest(!1)}};function Ec(e){let t;(e=e||{}).controlBar=void 0===e.controlBar||e.controlBar,e.controlButtons=e.controlButtons||["fullscreen","setting","video"],e.autoHideControlBar=void 0!==e.autoHideControlBar&&e.autoHideControlBar,e.autoHideInfospot=void 0===e.autoHideInfospot||e.autoHideInfospot,e.horizontalView=void 0!==e.horizontalView&&e.horizontalView,e.clickTolerance=e.clickTolerance||10,e.cameraFov=e.cameraFov||60,e.reverseDragging=e.reverseDragging||!1,e.enableReticle=e.enableReticle||!1,e.dwellTime=e.dwellTime||1500,e.autoReticleSelect=void 0===e.autoReticleSelect||e.autoReticleSelect,e.viewIndicator=void 0!==e.viewIndicator&&e.viewIndicator,e.indicatorSize=e.indicatorSize||30,e.output=e.output?e.output:"none",e.autoRotate=e.autoRotate||!1,e.autoRotateSpeed=e.autoRotateSpeed||2,e.autoRotateActivationDuration=e.autoRotateActivationDuration||5e3,this.options=e,e.container?(t=e.container,t._width=t.clientWidth,t._height=t.clientHeight):(t=document.createElement("div"),t.classList.add("panolens-container"),t.style.width="100%",t.style.height="100%",t._width=window.innerWidth,t._height=window.innerHeight,document.body.appendChild(t)),this.container=t,this.camera=e.camera||new ro(this.options.cameraFov,this.container.clientWidth/this.container.clientHeight,1,1e4),this.scene=e.scene||new _o,this.renderer=e.renderer||new yo({alpha:!0,antialias:!1}),this.sceneReticle=new _o,this.viewIndicatorSize=this.options.indicatorSize,this.reticle={},this.tempEnableReticle=this.options.enableReticle,this.mode=Wu.NORMAL,this.panorama=null,this.widget=null,this.hoverObject=null,this.infospot=null,this.pressEntityObject=null,this.pressObject=null,this.raycaster=new fu,this.raycasterPoint=new Ct,this.userMouse=new Ct,this.updateCallbacks=[],this.requestAnimationId=null,this.cameraFrustum=new on,this.cameraViewProjectionMatrix=new an,this.autoRotateRequestId=null,this.outputDivElement=null,this.touchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,this.HANDLER_MOUSE_DOWN=this.onMouseDown.bind(this),this.HANDLER_MOUSE_UP=this.onMouseUp.bind(this),this.HANDLER_MOUSE_MOVE=this.onMouseMove.bind(this),this.HANDLER_WINDOW_RESIZE=this.onWindowResize.bind(this),this.HANDLER_KEY_DOWN=this.onKeyDown.bind(this),this.HANDLER_KEY_UP=this.onKeyUp.bind(this),this.HANDLER_TAP=this.onTap.bind(this,{clientX:this.container.clientWidth/2,clientY:this.container.clientHeight/2}),this.OUTPUT_INFOSPOT=!1,this.tweenLeftAnimation=new nc.Tween,this.tweenUpAnimation=new nc.Tween,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setClearColor(0,0),this.renderer.autoClear=!1,this.renderer.domElement.classList.add("panolens-canvas"),this.renderer.domElement.style.display="block",this.container.style.backgroundColor="#000",this.container.appendChild(this.renderer.domElement),this.OrbitControls=new yc(this.camera,this.container),this.OrbitControls.id="orbit",this.OrbitControls.minDistance=1,this.OrbitControls.noPan=!0,this.OrbitControls.autoRotate=this.options.autoRotate,this.OrbitControls.autoRotateSpeed=this.options.autoRotateSpeed,this.DeviceOrientationControls=new vc(this.camera,this.container),this.DeviceOrientationControls.id="device-orientation",this.DeviceOrientationControls.enabled=!1,this.camera.position.z=1,this.options.passiveRendering&&console.warn("passiveRendering is now deprecated"),this.controls=[this.OrbitControls,this.DeviceOrientationControls],this.control=this.OrbitControls,this.CardboardEffect=new bc(this.renderer),this.CardboardEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.StereoEffect=new _c(this.renderer),this.StereoEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.effect=this.CardboardEffect,this.addReticle(),this.options.horizontalView&&(this.OrbitControls.minPolarAngle=Math.PI/2,this.OrbitControls.maxPolarAngle=Math.PI/2),!1!==this.options.controlBar&&this.addDefaultControlBar(this.options.controlButtons),this.options.viewIndicator&&this.addViewIndicator(),this.options.reverseDragging&&this.reverseDraggingDirection(),this.options.enableReticle?this.enableReticleControl():this.registerMouseAndTouchEvents(),"overlay"===this.options.output&&this.addOutputElement(),this.registerEventListeners(),this.animate.call(this)}Ec.prototype=Object.assign(Object.create(r.prototype),{constructor:Ec,add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}this.scene.add(e),e.addEventListener&&e.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),e instanceof oc&&e.dispatchEvent&&e.dispatchEvent({type:"panolens-container",container:this.container}),e instanceof gc&&e.dispatchEvent({type:"panolens-scene",scene:this.scene}),"panorama"===e.type&&(this.addPanoramaEventListener(e),this.panorama||this.setPanorama(e))},remove:function(e){e.removeEventListener&&e.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.scene.remove(e)},addDefaultControlBar:function(e){if(this.widget)return void console.warn("Default control bar exists");const t=new ic(this.container);t.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),t.addControlBar(),e.forEach((e=>{t.addControlButton(e)})),this.widget=t},setPanorama:function(e){const t=this.panorama;if("panorama"===e.type&&t!==e){this.hideInfospot();const n=function(){t&&t.onLeave(),e.removeEventListener("enter-fade-start",n)};e.addEventListener("enter-fade-start",n),(this.panorama=e).onEnter()}},eventHandler:function(e){e.method&&this[e.method]&&this[e.method](e.data)},dispatchEventToChildren:function(e){this.scene.traverse((function(t){t.dispatchEvent&&t.dispatchEvent(e)}))},activateWidgetItem:function(e,t){const n=this.widget.mainMenu,r=n.children[0],i=n.children[1];let o;if(void 0!==e){switch(e){case 0:default:o=r.subMenu.children[1];break;case 1:o=r.subMenu.children[2]}r.subMenu.setActiveItem(o),r.setSelectionTitle(o.textContent)}if(void 0!==t){switch(t){case Wu.CARDBOARD:o=i.subMenu.children[2];break;case Wu.STEREO:o=i.subMenu.children[3];break;default:o=i.subMenu.children[1]}i.subMenu.setActiveItem(o),i.setSelectionTitle(o.textContent)}},enableEffect:function(e){if(this.mode===e)return;if(e===Wu.NORMAL)return void this.disableEffect();this.mode=e;const t=this.camera.fov;switch(e){case Wu.CARDBOARD:this.effect=this.CardboardEffect,this.enableReticleControl();break;case Wu.STEREO:this.effect=this.StereoEffect,this.enableReticleControl();break;default:this.effect=null,this.disableReticleControl()}this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.camera.fov=t+.01,this.effect.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.camera.fov=t,this.dispatchEvent({type:"mode-change",mode:this.mode})},disableEffect:function(){this.mode!==Wu.NORMAL&&(this.mode=Wu.NORMAL,this.disableReticleControl(),this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.dispatchEvent({type:"mode-change",mode:this.mode}))},enableReticleControl:function(){this.reticle.visible||(this.tempEnableReticle=!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())},disableReticleControl:function(){this.tempEnableReticle=!1,this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())},enableAutoRate:function(){this.options.autoRotate=!0,this.OrbitControls.autoRotate=!0},disableAutoRate:function(){clearTimeout(this.autoRotateRequestId),this.options.autoRotate=!1,this.OrbitControls.autoRotate=!1},toggleVideoPlay:function(e){this.panorama instanceof cc&&this.panorama.dispatchEvent({type:"video-toggle",pause:e})},setVideoCurrentTime:function(e){this.panorama instanceof cc&&this.panorama.dispatchEvent({type:"video-time",percentage:e})},onVideoUpdate:function(e){const{widget:t}=this;t&&t.dispatchEvent({type:"video-update",percentage:e})},addUpdateCallback:function(e){e&&this.updateCallbacks.push(e)},removeUpdateCallback:function(e){const t=this.updateCallbacks.indexOf(e);e&&t>=0&&this.updateCallbacks.splice(t,1)},showVideoWidget:function(){const{widget:e}=this;e&&e.dispatchEvent({type:"video-control-show"})},hideVideoWidget:function(){const{widget:e}=this;e&&e.dispatchEvent({type:"video-control-hide"})},updateVideoPlayButton:function(e){const{widget:t}=this;t&&t.videoElement&&t.videoElement.controlButton&&t.videoElement.controlButton.update(e)},addPanoramaEventListener:function(e){e.addEventListener("enter-fade-start",this.setCameraControl.bind(this)),e instanceof cc&&(e.addEventListener("enter-fade-start",this.showVideoWidget.bind(this)),e.addEventListener("leave",function(){this.panorama instanceof cc||this.hideVideoWidget.call(this)}.bind(this)))},setCameraControl:function(){this.OrbitControls.target.copy(this.panorama.position)},getControl:function(){return this.control},getScene:function(){return this.scene},getCamera:function(){return this.camera},getRenderer:function(){return this.renderer},getContainer:function(){return this.container},getControlId:function(){return this.control.id},getNextControlId:function(){return this.controls[this.getNextControlIndex()].id},getNextControlIndex:function(){const e=this.controls,t=this.control,n=e.indexOf(t)+1;return n>=e.length?0:n},setCameraFov:function(e){this.camera.fov=e,this.camera.updateProjectionMatrix()},enableControl:function(e){switch(e=e>=0&&e<this.controls.length?e:0,this.control.enabled=!1,this.control=this.controls[e],this.control.enabled=!0,e){case qu.ORBIT:this.camera.position.copy(this.panorama.position),this.camera.position.z+=1;break;case qu.DEVICEORIENTATION:this.camera.position.copy(this.panorama.position)}this.control.update(),this.activateWidgetItem(e,void 0)},disableControl:function(){this.control.enabled=!1},toggleNextControl:function(){this.enableControl(this.getNextControlIndex())},getScreenVector:function(e){const t=e.clone(),n=this.container.clientWidth/2,r=this.container.clientHeight/2;return t.project(this.camera),t.x=t.x*n+n,t.y=-t.y*r+r,t.z=0,t},checkSpriteInViewport:function(e){return this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld),this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix),e.visible&&this.cameraFrustum.intersectsSprite(e)},reverseDraggingDirection:function(){this.OrbitControls.rotateSpeed*=-1,this.OrbitControls.momentumScalingFactor*=-1},addReticle:function(){this.reticle=new Ju(16777215,!0,this.options.dwellTime),this.reticle.hide(),this.camera.add(this.reticle),this.sceneReticle.add(this.camera)},tweenControlCenter:function(e,t,n){if(this.control!==this.OrbitControls)return;let r,i,o,a,s,l,u,c,d,h;e instanceof Array&&(t=e[1],n=e[2],e=e[0]),t=void 0!==t?t:1e3,n=n||nc.Easing.Exponential.Out,r=this,a=this.camera.getWorldDirection(new Lt),s=a.clone(),c=this.panorama.getWorldPosition(new Lt).sub(this.camera.getWorldPosition(new Lt)),l=e.clone(),l.x*=-1,l.add(c).normalize(),u=l.clone(),a.y=0,l.y=0,i=Math.atan2(l.z,l.x)-Math.atan2(a.z,a.x),i=i>Math.PI?i-2*Math.PI:i,i=i<-Math.PI?i+2*Math.PI:i,o=Math.abs(s.angleTo(a)+(s.y*u.y<=0?u.angleTo(l):-u.angleTo(l))),o*=u.y<s.y?1:-1,d={left:0,up:0},h={left:0,up:0},this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.tweenLeftAnimation=new nc.Tween(d).to({left:i},t).easing(n).onUpdate((function(e){r.control.rotateLeft(e.left-h.left),h.left=e.left})).start(),this.tweenUpAnimation=new nc.Tween(d).to({up:o},t).easing(n).onUpdate((function(e){r.control.rotateUp(e.up-h.up),h.up=e.up})).start()},tweenControlCenterByObject:function(e,t,n){let r=!1;if(e.traverseAncestors((function(e){e.scalePlaceHolder&&(r=!0)})),r){const r=new Lt(-1,1,1);this.tweenControlCenter(e.getWorldPosition(new Lt).multiply(r),t,n)}else this.tweenControlCenter(e.getWorldPosition(new Lt),t,n)},onWindowResize:function(e,t){let n,r;const i=this.container.classList.contains("panolens-container")||this.container.isFullscreen;if(void 0!==e&&void 0!==t)n=e,r=t,this.container._width=e,this.container._height=t;else{const e=/(android)/i.test(window.navigator.userAgent),t=e?Math.min(document.documentElement.clientWidth,window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),o=e?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0);n=i?t:this.container.clientWidth,r=i?o:this.container.clientHeight,this.container._width=n,this.container._height=r}this.camera.aspect=n/r,this.camera.updateProjectionMatrix(),this.renderer.setSize(n,r),(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent(),this.dispatchEvent({type:"window-resize",width:n,height:r}),this.scene.traverse((function(e){e.dispatchEvent&&e.dispatchEvent({type:"window-resize",width:n,height:r})}))},addOutputElement:function(){const e=document.createElement("div");e.style.position="absolute",e.style.right="10px",e.style.top="10px",e.style.color="#fff",this.container.appendChild(e),this.outputDivElement=e},outputPosition:function(){const e=this.raycaster.intersectObject(this.panorama,!0);if(e.length>0){const t=e[0].point.clone(),n=new Lt(-1,1,1),r=this.panorama.getWorldPosition(new Lt);t.sub(r).multiply(n);const i={x:t.x.toFixed(2),y:t.y.toFixed(2),z:t.z.toFixed(2)},o=`${i.x}, ${i.y}, ${i.z}`;if(0===t.length())return;switch(this.options.output){case"event":this.dispatchEvent({type:"position-output",position:i});break;case"console":console.info(o);break;case"overlay":this.outputDivElement.textContent=o}}},onMouseDown:function(e){e.preventDefault(),this.userMouse.x=e.clientX>=0?e.clientX:e.touches[0].clientX,this.userMouse.y=e.clientY>=0?e.clientY:e.touches[0].clientY,this.userMouse.type="mousedown",this.onTap(e)},onMouseMove:function(e){e.preventDefault(),this.userMouse.type="mousemove",this.onTap(e)},onMouseUp:function(e){let t=!1;this.userMouse.type="mouseup";const n=this.userMouse.x>=e.clientX-this.options.clickTolerance&&this.userMouse.x<=e.clientX+this.options.clickTolerance&&this.userMouse.y>=e.clientY-this.options.clickTolerance&&this.userMouse.y<=e.clientY+this.options.clickTolerance||e.changedTouches&&this.userMouse.x>=e.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=e.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=e.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=e.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0;if((!e||!e.target||e.target.classList.contains("panolens-canvas"))&&(e.preventDefault(),t=e.changedTouches&&1===e.changedTouches.length?this.onTap({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY},n):this.onTap(e,n),this.userMouse.type="none",!t&&"click"===n)){const{options:{autoHideInfospot:e,autoHideControlBar:t},panorama:n,toggleControlBar:r}=this;e&&n&&n.toggleInfospotVisibility(),t&&r()}},onTap:function(e,t){const{left:n,top:r}=this.container.getBoundingClientRect(),{clientWidth:i,clientHeight:o}=this.container;if(this.raycasterPoint.x=(e.clientX-n)/i*2-1,this.raycasterPoint.y=-(e.clientY-r)/o*2+1,this.raycaster.setFromCamera(this.raycasterPoint,this.camera),!this.panorama)return;("mousedown"!==e.type&&this.touchSupported||this.OUTPUT_INFOSPOT)&&this.outputPosition();const a=this.raycaster.intersectObjects(this.panorama.children,!0),s=this.getConvertedIntersect(a),l=a.length>0?a[0].object:void 0;if("mouseup"===this.userMouse.type&&(s&&this.pressEntityObject===s&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:e}),this.pressEntityObject=void 0),"mouseup"===this.userMouse.type&&(l&&this.pressObject===l&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:e}),this.pressObject=void 0),"click"===t?(this.panorama.dispatchEvent({type:"click",intersects:a,mouseEvent:e}),s&&s.dispatchEvent&&s.dispatchEvent({type:"click-entity",mouseEvent:e}),l&&l.dispatchEvent&&l.dispatchEvent({type:"click",mouseEvent:e})):(this.panorama.dispatchEvent({type:"hover",intersects:a,mouseEvent:e}),(this.hoverObject&&a.length>0&&this.hoverObject!==s||this.hoverObject&&0===a.length)&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:e}),this.reticle.end()),this.hoverObject=void 0),s&&a.length>0&&(this.hoverObject!==s&&(this.hoverObject=s,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:e}),(this.options.autoReticleSelect&&this.options.enableReticle||this.tempEnableReticle)&&this.reticle.start(this.onTap.bind(this,e,"click")))),"mousedown"===this.userMouse.type&&this.pressEntityObject!=s&&(this.pressEntityObject=s,this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstart-entity",mouseEvent:e})),"mousedown"===this.userMouse.type&&this.pressObject!=l&&(this.pressObject=l,this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstart",mouseEvent:e})),("mousemove"===this.userMouse.type||this.options.enableReticle)&&(l&&l.dispatchEvent&&l.dispatchEvent({type:"hover",mouseEvent:e}),this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressmove-entity",mouseEvent:e}),this.pressObject&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressmove",mouseEvent:e}))),!s&&this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&(this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:e}),this.pressEntityObject=void 0),!l&&this.pressObject&&this.pressObject.dispatchEvent&&(this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:e}),this.pressObject=void 0)),l&&l instanceof rc){if(this.infospot=l,"click"===t)return!0}else this.infospot&&this.hideInfospot();this.options.autoRotate&&"mousemove"!==this.userMouse.type&&(clearTimeout(this.autoRotateRequestId),this.control===this.OrbitControls&&(this.OrbitControls.autoRotate=!1,this.autoRotateRequestId=window.setTimeout(this.enableAutoRate.bind(this),this.options.autoRotateActivationDuration)))},getConvertedIntersect:function(e){let t;for(let n=0;n<e.length;n++)if(e[n].distance>=0&&e[n].object&&!e[n].object.passThrough){if(e[n].object.entity&&e[n].object.entity.passThrough)continue;if(e[n].object.entity&&!e[n].object.entity.passThrough){t=e[n].object.entity;break}t=e[n].object;break}return t},hideInfospot:function(){this.infospot&&(this.infospot.onHoverEnd(),this.infospot=void 0)},toggleControlBar:function(){const{widget:e}=this;e&&e.dispatchEvent({type:"control-bar-toggle"})},onKeyDown:function(e){this.options.output&&"none"!==this.options.output&&"Control"===e.key&&(this.OUTPUT_INFOSPOT=!0)},onKeyUp:function(){this.OUTPUT_INFOSPOT=!1},update:function(){nc.update(),this.updateCallbacks.forEach((function(e){e()})),this.control.update(),this.scene.traverse(function(e){if(e instanceof rc&&e.element&&(this.hoverObject===e||"none"!==e.element.style.display||e.element.left&&"none"!==e.element.left.style.display||e.element.right&&"none"!==e.element.right.style.display))if(this.checkSpriteInViewport(e)){const{x:t,y:n}=this.getScreenVector(e.getWorldPosition(new Lt));e.translateElement(t,n)}else e.onDismiss()}.bind(this))},render:function(){this.mode===Wu.CARDBOARD||this.mode===Wu.STEREO?(this.renderer.clear(),this.effect.render(this.scene,this.camera),this.effect.render(this.sceneReticle,this.camera)):(this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.renderer.render(this.sceneReticle,this.camera))},animate:function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this)),this.onChange()},onChange:function(){this.update(),this.render()},registerMouseAndTouchEvents:function(){const e={passive:!1};this.container.addEventListener("mousedown",this.HANDLER_MOUSE_DOWN,e),this.container.addEventListener("mousemove",this.HANDLER_MOUSE_MOVE,e),this.container.addEventListener("mouseup",this.HANDLER_MOUSE_UP,e),this.container.addEventListener("touchstart",this.HANDLER_MOUSE_DOWN,e),this.container.addEventListener("touchend",this.HANDLER_MOUSE_UP,e)},unregisterMouseAndTouchEvents:function(){this.container.removeEventListener("mousedown",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("mousemove",this.HANDLER_MOUSE_MOVE,!1),this.container.removeEventListener("mouseup",this.HANDLER_MOUSE_UP,!1),this.container.removeEventListener("touchstart",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("touchend",this.HANDLER_MOUSE_UP,!1)},registerReticleEvent:function(){this.addUpdateCallback(this.HANDLER_TAP)},unregisterReticleEvent:function(){this.removeUpdateCallback(this.HANDLER_TAP)},updateReticleEvent:function(){const e=this.container.clientWidth/2+this.container.offsetLeft,t=this.container.clientHeight/2;this.removeUpdateCallback(this.HANDLER_TAP),this.HANDLER_TAP=this.onTap.bind(this,{clientX:e,clientY:t}),this.addUpdateCallback(this.HANDLER_TAP)},registerEventListeners:function(){window.addEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.addEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.addEventListener("keyup",this.HANDLER_KEY_UP,!0)},unregisterEventListeners:function(){window.removeEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.removeEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.removeEventListener("keyup",this.HANDLER_KEY_UP,!0)},dispose:function(){this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.unregisterEventListeners(),function e(t){for(let n=t.children.length-1;n>=0;n--)e(t.children[n]),t.remove(t.children[n]);t instanceof oc||t instanceof rc?(t.dispose(),t=null):t.dispatchEvent&&t.dispatchEvent("dispose")}(this.scene),this.widget&&(this.widget.dispose(),this.widget=null),Ts&&Ts.enabled&&Ts.clear()},destroy:function(){this.dispose(),this.render(),window.cancelAnimationFrame(this.requestAnimationId)},onPanoramaDispose:function(e){e instanceof cc&&this.hideVideoWidget(),e===this.panorama&&(this.panorama=null)},loadAsyncRequest:function(e,t=(()=>{})){const n=new window.XMLHttpRequest;n.onloadend=function(e){t(e)},n.open("GET",e,!0),n.send(null)},addViewIndicator:function(){const e=this;this.loadAsyncRequest(Yu.ViewIndicator,(function(t){if(0===t.loaded)return;const n=t.target.responseXML.documentElement;n.style.width=e.viewIndicatorSize+"px",n.style.height=e.viewIndicatorSize+"px",n.style.position="absolute",n.style.top="10px",n.style.left="10px",n.style.opacity="0.5",n.style.cursor="pointer",n.id="panolens-view-indicator-container",e.container.appendChild(n);const r=n.querySelector("#indicator");e.addUpdateCallback((function(){e.radius=.225*e.viewIndicatorSize,e.currentPanoAngle=e.camera.rotation.y-Rt.degToRad(90),e.fovAngle=Rt.degToRad(e.camera.fov),e.leftAngle=-e.currentPanoAngle-e.fovAngle/2,e.rightAngle=-e.currentPanoAngle+e.fovAngle/2,e.leftX=e.radius*Math.cos(e.leftAngle),e.leftY=e.radius*Math.sin(e.leftAngle),e.rightX=e.radius*Math.cos(e.rightAngle),e.rightY=e.radius*Math.sin(e.rightAngle),e.indicatorD="M "+e.leftX+" "+e.leftY+" A "+e.radius+" "+e.radius+" 0 0 1 "+e.rightX+" "+e.rightY,e.leftX&&e.leftY&&e.rightX&&e.rightY&&e.radius&&r.setAttribute("d",e.indicatorD)})),n.addEventListener("mouseenter",(function(){this.style.opacity="1"})),n.addEventListener("mouseleave",(function(){this.style.opacity="0.5"}))}))},appendControlItem:function(e){const t=this.widget.createCustomItem(e);return"video"===e.group?this.widget.videoElement.appendChild(t):this.widget.barElement.appendChild(t),t},clearAllCache:function(){Ts.clear()}}),s!=Hu&&console.warn(`three.js version is not matched. Please consider use the target revision ${Hu}`),window.TWEEN=nc},6400:(e,t,n)=>{"use strict";n.d(t,{HY:()=>b,Tm:()=>G,Vf:()=>v,YM:()=>i,bR:()=>I,h:()=>g,sY:()=>z,wA:()=>_});var r,i,o,a,s,l,u,c={},d=[],h=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,p=Array.isArray;function f(e,t){for(var n in t)e[n]=t[n];return e}function m(e){var t=e.parentNode;t&&t.removeChild(e)}function g(e,t,n){var i,o,a,s={};for(a in t)"key"==a?i=t[a]:"ref"==a?o=t[a]:s[a]=t[a];if(arguments.length>2&&(s.children=arguments.length>3?r.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===s[a]&&(s[a]=e.defaultProps[a]);return y(e,s,i,o,null)}function y(e,t,n,r,a){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==a?++o:a};return null==a&&null!=i.vnode&&i.vnode(s),s}function v(){return{current:null}}function b(e){return e.children}function _(e,t){this.props=e,this.context=t}function E(e,t){if(null==t)return e.__?E(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?E(e):null}function w(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return w(e)}}function T(e){(!e.__d&&(e.__d=!0)&&a.push(e)&&!A.__r++||s!==i.debounceRendering)&&((s=i.debounceRendering)||l)(A)}function A(){var e,t,n,r,i,o,s,l,c;for(a.sort(u);e=a.shift();)e.__d&&(t=a.length,r=void 0,i=void 0,o=void 0,l=(s=(n=e).__v).__e,(c=n.__P)&&(r=[],i=[],(o=f({},s)).__v=s.__v+1,O(c,s,o,n.__n,void 0!==c.ownerSVGElement,null!=s.__h?[l]:null,r,null==l?E(s):l,s.__h,i),N(r,s,i),s.__e!=l&&w(s)),a.length>t&&a.sort(u));A.__r=0}function S(e,t,n,r,i,o,a,s,l,u,h){var f,m,g,v,_,w,T,A,S,I=0,M=r&&r.__k||d,L=M.length,P=L,D=t.length;for(n.__k=[],f=0;f<D;f++)null!=(v=n.__k[f]=null==(v=t[f])||"boolean"==typeof v||"function"==typeof v?null:"string"==typeof v||"number"==typeof v||"bigint"==typeof v?y(null,v,null,null,v):p(v)?y(b,{children:v},null,null,null):v.__b>0?y(v.type,v.props,v.key,v.ref?v.ref:null,v.__v):v)?(v.__=n,v.__b=n.__b+1,-1===(A=C(v,M,T=f+I,P))?g=c:(g=M[A]||c,M[A]=void 0,P--),O(e,v,g,i,o,a,s,l,u,h),_=v.__e,(m=v.ref)&&g.ref!=m&&(g.ref&&F(g.ref,null,v),h.push(m,v.__c||_,v)),null!=_&&(null==w&&(w=_),(S=g===c||null===g.__v)?-1==A&&I--:A!==T&&(A===T+1?I++:A>T?P>D-T?I+=A-T:I--:I=A<T&&A==T-1?A-T:0),T=f+I,"function"!=typeof v.type||A===T&&g.__k!==v.__k?"function"==typeof v.type||A===T&&!S?void 0!==v.__d?(l=v.__d,v.__d=void 0):l=_.nextSibling:l=R(e,_,l):l=x(v,l,e),"function"==typeof n.type&&(n.__d=l))):(g=M[f])&&null==g.key&&g.__e&&(g.__e==l&&(l=E(g)),B(g,g,!1),M[f]=null);for(n.__e=w,f=L;f--;)null!=M[f]&&("function"==typeof n.type&&null!=M[f].__e&&M[f].__e==n.__d&&(n.__d=M[f].__e.nextSibling),B(M[f],M[f]))}function x(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t="function"==typeof r.type?x(r,t,n):R(n,r.__e,t));return t}function I(e,t){return t=t||[],null==e||"boolean"==typeof e||(p(e)?e.some((function(e){I(e,t)})):t.push(e)),t}function R(e,t,n){return null==n||n.parentNode!==e?e.insertBefore(t,null):t==n&&null!=t.parentNode||e.insertBefore(t,n),t.nextSibling}function C(e,t,n,r){var i=e.key,o=e.type,a=n-1,s=n+1,l=t[n];if(null===l||l&&i==l.key&&o===l.type)return n;if(r>(null!=l?1:0))for(;a>=0||s<t.length;){if(a>=0){if((l=t[a])&&i==l.key&&o===l.type)return a;a--}if(s<t.length){if((l=t[s])&&i==l.key&&o===l.type)return s;s++}}return-1}function M(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||h.test(t)?n:n+"px"}function L(e,t,n,r,i){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||M(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||M(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/(PointerCapture)$|Capture$/,"$1")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?D:P,o):e.removeEventListener(t,o?D:P,o);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&"rowSpan"!==t&&"colSpan"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function P(e){return this.l[e.type+!1](i.event?i.event(e):e)}function D(e){return this.l[e.type+!0](i.event?i.event(e):e)}function O(e,t,n,r,o,a,s,l,u,c){var d,h,m,g,y,v,E,w,T,A,x,I,R,C,M,L=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(u=n.__h,l=t.__e=n.__e,t.__h=null,a=[l]),(d=i.__b)&&d(t);e:if("function"==typeof L)try{if(w=t.props,T=(d=L.contextType)&&r[d.__c],A=d?T?T.props.value:d.__:r,n.__c?E=(h=t.__c=n.__c).__=h.__E:("prototype"in L&&L.prototype.render?t.__c=h=new L(w,A):(t.__c=h=new _(w,A),h.constructor=L,h.render=U),T&&T.sub(h),h.props=w,h.state||(h.state={}),h.context=A,h.__n=r,m=h.__d=!0,h.__h=[],h._sb=[]),null==h.__s&&(h.__s=h.state),null!=L.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=f({},h.__s)),f(h.__s,L.getDerivedStateFromProps(w,h.__s))),g=h.props,y=h.state,h.__v=t,m)null==L.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==L.getDerivedStateFromProps&&w!==g&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(w,A),!h.__e&&(null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(w,h.__s,A)||t.__v===n.__v)){for(t.__v!==n.__v&&(h.props=w,h.state=h.__s,h.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),x=0;x<h._sb.length;x++)h.__h.push(h._sb[x]);h._sb=[],h.__h.length&&s.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(w,h.__s,A),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(g,y,v)}))}if(h.context=A,h.props=w,h.__P=e,h.__e=!1,I=i.__r,R=0,"prototype"in L&&L.prototype.render){for(h.state=h.__s,h.__d=!1,I&&I(t),d=h.render(h.props,h.state,h.context),C=0;C<h._sb.length;C++)h.__h.push(h._sb[C]);h._sb=[]}else do{h.__d=!1,I&&I(t),d=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++R<25);h.state=h.__s,null!=h.getChildContext&&(r=f(f({},r),h.getChildContext())),m||null==h.getSnapshotBeforeUpdate||(v=h.getSnapshotBeforeUpdate(g,y)),S(e,p(M=null!=d&&d.type===b&&null==d.key?d.props.children:d)?M:[M],t,n,r,o,a,s,l,u,c),h.base=t.__e,t.__h=null,h.__h.length&&s.push(h),E&&(h.__E=h.__=null)}catch(e){t.__v=null,(u||null!=a)&&(t.__e=l,t.__h=!!u,a[a.indexOf(l)]=null),i.__e(e,t,n)}else null==a&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=k(n.__e,t,n,r,o,a,s,u,c);(d=i.diffed)&&d(t)}function N(e,t,n){for(var r=0;r<n.length;r++)F(n[r],n[++r],n[++r]);i.__c&&i.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){i.__e(e,t.__v)}}))}function k(e,t,n,i,o,a,s,l,u){var d,h,f,g=n.props,y=t.props,v=t.type,b=0;if("svg"===v&&(o=!0),null!=a)for(;b<a.length;b++)if((d=a[b])&&"setAttribute"in d==!!v&&(v?d.localName===v:3===d.nodeType)){e=d,a[b]=null;break}if(null==e){if(null===v)return document.createTextNode(y);e=o?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,y.is&&y),a=null,l=!1}if(null===v)g===y||l&&e.data===y||(e.data=y);else{if(a=a&&r.call(e.childNodes),h=(g=n.props||c).dangerouslySetInnerHTML,f=y.dangerouslySetInnerHTML,!l){if(null!=a)for(g={},b=0;b<e.attributes.length;b++)g[e.attributes[b].name]=e.attributes[b].value;(f||h)&&(f&&(h&&f.__html==h.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(function(e,t,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in t||L(e,o,null,n[o],r);for(o in t)i&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||L(e,o,t[o],n[o],r)}(e,y,g,o,l),f)t.__k=[];else if(S(e,p(b=t.props.children)?b:[b],t,n,i,o&&"foreignObject"!==v,a,s,a?a[0]:n.__k&&E(n,0),l,u),null!=a)for(b=a.length;b--;)null!=a[b]&&m(a[b]);l||("value"in y&&void 0!==(b=y.value)&&(b!==e.value||"progress"===v&&!b||"option"===v&&b!==g.value)&&L(e,"value",b,g.value,!1),"checked"in y&&void 0!==(b=y.checked)&&b!==e.checked&&L(e,"checked",b,g.checked,!1))}return e}function F(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){i.__e(e,n)}}function B(e,t,n){var r,o;if(i.unmount&&i.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||F(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){i.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&B(r[o],t,n||"function"!=typeof e.type);n||null==e.__e||m(e.__e),e.__=e.__e=e.__d=void 0}function U(e,t,n){return this.constructor(e,n)}function z(e,t,n){var o,a,s,l;i.__&&i.__(e,t),a=(o="function"==typeof n)?null:n&&n.__k||t.__k,s=[],l=[],O(t,e=(!o&&n||t).__k=g(b,null,[e]),a||c,c,void 0!==t.ownerSVGElement,!o&&n?[n]:a?null:t.firstChild?r.call(t.childNodes):null,s,!o&&n?n:a?a.__e:t.firstChild,o,l),N(s,e,l)}function G(e,t,n){var i,o,a,s,l=f({},e.props);for(a in e.type&&e.type.defaultProps&&(s=e.type.defaultProps),t)"key"==a?i=t[a]:"ref"==a?o=t[a]:l[a]=void 0===t[a]&&void 0!==s?s[a]:t[a];return arguments.length>2&&(l.children=arguments.length>3?r.call(arguments,2):n),y(e.type,l,i||e.key,o||e.ref,null)}r=d.slice,i={__e:function(e,t,n,r){for(var i,o,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),a=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),a=i.__d),a)return i.__E=i}catch(t){e=t}throw e}},o=0,_.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=f({},this.state),"function"==typeof e&&(e=e(f({},n),this.props)),e&&f(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),T(this))},_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),T(this))},_.prototype.render=b,a=[],l="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,u=function(e,t){return e.__v.__b-t.__v.__b},A.__r=0},7129:(e,t)=>{"use strict";var n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function i(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var r,o,a=[];for(o in"string"!=typeof t&&(t="?"),e)if(n.call(e,o)){if((r=e[o])||null!=r&&!isNaN(r)||(r=""),o=i(o),r=i(r),null===o||null===r)continue;a.push(o+"="+r)}return a.length?t+a.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,i={};t=n.exec(e);){var o=r(t[1]),a=r(t[2]);null===o||null===a||o in i||(i[o]=a)}return i}},7418:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},7882:(e,t,n)=>{const r=n(9204),i=n(130),o="undefined"!=typeof WebAssembly&&n(1798)({imports:{debug:{log(...e){console.log(...e.map((e=>(e>>>0).toString(16).padStart(8,"0"))))},log_tee:e=>(console.log((e>>>0).toString(16).padStart(8,"0")),e)}}});let a=0;const s=[];e.exports=c;const l=e.exports.SHA256_BYTES=32,u=108;function c(){if(!(this instanceof c))return new c;if(!o)throw new Error("WASM not loaded. Wait for Sha256.ready(cb)");s.length||(s.push(a),a+=u),this.finalized=!1,this.digestLength=l,this.pointer=s.pop(),this.pos=0,this._memory=new Uint8Array(o.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+u),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+u)}function d(e){if(!(this instanceof d))return new d(e);this.pad=i.alloc(64),this.inner=c(),this.outer=c();const t=i.alloc(32);e.byteLength>64&&(c().update(e).digest(t),e=t),this.pad.fill(54);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.inner.update(this.pad),this.pad.fill(92);for(let t=0;t<e.byteLength;t++)this.pad[t]^=e[t];this.outer.update(this.pad),this.pad.fill(0),t.fill(0)}function h(){}c.prototype._realloc=function(e){o.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(o.memory.buffer)},c.prototype.update=function(e,t){r(!1===this.finalized,"Hash instance finalized"),a%4!=0&&(a+=4-a%4),r(a%4==0,"input shoud be aligned for int32");const[n,s]=function(e,t){var n=i.from(e,t);return[n,n.byteLength]}(e,t);return r(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),a+s>this._memory.length&&this._realloc(a+e.length),this._memory.fill(0,a,a+(s+64-1&-64)-64),this._memory.set(n.subarray(0,64-this.pos),this.pointer+40+this.pos),this._memory.set(n.subarray(64-this.pos),a),this.pos=this.pos+s&63,o.sha256(this.pointer,a,s,0),this},c.prototype.digest=function(e,t=0){r(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,s.push(this.pointer);const n=this.pointer+40+this.pos;this._memory.fill(0,n,this.pointer+40+64),o.sha256(this.pointer,a,0,1);const l=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!e)return l;if("string"==typeof e)return i.toString(l,e);r(e instanceof Uint8Array,"output must be Uint8Array or Buffer"),r(e.byteLength>=this.digestLength+t,"output must have at least 'SHA256_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)e[n+t]=l[n];return e},c.WASM=o,c.WASM_SUPPORTED="undefined"!=typeof WebAssembly,c.ready=function(e){return e||(e=h),o?(e(),Promise.resolve()):e(new Error("WebAssembly not supported"))},c.prototype.ready=c.ready,d.prototype.update=function(e,t){return this.inner.update(e,t),this},d.prototype.digest=function(e,t=0){return this.outer.update(this.inner.digest()),this.outer.digest(e,t)},c.HMAC=d},1798:e=>{var t,n,r=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:4*t-205]=t;return t=>{for(var n=t.length,r=new Uint8Array(3*(n-("="==t[n-1])-("="==t[n-2]))/4|0),i=0,o=0;i<n;){var a=e[t.charCodeAt(i++)],s=e[t.charCodeAt(i++)],l=e[t.charCodeAt(i++)],u=e[t.charCodeAt(i++)];r[o++]=a<<2|s>>4,r[o++]=s<<4|l>>2,r[o++]=l<<6|u}return r}})(),i=(t={"wasm-binary:./sha256.wat"(e,t){t.exports=r("AGFzbQEAAAABNAVgAX8Bf2AIf39/f39/f38AYAR/f39/AX9gEX9/f39/f39/f39/f39/f39/AGAEf39/fwADBgUAAQIDBAUDAQABBikIfwFBAAt/AUEAC38BQQALfwFBAAt/AUEAC38BQQALfwFBAAt/AUEACwcTAgZtZW1vcnkCAAZzaGEyNTYABAreFwUZACAAQf+B/AdxQQh4IABBgP6DeHFBCHdyC7wDAQZ/IwQjBXEjBEF/cyMGcXMhCiMAIwFxIwAjAnFzIwEjAnFzIQsjAEECeCMAQQ14cyMAQRZ4cyEMIwRBBngjBEELeHMjBEEZeHMhDSMHIApqIA1qIABqIARqIQggDCALaiEJIwMgCGokByAIIAlqJAMjByMEcSMHQX9zIwVxcyEKIwMjAHEjAyMBcXMjACMBcXMhCyMDQQJ4IwNBDXhzIwNBFnhzIQwjB0EGeCMHQQt4cyMHQRl4cyENIwYgCmogDWogAWogBWohCCAMIAtqIQkjAiAIaiQGIAggCWokAiMGIwdxIwZBf3MjBHFzIQojAiMDcSMCIwBxcyMDIwBxcyELIwJBAngjAkENeHMjAkEWeHMhDCMGQQZ4IwZBC3hzIwZBGXhzIQ0jBSAKaiANaiACaiAGaiEIIAwgC2ohCSMBIAhqJAUgCCAJaiQBIwUjBnEjBUF/cyMHcXMhCiMBIwJxIwEjA3FzIwIjA3FzIQsjAUECeCMBQQ14cyMBQRZ4cyEMIwVBBngjBUELeHMjBUEZeHMhDSMEIApqIA1qIANqIAdqIQggDCALaiEJIwAgCGokBCAIIAlqJAALKwAgAEEReCAAQRN4cyAAQQp2cyABaiACQQd4IAJBEnhzIAJBA3ZzIANqagvLCwEwfyAAKAJoRQRAIABB58yn0AY2AgAgAEGF3Z7bezYCBCAAQfLmu+MDNgIIIABBuuq/qno2AgwgAEH/pLmIBTYCECAAQYzRldh5NgIUIABBq7OP/AE2AhggAEGZmoPfBTYCHCAAQQE2AmgLIAAoAgAkACAAKAIEJAEgACgCCCQCIAAoAgwkAyAAKAIQJAQgACgCFCQFIAAoAhgkBiAAKAIcJAcgARAAIQEgAhAAIQIgAxAAIQMgBBAAIQQgBRAAIQUgBhAAIQYgBxAAIQcgCBAAIQggCRAAIQkgChAAIQogCxAAIQsgDBAAIQwgDRAAIQ0gDhAAIQ4gDxAAIQ8gEBAAIRAgASACIAMgBEGY36iUBEGRid2JB0HP94Oue0Glt9fNfhABIAUgBiAHIAhB24TbygNB8aPEzwVBpIX+kXlB1b3x2HoQASAJIAogCyAMQZjVnsB9QYG2jZQBQb6LxqECQcP7sagFEAEgDSAOIA8gEEH0uvmVB0H+4/qGeEGnjfDeeUH04u+MfBABIA8gCiACIAEQAiEBIBAgCyADIAIQAiECIAEgDCAEIAMQAiEDIAIgDSAFIAQQAiEEIAMgDiAGIAUQAiEFIAQgDyAHIAYQAiEGIAUgECAIIAcQAiEHIAYgASAJIAgQAiEIIAcgAiAKIAkQAiEJIAggAyALIAoQAiEKIAkgBCAMIAsQAiELIAogBSANIAwQAiEMIAsgBiAOIA0QAiENIAwgByAPIA4QAiEOIA0gCCAQIA8QAiEPIA4gCSABIBAQAiEQIAEgAiADIARBwdPtpH5Bho/5/X5BxruG/gBBzMOyoAIQASAFIAYgByAIQe/YpO8CQaqJ0tMEQdzTwuUFQdqR5rcHEAEgCSAKIAsgDEHSovnBeUHtjMfBekHIz4yAe0HH/+X6exABIA0gDiAPIBBB85eAt3xBx6KerX1B0capNkHn0qShARABIA8gCiACIAEQAiEBIBAgCyADIAIQAiECIAEgDCAEIAMQAiEDIAIgDSAFIAQQAiEEIAMgDiAGIAUQAiEFIAQgDyAHIAYQAiEGIAUgECAIIAcQAiEHIAYgASAJIAgQAiEIIAcgAiAKIAkQAiEJIAggAyALIAoQAiEKIAkgBCAMIAsQAiELIAogBSANIAwQAiEMIAsgBiAOIA0QAiENIAwgByAPIA4QAiEOIA0gCCAQIA8QAiEPIA4gCSABIBAQAiEQIAEgAiADIARBhZXcvQJBuMLs8AJB/Nux6QRBk5rgmQUQASAFIAYgByAIQdTmqagGQbuVqLMHQa6Si454QYXZyJN5EAEgCSAKIAsgDEGh0f+VekHLzOnAekHwlq6SfEGjo7G7fBABIA0gDiAPIBBBmdDLjH1BpIzktH1Bheu4oH9B8MCqgwEQASAPIAogAiABEAIhASAQIAsgAyACEAIhAiABIAwgBCADEAIhAyACIA0gBSAEEAIhBCADIA4gBiAFEAIhBSAEIA8gByAGEAIhBiAFIBAgCCAHEAIhByAGIAEgCSAIEAIhCCAHIAIgCiAJEAIhCSAIIAMgCyAKEAIhCiAJIAQgDCALEAIhCyAKIAUgDSAMEAIhDCALIAYgDiANEAIhDSAMIAcgDyAOEAIhDiANIAggECAPEAIhDyAOIAkgASAQEAIhECABIAIgAyAEQZaCk80BQYjY3fEBQczuoboCQbX5wqUDEAEgBSAGIAcgCEGzmfDIA0HK1OL2BEHPlPPcBUHz37nBBhABIAkgCiALIAxB7oW+pAdB78aVxQdBlPChpnhBiISc5ngQASANIA4gDyAQQfr/+4V5QevZwaJ6QffH5vd7QfLxxbN8EAEgACAAKAIAIwBqNgIAIAAgACgCBCMBajYCBCAAIAAoAggjAmo2AgggACAAKAIMIwNqNgIMIAAgACgCECMEajYCECAAIAAoAhQjBWo2AhQgACAAKAIYIwZqNgIYIAAgACgCHCMHajYCHAuKCAIBfhJ/IAApAyAhBCAEp0E/cSACaiEGIAQgAq18IQQgACAENwMgAkAgACgCKCEHIAAoAiwhCCAAKAIwIQkgACgCNCEKIAAoAjghCyAAKAI8IQwgACgCQCENIAAoAkQhDiAAKAJIIQ8gACgCTCEQIAAoAlAhESAAKAJUIRIgACgCWCETIAAoAlwhFCAAKAJgIRUgACgCZCEWIAZBwABrIgZBAEgNACAAIAcgCCAJIAogCyAMIA0gDiAPIBAgESASIBMgFCAVIBYQAwNAIAEoAgAhByABKAIEIQggASgCCCEJIAEoAgwhCiABKAIQIQsgASgCFCEMIAEoAhghDSABKAIcIQ4gASgCICEPIAEoAiQhECABKAIoIREgASgCLCESIAEoAjAhEyABKAI0IRQgASgCOCEVIAEoAjwhFiABQcAAaiEBIAZBwABrIgZBAEgEQCAAIAc2AiggACAINgIsIAAgCTYCMCAAIAo2AjQgACALNgI4IAAgDDYCPCAAIA02AkAgACAONgJEIAAgDzYCSCAAIBA2AkwgACARNgJQIAAgEjYCVCAAIBM2AlggACAUNgJcIAAgFTYCYCAAIBY2AmQMAgsgACAHIAggCSAKIAsgDCANIA4gDyAQIBEgEiATIBQgFSAWEAMMAAsLIANBAUYEQCAEp0E/cSEGQYABIAZBA3FBA3R0IQUCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgBkECdg4PAwQFBgcICQoLDA0ODxABAgsLIAUgFXIhFUEAIQULIAUgFnIhFkEAIQUgACAHIAggCSAKIAsgDCANIA4gDyAQIBEgEiATIBQgFSAWEAMgACAENwMgQQAhB0EAIQhBACEJQQAhCkEAIQtBACEMQQAhDUEAIQ5BACEPQQAhEEEAIRFBACESQQAhE0EAIRRBACEVQQAhFgsgBSAHciEHQQAhBQsgBSAIciEIQQAhBQsgBSAJciEJQQAhBQsgBSAKciEKQQAhBQsgBSALciELQQAhBQsgBSAMciEMQQAhBQsgBSANciENQQAhBQsgBSAOciEOQQAhBQsgBSAPciEPQQAhBQsgBSAQciEQQQAhBQsgBSARciERQQAhBQsgBSASciESQQAhBQsgBSATciETQQAhBQsgBSAUciEUQQAhBQsgBEIdiKcQACEVIARCA4anEAAhFiAAIAcgCCAJIAogCyAMIA0gDiAPIBAgESASIBMgFCAVIBYQAyAAIAAoAgAQADYCACAAIAAoAgQQADYCBCAAIAAoAggQADYCCCAAIAAoAgwQADYCDCAAIAAoAhAQADYCECAAIAAoAhQQADYCFCAAIAAoAhgQADYCGCAAIAAoAhwQADYCHAsL")}},function(){return n||(0,t[Object.keys(t)[0]])((n={exports:{}}).exports,n),n.exports})(),o=new WebAssembly.Module(i);e.exports=e=>new WebAssembly.Instance(o,e).exports},6815:(e,t,n)=>{"use strict";var r=n(3379),i=n.n(r),o=n(2989);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals},8957:(e,t,n)=>{"use strict";var r=n(3379),i=n.n(r),o=n(5384);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals},9418:(e,t,n)=>{"use strict";var r=n(3379),i=n.n(r),o=n(9526);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals},2406:(e,t,n)=>{"use strict";var r=n(3379),i=n.n(r),o=n(5506);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals},5948:(e,t,n)=>{"use strict";var r=n(3379),i=n.n(r),o=n(6998);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals},8842:(e,t,n)=>{"use strict";var r=n(3379),i=n.n(r),o=n(1211);i()(o.Z,{insert:"head",singleton:!1}),o.Z.locals},3379:(e,t,n)=>{"use strict";var r,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function a(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},r=[],i=0;i<e.length;i++){var s=e[i],l=t.base?s[0]+t.base:s[0],u=n[l]||0,c="".concat(l," ").concat(u);n[l]=u+1;var d=a(c),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(o[d].references++,o[d].updater(h)):o.push({identifier:c,updater:m(h,t),references:1}),r.push(c)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function h(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,f=0;function m(e,t){var n,r,i;if(t.singleton){var o=f++;n=p||(p=l(t)),r=d.bind(null,n,o,!1),i=d.bind(null,n,o,!0)}else n=l(t),r=h.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=a(n[r]);o[i].references--}for(var l=s(e,t),u=0;u<n.length;u++){var c=a(n[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}n=l}}}},4564:(e,t,n)=>{"use strict";var r=n(7418),i=n(7129),o=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,a=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,l=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function d(e){return(e||"").toString().replace(o,"")}var h=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};function f(e){var t,r=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},i={},o=typeof(e=e||r);if("blob:"===e.protocol)i=new y(unescape(e.pathname),{});else if("string"===o)for(t in i=new y(e,{}),p)delete i[t];else if("object"===o){for(t in e)t in p||(i[t]=e[t]);void 0===i.slashes&&(i.slashes=s.test(e.href))}return i}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function g(e,t){e=(e=d(e)).replace(a,""),t=t||{};var n,r=u.exec(e),i=r[1]?r[1].toLowerCase():"",o=!!r[2],s=!!r[3],l=0;return o?s?(n=r[2]+r[3]+r[4],l=r[2].length+r[3].length):(n=r[2]+r[4],l=r[2].length):s?(n=r[3]+r[4],l=r[3].length):n=r[4],"file:"===i?l>=2&&(n=n.slice(2)):m(i)?n=r[4]:i?o&&(n=n.slice(2)):l>=2&&m(t.protocol)&&(n=r[4]),{protocol:i,slashes:o||m(i),slashesCount:l,rest:n}}function y(e,t,n){if(e=(e=d(e)).replace(a,""),!(this instanceof y))return new y(e,t,n);var o,s,l,u,p,v,b=h.slice(),_=typeof t,E=this,w=0;for("object"!==_&&"string"!==_&&(n=t,t=null),n&&"function"!=typeof n&&(n=i.parse),o=!(s=g(e||"",t=f(t))).protocol&&!s.slashes,E.slashes=s.slashes||o&&t.slashes,E.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||c.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!m(E.protocol)))&&(b[3]=[/(.*)/,"pathname"]);w<b.length;w++)"function"!=typeof(u=b[w])?(l=u[0],v=u[1],l!=l?E[v]=e:"string"==typeof l?~(p="@"===l?e.lastIndexOf(l):e.indexOf(l))&&("number"==typeof u[2]?(E[v]=e.slice(0,p),e=e.slice(p+u[2])):(E[v]=e.slice(p),e=e.slice(0,p))):(p=l.exec(e))&&(E[v]=p[1],e=e.slice(0,p.index)),E[v]=E[v]||o&&u[3]&&t[v]||"",u[4]&&(E[v]=E[v].toLowerCase())):e=u(e,E);n&&(E.query=n(E.query)),o&&t.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==t.pathname)&&(E.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],o=!1,a=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),a++):a&&(0===r&&(o=!0),n.splice(r,1),a--);return o&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}(E.pathname,t.pathname)),"/"!==E.pathname.charAt(0)&&m(E.protocol)&&(E.pathname="/"+E.pathname),r(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(~(p=E.auth.indexOf(":"))?(E.username=E.auth.slice(0,p),E.username=encodeURIComponent(decodeURIComponent(E.username)),E.password=E.auth.slice(p+1),E.password=encodeURIComponent(decodeURIComponent(E.password))):E.username=encodeURIComponent(decodeURIComponent(E.auth)),E.auth=E.password?E.username+":"+E.password:E.username),E.origin="file:"!==E.protocol&&m(E.protocol)&&E.host?E.protocol+"//"+E.host:"null",E.href=E.toString()}y.prototype={set:function(e,t,n){var o=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||i.parse)(t)),o[e]=t;break;case"port":o[e]=t,r(t,o.protocol)?t&&(o.host=o.hostname+":"+t):(o.host=o.hostname,o[e]="");break;case"hostname":o[e]=t,o.port&&(t+=":"+o.port),o.host=t;break;case"host":o[e]=t,l.test(t)?(t=t.split(":"),o.port=t.pop(),o.hostname=t.join(":")):(o.hostname=t,o.port="");break;case"protocol":o.protocol=t.toLowerCase(),o.slashes=!n;break;case"pathname":case"hash":if(t){var a="pathname"===e?"/":"#";o[e]=t.charAt(0)!==a?a+t:t}else o[e]=t;break;case"username":case"password":o[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(o.username=t.slice(0,s),o.username=encodeURIComponent(decodeURIComponent(o.username)),o.password=t.slice(s+1),o.password=encodeURIComponent(decodeURIComponent(o.password))):o.username=encodeURIComponent(decodeURIComponent(t))}for(var u=0;u<h.length;u++){var c=h[u];c[4]&&(o[c[1]]=o[c[1]].toLowerCase())}return o.auth=o.password?o.username+":"+o.password:o.username,o.origin="file:"!==o.protocol&&m(o.protocol)&&o.host?o.protocol+"//"+o.host:"null",o.href=o.toString(),o},toString:function(e){e&&"function"==typeof e||(e=i.stringify);var t,n=this,r=n.host,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var a=o+(n.protocol&&n.slashes||m(n.protocol)?"//":"");return n.username?(a+=n.username,n.password&&(a+=":"+n.password),a+="@"):n.password?(a+=":"+n.password,a+="@"):"file:"!==n.protocol&&m(n.protocol)&&!r&&"/"!==n.pathname&&(a+="@"),(":"===r[r.length-1]||l.test(n.hostname)&&!n.port)&&(r+=":"),a+=r+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(a+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(a+=n.hash),a}},y.extractProtocol=g,y.location=f,y.trimLeft=d,y.qs=i,e.exports=y},3407:(e,t,n)=>{var r=n(8908),i=e.exports={WebVTT:n(3706),VTTCue:n(2230),VTTRegion:n(3710)};r.vttjs=i,r.WebVTT=i.WebVTT;var o=i.VTTCue,a=i.VTTRegion,s=r.VTTCue,l=r.VTTRegion;i.shim=function(){r.VTTCue=o,r.VTTRegion=a},i.restore=function(){r.VTTCue=s,r.VTTRegion=l},r.VTTCue||i.shim()},3706:(e,t,n)=>{var r=n(9144),i=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function o(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function a(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function s(){this.values=i(null)}function l(e,t,n,r){var i=r?e.split(r):[e];for(var o in i)if("string"==typeof i[o]){var a=i[o].split(n);2===a.length&&t(a[0].trim(),a[1].trim())}}function u(e,t,n){var r=e;function i(){var t=a(e);if(null===t)throw new o(o.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function u(){e=e.replace(/^\s+/,"")}if(u(),t.startTime=i(),u(),"--\x3e"!==e.substr(0,3))throw new o(o.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),u(),t.endTime=i(),u(),function(e,t){var r=new s;l(e,(function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var o=t.split(","),a=o[0];r.integer(e,a),r.percent(e,a)&&r.set("snapToLines",!1),r.alt(e,a,["auto"]),2===o.length&&r.alt("lineAlign",o[1],["start","center","end"]);break;case"position":o=t.split(","),r.percent(e,o[0]),2===o.length&&r.alt("positionAlign",o[1],["start","center","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");try{t.line=r.get("line","auto")}catch(e){}t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(e){t.align=r.get("align","middle")}try{t.position=r.get("position","auto")}catch(e){t.position=r.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}o.prototype=i(Error.prototype),o.prototype.constructor=o,o.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var c=r.createElement&&r.createElement("textarea"),d={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},h={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},p={v:"title",lang:"lang"},f={rt:"ruby"};function m(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function r(e){return c.innerHTML=e,e=c.textContent,c.textContent="",e}function i(e,t){return!f[t.localName]||f[t.localName]===e.localName}function o(t,n){var r=d[t];if(!r)return null;var i=e.document.createElement(r),o=p[t];return o&&n&&(i[o]=n.trim()),i}for(var s,l=e.document.createElement("div"),u=l,m=[];null!==(s=n());)if("<"!==s[0])u.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){m.length&&m[m.length-1]===s.substr(2).replace(">","")&&(m.pop(),u=u.parentNode);continue}var g,y=a(s.substr(1,s.length-2));if(y){g=e.document.createProcessingInstruction("timestamp",y),u.appendChild(g);continue}var v=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!v)continue;if(!(g=o(v[1],v[3])))continue;if(!i(u,g))continue;if(v[2]){var b=v[2].split(".");b.forEach((function(e){var t=/^bg_/.test(e),n=t?e.slice(3):e;if(h.hasOwnProperty(n)){var r=t?"background-color":"color",i=h[n];g.style[r]=i}})),g.className=b.join(" ")}m.push(v[1]),u.appendChild(g),u=g}return l}var g=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function y(e){for(var t=0;t<g.length;t++){var n=g[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function v(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function i(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var o=n.match(/^.*(\n|\r)/);return o?(e.length=0,o[0]):n}return"ruby"===t.tagName?i(e):t.childNodes?(r(e,t),i(e)):void 0}for(r(t,e);n=i(t);)for(var o=0;o<n.length;o++)if(y(n.charCodeAt(o)))return"rtl";return"ltr"}function b(){}function _(e,t,n){b.call(this),this.cue=t,this.cueDiv=m(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:v(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var i=0;switch(t.positionAlign){case"start":case"line-left":i=t.position;break;case"center":i=t.position-t.size/2;break;case"end":case"line-right":i=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(i,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(i,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function E(e){var t,n,r,i;if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var o=(o=e.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects();e=e.div.getBoundingClientRect(),t=o?Math.max(o[0]&&o[0].height||0,e.height/o.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function w(e,t,n,r){var i=new E(t),o=t.cue,a=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(o),s=[];if(o.snapToLines){var l;switch(o.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=i.lineHeight,c=u*Math.round(a),d=n[l]+u,h=s[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),a<0&&(c+=""===o.vertical?n.height:n.width,s=s.reverse()),i.move(h,c)}else{var p=i.lineHeight/n.height*100;switch(o.lineAlign){case"center":a-=p/2;break;case"end":a-=p}switch(o.vertical){case"":t.applyStyles({top:t.formatStyle(a,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(a,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(a,"%")})}s=["+y","-x","+x","-y"],i=new E(t)}var f=function(e,t){for(var i,o=new E(e),a=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(r);)e.move(t[s]);if(e.within(n))return e;var l=e.intersectPercentage(n);a>l&&(i=new E(e),a=l),e=new E(o)}return i||o}(i,s);t.move(f.toCSSCompatValues(n))}function T(){}b.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},b.prototype.formatStyle=function(e,t){return 0===e?0:e+t},_.prototype=i(b.prototype),_.prototype.constructor=_,E.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},E.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},E.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},E.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},E.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},E.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},E.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},E.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}},T.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},T.convertCueToDOMTree=function(e,t){return e&&t?m(e,t):null},T.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",n.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],o=E.getSimpleBoxPosition(r),a={font:Math.round(.05*o.height*100)/100+"px sans-serif"};!function(){for(var n,s,l=0;l<t.length;l++)s=t[l],n=new _(e,s,a),r.appendChild(n.div),w(0,n,o,i),s.displayState=n.div,i.push(E.getSimpleBoxPosition(n))}()}else for(var s=0;s<t.length;s++)r.appendChild(t[s].displayState)},T.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},T.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof o))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t,n=this;function r(){for(var e=n.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,n.buffer=e.substr(t),r}e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;var c=(i=r()).match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new o(o.Errors.BadSignature);n.state="HEADER"}for(var d=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(d?d=!1:i=r(),n.state){case"HEADER":/:/.test(i)?(t=i).match(/X-TIMESTAMP-MAP/)?l(t,(function(e,t){"X-TIMESTAMP-MAP"===e&&function(e){var t=new s;l(e,(function(e,n){switch(e){case"MPEGT":t.integer(e+"S",n);break;case"LOCA":t.set(e+"L",a(n))}}),/[^\d]:/,/,/),n.ontimestampmap&&n.ontimestampmap({MPEGTS:t.get("MPEGTS"),LOCAL:t.get("LOCAL")})}(t)}),/=/):l(t,(function(e,t){"Region"===e&&function(e){var t=new s;if(l(e,(function(e,n){switch(e){case"id":t.set(e,n);break;case"width":t.percent(e,n);break;case"lines":t.integer(e,n);break;case"regionanchor":case"viewportanchor":var r=n.split(",");if(2!==r.length)break;var i=new s;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;t.set(e+"X",i.get("x")),t.set(e+"Y",i.get("y"));break;case"scroll":t.alt(e,n,["up"])}}),/=/,/\s/),t.has("id")){var r=new(n.vttjs.VTTRegion||n.window.VTTRegion);r.width=t.get("width",100),r.lines=t.get("lines",3),r.regionAnchorX=t.get("regionanchorX",0),r.regionAnchorY=t.get("regionanchorY",100),r.viewportAnchorX=t.get("viewportanchorX",0),r.viewportAnchorY=t.get("viewportanchorY",100),r.scroll=t.get("scroll",""),n.onregion&&n.onregion(r),n.regionList.push({id:t.get("id"),region:r})}}(t)}),/:/):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;n.cue=new(n.vttjs.VTTCue||n.window.VTTCue)(0,0,"");try{n.cue.align="center"}catch(e){n.cue.align="middle"}if(n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{u(i,n.cue,n.regionList)}catch(e){n.reportOrThrowError(e),n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var h=-1!==i.indexOf("--\x3e");if(!i||h&&(d=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":i||(n.state="ID");continue}}}catch(e){n.reportOrThrowError(e),"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new o(o.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}},e.exports=T},2230:e=>{var t={"":1,lr:1,rl:1},n={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function r(e){return"string"==typeof e&&!!n[e.toLowerCase()]&&e.toLowerCase()}function i(e,n,i){this.hasBeenReset=!1;var o="",a=!1,s=e,l=n,u=i,c=null,d="",h=!0,p="auto",f="start",m="auto",g="auto",y=100,v="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return o},set:function(e){o=""+e}},pauseOnExit:{enumerable:!0,get:function(){return a},set:function(e){a=!!e}},startTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");s=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return d},set:function(e){var n=function(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===n)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");d=n,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return p},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return f},set:function(e){var t=r(e);t?(f=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return g},set:function(e){var t=r(e);t?(g=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return v},set:function(e){var t=r(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");v=t,this.hasBeenReset=!0}}}),this.displayState=void 0}i.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=i},3710:e=>{var t={"":!0,up:!0};function n(e){return"number"==typeof e&&e>=0&&e<=100}e.exports=function(){var e=100,r=3,i=0,o=100,a=0,s=100,l="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!n(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return r},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");r=e}},regionAnchorY:{enumerable:!0,get:function(){return o},set:function(e){if(!n(e))throw new Error("RegionAnchorX must be between 0 and 100.");o=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!n(e))throw new Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!n(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!n(e))throw new Error("ViewportAnchorX must be between 0 and 100.");a=e}},scroll:{enumerable:!0,get:function(){return l},set:function(e){var n=function(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);!1===n?console.warn("Scroll: an invalid or illegal string was specified."):l=n}}})}},7147:(e,t,n)=>{"use strict";var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==n.g&&n.g||{},i="URLSearchParams"in r,o="Symbol"in r&&"iterator"in Symbol,a="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in r,l="ArrayBuffer"in r;if(l)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function g(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=g(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():l&&a&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return m(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(a)return this.blob().then(y);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,n,r,i,o=m(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,n=g(t=new FileReader),i=(r=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?r[1]:"utf-8",t.readAsText(e,i),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=d(e),t=h(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[d(e)]},f.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},f.prototype.set=function(e,t){this.map[d(e)]=h(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},o&&(f.prototype[Symbol.iterator]=f.prototype.entries);var _=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,o=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(i=(n=t.method||this.method||"GET").toUpperCase(),_.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in r)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var a=/([?&])_=[^&]*/;a.test(this.url)?this.url=this.url.replace(a,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function T(e,t){if(!(this instanceof T))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},b.call(E.prototype),b.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},T.error=function(){var e=new T(null,{status:200,statusText:""});return e.status=0,e.type="error",e};var A=[301,302,303,307,308];T.redirect=function(e,t){if(-1===A.indexOf(t))throw new RangeError("Invalid status code");return new T(null,{status:t,headers:{location:e}})};var S=r.DOMException;try{new S}catch(e){(S=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function x(e,t){return new Promise((function(n,i){var o=new E(e,t);if(o.signal&&o.signal.aborted)return i(new S("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}if(s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(e){console.warn("Response "+e.message)}}})),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;setTimeout((function(){n(new T(i,r))}),0)},s.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){i(new S("Aborted","AbortError"))}),0)},s.open(o.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&(a?s.responseType="blob":l&&(s.responseType="arraybuffer")),t&&"object"==typeof t.headers&&!(t.headers instanceof f||r.Headers&&t.headers instanceof r.Headers)){var c=[];Object.getOwnPropertyNames(t.headers).forEach((function(e){c.push(d(e)),s.setRequestHeader(e,h(t.headers[e]))})),o.headers.forEach((function(e,t){-1===c.indexOf(t)&&s.setRequestHeader(t,e)}))}else o.headers.forEach((function(e,t){s.setRequestHeader(t,e)}));o.signal&&(o.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",u)}),s.send(void 0===o._bodyInit?null:o._bodyInit)}))}x.polyfill=!0,r.fetch||(r.fetch=x,r.Headers=f,r.Request=E,r.Response=T)},1196:e=>{"use strict";function t(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}t.prototype.match=function(e){var t,n,r=!0,i=this.parts,o=i.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(n=(e||"").split(this.separator),t=0;r&&t<o;t++)"*"!==i[t]&&(r=t<n.length&&i[t]===n[t]);r=r&&n}else r=!1;else if("function"==typeof e.splice)for(r=[],t=e.length;t--;)this.match(e[t])&&(r[r.length]=e[t]);else if("object"==typeof e)for(var a in r={},e)this.match(a)&&(r[a]=e[a]);return r},e.exports=function(e,n,r){var i=new t(e,r||/[\/\.]/);return void 0!==n?i.match(n):i}},2183:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/close-icon-f351818e2777dc817a97.svg"},6199:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/fluid-icons-583850a426583410ea8e.svg"},1630:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/fluid-spinner-752b43429bb9ac6dc9e4.svg"},1533:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/miniplayer-toggle-off-76e6fc38ebf88d41fee3.svg"},9671:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/miniplayer-toggle-on-d896e5e9d302738683b8.svg"},9465:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/skip-backward-439b042e4d7ee9fe107a.svg"},895:(e,t,n)=>{"use strict";e.exports=n.p+"static/bundle/svg/skip-forward-0b7ba558ff785aac218a.svg"},8596:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(8214);class i{constructor(e,t){void 0===t&&(t={}),this.uppy=e,this.opts=t}getPluginState(){const{plugins:e}=this.uppy.getState();return e[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(),this.i18nInit()}i18nInit(){const e=new r.Z([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState()}addTarget(){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}render(){throw new Error("Extend the render method to add your plugin to a DOM element")}update(){}afterUpdate(){}}},8386:(e,t,n)=>{"use strict";n.d(t,{di:()=>Te,ZP:()=>pe});var r=n(8214),i=n(4800),o=n(9022),a=n(3493);function s(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var l=0;function u(e){return"__private_"+l+++"_"+e}var c=u("callbacks"),d=u("publish");class h{constructor(){Object.defineProperty(this,d,{value:p}),Object.defineProperty(this,c,{writable:!0,value:new Set}),this.state={}}getState(){return this.state}setState(e){const t={...this.state},n={...this.state,...e};this.state=n,s(this,d)[d](t,n,e)}subscribe(e){return s(this,c)[c].add(e),()=>{s(this,c)[c].delete(e)}}}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s(this,c)[c].forEach((e=>{e(...t)}))}h.VERSION="3.0.3";const f=h;var m=n(3563),g=n(3454),y=n(1988);function v(e){if(null==e&&"undefined"!=typeof navigator&&(e=navigator.userAgent),!e)return!0;const t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;const n=t[1];let[r,i]=n.split(".");return r=parseInt(r,10),i=parseInt(i,10),r<15||15===r&&i<15063||r>18||18===r&&i>=18218}function b(e){return e<10?`0${e}`:e.toString()}function _(){const e=new Date;return`${b(e.getHours())}:${b(e.getMinutes())}:${b(e.getSeconds())}`}const E={debug:()=>{},warn:()=>{},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error(`[Uppy] [${_()}]`,...t)}},w={debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.debug(`[Uppy] [${_()}]`,...t)},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.warn(`[Uppy] [${_()}]`,...t)},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error(`[Uppy] [${_()}]`,...t)}};var T=n(5158),A=n(4193);const S={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class x extends Error{constructor(e,t){let{isUserFacing:n=!0,file:r}=void 0===t?{}:t;super(e),this.isRestriction=!0,this.isUserFacing=n,null!=r&&(this.file=r)}}class I{constructor(e,t){this.i18n=t,this.getOpts=()=>{const t=e();if(null!=t.restrictions.allowedFileTypes&&!Array.isArray(t.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return t}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:n,maxNumberOfFiles:r}=this.getOpts().restrictions;if(r&&e.filter((e=>!e.isGhost)).length+t.length>r)throw new x(`${this.i18n("youCanOnlyUploadX",{smart_count:r})}`);if(n){let r=e.reduce(((e,t)=>e+t.size),0);for(const e of t)if(null!=e.size&&(r+=e.size,r>n))throw new x(this.i18n("exceedsSize",{size:T(n),file:e.name}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:n,allowedFileTypes:r}=this.getOpts().restrictions;if(r&&!r.some((t=>t.includes("/")?!!e.type&&A(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.slice(1).toLowerCase()))){const t=r.join(", ");throw new x(this.i18n("youCanOnlyUploadFileTypes",{types:t}),{file:e})}if(t&&null!=e.size&&e.size>t)throw new x(this.i18n("exceedsSize",{size:T(t),file:e.name}),{file:e});if(n&&null!=e.size&&e.size<n)throw new x(this.i18n("inferiorSize",{size:T(n)}),{file:e})}validate(e,t){t.forEach((e=>{this.validateSingleFile(e)})),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(Object.keys(e).length<t)throw new x(this.i18n("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new x(this.i18n("missingRequiredMetaFieldOnFile",{fileName:e.name})),{requiredMetaFields:n}=this.getOpts().restrictions,r=[];for(const t of n)Object.hasOwn(e.meta,t)&&""!==e.meta[t]||r.push(t);return{missingFields:r,error:t}}}const R={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled"}};let C,M;function L(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var P=0;function D(e){return"__private_"+P+++"_"+e}var O=D("plugins"),N=D("restricter"),k=D("storeUnsubscribe"),F=D("emitter"),B=D("preProcessors"),U=D("uploaders"),z=D("postProcessors"),G=D("informAndEmit"),V=D("checkRequiredMetaFieldsOnFile"),j=D("checkRequiredMetaFields"),H=D("assertNewUploadAllowed"),Z=D("transformFile"),q=D("startIfAutoProceed"),W=D("checkAndUpdateFileState"),Y=D("addListeners"),K=D("updateOnlineStatus"),$=D("createUpload"),X=D("getUpload"),Q=D("removeUpload"),J=D("runUpload");C=Symbol.for("uppy test: getPlugins"),M=Symbol.for("uppy test: createUpload");class ee{constructor(e){Object.defineProperty(this,J,{value:he}),Object.defineProperty(this,Q,{value:de}),Object.defineProperty(this,X,{value:ce}),Object.defineProperty(this,$,{value:ue}),Object.defineProperty(this,Y,{value:le}),Object.defineProperty(this,W,{value:se}),Object.defineProperty(this,q,{value:ae}),Object.defineProperty(this,Z,{value:oe}),Object.defineProperty(this,H,{value:ie}),Object.defineProperty(this,j,{value:re}),Object.defineProperty(this,V,{value:ne}),Object.defineProperty(this,G,{value:te}),Object.defineProperty(this,O,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,N,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:i()}),Object.defineProperty(this,B,{writable:!0,value:new Set}),Object.defineProperty(this,U,{writable:!0,value:new Set}),Object.defineProperty(this,z,{writable:!0,value:new Set}),this.calculateProgress=a(((e,t)=>{const n=this.getFile(null==e?void 0:e.id);if(null==e||!n)return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);if(100===n.progress.percentage)return void this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);const r=Number.isFinite(t.bytesTotal)&&t.bytesTotal>0;this.setFileState(e.id,{progress:{...n.progress,bytesUploaded:t.bytesUploaded,bytesTotal:t.bytesTotal,percentage:r?Math.round(t.bytesUploaded/t.bytesTotal*100):0}}),this.calculateTotalProgress()}),500,{leading:!0,trailing:!0}),Object.defineProperty(this,K,{writable:!0,value:this.updateOnlineStatus.bind(this)}),this.defaultLocale=R;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:S,meta:{},onBeforeFileAdded:(e,t)=>!Object.hasOwn(t,e.id),onBeforeUpload:e=>e,store:new f,logger:E,infoTimeout:5e3};this.opts={...t,...e,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=w),this.log(`Using Core v${this.constructor.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{uploadProgress:v(),individualCancellation:!0,resumableUploads:!1},totalProgress:0,meta:{...this.opts.meta},info:[],recoveredState:null}),L(this,N)[N]=new I((()=>this.opts),this.i18n),L(this,k)[k]=this.store.subscribe(((e,t,n)=>{this.emit("state-update",e,t,n),this.updateAll(t)})),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),L(this,Y)[Y]()}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];L(this,F)[F].emit(e,...n)}on(e,t){return L(this,F)[F].on(e,t),this}once(e,t){return L(this,F)[F].once(e,t),this}off(e,t){return L(this,F)[F].off(e,t),this}updateAll(e){this.iteratePlugins((t=>{t.update(e)}))}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map((e=>{let[n,r]=e;return[n,{...t[n],...r}]})))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Canât set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=new r.Z([this.defaultLocale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e&&e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((t=>{t.setOptions(e)})),this.setState()}resetProgress(){const e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},n={};Object.keys(t).forEach((r=>{n[r]={...t[r],progress:{...t[r].progress,...e}}})),this.setState({files:n,totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null}),this.emit("reset-progress")}addPreProcessor(e){L(this,B)[B].add(e)}removePreProcessor(e){return L(this,B)[B].delete(e)}addPostProcessor(e){L(this,z)[z].add(e)}removePostProcessor(e){return L(this,z)[z].delete(e)}addUploader(e){L(this,U)[U].add(e)}removeUploader(e){return L(this,U)[U].delete(e)}setMeta(e){const t={...this.getState().meta,...e},n={...this.getState().files};Object.keys(n).forEach((t=>{n[t]={...n[t],meta:{...n[t].meta,...e}}})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:n})}setFileMeta(e,t){const n={...this.getState().files};if(!n[e])return void this.log("Was trying to set metadata for a file that has been removed: ",e);const r={...n[e].meta,...t};n[e]={...n[e],meta:r},this.setState({files:n})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map((e=>this.getFile(e)))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:n}=this.getState(),r=Object.values(e),i=r.filter((e=>{let{progress:t}=e;return!t.uploadComplete&&t.uploadStarted})),o=r.filter((e=>!e.progress.uploadStarted)),a=r.filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess)),s=r.filter((e=>e.progress.uploadStarted)),l=r.filter((e=>e.isPaused)),u=r.filter((e=>e.progress.uploadComplete)),c=r.filter((e=>e.error)),d=i.filter((e=>!e.isPaused)),h=r.filter((e=>e.progress.preprocess||e.progress.postprocess));return{newFiles:o,startedFiles:a,uploadStartedFiles:s,pausedFiles:l,completeFiles:u,erroredFiles:c,inProgressFiles:i,inProgressNotPausedFiles:d,processingFiles:h,isUploadStarted:s.length>0,isAllComplete:100===t&&u.length===r.length&&0===h.length,isAllErrored:!!n&&c.length===r.length,isAllPaused:0!==i.length&&l.length===i.length,isUploadInProgress:i.length>0,isSomeGhost:r.some((e=>e.isGhost))}}validateRestrictions(e,t){void 0===t&&(t=this.getFiles());try{L(this,N)[N].validate(t,[e])}catch(e){return e}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!(!t[e]||t[e].isGhost)}addFile(e){L(this,H)[H](e);const{nextFilesState:t,validFilesToAdd:n,errors:r}=L(this,W)[W]([e]),i=r.filter((e=>e.isRestriction));if(L(this,G)[G](i),r.length>0)throw r[0];this.setState({files:t});const[o]=n;return this.emit("file-added",o),this.emit("files-added",n),this.log(`Added file: ${o.name}, ${o.id}, mime type: ${o.type}`),L(this,q)[q](),o.id}addFiles(e){L(this,H)[H]();const{nextFilesState:t,validFilesToAdd:n,errors:r}=L(this,W)[W](e),i=r.filter((e=>e.isRestriction));L(this,G)[G](i);const o=r.filter((e=>!e.isRestriction));if(o.length>0){let e="Multiple errors occurred while adding files:\n";if(o.forEach((t=>{e+=`\n * ${t.message}`})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:o.length}),details:e},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(o,e);{const t=new Error(e);throw t.errors=o,t}}this.setState({files:t}),n.forEach((e=>{this.emit("file-added",e)})),this.emit("files-added",n),n.length>5?this.log(`Added batch of ${n.length} files`):Object.values(n).forEach((e=>{this.log(`Added file: ${e.name}\n id: ${e.id}\n type: ${e.type}`)})),n.length>0&&L(this,q)[q]()}removeFiles(e,t){const{files:n,currentUploads:r}=this.getState(),i={...n},o={...r},a=Object.create(null);function s(e){return void 0===a[e]}e.forEach((e=>{n[e]&&(a[e]=n[e],delete i[e])})),Object.keys(o).forEach((e=>{const t=r[e].fileIDs.filter(s);if(0===t.length)return void delete o[e];const{capabilities:n}=this.getState();if(t.length!==r[e].fileIDs.length&&!n.individualCancellation)throw new Error("individualCancellation is disabled");o[e]={...r[e],fileIDs:t}}));const l={currentUploads:o,files:i};0===Object.keys(i).length&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.calculateTotalProgress();const u=Object.keys(a);u.forEach((e=>{this.emit("file-removed",a[e],t)})),u.length>5?this.log(`Removed ${u.length} files`):this.log(`Removed files: ${u.join(", ")}`)}removeFile(e,t){void 0===t&&(t=null),this.removeFiles([e],t)}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).uploadComplete)return;const t=!this.getFile(e).isPaused;return this.setFileState(e,{isPaused:t}),this.emit("upload-pause",e,t),t}pauseAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const n={...e[t],isPaused:!0};e[t]=n})),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const n={...e[t],isPaused:!1,error:null};e[t]=n})),this.setState({files:e}),this.emit("resume-all")}retryAll(){const e={...this.getState().files},t=Object.keys(e).filter((t=>e[t].error));if(t.forEach((t=>{const n={...e[t],isPaused:!1,error:null};e[t]=n})),this.setState({files:e,error:null}),this.emit("retry-all",t),0===t.length)return Promise.resolve({successful:[],failed:[]});const n=L(this,$)[$](t,{forceAllowNewUpload:!0});return L(this,J)[J](n)}cancelAll(e){let{reason:t="user"}=void 0===e?{}:e;if(this.emit("cancel-all",{reason:t}),"user"===t){const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t,"cancel-all"),this.setState({totalProgress:0,error:null,recoveredState:null})}}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);const t=L(this,$)[$]([e],{forceAllowNewUpload:!0});return L(this,J)[J](t)}logout(){this.iteratePlugins((e=>{e.provider&&e.provider.logout&&e.provider.logout()}))}calculateTotalProgress(){const e=this.getFiles().filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess));if(0===e.length)return this.emit("progress",0),void this.setState({totalProgress:0});const t=e.filter((e=>null!=e.progress.bytesTotal)),n=e.filter((e=>null==e.progress.bytesTotal));if(0===t.length){const t=100*e.length,r=n.reduce(((e,t)=>e+t.progress.percentage),0),i=Math.round(r/t*100);return void this.setState({totalProgress:i})}let r=t.reduce(((e,t)=>e+t.progress.bytesTotal),0);const i=r/t.length;r+=i*n.length;let o=0;t.forEach((e=>{o+=e.progress.bytesUploaded})),n.forEach((e=>{o+=i*(e.progress.percentage||0)/100}));let a=0===r?0:Math.round(o/r*100);a>100&&(a=100),this.setState({totalProgress:a}),this.emit("progress",a)}updateOnlineStatus(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,t){if("function"!=typeof e)throw new TypeError(`Expected a plugin class, but got ${null===e?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`);const n=new e(this,t),r=n.id;if(!r)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");const i=this.getPlugin(r);if(i){const e=`Already found a plugin named '${i.id}'. Tried to use: '${r}'.\nUppy plugins must have unique \`id\` options. See https://uppy.io/docs/plugins/#id.`;throw new Error(e)}return e.VERSION&&this.log(`Using ${r} v${e.VERSION}`),n.type in L(this,O)[O]?L(this,O)[O][n.type].push(n):L(this,O)[O][n.type]=[n],n.install(),this}getPlugin(e){for(const t of Object.values(L(this,O)[O])){const n=t.find((t=>t.id===e));if(null!=n)return n}}[C](e){return L(this,O)[O][e]}iteratePlugins(e){Object.values(L(this,O)[O]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=L(this,O)[O][e.type],n=t.findIndex((t=>t.id===e.id));-1!==n&&t.splice(n,1);const r={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(r)}close(e){let{reason:t}=void 0===e?{}:e;this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll({reason:t}),L(this,k)[k](),this.iteratePlugins((e=>{this.removePlugin(e)})),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("online",L(this,K)[K]),window.removeEventListener("offline",L(this,K)[K]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,n){void 0===t&&(t="info"),void 0===n&&(n=3e3);const r="object"==typeof e;this.setState({info:[...this.getState().info,{type:t,message:r?e.message:e,details:r?e.details:null}]}),setTimeout((()=>this.hideInfo()),n),this.emit("info-visible")}log(e,t){const{logger:n}=this.opts;switch(t){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e)}}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?L(this,J)[J](e):(L(this,Q)[Q](e),Promise.reject(new Error("Nonexistent upload")))}[M](){return L(this,$)[$](...arguments)}addResultData(e,t){if(!L(this,X)[X](e))return void this.log(`Not setting result for an upload that has been removed: ${e}`);const{currentUploads:n}=this.getState(),r={...n[e],result:{...n[e].result,...t}};this.setState({currentUploads:{...n,[e]:r}})}upload(){var e;null!=(e=L(this,O)[O].uploader)&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();const n=this.opts.onBeforeUpload(t);return!1===n?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(n&&"object"==typeof n&&(t=n,this.setState({files:t})),Promise.resolve().then((()=>L(this,N)[N].validateMinNumberOfFiles(t))).catch((e=>{throw L(this,G)[G]([e]),e})).then((()=>{if(!L(this,j)[j](t))throw new x(this.i18n("missingRequiredMetaField"))})).catch((e=>{throw e})).then((()=>{const{currentUploads:e}=this.getState(),n=Object.values(e).flatMap((e=>e.fileIDs)),r=[];Object.keys(t).forEach((e=>{const t=this.getFile(e);t.progress.uploadStarted||-1!==n.indexOf(e)||r.push(t.id)}));const i=L(this,$)[$](r);return L(this,J)[J](i)})).catch((e=>{throw this.emit("error",e),this.log(e,"error"),e})))}}function te(e){for(const t of e){const{file:e,isRestriction:n}=t;n?this.emit("restriction-failed",e,t):this.emit("error",t),this.log(t,"warning")}const t=e.filter((e=>e.isUserFacing)),n=t.slice(0,4),r=t.slice(4);n.forEach((e=>{let{message:t,details:n=""}=e;this.info({message:t,details:n},"error",this.opts.infoTimeout)})),r.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:r.length})})}function ne(e){const{missingFields:t,error:n}=L(this,N)[N].getMissingRequiredMetaFields(e);return!(t.length>0&&(this.setFileState(e.id,{missingRequiredMetaFields:t}),this.log(n.message),this.emit("restriction-failed",e,n),1))}function re(e){let t=!0;for(const n of Object.values(e))L(this,V)[V](n)||(t=!1);return t}function ie(e){const{allowNewUpload:t}=this.getState();if(!1===t){const t=new x(this.i18n("noMoreFilesAllowed"),{file:e});throw L(this,G)[G]([t]),t}}function oe(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,n=(0,m.Z)(t),r=function(e,t){return t.name?t.name:"image"===e.split("/")[0]?`${e.split("/")[0]}.${e.split("/")[1]}`:"noname"}(n,t),i=(0,g.Z)(r).extension,o=Boolean(t.isRemote),a=(0,y.H)(t),s=t.meta||{};s.name=r,s.type=n;const l=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:a,name:r,extension:i||"",meta:{...this.getState().meta,...s},type:n,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isRemote:o,remote:t.remote||"",preview:t.preview}}function ae(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((()=>{this.scheduledAutoProceed=null,this.upload().catch((e=>{e.isRestriction||this.log(e.stack||e.message||e)}))}),4))}function se(e){const{files:t}=this.getState(),n={...t},r=[],i=[];for(const a of e)try{var o;let e=L(this,Z)[Z](a);if(null!=(o=t[e.id])&&o.isGhost){const{isGhost:n,...r}=t[e.id];e={...r,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${e.name}, ${e.id}`)}const i=this.opts.onBeforeFileAdded(e,n);if(!i&&this.checkIfFileAlreadyExists(e.id))throw new x(this.i18n("noDuplicates",{fileName:e.name}),{file:a});if(!1===i)throw new x("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});"object"==typeof i&&null!==i&&(e=i),L(this,N)[N].validateSingleFile(e),n[e.id]=e,r.push(e)}catch(e){i.push(e)}try{L(this,N)[N].validateAggregateRestrictions(Object.values(t),r)}catch(e){return i.push(e),{nextFilesState:t,validFilesToAdd:[],errors:i}}return{nextFilesState:n,validFilesToAdd:r,errors:i}}function le(){const e=(e,t,n)=>{let r=e.message||"Unknown error";e.details&&(r+=` ${e.details}`),this.setState({error:r}),null!=t&&t.id in this.getState().files&&this.setFileState(t.id,{error:r,response:n})};let t;this.on("error",e),this.on("upload-error",((t,n,r)=>{if(e(n,t,r),"object"==typeof n&&n.message){this.log(n.message,"error");const e=new Error(this.i18n("failedToUpload",{file:null==t?void 0:t.name}));e.isUserFacing=!0,e.details=n.message,n.details&&(e.details+=` ${n.details}`),L(this,G)[G]([e])}else L(this,G)[G]([n])})),this.on("upload-stalled",((e,n)=>{const{message:r}=e,i=n.map((e=>e.meta.name)).join(", ");t||(this.info({message:r,details:i},"warning",this.opts.infoTimeout),t=setTimeout((()=>{t=null}),this.opts.infoTimeout)),this.log(`${r} ${i}`.trim(),"warning")})),this.on("upload",(()=>{this.setState({error:null})}));const n=e=>{const t=e.filter((e=>{const t=null!=e&&this.getFile(e.id);return t||this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`),t})),n=Object.fromEntries(t.map((e=>[e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}])));this.patchFilesState(n)};this.on("upload-start",(e=>{e.forEach((e=>{this.emit("upload-started",e)})),n(e)})),this.on("upload-progress",this.calculateProgress),this.on("upload-success",((e,t)=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const n=this.getFile(e.id).progress;this.setFileState(e.id,{progress:{...n,postprocess:L(this,z)[z].size>0?{mode:"indeterminate"}:null,uploadComplete:!0,percentage:100,bytesUploaded:n.bytesTotal},response:t,uploadURL:t.uploadURL,isPaused:!1}),null==e.size&&this.setFileState(e.id,{size:t.bytesUploaded||n.bytesTotal}),this.calculateTotalProgress()})),this.on("preprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,preprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("preprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.preprocess,this.setState({files:t})})),this.on("postprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getState().files[e.id].progress,postprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("postprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.postprocess,this.setState({files:t})})),this.on("restored",(()=>{this.calculateTotalProgress()})),this.on("dashboard:file-edit-complete",(e=>{e&&L(this,V)[V](e)})),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",L(this,K)[K]),window.addEventListener("offline",L(this,K)[K]),setTimeout(L(this,K)[K],3e3))}function ue(e,t){void 0===t&&(t={});const{forceAllowNewUpload:n=!1}=t,{allowNewUpload:r,currentUploads:i}=this.getState();if(!r&&!n)throw new Error("Cannot create a new upload: already uploading.");const a=(0,o.x)();return this.emit("upload",{id:a,fileIDs:e}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:{...i,[a]:{fileIDs:e,step:0,result:{}}}}),a}function ce(e){const{currentUploads:t}=this.getState();return t[e]}function de(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async function he(e){const t=()=>{const{currentUploads:t}=this.getState();return t[e]};let n=t();const r=[...L(this,B)[B],...L(this,U)[U],...L(this,z)[z]];try{for(let i=n.step||0;i<r.length&&n;i++){const o=r[i];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...n,step:i}}});const{fileIDs:a}=n;await o(a,e),n=t()}}catch(t){throw L(this,Q)[Q](e),t}if(n){n.fileIDs.forEach((e=>{const t=this.getFile(e);t&&t.progress.postprocess&&this.emit("postprocess-complete",t)}));const r=n.fileIDs.map((e=>this.getFile(e))),i=r.filter((e=>!e.error)),o=r.filter((e=>e.error));await this.addResultData(e,{successful:i,failed:o,uploadID:e}),n=t()}let i;return n&&(i=n.result,this.emit("complete",i),L(this,Q)[Q](e)),null==i&&this.log(`Not setting result for an upload that has been removed: ${e}`),i}ee.VERSION="3.4.0";const pe=ee;var fe=n(6400),me=n(8674),ge=n(9507),ye=n(8596);function ve(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var be=0;function _e(e){return"__private_"+be+++"_"+e}var Ee=_e("updateUI");class we extends ye.Z{constructor(){super(...arguments),Object.defineProperty(this,Ee,{writable:!0,value:void 0})}getTargetPlugin(e){let t;if("object"==typeof e&&e instanceof we)t=e;else if("function"==typeof e){const n=e;this.uppy.iteratePlugins((e=>{e instanceof n&&(t=e)}))}return t}mount(e,t){const n=t.id,r=(0,me.Z)(e);if(r){this.isTargetDOMEl=!0;const t=document.createElement("div");return t.classList.add("uppy-Root"),ve(this,Ee)[Ee]=function(e){let t=null,n=null;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n=i,t||(t=Promise.resolve().then((()=>(t=null,e(...n))))),t}}((e=>{this.uppy.getPlugin(this.id)&&((0,fe.sY)(this.render(e),t),this.afterUpdate())})),this.uppy.log(`Installing ${n} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),(0,fe.sY)(this.render(this.uppy.getState()),t),this.el=t,r.appendChild(t),t.dir=this.opts.direction||(0,ge.Z)(t)||"ltr",this.onMount(),this.el}const i=this.getTargetPlugin(e);if(i)return this.uppy.log(`Installing ${n} to ${i.id}`),this.parent=i,this.el=i.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${n}`);let o=`Invalid target option given to ${n}.`;throw o+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}update(e){var t,n;null!=this.el&&(null==(t=(n=ve(this,Ee))[Ee])||t.call(n,e))}unmount(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove()),this.onUnmount()}onMount(){}onUnmount(){}}const Te=we},6880:(e,t,n)=>{"use strict";n.d(t,{Z:()=>zi});var r=n(8386);function i(e,t,n,r){return 0===n||e===t?e:0===r?t:e+(t-e)*2**(-r/n)}var o=n(9507);const a={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var s=n(6400),l=n(4184);function u(e){const t=[];let n,r;for(const{progress:i}of Object.values(e)){const{preprocess:e,postprocess:o}=i;null==r&&(e||o)&&({mode:n,message:r}=e||o),"determinate"===(null==e?void 0:e.mode)&&t.push(e.value),"determinate"===(null==o?void 0:o.mode)&&t.push(o.value)}return{mode:n,message:r,value:t.reduce(((e,n)=>e+n/t.length),0)}}var c=n(5158);function d(e){const t=(n=e,{hours:Math.floor(n/3600)%24,minutes:Math.floor(n/60)%60,seconds:Math.floor(n%60)});var n;return`${0===t.hours?"":`${t.hours}h`}${0===t.minutes?"":`${0===t.hours?t.minutes:` ${t.minutes.toString(10).padStart(2,"0")}`}m`}${0!==t.hours?"":`${0===t.minutes?t.seconds:` ${t.seconds.toString(10).padStart(2,"0")}`}s`}`}const h=()=>" Â· ";function p(e){const{newFiles:t,isUploadStarted:n,recoveredState:r,i18n:i,uploadState:o,isSomeGhost:u,startUpload:c}=e,d=l("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":o===a.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":u}),h=i(t&&n&&!r?"uploadXNewFiles":"uploadXFiles",{smart_count:t});return(0,s.h)("button",{type:"button",className:d,"aria-label":i("uploadXFiles",{smart_count:t}),onClick:c,disabled:u,"data-uppy-super-focusable":!0},h)}function f(e){const{i18n:t,uppy:n}=e;return(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":t("retryUpload"),onClick:()=>n.retryAll().catch((()=>{})),"data-uppy-super-focusable":!0,"data-cy":"retry"},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},(0,s.h)("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),t("retry"))}function m(e){const{i18n:t,uppy:n}=e;return(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:t("cancel"),"aria-label":t("cancel"),onClick:()=>n.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},(0,s.h)("g",{fill:"none",fillRule:"evenodd"},(0,s.h)("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),(0,s.h)("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function g(e){const{isAllPaused:t,i18n:n,isAllComplete:r,resumableUploads:i,uppy:o}=e,a=n(t?"resume":"pause");return(0,s.h)("button",{title:a,"aria-label":a,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:function(){return r?null:i?t?o.resumeAll():o.pauseAll():o.cancelAll()},"data-cy":"togglePauseResume","data-uppy-super-focusable":!0},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},(0,s.h)("g",{fill:"none",fillRule:"evenodd"},(0,s.h)("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),(0,s.h)("path",{fill:"#FFF",d:t?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"}))))}function y(e){const{i18n:t,doneButtonHandler:n}=e;return(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:n,"data-uppy-super-focusable":!0},t("done"))}function v(){return(0,s.h)("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},(0,s.h)("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))}function b(e){const{progress:t}=e,{value:n,mode:r,message:i}=t,o=Math.round(100*n);return(0,s.h)("div",{className:"uppy-StatusBar-content"},(0,s.h)(v,null),"determinate"===r?`${o}% Â· `:"",i)}function _(e){const{numUploads:t,complete:n,totalUploadedSize:r,totalSize:i,totalETA:o,i18n:a}=e,l=t>1;return(0,s.h)("div",{className:"uppy-StatusBar-statusSecondary"},l&&a("filesUploadedOfTotal",{complete:n,smart_count:t}),(0,s.h)("span",{className:"uppy-StatusBar-additionalInfo"},l&&h(),a("dataUploadedOfTotal",{complete:c(r),total:c(i)}),h(),a("xTimeLeft",{time:d(o)})))}function E(e){const{i18n:t,complete:n,numUploads:r}=e;return(0,s.h)("div",{className:"uppy-StatusBar-statusSecondary"},t("filesUploadedOfTotal",{complete:n,smart_count:r}))}function w(e){const{i18n:t,newFiles:n,startUpload:r}=e,i=l("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return(0,s.h)("div",{className:"uppy-StatusBar-statusSecondary"},(0,s.h)("div",{className:"uppy-StatusBar-statusSecondaryHint"},t("xMoreFilesAdded",{smart_count:n})),(0,s.h)("button",{type:"button",className:i,"aria-label":t("uploadXFiles",{smart_count:n}),onClick:r},t("upload")))}function T(e){const{i18n:t,supportsUploadProgress:n,totalProgress:r,showProgressDetails:i,isUploadStarted:o,isAllComplete:a,isAllPaused:l,newFiles:u,numUploads:c,complete:d,totalUploadedSize:h,totalSize:p,totalETA:f,startUpload:m}=e,g=u&&o;if(!o||a)return null;const y=t(l?"paused":"uploading");return(0,s.h)("div",{className:"uppy-StatusBar-content","aria-label":y,title:y},l?null:(0,s.h)(v,null),(0,s.h)("div",{className:"uppy-StatusBar-status"},(0,s.h)("div",{className:"uppy-StatusBar-statusPrimary"},n?`${y}: ${r}%`:y),l||g||!i?null:n?(0,s.h)(_,{numUploads:c,complete:d,totalUploadedSize:h,totalSize:p,totalETA:f,i18n:t}):(0,s.h)(E,{i18n:t,complete:d,numUploads:c}),g?(0,s.h)(w,{i18n:t,newFiles:u,startUpload:m}):null))}function A(e){const{i18n:t}=e;return(0,s.h)("div",{className:"uppy-StatusBar-content",role:"status",title:t("complete")},(0,s.h)("div",{className:"uppy-StatusBar-status"},(0,s.h)("div",{className:"uppy-StatusBar-statusPrimary"},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},(0,s.h)("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),t("complete"))))}function S(e){const{error:t,i18n:n,complete:r,numUploads:i}=e;return(0,s.h)("div",{className:"uppy-StatusBar-content",title:n("uploadFailed")},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},(0,s.h)("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),(0,s.h)("div",{className:"uppy-StatusBar-status"},(0,s.h)("div",{className:"uppy-StatusBar-statusPrimary"},n("uploadFailed"),(0,s.h)("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":n("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:function(){const e=`${n("uploadFailed")} \n\n ${t}`;alert(e)},type:"button"},"?")),(0,s.h)(E,{i18n:n,complete:r,numUploads:i})))}const{STATE_ERROR:x,STATE_WAITING:I,STATE_PREPROCESSING:R,STATE_UPLOADING:C,STATE_POSTPROCESSING:M,STATE_COMPLETE:L}=a,P={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};function D(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var O=0;function N(e){return"__private_"+O+++"_"+e}function k(e,t,n,r){if(e)return a.STATE_ERROR;if(t)return a.STATE_COMPLETE;if(n)return a.STATE_WAITING;let i=a.STATE_WAITING;const o=Object.keys(r);for(let e=0;e<o.length;e++){const{progress:t}=r[o[e]];if(t.uploadStarted&&!t.uploadComplete)return a.STATE_UPLOADING;t.preprocess&&i!==a.STATE_UPLOADING&&(i=a.STATE_PREPROCESSING),t.postprocess&&i!==a.STATE_UPLOADING&&i!==a.STATE_PREPROCESSING&&(i=a.STATE_POSTPROCESSING)}return i}var F=N("lastUpdateTime"),B=N("previousUploadedBytes"),U=N("previousSpeed"),z=N("previousETA"),G=N("computeSmoothETA"),V=N("onUploadStart");class j extends r.di{constructor(e,t){super(e,t),Object.defineProperty(this,G,{value:H}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch((()=>{})),Object.defineProperty(this,V,{writable:!0,value:()=>{const{recoveredState:e}=this.uppy.getState();if(D(this,U)[U]=null,D(this,z)[z]=null,e)return D(this,B)[B]=Object.values(e.files).reduce(((e,t)=>{let{progress:n}=t;return e+n.bytesUploaded}),0),void this.uppy.emit("restore-confirmed");D(this,F)[F]=performance.now(),D(this,B)[B]=0}}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=P,this.opts={target:"body",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null,...t},this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){const{capabilities:t,files:n,allowNewUpload:r,totalProgress:i,error:o,recoveredState:a}=e,{newFiles:c,startedFiles:d,completeFiles:h,isUploadStarted:v,isAllComplete:_,isAllErrored:E,isAllPaused:w,isUploadInProgress:P,isSomeGhost:O}=this.uppy.getObjectOfFilesPerState(),N=a?Object.values(n):c,F=!!t.resumableUploads,B=!1!==t.uploadProgress;let U=0,z=0;d.forEach((e=>{U+=e.progress.bytesTotal||0,z+=e.progress.bytesUploaded||0}));const V=D(this,G)[G]({uploaded:z,total:U,remaining:U-z});return function(e){const{newFiles:t,allowNewUpload:n,isUploadInProgress:r,isAllPaused:i,resumableUploads:o,error:a,hideUploadButton:c,hidePauseResumeButton:d,hideCancelButton:h,hideRetryButton:v,recoveredState:_,uploadState:E,totalProgress:w,files:P,supportsUploadProgress:D,hideAfterFinish:O,isSomeGhost:N,doneButtonHandler:k,isUploadStarted:F,i18n:B,startUpload:U,uppy:z,isAllComplete:G,showProgressDetails:V,numUploads:j,complete:H,totalSize:Z,totalETA:q,totalUploadedSize:W}=e,Y=function(){switch(E){case M:case R:{const e=u(P);return"determinate"===e.mode?100*e.value:w}case x:return null;case C:return D?w:null;default:return w}}(),K=function(){if(_)return!1;switch(E){case I:return c||0===t;case L:return O;default:return!1}}(),$=null!=Y?Y:100,X=!a&&t&&!r&&!i&&n&&!c,Q=!h&&E!==I&&E!==L,J=o&&!d&&E===C,ee=a&&!G&&!v,te=k&&E===L,ne=l("uppy-StatusBar-progress",{"is-indeterminate":function(){switch(E){case M:case R:{const{mode:e}=u(P);return"indeterminate"===e}case C:return!D;default:return!1}}()}),re=l("uppy-StatusBar",`is-${E}`,{"has-ghosts":N});return(0,s.h)("div",{className:re,"aria-hidden":K},(0,s.h)("div",{className:ne,style:{width:`${$}%`},role:"progressbar","aria-label":`${$}%`,"aria-valuetext":`${$}%`,"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":Y}),(()=>{switch(E){case R:case M:return(0,s.h)(b,{progress:u(P)});case L:return(0,s.h)(A,{i18n:B});case x:return(0,s.h)(S,{error:a,i18n:B,numUploads:j,complete:H});case C:return(0,s.h)(T,{i18n:B,supportsUploadProgress:D,totalProgress:w,showProgressDetails:V,isUploadStarted:F,isAllComplete:G,isAllPaused:i,newFiles:t,numUploads:j,complete:H,totalUploadedSize:W,totalSize:Z,totalETA:q,startUpload:U});default:return null}})(),(0,s.h)("div",{className:"uppy-StatusBar-actions"},_||X?(0,s.h)(p,{newFiles:t,isUploadStarted:F,recoveredState:_,i18n:B,isSomeGhost:N,startUpload:U,uploadState:E}):null,ee?(0,s.h)(f,{i18n:B,uppy:z}):null,J?(0,s.h)(g,{isAllPaused:i,i18n:B,isAllComplete:G,resumableUploads:o,uppy:z}):null,Q?(0,s.h)(m,{i18n:B,uppy:z}):null,te?(0,s.h)(y,{i18n:B,doneButtonHandler:k}):null))}({error:o,uploadState:k(o,_,a,e.files||{}),allowNewUpload:r,totalProgress:i,totalSize:U,totalUploadedSize:z,isAllComplete:!1,isAllPaused:w,isAllErrored:E,isUploadStarted:v,isUploadInProgress:P,isSomeGhost:O,recoveredState:a,complete:h.length,newFiles:N.length,numUploads:d.length,totalETA:V,files:n,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:F,supportsUploadProgress:B,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})}onMount(){const e=this.el;(0,o.Z)(e)||(e.dir="ltr")}install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",D(this,V)[V]),D(this,F)[F]=performance.now(),D(this,B)[B]=this.uppy.getFiles().reduce(((e,t)=>e+t.progress.bytesUploaded),0)}uninstall(){this.unmount(),this.uppy.off("upload",D(this,V)[V])}}function H(e){var t;if(0===e.total||0===e.remaining)return 0;null!=(t=D(this,F))[F]||(t[F]=performance.now());const n=performance.now()-D(this,F)[F];var r;if(0===n)return Math.round((null!=(r=D(this,z)[z])?r:0)/100)/10;const o=e.uploaded-D(this,B)[B];var a;if(D(this,B)[B]=e.uploaded,o<=0)return Math.round((null!=(a=D(this,z)[z])?a:0)/100)/10;const s=o/n,l=null==D(this,U)[U]?s:i(s,D(this,U)[U],2e3,n);D(this,U)[U]=l;const u=e.remaining/l,c=Math.max(D(this,z)[z]-n,0),d=null==D(this,z)[z]?u:i(u,c,2e3,n);return D(this,z)[z]=d,D(this,F)[F]=performance.now(),Math.round(d/100)/10}j.VERSION="3.2.4";class Z extends s.wA{constructor(){super(...arguments),this.ref=(0,s.Vf)()}componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,300)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,300)}render(){const{children:e}=this.props;return(0,s.h)("div",{className:"uppy-Informer-animated",ref:this.ref},e)}}function q(e){const t={};for(let o=0;o<e.length;o++)null!=e[o]&&(t[(n=e[o],r=o.toString(36),void 0,null!=(i=null==n?void 0:n.key)?i:r)]=e[o]);var n,r,i;return t}function W(e,t){e=e||{},t=t||{};const n=n=>t.hasOwnProperty(n)?t[n]:e[n],r={};let i=[];for(const n in e)t.hasOwnProperty(n)?i.length&&(r[n]=i,i=[]):i.push(n);const o={};for(const e in t){if(r.hasOwnProperty(e))for(let t=0;t<r[e].length;t++){const i=r[e][t];o[r[e][t]]=n(i)}o[e]=n(e)}for(let e=0;e<i.length;e++)o[i[e]]=n(i[e]);return o}class Y extends s.wA{constructor(e,t){super(e,t),this.refs={},this.state={children:q((0,s.bR)((0,s.bR)(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){const e=this.state.children;for(const t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){const t=q((0,s.bR)(e.children)||[]),n=this.state.children;let r;for(r in this.setState((e=>({children:W(e.children,t)}))),t)if(t.hasOwnProperty(r)){const e=n&&n.hasOwnProperty(r);t[r]&&e&&this.currentlyTransitioningKeys[r]?(this.keysToEnter.push(r),this.keysToAbortLeave.push(r)):!t[r]||e||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r)}for(r in n)if(n.hasOwnProperty(r)){const e=t&&t.hasOwnProperty(r);!n[r]||e||this.currentlyTransitioningKeys[r]||this.keysToLeave.push(r)}}componentDidUpdate(){const{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);const{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){const t=this.keysToAbortLeave.indexOf(e);-1!==t&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];null!=t&&t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){const t=this.refs[e];null!=t&&t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const n=q((0,s.bR)(this.props.children)||[]);n&&n.hasOwnProperty(e)||this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];null!=t&&t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){const t=this.refs[e];null!=t&&t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const n=q((0,s.bR)(this.props.children)||[]);n&&n.hasOwnProperty(e)||this.performLeave(e)}performLeave(e){if(-1!==this.keysToAbortLeave.indexOf(e))return;this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];null!=t&&t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(-1!==this.keysToAbortLeave.indexOf(e))return;const t=this.refs[e];null!=t&&t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];const n=q((0,s.bR)(this.props.children)||[]);if(n&&n.hasOwnProperty(e))this.performEnter(e);else{const t=(r={},i=this.state.children,Object.assign(r,i));delete t[e],this.setState({children:t})}var r,i}render(e,t){let{childFactory:n,transitionLeave:r,transitionName:i,transitionAppear:o,transitionEnter:a,transitionLeaveTimeout:l,transitionEnterTimeout:u,transitionAppearTimeout:c,component:d,...h}=e,{children:p}=t;const f=Object.entries(p).map((e=>{let[t,r]=e;if(!r)return;const i=function(e,t){const n=e._ptgLinkedRefs||(e._ptgLinkedRefs={});return n[t]||(n[t]=n=>{e.refs[t]=n})}(this,t);return(0,s.Tm)(n(r),{ref:i,key:t})})).filter(Boolean);return(0,s.h)(d,h,f)}}Y.defaultProps={component:"span",childFactory:e=>e};const K=Y;class $ extends r.di{constructor(e,t){super(e,t),this.render=e=>(0,s.h)("div",{className:"uppy uppy-Informer"},(0,s.h)(K,null,e.info.map((e=>(0,s.h)(Z,{key:e.message},(0,s.h)("p",{role:"alert"},e.message," ",e.details&&(0,s.h)("span",{"aria-label":e.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${e.message} \n\n ${e.details}`)},"?"))))))),this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer",this.opts={...t}}install(){const{target:e}=this.opts;e&&this.mount(e,this)}}$.VERSION="3.0.3";const X=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function Q(e){return e.startsWith("blob:")}function J(e){return!!e&&/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te="undefined"!=typeof self?self:global;const ne="undefined"!=typeof navigator,re=ne&&"undefined"==typeof HTMLImageElement,ie=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),oe=te.Buffer,ae=!!oe,se=e=>void 0!==e;function le(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(se).length)}function ue(e){let t=new Error(e);throw delete t.stack,t}function ce(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const de=e=>String.fromCharCode.apply(null,e),he="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class pe{static from(e,t){return e instanceof this&&e.le===t?e:new pe(e,void 0,void 0,t)}constructor(e,t=0,n,r){if("boolean"==typeof r&&(this.le=r),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===n&&(n=e.byteLength-t);let r=new DataView(e,t,n);this._swapDataView(r)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof pe){void 0===n&&(n=e.byteLength-t),(t+=e.byteOffset)+n>e.byteOffset+e.byteLength&&ue("Creating view outside of available memory in ArrayBuffer");let r=new DataView(e.buffer,t,n);this._swapDataView(r)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else ue("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,n=pe){return e instanceof DataView||e instanceof pe?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||ue("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new n(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new pe(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return n=this.getUint8Array(e,t),he?he.decode(n):ae?Buffer.from(n).toString("utf8"):decodeURIComponent(escape(de(n)));var n}getLatin1String(e=0,t=this.byteLength){let n=this.getUint8Array(e,t);return de(n)}getUnicodeString(e=0,t=this.byteLength){const n=[];for(let r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return de(n)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}getUint(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function fe(e,t){ue(`${e} '${t}' was not loaded, try using full build of exifr.`)}class me extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||fe(this.kind,e),t&&(e in t||function(e,t){ue(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||fe(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var ge=new me("file parser"),ye=new me("segment parser"),ve=new me("file reader");let be=te.fetch;function _e(e,t){return(n=e).startsWith("data:")||n.length>1e4?we(e,t,"base64"):ie&&e.includes("://")?Ee(e,t,"url",Te):ie?we(e,t,"fs"):ne?Ee(e,t,"url",Te):void ue("Invalid input argument");var n}async function Ee(e,t,n,r){return ve.has(n)?we(e,t,n):r?async function(e,t){let n=await t(e);return new pe(n)}(e,r):void ue(`Parser ${n} is not loaded`)}async function we(e,t,n){let r=new(ve.get(n))(e,t);return await r.read(),r}const Te=e=>be(e).then((e=>e.arrayBuffer())),Ae=e=>new Promise(((t,n)=>{let r=new FileReader;r.onloadend=()=>t(r.result||new ArrayBuffer),r.onerror=n,r.readAsArrayBuffer(e)}));class Se extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function xe(e,t,n){let r=new Se;for(let[e,t]of n)r.set(e,t);if(Array.isArray(t))for(let n of t)e.set(n,r);else e.set(t,r);return r}function Ie(e,t,n){let r,i=e.get(t);for(r of n)i.set(r[0],r[1])}const Re=new Map,Ce=new Map,Me=new Map,Le=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Pe=["jfif","xmp","icc","iptc","ihdr"],De=["tiff",...Pe],Oe=["ifd0","ifd1","exif","gps","interop"],Ne=[...De,...Oe],ke=["makerNote","userComment"],Fe=["translateKeys","translateValues","reviveValues","multiSegment"],Be=[...Fe,"sanitize","mergeOutput","silentErrors"];class Ue{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class ze extends Ue{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,n,r){if(super(),ee(this,"enabled",!1),ee(this,"skip",new Set),ee(this,"pick",new Set),ee(this,"deps",new Set),ee(this,"translateKeys",!1),ee(this,"translateValues",!1),ee(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=Oe.includes(e),this.canBeFiltered&&(this.dict=Re.get(e)),void 0!==n)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if("object"==typeof n){if(this.enabled=!0,this.parse=!1!==n.parse,this.canBeFiltered){let{pick:e,skip:t}=n;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(n)}else!0===n||!1===n?this.parse=this.enabled=n:ue(`Invalid options argument: ${n}`)}applyInheritables(e){let t,n;for(t of Fe)n=e[t],void 0!==n&&(this[t]=n)}translateTagSet(e,t){if(this.dict){let n,r,{tagKeys:i,tagValues:o}=this.dict;for(n of e)"string"==typeof n?(r=o.indexOf(n),-1===r&&(r=i.indexOf(Number(n))),-1!==r&&t.add(Number(i[r]))):t.add(n)}else for(let n of e)t.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,qe(this.pick,this.deps)):this.enabled&&this.pick.size>0&&qe(this.pick,this.deps)}}var Ge={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Ve=new Map;class je extends Ue{static useCached(e){let t=Ve.get(e);return void 0!==t||(t=new this(e),Ve.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):ue(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=ne?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of Le)this[e]=Ge[e];for(e of Be)this[e]=Ge[e];for(e of ke)this[e]=Ge[e];for(e of Ne)this[e]=new ze(e,Ge[e],void 0,this)}setupFromTrue(){let e;for(e of Le)this[e]=Ge[e];for(e of Be)this[e]=Ge[e];for(e of ke)this[e]=!0;for(e of Ne)this[e]=new ze(e,!0,void 0,this)}setupFromArray(e){let t;for(t of Le)this[t]=Ge[t];for(t of Be)this[t]=Ge[t];for(t of ke)this[t]=Ge[t];for(t of Ne)this[t]=new ze(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Oe)}setupFromObject(e){let t;for(t of(Oe.ifd0=Oe.ifd0||Oe.image,Oe.ifd1=Oe.ifd1||Oe.thumbnail,Object.assign(this,e),Le))this[t]=Ze(e[t],Ge[t]);for(t of Be)this[t]=Ze(e[t],Ge[t]);for(t of ke)this[t]=Ze(e[t],Ge[t]);for(t of De)this[t]=new ze(t,Ge[t],e[t],this);for(t of Oe)this[t]=new ze(t,Ge[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Oe,Ne),!0===e.tiff?this.batchEnableWithBool(Oe,!0):!1===e.tiff?this.batchEnableWithUserValue(Oe,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Oe):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Oe)}batchEnableWithBool(e,t){for(let n of e)this[n].enabled=t}batchEnableWithUserValue(e,t){for(let n of e){let e=t[n];this[n].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,n,r=n){if(e&&e.length){for(let e of r)this[e].enabled=!1;let t=He(e,n);for(let[e,n]of t)qe(this[e].pick,n),this[e].enabled=!0}else if(t&&t.length){let e=He(t,n);for(let[t,n]of e)qe(this[t].skip,n)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:n,iptc:r,icc:i}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),n.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),i.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:n,interop:r}=this;r.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),n.needed&&e.deps.add(34853),this.tiff.enabled=Oe.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of Oe)this[e].finalizeFilters()}get onlyTiff(){return!Pe.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of De)this[e].enabled&&!ye.has(e)&&fe("segment parser",e)}}function He(e,t){let n,r,i,o,a=[];for(i of t){for(o of(n=Re.get(i),r=[],n))(e.includes(o[0])||e.includes(o[1]))&&r.push(o[0]);r.length&&a.push([i,r])}return a}function Ze(e,t){return void 0!==e?e:void 0!==t?t:void 0}function qe(e,t){for(let n of t)e.add(n)}ee(je,"default",Ge);class We{constructor(e){ee(this,"parsers",{}),ee(this,"output",{}),ee(this,"errors",[]),ee(this,"pushToErrors",(e=>this.errors.push(e))),this.options=je.useCached(e)}async read(e){this.file=await function(e,t){return"string"==typeof e?_e(e,t):ne&&!re&&e instanceof HTMLImageElement?_e(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new pe(e):ne&&e instanceof Blob?Ee(e,t,"blob",Ae):void ue("Invalid input argument")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[n,r]of ge)if(r.canHandle(e,t))return this.fileParser=new r(this.options,this.file,this.parsers),e[n]=!0;this.file.close&&this.file.close(),ue("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),le(n=e)?void 0:n;var n}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let n=await t.parse();t.assignToOutput(e,n)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,n=ye.get("tiff",e);var r;if(t.tiff?r={start:0,type:"tiff"}:t.jpeg&&(r=await this.fileParser.getOrFindSegment("tiff")),void 0===r)return;let i=await this.fileParser.ensureSegmentChunk(r),o=this.parsers.tiff=new n(i,e,t),a=await o.extractThumbnail();return t.close&&t.close(),a}}async function Ye(e,t){let n=new We(t);return await n.read(e),n.parse()}var Ke=Object.freeze({__proto__:null,parse:Ye,Exifr:We,fileParsers:ge,segmentParsers:ye,fileReaders:ve,tagKeys:Re,tagValues:Ce,tagRevivers:Me,createDictionary:xe,extendDictionary:Ie,fetchUrlAsArrayBuffer:Te,readBlobAsArrayBuffer:Ae,chunkedProps:Le,otherSegments:Pe,segments:De,tiffBlocks:Oe,segmentsAndBlocks:Ne,tiffExtractables:ke,inheritables:Fe,allFormatters:Be,Options:je});class $e{static findPosition(e,t){let n=e.getUint16(t+2)+2,r="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,i=t+r,o=n-r;return{offset:t,length:n,headerLength:r,start:i,size:o,end:i+o}}static parse(e,t={}){return new this(e,new je({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof pe?e:new pe(e)}constructor(e,t={},n){ee(this,"errors",[]),ee(this,"raw",new Map),ee(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let n=Me.get(t),r=Ce.get(t),i=Re.get(t),o=this.options[t],a=o.reviveValues&&!!n,s=o.translateValues&&!!r,l=o.translateKeys&&!!i,u={};for(let[t,o]of e)a&&n.has(t)?o=n.get(t)(o):s&&r.has(t)&&(o=this.translateValue(o,r.get(t))),l&&i.has(t)&&(t=i.get(t)||t),u[t]=o;return u}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,n){if(this.globalOptions.mergeOutput)return Object.assign(e,n);e[t]?Object.assign(e[t],n):e[t]=n}}function Xe(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function Qe(e){return e>=224&&e<=239}function Je(e,t,n){for(let[r,i]of ye)if(i.canHandle(e,t,n))return r}ee($e,"headerLength",4),ee($e,"type",void 0),ee($e,"multiSegment",!1),ee($e,"canHandle",(()=>!1));class et extends class{constructor(e,t,n){ee(this,"errors",[]),ee(this,"ensureSegmentChunk",(async e=>{let t=e.start,n=e.size||65536;if(this.file.chunked)if(this.file.available(t,n))e.chunk=this.file.subarray(t,n);else try{e.chunk=await this.file.readChunk(t,n)}catch(t){ue(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+n?e.chunk=this.file.subarray(t,n):void 0===e.size?e.chunk=this.file.subarray(t):ue("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=n}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let n=new(ye.get(e))(t,this.options,this.file);return this.parsers[e]=n}createParsers(e){for(let t of e){let{type:e,chunk:n}=t,r=this.options[e];if(r&&r.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),ee(this,"appSegments",[]),ee(this,"jpegSegments",[]),ee(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(ye.keyList())):(e=void 0===e?ye.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&ye.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:n,findAll:r,wanted:i,remaining:o}=this;if(!r&&this.file.chunked&&(r=Array.from(i).some((e=>{let t=ye.get(e),n=this.options[e];return t.multiSegment&&n.multiSegment})),r&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,n.byteLength),!this.options.onlyTiff&&n.chunked){let t=!1;for(;o.size>0&&!t&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:r}=n,i=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>r&&!i?!await n.readNextChunk(e):!await n.readNextChunk(r),void 0===(e=this.findAppSegmentsInRange(e,n.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let n,r,i,o,a,s,{file:l,findAll:u,wanted:c,remaining:d,options:h}=this;for(;e<t;e++)if(255===l.getUint8(e))if(n=l.getUint8(e+1),Qe(n)){if(r=l.getUint16(e+2),i=Je(l,e,r),i&&c.has(i)&&(o=ye.get(i),a=o.findPosition(l,e),s=h[i],a.type=i,this.appSegments.push(a),!u&&(o.multiSegment&&s.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||d.delete(i)):d.delete(i),0===d.size)))break;h.recordUnknownSegments&&(a=$e.findPosition(l,e),a.marker=n,this.unknownSegments.push(a)),e+=r+1}else if(Xe(n)){if(r=l.getUint16(e+2),218===n&&!1!==h.stopAfterSos)return;h.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let n,r,i,o=new Map;for(let t=0;t<e.length;t++)n=e[t],r=n.type,o.has(r)?i=o.get(r):o.set(r,i=[]),i.push(n);return Array.from(o)}(this.appSegments);this.mergedAppSegments=e.map((([e,t])=>{let n=ye.get(e,this.options);return n.handleMultiSegments?{type:e,chunk:n.handleMultiSegments(t)}:t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}ee(et,"type","jpeg"),ge.set("jpeg",et);const tt=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class nt extends $e{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,n=new Map){let{pick:r,skip:i}=this.options[t];r=new Set(r);let o=r.size>0,a=0===i.size,s=this.chunk.getUint16(e);e+=2;for(let l=0;l<s;l++){let s=this.chunk.getUint16(e);if(o){if(r.has(s)&&(n.set(s,this.parseTag(e,s,t)),r.delete(s),0===r.size))break}else!a&&i.has(s)||n.set(s,this.parseTag(e,s,t));e+=12}return n}parseTag(e,t,n){let{chunk:r}=this,i=r.getUint16(e+2),o=r.getUint32(e+4),a=tt[i];if(a*o<=4?e+=8:e=r.getUint32(e+8),(i<1||i>13)&&ue(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${t.toString(16)}, type: ${i}, offset ${e}`),e>r.byteLength&&ue(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${t.toString(16)}, type: ${i}, offset ${e} is outside of chunk size ${r.byteLength}`),1===i)return r.getUint8Array(e,o);if(2===i)return""===(s=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(s=r.getString(e,o)).trim())?void 0:s;var s;if(7===i)return r.getUint8Array(e,o);if(1===o)return this.parseTagValue(i,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(i))(o),n=a;for(let r=0;r<o;r++)t[r]=this.parseTagValue(i,e),e+=n;return t}}parseTagValue(e,t){let{chunk:n}=this;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:case 13:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);default:ue(`Invalid tiff type ${e}`)}}}class rt extends nt{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let n=new Map;return this[t]=n,this.parseTags(e,t,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&ue("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&ue(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,ce(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,ce(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let n=e.get(t);n&&1===n.length&&e.set(t,n[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",it(...e.get(2),e.get(1))),e.set("longitude",it(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,n,r={};for(t of Oe)if(e=this[t],!le(e))if(n=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(r,n)}else r[t]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[n,r]of Object.entries(t))this.assignObjectToOutput(e,n,r)}}function it(e,t,n,r){var i=e+t/60+n/3600;return"S"!==r&&"W"!==r||(i*=-1),i}ee(rt,"type","tiff"),ee(rt,"headerLength",10),ye.set("tiff",rt),Object.freeze({__proto__:null,default:Ke,Exifr:We,fileParsers:ge,segmentParsers:ye,fileReaders:ve,tagKeys:Re,tagValues:Ce,tagRevivers:Me,createDictionary:xe,extendDictionary:Ie,fetchUrlAsArrayBuffer:Te,readBlobAsArrayBuffer:Ae,chunkedProps:Le,otherSegments:Pe,segments:De,tiffBlocks:Oe,segmentsAndBlocks:Ne,tiffExtractables:ke,inheritables:Fe,allFormatters:Be,Options:je,parse:Ye});const ot={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},ot,{firstChunkSize:4e4,gps:[1,2,3,4]}),Object.assign({},ot,{tiff:!1,ifd1:!0,mergeOutput:!1});const at=Object.assign({},ot,{firstChunkSize:4e4,ifd0:[274]}),st=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let lt=!0,ut=!0;if("object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,e,n]=t,r=Number(e)+.1*Number(n);lt=r<13.4,ut=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);lt=ut=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);lt=ut=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);lt=ut=Number(t)<77}}class ct extends pe{constructor(...e){super(...e),ee(this,"ranges",new dt),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,n){if(0===e&&0===this.byteLength&&n){let e=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(e)}else{let n=e+t;if(n>this.byteLength){let{dataView:e}=this._extend(n);this._swapDataView(e)}}}_extend(e){let t;t=ae?oe.allocUnsafe(e):new Uint8Array(e);let n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}subarray(e,t,n=!1){return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,n=!1){n&&this._tryExtend(t,e.byteLength,e);let r=super.set(e,t);return this.ranges.add(t,r.byteLength),r}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class dt{constructor(){ee(this,"list",[])}get length(){return this.list.length}add(e,t,n=0){let r=e+t,i=this.list.filter((t=>ht(e,t.offset,r)||ht(e,t.end,r)));if(i.length>0){e=Math.min(e,...i.map((e=>e.offset))),r=Math.max(r,...i.map((e=>e.end))),t=r-e;let n=i.shift();n.offset=e,n.length=t,n.end=r,this.list=this.list.filter((e=>!i.includes(e)))}else this.list.push({offset:e,length:t,end:r})}available(e,t){let n=e+t;return this.list.some((t=>t.offset<=e&&n<=t.end))}}function ht(e,t,n){return e<=t&&t<=n}class pt extends ct{constructor(e,t){super(0),ee(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,n=await this.readChunk(e,t);return!!n&&n.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}ve.set("blob",class extends pt{async readWhole(){this.chunked=!1;let e=await Ae(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let n=t?e+t:void 0,r=this.input.slice(e,n),i=await Ae(r);return this.set(i,e,!0)}});const ft={strings:{generatingThumbnails:"Generating thumbnails..."}};class mt extends r.di{constructor(e,t){if(super(e,t),this.onFileAdded=e=>{!e.preview&&e.data&&J(e.type)&&!e.isRemote&&this.addToQueue(e.id)},this.onCancelRequest=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1)},this.onFileRemoved=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1),e.preview&&Q(e.preview)&&URL.revokeObjectURL(e.preview)},this.onRestored=()=>{this.uppy.getFiles().filter((e=>e.isRestored)).forEach((e=>{e.preview&&!Q(e.preview)||this.addToQueue(e.id)}))},this.onAllFilesRemoved=()=>{this.queue=[]},this.waitUntilAllProcessed=e=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-progress",t,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})}));const t=()=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-complete",t)}))};return new Promise((e=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",(()=>{t(),e()})):(t(),e())}))},this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType||"image/jpeg",this.defaultLocale=ft,this.opts={thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1,...t},this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,n){const r=URL.createObjectURL(e.data),i=new Promise(((e,t)=>{const n=new Image;n.src=r,n.addEventListener("load",(()=>{URL.revokeObjectURL(r),e(n)})),n.addEventListener("error",(e=>{URL.revokeObjectURL(r),t(e.error||new Error("Could not create thumbnail"))}))})),o=async function(e){let t=await async function(e){let t=new We(at);await t.read(e);let n=await t.parse();if(n&&n.ifd0)return n.ifd0[274]}(e);return Object.assign({canvas:lt,css:ut},st[t])}(e.data).catch((()=>1));return Promise.all([i,o]).then((e=>{let[r,i]=e;const o=this.getProportionalDimensions(r,t,n,i.deg),a=function(e,t){let n=e.width,r=e.height;90!==t.deg&&270!==t.deg||(n=e.height,r=e.width);const i=document.createElement("canvas");i.width=n,i.height=r;const o=i.getContext("2d");return o.translate(n/2,r/2),t.canvas&&(o.rotate(t.rad),o.scale(t.scaleX,t.scaleY)),o.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),i}(r,i);return function(e,t,n){try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise((r=>{e.toBlob(r,t,n)})).then((e=>{if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e})):Promise.resolve().then((()=>function(e,t,n){var r,i;const o=X.exec(e),a=null!=(r=null!=(i=t.mimeType)?i:null==o?void 0:o[1])?r:"plain/text";let s;if(null!=o[2]){const e=atob(decodeURIComponent(o[3])),t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);s=[t]}else s=[decodeURIComponent(o[3])];return new Blob(s,{type:a})}(e.toDataURL(t,n),{}))).then((e=>{if(null===e)throw new Error("could not extract blob, probably an old browser");return e}))}(this.resizeImage(a,o.width,o.height),this.thumbnailType,80)})).then((e=>URL.createObjectURL(e)))}getProportionalDimensions(e,t,n,r){let i=e.width/e.height;return 90!==r&&270!==r||(i=e.height/e.width),null!=t?{width:t,height:Math.round(t/i)}:null!=n?{width:Math.round(n*i),height:n}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/i)}}resizeImage(e,t,n){let r=function(e){const t=e.width/e.height,n=5e6,r=4096;let i=Math.floor(Math.sqrt(n*t)),o=Math.floor(n/Math.sqrt(n*t));if(i>r&&(i=r,o=Math.round(i/t)),o>r&&(o=r,i=Math.round(t*o)),e.width>i){const t=document.createElement("canvas");return t.width=i,t.height=o,t.getContext("2d").drawImage(e,0,0,i,o),t}return e}(e),i=Math.ceil(Math.log2(r.width/t));i<1&&(i=1);let o=t*2**(i-1),a=n*2**(i-1);for(;i--;){const e=document.createElement("canvas");e.width=o,e.height=a,e.getContext("2d").drawImage(r,0,0,o,a),r=e,o=Math.round(o/2),a=Math.round(a/2)}return r}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch((()=>{})).then((()=>this.processQueue())):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return J(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then((t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)})).catch((t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)})):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}mt.VERSION="3.0.4";var gt=n(1423);function yt(e){if("string"==typeof e){const t=document.querySelectorAll(e);return 0===t.length?null:Array.from(t)}return"object"==typeof e&&(0,gt.Z)(e)?[e]:null}var vt=n(7581);function bt(e,t,n,r){let{onSuccess:i}=r;e.readEntries((r=>{const o=[...t,...r];r.length?queueMicrotask((()=>{bt(e,o,n,{onSuccess:i})})):i(o)}),(e=>{n(e),i(t)}))}function _t(e,t){return null==e?e:{kind:e.isFile?"file":e.isDirectory?"directory":void 0,name:e.name,getFile:()=>new Promise(((t,n)=>e.file(t,n))),async*values(){const n=e.createReader(),r=await new Promise((e=>{bt(n,[],t,{onSuccess:n=>e(n.map((e=>_t(e,t))))})}));yield*r}}}function Et(e,t,n){try{return void 0===n&&(n=void 0),async function*(){const r=()=>`${t}/${e.name}`;if("file"===e.kind){const i=await e.getFile();null!=i?(i.relativePath=t?r():null,yield i):null!=n&&(yield n)}else if("directory"===e.kind)for await(const n of e.values())yield*Et(n,t?r():e.name);else null!=n&&(yield n)}()}catch(e){return Promise.reject(e)}}var wt=n(6729);class Tt extends Error{constructor(e){super(e),this.name="TimeoutError"}}class At extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const St=e=>void 0===globalThis.DOMException?new At(e):new DOMException(e),xt=e=>{const t=void 0===e.reason?St("This operation was aborted."):e.reason;return t instanceof Error?t:St(t)};var It,Rt=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Ct{constructor(){It.set(this,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&Rt(this,It,"f")[this.size-1].priority>=t.priority)return void Rt(this,It,"f").push(n);const r=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let a=r+o;n(e[a],t)<=0?(r=++a,i-=o+1):i=o}return r}(Rt(this,It,"f"),n,((e,t)=>t.priority-e.priority));Rt(this,It,"f").splice(r,0,n)}dequeue(){const e=Rt(this,It,"f").shift();return null==e?void 0:e.run}filter(e){return Rt(this,It,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return Rt(this,It,"f").length}}It=new WeakMap;var Mt,Lt,Pt,Dt,Ot,Nt,kt,Ft,Bt,Ut,zt,Gt,Vt,jt,Ht,Zt,qt,Wt,Yt,Kt,$t,Xt,Qt,Jt,en,tn,nn=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},rn=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class on extends Error{}class an extends wt{constructor(e){var t,n,r,i;if(super(),Mt.add(this),Lt.set(this,void 0),Pt.set(this,void 0),Dt.set(this,0),Ot.set(this,void 0),Nt.set(this,void 0),kt.set(this,0),Ft.set(this,void 0),Bt.set(this,void 0),Ut.set(this,void 0),zt.set(this,void 0),Gt.set(this,0),Vt.set(this,void 0),jt.set(this,void 0),Ht.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Ct,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(i=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==i?i:""}\` (${typeof e.interval})`);nn(this,Lt,e.carryoverConcurrencyCount,"f"),nn(this,Pt,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),nn(this,Ot,e.intervalCap,"f"),nn(this,Nt,e.interval,"f"),nn(this,Ut,new e.queueClass,"f"),nn(this,zt,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,nn(this,Ht,!0===e.throwOnTimeout,"f"),nn(this,jt,!1===e.autoStart,"f")}get concurrency(){return rn(this,Vt,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);nn(this,Vt,e,"f"),rn(this,Mt,"m",Jt).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:rn(this,Ht,"f"),...t},new Promise(((n,r)=>{rn(this,Ut,"f").enqueue((async()=>{var i,o,a;nn(this,Gt,(o=rn(this,Gt,"f"),++o),"f"),nn(this,Dt,(a=rn(this,Dt,"f"),++a),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)throw new on("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=function(e,t,n,r){let i;const o=new Promise(((o,a)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((r={customTimers:{setTimeout,clearTimeout},...r}).signal){const{signal:e}=r;e.aborted&&a(xt(e)),e.addEventListener("abort",(()=>{a(xt(e))}))}i=r.customTimers.setTimeout.call(void 0,(()=>{const r=n instanceof Error?n:new Tt(`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),a(r)}),t),(async()=>{try{o(await e)}catch(e){a(e)}finally{r.customTimers.clearTimeout.call(void 0,i)}})()}else o(e)}));return o.clear=()=>{clearTimeout(i),i=void 0},o}(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,rn(this,Mt,"m",en).call(this,t.signal)]));const o=await r;n(o),this.emit("completed",o)}catch(e){if(e instanceof Tt&&!t.throwOnTimeout)return void n();r(e),this.emit("error",e)}finally{rn(this,Mt,"m",Wt).call(this)}}),t),this.emit("add"),rn(this,Mt,"m",$t).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return rn(this,jt,"f")?(nn(this,jt,!1,"f"),rn(this,Mt,"m",Jt).call(this),this):this}pause(){nn(this,jt,!0,"f")}clear(){nn(this,Ut,new(rn(this,zt,"f")),"f")}async onEmpty(){0!==rn(this,Ut,"f").size&&await rn(this,Mt,"m",tn).call(this,"empty")}async onSizeLessThan(e){rn(this,Ut,"f").size<e||await rn(this,Mt,"m",tn).call(this,"next",(()=>rn(this,Ut,"f").size<e))}async onIdle(){0===rn(this,Gt,"f")&&0===rn(this,Ut,"f").size||await rn(this,Mt,"m",tn).call(this,"idle")}get size(){return rn(this,Ut,"f").size}sizeBy(e){return rn(this,Ut,"f").filter(e).length}get pending(){return rn(this,Gt,"f")}get isPaused(){return rn(this,jt,"f")}}Lt=new WeakMap,Pt=new WeakMap,Dt=new WeakMap,Ot=new WeakMap,Nt=new WeakMap,kt=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,Ut=new WeakMap,zt=new WeakMap,Gt=new WeakMap,Vt=new WeakMap,jt=new WeakMap,Ht=new WeakMap,Mt=new WeakSet,Zt=function(){return rn(this,Pt,"f")||rn(this,Dt,"f")<rn(this,Ot,"f")},qt=function(){return rn(this,Gt,"f")<rn(this,Vt,"f")},Wt=function(){var e;nn(this,Gt,(e=rn(this,Gt,"f"),--e),"f"),rn(this,Mt,"m",$t).call(this),this.emit("next")},Yt=function(){rn(this,Mt,"m",Qt).call(this),rn(this,Mt,"m",Xt).call(this),nn(this,Bt,void 0,"f")},Kt=function(){const e=Date.now();if(void 0===rn(this,Ft,"f")){const t=rn(this,kt,"f")-e;if(!(t<0))return void 0===rn(this,Bt,"f")&&nn(this,Bt,setTimeout((()=>{rn(this,Mt,"m",Yt).call(this)}),t),"f"),!0;nn(this,Dt,rn(this,Lt,"f")?rn(this,Gt,"f"):0,"f")}return!1},$t=function(){if(0===rn(this,Ut,"f").size)return rn(this,Ft,"f")&&clearInterval(rn(this,Ft,"f")),nn(this,Ft,void 0,"f"),this.emit("empty"),0===rn(this,Gt,"f")&&this.emit("idle"),!1;if(!rn(this,jt,"f")){const e=!rn(this,Mt,"a",Kt);if(rn(this,Mt,"a",Zt)&&rn(this,Mt,"a",qt)){const t=rn(this,Ut,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&rn(this,Mt,"m",Xt).call(this),!0)}}return!1},Xt=function(){rn(this,Pt,"f")||void 0!==rn(this,Ft,"f")||(nn(this,Ft,setInterval((()=>{rn(this,Mt,"m",Qt).call(this)}),rn(this,Nt,"f")),"f"),nn(this,kt,Date.now()+rn(this,Nt,"f"),"f"))},Qt=function(){0===rn(this,Dt,"f")&&0===rn(this,Gt,"f")&&rn(this,Ft,"f")&&(clearInterval(rn(this,Ft,"f")),nn(this,Ft,void 0,"f")),nn(this,Dt,rn(this,Lt,"f")?rn(this,Gt,"f"):0,"f"),rn(this,Mt,"m",Jt).call(this)},Jt=function(){for(;rn(this,Mt,"m",$t).call(this););},en=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new on("The task was aborted."))}),{once:!0})}))},tn=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))};var sn=n(1988);function ln(){return(0,s.h)("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},(0,s.h)("g",{fill:"none","fill-rule":"evenodd"},(0,s.h)("circle",{fill:"#FFF",cx:"13",cy:"13",r:"13"}),(0,s.h)("path",{d:"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z",fill:"#4285F4","fill-rule":"nonzero"}),(0,s.h)("path",{d:"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z",fill:"#34A853","fill-rule":"nonzero"}),(0,s.h)("path",{d:"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05","fill-rule":"nonzero"}),(0,s.h)("path",{d:"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z",fill:"#EA4335","fill-rule":"nonzero"}),(0,s.h)("path",{d:"M4 4h18v18H4z"})))}const un=function(e){const{pluginName:t,pluginIcon:n,i18nArray:r,handleAuth:i}=e,o="Google Drive"===t,a=(0,s.h)("span",{className:"uppy-Provider-authTitleName"},t,(0,s.h)("br",null));return(0,s.h)("div",{className:"uppy-Provider-auth"},(0,s.h)("div",{className:"uppy-Provider-authIcon"},n()),(0,s.h)("div",{className:"uppy-Provider-authTitle"},r("authenticateWithTitle",{pluginName:a})),o?(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google",onClick:i,"data-uppy-super-focusable":!0},(0,s.h)(ln,null),r("signInWithGoogle")):(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onClick:i,"data-uppy-super-focusable":!0},r("authenticateWith",{pluginName:t})))},cn=e=>{const{getFolder:t,title:n,isLast:r}=e;return(0,s.h)(s.HY,null,(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn",onClick:t},n),r?"":" / ")},dn=e=>{const t=[];return e.showBreadcrumbs&&t.push((e=>{const{getFolder:t,title:n,breadcrumbsIcon:r,breadcrumbs:i}=e;return(0,s.h)("div",{className:"uppy-Provider-breadcrumbs"},(0,s.h)("div",{className:"uppy-Provider-breadcrumbsIcon"},r),i.map(((e,r)=>(0,s.h)(cn,{key:e.id,getFolder:()=>t(e.requestPath),title:0===r?n:e.name,isLast:r+1===i.length}))))})({getFolder:e.getFolder,breadcrumbs:e.breadcrumbs,breadcrumbsIcon:e.pluginIcon&&e.pluginIcon(),title:e.title})),t.push((e=>{let{i18n:t,logout:n,username:r}=e;return[(0,s.h)("span",{className:"uppy-ProviderBrowser-user",key:"username"},r),(0,s.h)("button",{type:"button",onClick:n,className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout",key:"logout"},t("logOut"))]})({logout:e.logout,username:e.username,i18n:e.i18n})),t};var hn=n(3454);function pn(e){return{...e,type:e.mimeType,extension:e.name?(0,hn.Z)(e.name).extension:null}}var fn,mn,gn,yn,vn=0,bn=[],_n=[],En=s.YM.__b,wn=s.YM.__r,Tn=s.YM.diffed,An=s.YM.__c,Sn=s.YM.unmount;function xn(e,t){s.YM.__h&&s.YM.__h(mn,e,vn||t),vn=0;var n=mn.__H||(mn.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:_n}),n.__[e]}function In(e){return vn=1,function(e,t,n){var r=xn(fn++,2);if(r.t=e,!r.__c&&(r.__=[Fn(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=mn,!mn.u)){var i=function(e,t,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter((function(e){return e.__c}));if(i.every((function(e){return!e.__N})))return!o||o.call(this,e,t,n);var a=!1;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}})),!(!a&&r.__c.props===e)&&(!o||o.call(this,e,t,n))};mn.u=!0;var o=mn.shouldComponentUpdate,a=mn.componentWillUpdate;mn.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,i(e,t,n),o=r}a&&a.call(this,e,t,n)},mn.shouldComponentUpdate=i}return r.__N||r.__}(Fn,e)}function Rn(e,t){var n=xn(fn++,3);!s.YM.__s&&kn(n.__H,t)&&(n.__=e,n.i=t,mn.__H.__h.push(n))}function Cn(e,t){var n=xn(fn++,7);return kn(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}function Mn(e,t){return vn=8,Cn((function(){return e}),t)}function Ln(){for(var e;e=bn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(On),e.__H.__h.forEach(Nn),e.__H.__h=[]}catch(t){e.__H.__h=[],s.YM.__e(t,e.__v)}}s.YM.__b=function(e){mn=null,En&&En(e)},s.YM.__r=function(e){wn&&wn(e),fn=0;var t=(mn=e.__c).__H;t&&(gn===mn?(t.__h=[],mn.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=_n,e.__N=e.i=void 0}))):(t.__h.forEach(On),t.__h.forEach(Nn),t.__h=[],fn=0)),gn=mn},s.YM.diffed=function(e){Tn&&Tn(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==bn.push(t)&&yn===s.YM.requestAnimationFrame||((yn=s.YM.requestAnimationFrame)||Dn)(Ln)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==_n&&(e.__=e.__V),e.i=void 0,e.__V=_n}))),gn=mn=null},s.YM.__c=function(e,t){t.some((function(e){try{e.__h.forEach(On),e.__h=e.__h.filter((function(e){return!e.__||Nn(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],s.YM.__e(n,e.__v)}})),An&&An(e,t)},s.YM.unmount=function(e){Sn&&Sn(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{On(e)}catch(e){t=e}})),n.__H=void 0,t&&s.YM.__e(t,n.__v))};var Pn="function"==typeof requestAnimationFrame;function Dn(e){var t,n=function(){clearTimeout(r),Pn&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Pn&&(t=requestAnimationFrame(n))}function On(e){var t=mn,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),mn=t}function Nn(e){var t=mn;e.__c=e.__(),mn=t}function kn(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function Fn(e,t){return"function"==typeof t?t(e):t}function Bn(){return Bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bn.apply(this,arguments)}const Un={position:"relative",width:"100%",minHeight:"100%"},zn={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class Gn extends s.wA{constructor(e){super(e),this.handleScroll=()=>{this.setState({offset:this.base.scrollTop})},this.handleResize=()=>{this.resize()},this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){this.focusElement&&this.focusElement.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}resize(){const{height:e}=this.state;e!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render(e){let{data:t,rowHeight:n,renderRow:r,overscanCount:i=10,...o}=e;const{offset:a,height:l}=this.state;let u=Math.floor(a/n),c=Math.floor(l/n);i&&(u=Math.max(0,u-u%i),c+=i);const d=u+c+4,h=t.slice(u,d),p={...Un,height:t.length*n},f={...zn,top:u*n};return(0,s.h)("div",Bn({onScroll:this.handleScroll},o),(0,s.h)("div",{role:"presentation",style:p},(0,s.h)("div",{role:"presentation",style:f},h.map(r))))}}const Vn=Gn;var jn=n(9022);function Hn(e){const{search:t,searchOnInput:n,searchTerm:r,showButton:i,inputLabel:o,clearSearchLabel:a,buttonLabel:l,clearSearch:u,inputClassName:c,buttonCSSClassName:d}=e,[h,p]=In(null!=r?r:""),f=Mn((e=>{e.preventDefault(),t(h)}),[t,h]),m=Mn((e=>{const r=e.target.value;p(r),n&&t(r)}),[p,n,t]),[g]=In((()=>{const e=document.createElement("form");return e.setAttribute("tabindex","-1"),e.id=(0,jn.x)(),e}));return Rn((()=>(document.body.appendChild(g),g.addEventListener("submit",f),()=>{g.removeEventListener("submit",f),document.body.removeChild(g)})),[g,f]),(0,s.h)(s.HY,null,(0,s.h)("input",{className:`uppy-u-reset ${c}`,type:"search","aria-label":o,placeholder:o,value:h,onInput:m,form:g.id,"data-uppy-super-focusable":!0}),!i&&(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon",width:"12",height:"12",viewBox:"0 0 12 12"},(0,s.h)("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})),!i&&h&&(0,s.h)("button",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterReset",type:"button","aria-label":a,title:a,onClick:()=>{p(""),u&&u()}},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",viewBox:"0 0 19 19"},(0,s.h)("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"}))),i&&(0,s.h)("button",{className:`uppy-u-reset uppy-c-btn uppy-c-btn-primary ${d}`,type:"submit",form:g.id},l))}const Zn=e=>{let{cancel:t,done:n,i18n:r,selected:i}=e;return(0,s.h)("div",{className:"uppy-ProviderBrowser-footer"},(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",onClick:n,type:"button"},r("selectX",{smart_count:i})),(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onClick:t,type:"button"},r("cancel")))};function qn(){return(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58"},(0,s.h)("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"}))}function Wn(){return(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157"},(0,s.h)("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"}))}function Yn(){return(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58"},(0,s.h)("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),(0,s.h)("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))}const Kn=e=>{const{itemIconString:t}=e;if(null!==t)switch(t){case"file":return(0,s.h)(qn,null);case"folder":return(0,s.h)(Wn,null);case"video":return(0,s.h)(Yn,null);default:{const{alt:n}=e;return(0,s.h)("img",{src:t,alt:n,loading:"lazy",width:16,height:16})}}},$n=function(e){const{className:t,isDisabled:n,restrictionError:r,isChecked:i,title:o,itemIconEl:a,showTitles:u,toggleCheckbox:c,recordShiftKeyPress:d,id:h,children:p}=e,f=l("uppy-u-reset","uppy-ProviderBrowserItem-checkbox","uppy-ProviderBrowserItem-checkbox--grid",{"uppy-ProviderBrowserItem-checkbox--is-checked":i});return(0,s.h)("li",{className:t,title:n?null==r?void 0:r.message:null},(0,s.h)("input",{type:"checkbox",className:f,onChange:c,onKeyDown:d,onMouseDown:d,name:"listitem",id:h,checked:i,disabled:n,"data-uppy-super-focusable":!0}),(0,s.h)("label",{htmlFor:h,"aria-label":o,className:"uppy-u-reset uppy-ProviderBrowserItem-inner"},a,u&&o,p))},Xn=function(e){const{className:t,isDisabled:n,restrictionError:r,isCheckboxDisabled:i,isChecked:o,toggleCheckbox:a,recordShiftKeyPress:l,type:u,id:c,itemIconEl:d,title:h,handleFolderClick:p,showTitles:f,i18n:m}=e;return(0,s.h)("li",{className:t,title:n?null==r?void 0:r.message:null},i?null:(0,s.h)("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox "+(o?"uppy-ProviderBrowserItem-checkbox--is-checked":""),onChange:a,onKeyDown:l,onMouseDown:l,name:"listitem",id:c,checked:o,"aria-label":"file"===u?null:m("allFilesFromFolderNamed",{name:h}),disabled:n,"data-uppy-super-focusable":!0}),"file"===u?(0,s.h)("label",{htmlFor:c,className:"uppy-u-reset uppy-ProviderBrowserItem-inner"},(0,s.h)("div",{className:"uppy-ProviderBrowserItem-iconWrap"},d),f&&h):(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",onClick:p,"aria-label":m("openFolderNamed",{name:h})},(0,s.h)("div",{className:"uppy-ProviderBrowserItem-iconWrap"},d),f&&(0,s.h)("span",null,h)))};function Qn(){return Qn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Qn.apply(this,arguments)}const Jn=e=>{const{author:t,getItemIcon:n,isChecked:r,isDisabled:i,viewType:o}=e,a=n(),u=l("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--selected":r},{"uppy-ProviderBrowserItem--disabled":i},{"uppy-ProviderBrowserItem--noPreview":"video"===a}),c=(0,s.h)(Kn,{itemIconString:a});switch(o){case"grid":return(0,s.h)($n,Qn({},e,{className:u,itemIconEl:c}));case"list":return(0,s.h)(Xn,Qn({},e,{className:u,itemIconEl:c}));case"unsplash":return(0,s.h)($n,Qn({},e,{className:u,itemIconEl:c}),(0,s.h)("a",{href:`${t.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",className:"uppy-ProviderBrowserItem-author",tabIndex:"-1"},t.name));default:throw new Error(`There is no such type ${o}`)}};function er(e){const{currentSelection:t,uppyFiles:n,viewType:r,isChecked:i,toggleCheckbox:o,recordShiftKeyPress:a,showTitles:s,i18n:l,validateRestrictions:u,getNextFolder:c,columns:d,f:h}=e;var p;if(h.isFolder)return Jn({columns:d,showTitles:s,viewType:r,i18n:l,id:h.id,title:h.name,getItemIcon:()=>h.icon,isChecked:i(h),toggleCheckbox:e=>o(e,h),recordShiftKeyPress:a,type:"folder",isDisabled:null==(p=i(h))?void 0:p.loading,isCheckboxDisabled:"shared-with-me"===h.id,handleFolderClick:()=>c(h)});const f=u(pn(h),[...n,...t]);return Jn({id:h.id,title:h.name,author:h.author,getItemIcon:()=>h.icon,isChecked:i(h),toggleCheckbox:e=>o(e,h),recordShiftKeyPress:a,columns:d,showTitles:s,viewType:r,i18n:l,type:"file",isDisabled:f&&!i(h),restrictionError:f})}const tr=function(e){const{currentSelection:t,folders:n,files:r,uppyFiles:i,viewType:o,headerComponent:a,showBreadcrumbs:u,isChecked:c,toggleCheckbox:d,recordShiftKeyPress:h,handleScroll:p,showTitles:f,i18n:m,validateRestrictions:g,isLoading:y,showSearchFilter:v,search:b,searchTerm:_,clearSearch:E,searchOnInput:w,searchInputLabel:T,clearSearchLabel:A,getNextFolder:S,cancel:x,done:I,columns:R,noResultsLabel:C,loadAllFiles:M}=e,L=t.length,P=Cn((()=>[...n,...r]),[n,r]);return(0,s.h)("div",{className:l("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${o}`)},a&&(0,s.h)("div",{className:"uppy-ProviderBrowser-header"},(0,s.h)("div",{className:l("uppy-ProviderBrowser-headerBar",!u&&"uppy-ProviderBrowser-headerBar--simple")},a)),v&&(0,s.h)("div",{class:"uppy-ProviderBrowser-searchFilter"},(0,s.h)(Hn,{search:b,searchTerm:_,clearSearch:E,inputLabel:T,clearSearchLabel:A,inputClassName:"uppy-ProviderBrowser-searchFilterInput",searchOnInput:w})),y?(0,s.h)("div",{className:"uppy-Provider-loading"},(0,s.h)("span",null,m("loading"))):n.length||r.length?M?(0,s.h)("div",{className:"uppy-ProviderBrowser-body"},(0,s.h)("ul",{className:"uppy-ProviderBrowser-list"},(0,s.h)(Vn,{data:P,renderRow:e=>(0,s.h)(er,{currentSelection:t,uppyFiles:i,viewType:o,isChecked:c,toggleCheckbox:d,recordShiftKeyPress:h,showTitles:f,i18n:m,validateRestrictions:g,getNextFolder:S,columns:R,f:e}),rowHeight:31}))):(0,s.h)("div",{className:"uppy-ProviderBrowser-body"},(0,s.h)("ul",{className:"uppy-ProviderBrowser-list",onScroll:p,role:"listbox",tabIndex:"-1"},P.map((e=>(0,s.h)(er,{currentSelection:t,uppyFiles:i,viewType:o,isChecked:c,toggleCheckbox:d,recordShiftKeyPress:h,showTitles:f,i18n:m,validateRestrictions:g,getNextFolder:S,columns:R,f:e}))))):(0,s.h)("div",{className:"uppy-Provider-empty"},C),L>0&&(0,s.h)(Zn,{selected:L,done:I,cancel:x,i18n:m}))},nr=e=>{let{i18n:t,loading:n}=e;return(0,s.h)("div",{className:"uppy-Provider-loading"},(0,s.h)("span",null,t("loading")),"string"==typeof n&&(0,s.h)("span",{style:{marginTop:".7em"}},n))};class rr extends s.wA{componentWillUnmount(){const{onUnmount:e}=this.props;e()}render(){const{children:e}=this.props;return(0,s.bR)(e)[0]}}var ir=n(3563);class or{constructor(e,t){this.filterItems=e=>{const t=this.plugin.getPluginState();return t.filterInput&&""!==t.filterInput?e.filter((e=>-1!==e.name.toLowerCase().indexOf(t.filterInput.toLowerCase()))):e},this.recordShiftKeyPress=e=>{this.isShiftKeyPressed=e.shiftKey},this.toggleCheckbox=(e,t)=>{e.stopPropagation(),e.preventDefault(),e.currentTarget.focus();const{folders:n,files:r}=this.plugin.getPluginState(),i=this.filterItems(n.concat(r));if(this.lastCheckbox&&this.isShiftKeyPressed){const{currentSelection:e}=this.plugin.getPluginState(),n=i.indexOf(this.lastCheckbox),r=i.indexOf(t),o=n<r?i.slice(n,r+1):i.slice(r,n+1),a=[];for(const e of o){const{uppy:t}=this.plugin,n=t.validateRestrictions(pn(e),[...t.getFiles(),...a]);n?t.info({message:n.message},"error",t.opts.infoTimeout):a.push(e)}return void this.plugin.setPluginState({currentSelection:[...new Set([...e,...a])]})}this.lastCheckbox=t;const{currentSelection:o}=this.plugin.getPluginState();this.isChecked(t)?this.plugin.setPluginState({currentSelection:o.filter((e=>e.id!==t.id))}):this.plugin.setPluginState({currentSelection:o.concat([t])})},this.isChecked=e=>{const{currentSelection:t}=this.plugin.getPluginState();return t.some((t=>t.id===e.id))},this.plugin=e,this.provider=t.provider,this.isHandlingScroll=!1,this.preFirstRender=this.preFirstRender.bind(this),this.handleError=this.handleError.bind(this),this.clearSelection=this.clearSelection.bind(this),this.cancelPicking=this.cancelPicking.bind(this)}preFirstRender(){this.plugin.setPluginState({didFirstRender:!0}),this.plugin.onFirstRender()}shouldHandleScroll(e){const{scrollHeight:t,scrollTop:n,offsetHeight:r}=e.target;return t-(n+r)<50&&!this.isHandlingScroll}clearSelection(){this.plugin.setPluginState({currentSelection:[],filterInput:""})}cancelPicking(){this.clearSelection();const e=this.plugin.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()}handleError(e){var t;const{uppy:n}=this.plugin,r=n.i18n("companionError");n.log(e.toString()),e.isAuthError||"AbortError"===(null==(t=e.cause)?void 0:t.name)||n.info({message:r,details:e.toString()},"error",5e3)}getTagFile(e){const t={id:e.id,source:this.plugin.id,data:e,name:e.name||e.id,type:e.mimeType,isRemote:!0,meta:{},body:{fileId:e.id},remote:{companionUrl:this.plugin.opts.companionUrl,url:`${this.provider.fileUrl(e.requestPath)}`,body:{fileId:e.id},providerOptions:this.provider.opts,providerName:this.provider.name,provider:this.provider.provider}},n=(0,ir.Z)(t);return n&&J(n)&&(t.preview=e.thumbnail),e.author&&(null!=e.author.name&&(t.meta.authorName=String(e.author.name)),e.author.url&&(t.meta.authorUrl=e.author.url)),null!=e.relDirPath&&(t.meta.relativePath=e.relDirPath?`${e.relDirPath}/${t.name}`:null),null!=e.absDirPath&&(t.meta.absolutePath=e.absDirPath?`/${e.absDirPath}/${t.name}`:`/${t.name}`),t}setLoading(e){this.plugin.setPluginState({loading:e})}}function ar(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var sr=0;function lr(e){return"__private_"+sr+++"_"+e}function ur(e,t){return e?`${e}/${t}`:t}function cr(){return(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30"},(0,s.h)("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))}var dr=lr("abortController"),hr=lr("withAbort"),pr=lr("list"),fr=lr("listFilesAndFolders"),mr=lr("recursivelyListAllFiles");class gr extends or{constructor(e,t){super(e,t),Object.defineProperty(this,mr,{value:_r}),Object.defineProperty(this,fr,{value:br}),Object.defineProperty(this,pr,{value:vr}),Object.defineProperty(this,hr,{value:yr}),Object.defineProperty(this,dr,{writable:!0,value:void 0}),this.opts={viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1,...t},this.filterQuery=this.filterQuery.bind(this),this.clearFilter=this.clearFilter.bind(this),this.getFolder=this.getFolder.bind(this),this.getNextFolder=this.getNextFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.plugin.setPluginState({authenticated:!1,files:[],folders:[],breadcrumbs:[],filterInput:"",isSearchVisible:!1,currentSelection:[]})}tearDown(){}async getFolder(e,t){this.setLoading(!0);try{await ar(this,hr)[hr]((async n=>{this.lastCheckbox=void 0;let{breadcrumbs:r}=this.plugin.getPluginState();const i=r.findIndex((t=>e===t.requestPath));r=-1!==i?r.slice(0,i+1):[...r,{requestPath:e,name:t}],this.nextPagePath=e;let o=[],a=[];do{const{files:e,folders:t}=await ar(this,fr)[fr]({breadcrumbs:r,signal:n});o=o.concat(e),a=a.concat(t),this.setLoading(this.plugin.uppy.i18n("loadedXFiles",{numFiles:o.length+a.length}))}while(this.opts.loadAllFiles&&this.nextPagePath);this.plugin.setPluginState({folders:a,files:o,breadcrumbs:r,filterInput:""})}))}catch(e){this.handleError(e)}finally{this.setLoading(!1)}}getNextFolder(e){this.getFolder(e.requestPath,e.name),this.lastCheckbox=void 0}async logout(){try{await ar(this,hr)[hr]((async e=>{const t=await this.provider.logout({signal:e});if(t.ok){if(!t.revoked){const e=this.plugin.uppy.i18n("companionUnauthorizeHint",{provider:this.plugin.title,url:t.manual_revoke_url});this.plugin.uppy.info(e,"info",7e3)}const e={authenticated:!1,files:[],folders:[],breadcrumbs:[],filterInput:""};this.plugin.setPluginState(e)}}))}catch(e){this.handleError(e)}}filterQuery(e){this.plugin.setPluginState({filterInput:e})}clearFilter(){this.plugin.setPluginState({filterInput:""})}async handleAuth(){const e=`@uppy/provider-views=${gr.VERSION}`;try{await this.provider.login({uppyVersions:e}),this.plugin.setPluginState({authenticated:!0}),this.preFirstRender()}catch(e){this.plugin.uppy.log(`login failed: ${e.message}`)}}async handleScroll(e){if(this.shouldHandleScroll(e)&&this.nextPagePath){this.isHandlingScroll=!0;try{await ar(this,hr)[hr]((async e=>{const{files:t,folders:n,breadcrumbs:r}=this.plugin.getPluginState(),{files:i,folders:o}=await ar(this,fr)[fr]({breadcrumbs:r,signal:e}),a=t.concat(i),s=n.concat(o);this.plugin.setPluginState({folders:s,files:a})}))}catch(e){this.handleError(e)}finally{this.isHandlingScroll=!1}}}async donePicking(){this.setLoading(!0);try{await ar(this,hr)[hr]((async e=>{const{currentSelection:t}=this.plugin.getPluginState(),n=[],r=[];for(const i of t){const{requestPath:t}=i,o=e=>({...e,relDirPath:e.absDirPath.replace(i.absDirPath,"").replace(/^\//,"")});if(i.isFolder){let a=!0,s=0;const l=new an({concurrency:6}),u=e=>{for(const t of e){const e=this.getTagFile(t),n=(0,sn.H)(e);this.plugin.uppy.checkIfFileAlreadyExists(n)||(r.push(o(t)),s++,this.setLoading(this.plugin.uppy.i18n("addedNumFiles",{numFiles:s}))),a=!1}};let c;await ar(this,mr)[mr]({requestPath:t,absDirPath:ur(i.absDirPath,i.name),relDirPath:i.name,queue:l,onFiles:u,signal:e}),await l.onIdle(),c=a?this.plugin.uppy.i18n("emptyFolderAdded"):0===s?this.plugin.uppy.i18n("folderAlreadyAdded",{folder:i.name}):this.plugin.uppy.i18n("folderAdded",{smart_count:s,folder:i.name}),n.push(c)}else r.push(o(i))}this.plugin.uppy.log("Adding remote provider files"),this.plugin.uppy.addFiles(r.map((e=>this.getTagFile(e)))),this.plugin.setPluginState({filterInput:""}),n.forEach((e=>this.plugin.uppy.info(e))),this.clearSelection()}))}catch(e){this.handleError(e)}finally{this.setLoading(!1)}}render(e,t){var n=this;void 0===t&&(t={});const{authenticated:r,didFirstRender:i}=this.plugin.getPluginState(),{i18n:o}=this.plugin.uppy;i||this.preFirstRender();const a={...this.opts,...t},{files:l,folders:u,filterInput:c,loading:d,currentSelection:h}=this.plugin.getPluginState(),{isChecked:p,toggleCheckbox:f,recordShiftKeyPress:m,filterItems:g}=this,y=""!==c,v=this.plugin.icon||cr,b={showBreadcrumbs:a.showBreadcrumbs,getFolder:this.getFolder,breadcrumbs:this.plugin.getPluginState().breadcrumbs,pluginIcon:v,title:this.plugin.title,logout:this.logout,username:this.username,i18n:o},_={isChecked:p,toggleCheckbox:f,recordShiftKeyPress:m,currentSelection:h,files:y?g(l):l,folders:y?g(u):u,username:this.username,getNextFolder:this.getNextFolder,getFolder:this.getFolder,loadAllFiles:this.opts.loadAllFiles,showSearchFilter:a.showFilter,search:this.filterQuery,clearSearch:this.clearFilter,searchTerm:c,searchOnInput:!0,searchInputLabel:o("filter"),clearSearchLabel:o("resetFilter"),noResultsLabel:o("noFilesFound"),logout:this.logout,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,headerComponent:dn(b),title:this.plugin.title,viewType:a.viewType,showTitles:a.showTitles,showBreadcrumbs:a.showBreadcrumbs,pluginIcon:v,i18n:this.plugin.uppy.i18n,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:function(){return n.plugin.uppy.validateRestrictions(...arguments)}};return d?(0,s.h)(rr,{onUnmount:this.clearSelection},(0,s.h)(nr,{i18n:this.plugin.uppy.i18n,loading:d})):r?(0,s.h)(rr,{onUnmount:this.clearSelection},(0,s.h)(tr,_)):(0,s.h)(rr,{onUnmount:this.clearSelection},(0,s.h)(un,{pluginName:this.plugin.title,pluginIcon:v,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,i18nArray:this.plugin.uppy.i18nArray}))}}async function yr(e){var t;null==(t=ar(this,dr)[dr])||t.abort();const n=new AbortController;ar(this,dr)[dr]=n;const r=()=>{n.abort(),this.clearSelection()};try{this.plugin.uppy.on("dashboard:close-panel",r),this.plugin.uppy.on("cancel-all",r),await e(n.signal)}finally{this.plugin.uppy.off("dashboard:close-panel",r),this.plugin.uppy.off("cancel-all",r),ar(this,dr)[dr]=void 0}}async function vr(e){let{requestPath:t,absDirPath:n,signal:r}=e;const{username:i,nextPagePath:o,items:a}=await this.provider.list(t,{signal:r});return this.username=i||this.username,{items:a.map((e=>({...e,absDirPath:n}))),nextPagePath:o}}async function br(e){let{breadcrumbs:t,signal:n}=e;const r=function(e){return e.slice(1).map((e=>e.name)).join("/")}(t),{items:i,nextPagePath:o}=await ar(this,pr)[pr]({requestPath:this.nextPagePath,absDirPath:r,signal:n});this.nextPagePath=o;const a=[],s=[];return i.forEach((e=>{e.isFolder?s.push(e):a.push(e)})),{files:a,folders:s}}async function _r(e){let{requestPath:t,absDirPath:n,relDirPath:r,queue:i,onFiles:o,signal:a}=e,s=t;for(;s;){const e=await ar(this,pr)[pr]({requestPath:s,absDirPath:n,signal:a});s=e.nextPagePath;const t=e.items.filter((e=>!e.isFolder)),l=e.items.filter((e=>e.isFolder));o(t);const u=l.map((async e=>i.add((async()=>ar(this,mr)[mr]({requestPath:e.requestPath,absDirPath:ur(n,e.name),relDirPath:ur(r,e.name),queue:i,onFiles:o,signal:a})))));await Promise.all(u)}}function Er(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}gr.VERSION="3.5.0";var wr=0;function Tr(e){return"__private_"+wr+++"_"+e}var Ar=Tr("updateFilesAndInputMode");function Sr(e,t){this.nextPageQuery=e.nextPageQuery,e.items.forEach((e=>{t.push(e)})),this.plugin.setPluginState({currentSelection:[],isInputMode:!1,files:t,searchTerm:e.searchedFor})}(class extends or{constructor(e,t){super(e,t),Object.defineProperty(this,Ar,{value:Sr}),this.opts={viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1,...t},this.search=this.search.bind(this),this.clearSearch=this.clearSearch.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.defaultState={isInputMode:!0,files:[],folders:[],breadcrumbs:[],filterInput:"",currentSelection:[],searchTerm:null},this.plugin.setPluginState(this.defaultState)}tearDown(){}resetPluginState(){this.plugin.setPluginState(this.defaultState)}async search(e){const{searchTerm:t}=this.plugin.getPluginState();if(!e||e!==t){this.setLoading(!0);try{const t=await this.provider.search(e);Er(this,Ar)[Ar](t,[])}catch(e){this.handleError(e)}finally{this.setLoading(!1)}}}clearSearch(){this.plugin.setPluginState({currentSelection:[],files:[],searchTerm:null})}async handleScroll(e){const t=this.nextPageQuery||null;if(this.shouldHandleScroll(e)&&t){this.isHandlingScroll=!0;try{const{files:e,searchTerm:n}=this.plugin.getPluginState(),r=await this.provider.search(n,t);Er(this,Ar)[Ar](r,e)}catch(e){this.handleError(e)}finally{this.isHandlingScroll=!1}}}donePicking(){const{currentSelection:e}=this.plugin.getPluginState();this.plugin.uppy.log("Adding remote search provider files"),this.plugin.uppy.addFiles(e.map((e=>this.getTagFile(e)))),this.resetPluginState()}render(e,t){var n=this;void 0===t&&(t={});const{didFirstRender:r,isInputMode:i,searchTerm:o}=this.plugin.getPluginState(),{i18n:a}=this.plugin.uppy;r||this.preFirstRender();const l={...this.opts,...t},{files:u,folders:c,filterInput:d,loading:h,currentSelection:p}=this.plugin.getPluginState(),{isChecked:f,toggleCheckbox:m,filterItems:g,recordShiftKeyPress:y}=this,v=""!==d,b={isChecked:f,toggleCheckbox:m,recordShiftKeyPress:y,currentSelection:p,files:v?g(u):u,folders:v?g(c):c,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,showSearchFilter:l.showFilter,search:this.search,clearSearch:this.clearSearch,searchTerm:o,searchOnInput:!1,searchInputLabel:a("search"),clearSearchLabel:a("resetSearch"),noResultsLabel:a("noSearchResults"),title:this.plugin.title,viewType:l.viewType,showTitles:l.showTitles,showFilter:l.showFilter,isLoading:h,showBreadcrumbs:l.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:a,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:function(){return n.plugin.uppy.validateRestrictions(...arguments)}};return i?(0,s.h)(rr,{onUnmount:this.resetPluginState},(0,s.h)("div",{className:"uppy-SearchProvider"},(0,s.h)(Hn,{search:this.search,clearSelection:this.clearSelection,inputLabel:a("enterTextToSearch"),buttonLabel:a("searchImages"),inputClassName:"uppy-c-textInput uppy-SearchProvider-input",buttonCSSClassName:"uppy-SearchProvider-searchButton",showButton:!0}))):(0,s.h)(rr,{onUnmount:this.resetPluginState},(0,s.h)(tr,b))}}).VERSION="3.5.0";var xr=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Ir(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!((r=e[n])===(i=t[n])||xr(r)&&xr(i)))return!1;var r,i;return!0}function Rr(e,t){void 0===t&&(t=Ir);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var o=e.apply(this,r);return n={lastResult:o,lastArgs:r,lastThis:this},o}return r.clear=function(){n=null},r}const Cr=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];function Mr(e,t){if(t){const n=e.querySelector(`[data-uppy-paneltype="${t}"]`);if(n)return n}return e}function Lr(e,t){const n=t[0];n&&(n.focus(),e.preventDefault())}function Pr(e,t,n){const r=Mr(n,t),i=(0,vt.Z)(r.querySelectorAll(Cr)),o=i.indexOf(document.activeElement);!function(e){return e.contains(document.activeElement)}(r)?Lr(e,i):e.shiftKey&&0===o?function(e,t){const n=t[t.length-1];n&&(n.focus(),e.preventDefault())}(e,i):e.shiftKey||o!==i.length-1||Lr(e,i)}var Dr=n(3279);function Or(){const e=document.body;return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&"FormData"in window&&"FileReader"in window}var Nr=n(81);function kr(e){const t={color:"#838999",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("g",{fill:"#A7AFB7",fillRule:"nonzero"},(0,s.h)("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),(0,s.h)("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})))};if(!e)return t;const n=e.split("/")[0],r=e.split("/")[1];return"text"===n?{color:"#5a5e69",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"}))}:"image"===n?{color:"#686de0",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("g",{fill:"#686DE0",fillRule:"evenodd"},(0,s.h)("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),(0,s.h)("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),(0,s.h)("circle",{cx:"7.5",cy:"9.5",r:"1.5"})))}:"audio"===n?{color:"#068dbb",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"}))}:"video"===n?{color:"#19af67",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"}))}:"application"===n&&"pdf"===r?{color:"#e25149",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"}))}:"application"===n&&-1!==["zip","x-7z-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(r)?{color:"#00C469",icon:(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},(0,s.h)("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"}))}:t}function Fr(e){const{file:t}=e;if(t.preview)return(0,s.h)("img",{className:"uppy-Dashboard-Item-previewImg",alt:t.name,src:t.preview});const{color:n,icon:r}=kr(t.type);return(0,s.h)("div",{className:"uppy-Dashboard-Item-previewIconWrap"},(0,s.h)("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:n}},r),(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76"},(0,s.h)("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})))}const Br=(e,t)=>{const n=("function"==typeof t?t():t).filter((t=>t.id===e));return n[0].name};function Ur(e){const{file:t,toggleFileCard:n,i18n:r,metaFields:i}=e,{missingRequiredMetaFields:o}=t;if(null==o||!o.length)return null;const a=o.map((e=>Br(e,i))).join(", ");return(0,s.h)("div",{className:"uppy-Dashboard-Item-errorMessage"},r("missingRequiredMetaFields",{smart_count:o.length,fields:a})," ",(0,s.h)("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>n(!0,t.id)},r("editFile")))}function zr(e){const{file:t,i18n:n,toggleFileCard:r,metaFields:i,showLinkToFileUploadResult:o}=e,a=t.preview?"rgba(255, 255, 255, 0.5)":kr(e.file.type).color;return(0,s.h)("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a}},o&&t.uploadURL&&(0,s.h)("a",{className:"uppy-Dashboard-Item-previewLink",href:t.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":t.meta.name},(0,s.h)("span",{hidden:!0},t.meta.name)),(0,s.h)(Fr,{file:t}),(0,s.h)(Ur,{file:t,i18n:n,toggleFileCard:r,metaFields:i}))}function Gr(e){return e.isUploaded?e.i18n("uploadComplete"):e.error?e.i18n("retryUpload"):e.resumableUploads?e.file.isPaused?e.i18n("resumeUpload"):e.i18n("pauseUpload"):e.individualCancellation?e.i18n("cancelUpload"):""}function Vr(e){return(0,s.h)("div",{className:"uppy-Dashboard-Item-progress"},(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":Gr(e),title:Gr(e),onClick:()=>function(e){e.isUploaded||(!e.error||e.hideRetryButton?e.resumableUploads&&!e.hidePauseResumeButton?e.uppy.pauseResume(e.file.id):e.individualCancellation&&!e.hideCancelButton&&e.uppy.removeFile(e.file.id):e.uppy.retryUpload(e.file.id))}(e)},e.children))}function jr(e){let{children:t}=e;return(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle"},t)}function Hr(e){let{progress:t}=e;const n=2*Math.PI*15;return(0,s.h)("g",null,(0,s.h)("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),(0,s.h)("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":n,"stroke-dashoffset":n-n/100*t}))}function Zr(e){return e.file.progress.uploadStarted?e.isUploaded?(0,s.h)("div",{className:"uppy-Dashboard-Item-progress"},(0,s.h)("div",{className:"uppy-Dashboard-Item-progressIndicator"},(0,s.h)(jr,null,(0,s.h)("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),(0,s.h)("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})))):e.recoveredState?void 0:e.error&&!e.hideRetryButton?(0,s.h)(Vr,e,(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19"},(0,s.h)("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),(0,s.h)("path",{d:"M7.9 3H10v2H7.9z"}),(0,s.h)("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),(0,s.h)("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"}))):e.resumableUploads&&!e.hidePauseResumeButton?(0,s.h)(Vr,e,(0,s.h)(jr,null,(0,s.h)(Hr,{progress:e.file.progress.percentage}),e.file.isPaused?(0,s.h)("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):(0,s.h)("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)"},(0,s.h)("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),(0,s.h)("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})))):e.resumableUploads||!e.individualCancellation||e.hideCancelButton?(0,s.h)("div",{className:"uppy-Dashboard-Item-progress"},(0,s.h)("div",{className:"uppy-Dashboard-Item-progressIndicator"},(0,s.h)(jr,null,(0,s.h)(Hr,{progress:e.file.progress.percentage})))):(0,s.h)(Vr,e,(0,s.h)(jr,null,(0,s.h)(Hr,{progress:e.file.progress.percentage}),(0,s.h)("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"}))):null}var qr=n(1737);const Wr="...";function Yr(e,t){if(0===t)return"";if(e.length<=t)return e;if(t<=4)return`${e.slice(0,t-1)}â¦`;const n=t-3,r=Math.ceil(n/2),i=Math.floor(n/2);return e.slice(0,r)+Wr+e.slice(-i)}const Kr=e=>{let{file:t,onClick:n}=e;return t.error?(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":t.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:n,type:"button"},"?"):null};function $r(e){const{file:t}=e;return(0,s.h)("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":t.source},(0,s.h)("div",{className:"uppy-Dashboard-Item-fileName"},(e=>{const{author:t,name:n}=e.file.meta;return(0,s.h)("div",{className:"uppy-Dashboard-Item-name",title:n},Yr(n,e.isSingleFile&&e.containerHeight>=350?90:e.containerWidth<=352?35:e.containerWidth<=576?60:t?20:30))})(e),(0,s.h)(Kr,{file:e.file,onClick:()=>alert(e.file.error)})),(0,s.h)("div",{className:"uppy-Dashboard-Item-status"},(e=>{const{author:t}=e.file.meta,{providerName:n}=e.file.remote;return t?(0,s.h)("div",{className:"uppy-Dashboard-Item-author"},(0,s.h)("a",{href:`${t.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer"},Yr(t.name,13)),n?(0,s.h)(s.HY,null," Â· ",n," Â· "):null):null})(e),(e=>e.file.size&&(0,s.h)("div",{className:"uppy-Dashboard-Item-statusSize"},qr(e.file.size)))(e),(e=>e.file.isGhost&&(0,s.h)("span",null," â¢ ",(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:e.toggleAddFilesPanel},e.i18n("reSelect"))))(e)),(0,s.h)(Ur,{file:e.file,i18n:e.i18n,toggleFileCard:e.toggleFileCard,metaFields:e.metaFields}))}function Xr(e){let{file:t,uploadInProgressOrComplete:n,metaFields:r,canEditFile:i,i18n:o,onClick:a}=e;return!n&&r&&r.length>0||!n&&i(t)?(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":o("editFileWithFilename",{file:t.meta.name}),title:o("editFileWithFilename",{file:t.meta.name}),onClick:()=>a()},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14"},(0,s.h)("g",{fillRule:"evenodd"},(0,s.h)("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),(0,s.h)("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),(0,s.h)("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})))):null}function Qr(e){let{i18n:t,onClick:n,file:r}=e;return(0,s.h)("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":t("removeFile",{file:r.meta.name}),title:t("removeFile",{file:r.meta.name}),onClick:()=>n()},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18"},(0,s.h)("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),(0,s.h)("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})))}const Jr=(e,t)=>{var n,r;(n=t.file.uploadURL,r=t.i18n("copyLinkToClipboardFallback"),void 0===r&&(r="Copy the URL below"),new Promise((e=>{const t=document.createElement("textarea");t.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),t.value=n,document.body.appendChild(t),t.select();const i=()=>{document.body.removeChild(t),window.prompt(r,n),e()};try{return document.execCommand("copy")?(document.body.removeChild(t),e()):i()}catch(e){return document.body.removeChild(t),i()}}))).then((()=>{t.uppy.log("Link copied to clipboard."),t.uppy.info(t.i18n("copyLinkToClipboardSuccess"),"info",3e3)})).catch(t.uppy.log).then((()=>e.target.focus({preventScroll:!0})))};function ei(e){const{i18n:t}=e;return(0,s.h)("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:t=>Jr(t,e)},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12"},(0,s.h)("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})))}function ti(e){const{uppy:t,file:n,uploadInProgressOrComplete:r,canEditFile:i,metaFields:o,showLinkToFileUploadResult:a,showRemoveButton:l,i18n:u,toggleFileCard:c,openFileEditor:d}=e;return(0,s.h)("div",{className:"uppy-Dashboard-Item-actionWrapper"},(0,s.h)(Xr,{i18n:u,file:n,uploadInProgressOrComplete:r,canEditFile:i,metaFields:o,onClick:()=>{o&&o.length>0?c(!0,n.id):d(n)}}),a&&n.uploadURL?(0,s.h)(ei,{file:n,uppy:t,i18n:u}):null,l?(0,s.h)(Qr,{i18n:u,file:n,uppy:t,onClick:()=>e.uppy.removeFile(n.id,"removed-by-user")}):null)}class ni extends s.wA{componentDidMount(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!Nr(this.props,e)}componentDidUpdate(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){const{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){const{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,n=e.progress.uploadComplete&&!t&&!e.error,r=e.progress.uploadStarted||t,i=e.progress.uploadStarted&&!e.progress.uploadComplete||t,o=e.error||!1,{isGhost:a}=e;let u=(this.props.individualCancellation||!i)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(u=!0);const c=l({"uppy-Dashboard-Item":!0,"is-inprogress":i&&!this.props.recoveredState,"is-processing":t,"is-complete":n,"is-error":!!o,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return(0,s.h)("div",{className:c,id:`uppy_${e.id}`,role:this.props.role},(0,s.h)("div",{className:"uppy-Dashboard-Item-preview"},(0,s.h)(zr,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),(0,s.h)(Zr,{uppy:this.props.uppy,file:e,error:o,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,showRemoveButtonAfterComplete:this.props.showRemoveButtonAfterComplete,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})),(0,s.h)("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons"},(0,s.h)($r,{file:e,id:this.props.id,acquirers:this.props.acquirers,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),(0,s.h)(ti,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:u,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})))}}const ri=e=>{let{id:t,error:n,i18n:r,uppy:i,files:o,acquirers:a,resumableUploads:l,hideRetryButton:u,hidePauseResumeButton:c,hideCancelButton:d,showLinkToFileUploadResult:h,showRemoveButtonAfterComplete:p,isWide:f,metaFields:m,isSingleFile:g,toggleFileCard:y,handleRequestThumbnail:v,handleCancelThumbnail:b,recoveredState:_,individualCancellation:E,itemsPerRow:w,openFileEditor:T,canEditFile:A,toggleAddFilesPanel:S,containerWidth:x,containerHeight:I}=e;const R=1===w?71:200,C=Cn((()=>{const e=Object.keys(o);return _&&e.sort(((e,t)=>o[t].isGhost-o[e].isGhost)),function(e,t){const n=[];let r=[];return e.forEach((e=>{r.length<t?r.push(e):(n.push(r),r=[e])})),r.length&&n.push(r),n}(e,w)}),[o,w,_]),M=e=>(0,s.h)("div",{class:"uppy-Dashboard-filesInner",role:"presentation",key:e[0]},e.map((e=>(0,s.h)(ni,{key:e,uppy:i,id:t,error:n,i18n:r,acquirers:a,resumableUploads:l,individualCancellation:E,hideRetryButton:u,hidePauseResumeButton:c,hideCancelButton:d,showLinkToFileUploadResult:h,showRemoveButtonAfterComplete:p,isWide:f,metaFields:m,recoveredState:_,isSingleFile:g,containerWidth:x,containerHeight:I,toggleFileCard:y,handleRequestThumbnail:v,handleCancelThumbnail:b,role:"listitem",openFileEditor:T,canEditFile:A,toggleAddFilesPanel:S,file:o[e]}))));return g?(0,s.h)("div",{class:"uppy-Dashboard-files"},M(C[0])):(0,s.h)(Vn,{class:"uppy-Dashboard-files",role:"list",data:C,renderRow:M,rowHeight:R})};let ii;ii=Symbol.for("uppy test: disable unused locale key warning");class oi extends s.wA{constructor(){super(...arguments),this.triggerFileInputClick=()=>{this.fileInput.click()},this.triggerFolderInputClick=()=>{this.folderInput.click()},this.triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput.click()},this.triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput.click()},this.onFileInputChange=e=>{this.props.handleInputChange(e),e.target.value=null},this.renderHiddenInput=(e,t)=>(0,s.h)("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:1!==this.props.maxNumberOfFiles,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes,ref:t}),this.renderHiddenCameraInput=(e,t,n)=>{const r={photo:"image/*",video:"video/*"}[e];return(0,s.h)("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t,accept:r,ref:n})},this.renderMyDeviceAcquirer=()=>(0,s.h)("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice"},(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick},(0,s.h)("div",{className:"uppy-DashboardTab-inner"},(0,s.h)("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},(0,s.h)("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"}))),(0,s.h)("div",{className:"uppy-DashboardTab-name"},this.props.i18n("myDevice")))),this.renderPhotoCamera=()=>(0,s.h)("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera"},(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick},(0,s.h)("div",{className:"uppy-DashboardTab-inner"},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},(0,s.h)("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"}))),(0,s.h)("div",{className:"uppy-DashboardTab-name"},this.props.i18n("takePictureBtn")))),this.renderVideoCamera=()=>(0,s.h)("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera"},(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick},(0,s.h)("div",{className:"uppy-DashboardTab-inner"},(0,s.h)("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32"},(0,s.h)("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "}))),(0,s.h)("div",{className:"uppy-DashboardTab-name"},this.props.i18n("recordVideoBtn")))),this.renderBrowseButton=(e,t)=>{const n=this.props.acquirers.length;return(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:t,"data-uppy-super-focusable":0===n},e)},this.renderDropPasteBrowseTagline=e=>{const t=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),n=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,i=r.charAt(0).toUpperCase()+r.slice(1);return(0,s.h)("div",{class:"uppy-Dashboard-AddFiles-title"},this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${i}`,{browseFiles:t,browseFolders:n,browse:t}):this.props.i18nArray(`dropPaste${i}`,{browseFiles:t,browseFolders:n,browse:t}))},this.renderAcquirer=e=>(0,s.h)("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id},(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":this.props.activePickerPanel.id===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id)},(0,s.h)("div",{className:"uppy-DashboardTab-inner"},e.icon()),(0,s.h)("div",{className:"uppy-DashboardTab-name"},e.name))),this.renderAcquirers=e=>{const t=[...e],n=t.splice(e.length-2,e.length);return(0,s.h)(s.HY,null,t.map((e=>this.renderAcquirer(e))),(0,s.h)("span",{role:"presentation",style:{"white-space":"nowrap"}},n.map((e=>this.renderAcquirer(e)))))},this.renderSourcesList=(e,t)=>{const{showNativePhotoCameraButton:n,showNativeVideoCameraButton:r}=this.props;let i=[];const o="myDevice";t||(i.push({key:o,elements:this.renderMyDeviceAcquirer()}),n&&i.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&i.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()})),i.push(...e.map((e=>({key:e.id,elements:this.renderAcquirer(e)})))),1===i.length&&i[0].key===o&&(i=[]);const a=[...i],l=a.splice(i.length-2,i.length),u=e=>e.map((e=>{let{key:t,elements:n}=e;return(0,s.h)(s.HY,{key:t},n)}));return(0,s.h)(s.HY,null,this.renderDropPasteBrowseTagline(i.length),(0,s.h)("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist"},u(a),(0,s.h)("span",{role:"presentation",style:{"white-space":"nowrap"}},u(l))))}}[ii](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderPoweredByUppy(){const{i18nArray:e}=this.props,t=e("poweredBy",{uppy:(0,s.h)("span",null,(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11"},(0,s.h)("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})),(0,s.h)("span",{className:"uppy-Dashboard-poweredByUppy"},"Uppy"))});return(0,s.h)("a",{tabIndex:"-1",href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy"},t)}render(){const{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:n}=this.props;return(0,s.h)("div",{className:"uppy-Dashboard-AddFiles"},this.renderHiddenInput(!1,(e=>{this.fileInput=e})),this.renderHiddenInput(!0,(e=>{this.folderInput=e})),e&&this.renderHiddenCameraInput("photo",n,(e=>{this.mobilePhotoFileInput=e})),t&&this.renderHiddenCameraInput("video",n,(e=>{this.mobileVideoFileInput=e})),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),(0,s.h)("div",{className:"uppy-Dashboard-AddFiles-info"},this.props.note&&(0,s.h)("div",{className:"uppy-Dashboard-note"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy(this.props)))}}const ai=oi,si=e=>(0,s.h)("div",{className:l("uppy-Dashboard-AddFilesPanel",e.className),"data-uppy-panelType":"AddFiles","aria-hidden":e.showAddFilesPanel},(0,s.h)("div",{className:"uppy-DashboardContent-bar"},(0,s.h)("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18n("addingMoreFiles")),(0,s.h)("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>e.toggleAddFilesPanel(!1)},e.i18n("back"))),(0,s.h)(ai,e)),li=function(e){const{tagName:t}=e.target;"INPUT"!==t&&"TEXTAREA"!==t?(e.preventDefault(),e.stopPropagation()):e.stopPropagation()},ui=function(e){let{activePickerPanel:t,className:n,hideAllPanels:r,i18n:i,state:o,uppy:a}=e;return(0,s.h)("div",{className:l("uppy-DashboardContent-panel",n),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${t.id}`,onDragOver:li,onDragLeave:li,onDrop:li,onPaste:li},(0,s.h)("div",{className:"uppy-DashboardContent-bar"},(0,s.h)("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},i("importFrom",{name:t.name})),(0,s.h)("button",{className:"uppy-DashboardContent-back",type:"button",onClick:r},i("cancel"))),(0,s.h)("div",{className:"uppy-DashboardContent-panelBody"},a.getPlugin(t.id).render(o)))},ci=function(e){const t=e.files[e.fileCardFor];return(0,s.h)("div",{className:l("uppy-DashboardContent-panel",e.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor"},(0,s.h)("div",{className:"uppy-DashboardContent-bar"},(0,s.h)("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18nArray("editing",{file:(0,s.h)("span",{className:"uppy-DashboardContent-titleFile"},t.meta?t.meta.name:t.name)})),(0,s.h)("button",{className:"uppy-DashboardContent-back",type:"button",onClick:e.hideAllPanels},e.i18n("cancel")),(0,s.h)("button",{className:"uppy-DashboardContent-save",type:"button",onClick:e.saveFileEditor},e.i18n("save"))),(0,s.h)("div",{className:"uppy-DashboardContent-panelBody"},e.editors.map((t=>e.uppy.getPlugin(t.id).render(e.state)))))},di="error",hi="waiting",pi="preprocessing",fi="uploading",mi="postprocessing",gi="complete",yi="paused";function vi(e){let{files:t,i18n:n,isAllComplete:r,isAllErrored:i,isAllPaused:o,inProgressNotPausedFiles:a,newFiles:s,processingFiles:l}=e;const u=function(e,t,n,r){if(void 0===r&&(r={}),e)return di;if(t)return gi;if(n)return yi;let i=hi;const o=Object.keys(r);for(let e=0;e<o.length;e++){const{progress:t}=r[o[e]];if(t.uploadStarted&&!t.uploadComplete)return fi;t.preprocess&&i!==fi&&(i=pi),t.postprocess&&i!==fi&&i!==pi&&(i=mi)}return i}(i,r,o,t);switch(u){case"uploading":return n("uploadingXFiles",{smart_count:a.length});case"preprocessing":case"postprocessing":return n("processingXFiles",{smart_count:l.length});case"paused":return n("uploadPaused");case"waiting":return n("xFilesSelected",{smart_count:s.length});case"complete":return n("uploadComplete");case"error":return n("error")}}const bi=function(e){const{i18n:t,isAllComplete:n,hideCancelButton:r,maxNumberOfFiles:i,toggleAddFilesPanel:o,uppy:a}=e;let{allowNewUpload:l}=e;return l&&i&&(l=e.totalFileCount<e.maxNumberOfFiles),(0,s.h)("div",{className:"uppy-DashboardContent-bar"},n||r?(0,s.h)("div",null):(0,s.h)("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>a.cancelAll()},t("cancel")),(0,s.h)("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},(0,s.h)(vi,e)),l?(0,s.h)("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":t("addMoreFiles"),title:t("addMoreFiles"),onClick:()=>o(!0)},(0,s.h)("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15"},(0,s.h)("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})),(0,s.h)("span",{className:"uppy-DashboardContent-addMoreCaption"},t("addMore"))):(0,s.h)("div",null))};function _i(e){const{computedMetaFields:t,requiredMetaFields:n,updateMeta:r,form:i,formState:o}=e,a={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return t.map((e=>{const t=`uppy-Dashboard-FileCard-input-${e.id}`,l=n.includes(e.id);return(0,s.h)("fieldset",{key:e.id,className:"uppy-Dashboard-FileCard-fieldset"},(0,s.h)("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:t},e.name),void 0!==e.render?e.render({value:o[e.id],onChange:t=>r(t,e.id),fieldCSSClasses:a,required:l,form:i.id},s.h):(0,s.h)("input",{className:a.text,id:t,form:i.id,type:e.type||"text",required:l,value:o[e.id],placeholder:e.placeholder,onInput:t=>r(t.target.value,e.id),"data-uppy-super-focusable":!0}))}))}function Ei(e){var t;const{uppy:n,files:r,fileCardFor:i,toggleFileCard:o,saveFileCard:a,metaFields:u,requiredMetaFields:c,openFileEditor:d,i18n:h,i18nArray:p,className:f,canEditFile:m}=e,g=r[i],y=null!=(t="function"==typeof u?u(r[i]):u)?t:[],v=m(g),b={};y.forEach((e=>{var t;b[e.id]=null!=(t=g.meta[e.id])?t:""}));const[_,E]=In(b),w=Mn((e=>{e.preventDefault(),a(_,i)}),[a,_,i]),T=()=>{n.emit("file-editor:cancel",g),o(!1)},[A]=In((()=>{const e=document.createElement("form");return e.setAttribute("tabindex","-1"),e.id=(0,jn.x)(),e}));return Rn((()=>(document.body.appendChild(A),A.addEventListener("submit",w),()=>{A.removeEventListener("submit",w),document.body.removeChild(A)})),[A,w]),(0,s.h)("div",{className:l("uppy-Dashboard-FileCard",f),"data-uppy-panelType":"FileCard",onDragOver:li,onDragLeave:li,onDrop:li,onPaste:li},(0,s.h)("div",{className:"uppy-DashboardContent-bar"},(0,s.h)("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},p("editing",{file:(0,s.h)("span",{className:"uppy-DashboardContent-titleFile"},g.meta?g.meta.name:g.name)})),(0,s.h)("button",{className:"uppy-DashboardContent-back",type:"button",form:A.id,title:h("finishEditingFile"),onClick:T},h("cancel"))),(0,s.h)("div",{className:"uppy-Dashboard-FileCard-inner"},(0,s.h)("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:kr(g.type).color}},(0,s.h)(Fr,{file:g}),v&&(0,s.h)("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:e=>{w(e),d(g)}},h("editFile"))),(0,s.h)("div",{className:"uppy-Dashboard-FileCard-info"},(0,s.h)(_i,{computedMetaFields:y,requiredMetaFields:c,updateMeta:(e,t)=>{E({..._,[t]:e})},form:A,formState:_})),(0,s.h)("div",{className:"uppy-Dashboard-FileCard-actions"},(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:A.id},h("saveChanges")),(0,s.h)("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:T,form:A.id},h("cancel")))))}const wi="uppy-transition-slideDownUp";class Ti extends s.wA{constructor(e){super(e),this.state={cachedChildren:null,className:""}}componentWillUpdate(e){const{cachedChildren:t}=this.state,n=(0,s.bR)(e.children)[0];if(t===n)return null;const r={cachedChildren:n};n&&!t&&(r.className=`${wi}-enter`,cancelAnimationFrame(this.animationFrame),clearTimeout(this.leaveTimeout),this.leaveTimeout=void 0,this.animationFrame=requestAnimationFrame((()=>{this.setState({className:`${wi}-enter ${wi}-enter-active`}),this.enterTimeout=setTimeout((()=>{this.setState({className:""})}),250)}))),t&&!n&&void 0===this.leaveTimeout&&(r.cachedChildren=t,r.className=`${wi}-leave`,cancelAnimationFrame(this.animationFrame),clearTimeout(this.enterTimeout),this.enterTimeout=void 0,this.animationFrame=requestAnimationFrame((()=>{this.setState({className:`${wi}-leave ${wi}-leave-active`}),this.leaveTimeout=setTimeout((()=>{this.setState({cachedChildren:null,className:""})}),250)}))),this.setState(r)}render(){const{cachedChildren:e,className:t}=this.state;return e?(0,s.Tm)(e,{className:l(t,e.props.className)}):null}}const Ai=Ti;function Si(){return Si=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Si.apply(this,arguments)}const xi={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}};function Ii(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Ri=0;function Ci(e){return"__private_"+Ri+++"_"+e}const Mi=Rr.default||Rr;function Li(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}var Pi=Ci("disabledNodes"),Di=Ci("generateLargeThumbnailIfSingleFile"),Oi=Ci("openFileEditorWhenFilesAdded"),Ni=Ci("attachRenderFunctionToTarget"),ki=Ci("isTargetSupported"),Fi=Ci("getAcquirers"),Bi=Ci("getProgressIndicators"),Ui=Ci("getEditors");class zi extends r.di{constructor(e,t){var n;super(e,t),n=this,Object.defineProperty(this,Pi,{writable:!0,value:null}),this.removeTarget=e=>{const t=this.getPluginState().targets.filter((t=>t.id!==e.id));this.setPluginState({targets:t})},this.addTarget=e=>{const t=e.id||e.constructor.name,n=e.title||t,r=e.type;if("acquirer"!==r&&"progressindicator"!==r&&"editor"!==r){const e="Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor";return void this.uppy.log(e,"error")}const i={id:t,name:n,type:r},o=this.getPluginState().targets.slice();return o.push(i),this.setPluginState({targets:o}),this.el},this.hideAllPanels=()=>{const e=this.getPluginState(),t={activePickerPanel:!1,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===t.activePickerPanel&&e.showAddFilesPanel===t.showAddFilesPanel&&e.showFileEditor===t.showFileEditor&&e.activeOverlayType===t.activeOverlayType||(this.setPluginState(t),this.uppy.emit("dashboard:close-panel",e.activePickerPanel.id))},this.showPanel=e=>{const{targets:t}=this.getPluginState(),n=t.filter((t=>"acquirer"===t.type&&t.id===e))[0];this.setPluginState({activePickerPanel:n,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)},this.canEditFile=e=>{const{targets:t}=this.getPluginState();return Ii(this,Ui)[Ui](t).some((t=>this.uppy.getPlugin(t.id).canEditFile(e)))},this.openFileEditor=e=>{const{targets:t}=this.getPluginState(),n=Ii(this,Ui)[Ui](t);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),n.forEach((t=>{this.uppy.getPlugin(t.id).selectFile(e)}))},this.saveFileEditor=()=>{const{targets:e}=this.getPluginState();Ii(this,Ui)[Ui](e).forEach((e=>{this.uppy.getPlugin(e.id).save()})),this.hideAllPanels()},this.openModal=()=>{const{promise:e,resolve:t}=Li();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const e=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",e,!1),t()};this.el.addEventListener("animationend",e,!1)}else this.setPluginState({isHidden:!1}),t();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e},this.closeModal=function(e){void 0===e&&(e={});const{manualClose:t=!0}=e,{isHidden:r,isClosing:i}=n.getPluginState();if(r||i)return;const{promise:o,resolve:a}=Li();if(n.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),n.opts.animateOpenClose){n.setPluginState({isClosing:!0});const e=()=>{n.setPluginState({isHidden:!0,isClosing:!1}),n.superFocus.cancel(),n.savedActiveElement.focus(),n.el.removeEventListener("animationend",e,!1),a()};n.el.addEventListener("animationend",e,!1)}else n.setPluginState({isHidden:!0}),n.superFocus.cancel(),n.savedActiveElement.focus(),a();var s;return document.removeEventListener("keydown",n.handleKeyDownInModal),t&&n.opts.browserBackButtonClose&&null!=(s=history.state)&&s[n.modalName]&&history.back(),n.uppy.emit("dashboard:modal-closed"),o},this.isModalOpen=()=>!this.getPluginState().isHidden||!1,this.requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal(),this.setDarkModeCapability=e=>{const{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:{...t,darkMode:e}})},this.handleSystemDarkModeChange=e=>{const t=e.matches;this.uppy.log("[Dashboard] Dark mode is "+(t?"on":"off")),this.setDarkModeCapability(t)},this.toggleFileCard=(e,t)=>{const n=this.uppy.getFile(t);e?this.uppy.emit("dashboard:file-edit-start",n):this.uppy.emit("dashboard:file-edit-complete",n),this.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})},this.toggleAddFilesPanel=e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})},this.addFiles=e=>{const t=e.map((e=>({source:this.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||e.webkitRelativePath||null}})));try{this.uppy.addFiles(t)}catch(e){this.uppy.log(e)}},this.startListeningToResize=()=>{this.resizeObserver=new ResizeObserver((e=>{const t=e[0],{width:n,height:r}=t.contentRect;this.setPluginState({containerWidth:n,containerHeight:r,areInsidesReadyToBeVisible:!0})})),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout((()=>{const e=this.getPluginState(),t=!this.opts.inline&&e.isHidden;e.areInsidesReadyToBeVisible||t||(this.uppy.log("[Dashboard] resize event didnât fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))}),1e3)},this.stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)},this.recordIfFocusedOnUppyRecently=e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())},this.disableInteractiveElements=e=>{var t;const n=null!=(t=Ii(this,Pi)[Pi])?t:(0,vt.Z)(this.el.querySelectorAll(["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'])).filter((e=>!e.classList.contains("uppy-Dashboard-close")));for(const t of n)"A"===t.tagName?t.setAttribute("aria-disabled",e):t.disabled=e;Ii(this,Pi)[Pi]=e?n:null,this.dashboardIsDisabled=e},this.updateBrowserHistory=()=>{var e;null!=(e=history.state)&&e[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)},this.handlePopState=e=>{var t;!this.isModalOpen()||e.state&&e.state[this.modalName]||this.closeModal({manualClose:!1}),!this.isModalOpen()&&null!=(t=e.state)&&t[this.modalName]&&history.back()},this.handleKeyDownInModal=e=>{27===e.keyCode&&this.requestCloseModal(e),9===e.keyCode&&Pr(e,this.getPluginState().activeOverlayType,this.el)},this.handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()},this.handlePaste=e=>{this.uppy.iteratePlugins((t=>{"acquirer"===t.type&&(null==t.handleRootPaste||t.handleRootPaste(e))}));const t=(0,vt.Z)(e.clipboardData.files);t.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(t))},this.handleInputChange=e=>{e.preventDefault();const t=(0,vt.Z)(e.target.files);t.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(t))},this.handleDragOver=e=>{var t,n;e.preventDefault(),e.stopPropagation();const r=(()=>{let t=!0;return this.uppy.iteratePlugins((n=>{null!=n.canHandleRootDrop&&n.canHandleRootDrop(e)&&(t=!0)})),t})(),i=(()=>{const{types:t}=e.dataTransfer;return t.some((e=>"Files"===e))})();if(!r&&!i||this.opts.disabled||this.opts.disableLocalFiles&&(i||!r)||!this.uppy.getState().allowNewUpload)return e.dataTransfer.dropEffect="none",void clearTimeout(this.removeDragOverClassTimeout);e.dataTransfer.dropEffect="copy",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0}),null==(t=(n=this.opts).onDragOver)||t.call(n,e)},this.handleDragLeave=e=>{var t,n;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout((()=>{this.setPluginState({isDraggingOver:!1})}),50),null==(t=(n=this.opts).onDragLeave)||t.call(n,e)},this.handleDrop=async e=>{var t,n;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins((t=>{"acquirer"===t.type&&(null==t.handleRootDrop||t.handleRootDrop(e))}));let r=!1;this.uppy.log("[Dashboard] Processing dropped files");const i=await async function(e,t){let{logDropError:n=(()=>{})}=void 0===t?{}:t;try{const t=[];for await(const r of async function*(e,t){const n=await Promise.all(Array.from(e.items,(async e=>{let n;return null!=n||(n=_t("function"==typeof e.getAsEntry?e.getAsEntry():e.webkitGetAsEntry(),t)),{fileSystemHandle:n,lastResortFile:e.getAsFile()}})));for(const{lastResortFile:e,fileSystemHandle:r}of n)if(null!=r)try{yield*Et(r,"",e)}catch(n){null!=e?yield e:t(n)}else null!=e&&(yield e)}(e,n))t.push(r);return t}catch{return function(e){const t=(0,vt.Z)(e.files);return Promise.resolve(t)}(e)}}(e.dataTransfer,{logDropError:e=>{this.uppy.log(e,"error"),r||(this.uppy.info(e.message,"error"),r=!0)}});i.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(i)),null==(t=(n=this.opts).onDrop)||t.call(n,e)},this.handleRequestThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)},this.handleCancelThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)},this.handleKeyDownInInline=e=>{9===e.keyCode&&function(e,t,n){null===t||Pr(e,t,n)}(e,this.getPluginState().activeOverlayType,this.el)},this.handlePasteOnBody=e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)},this.handleComplete=e=>{let{failed:t}=e;this.opts.closeAfterFinish&&0===t.length&&this.requestCloseModal()},this.handleCancelRestore=()=>{this.uppy.emit("restore-canceled")},Object.defineProperty(this,Di,{writable:!0,value:()=>{if(this.opts.disableThumbnailGenerator)return;const e=this.uppy.getFiles();if(1===e.length){const t=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);null==t||t.setOptions({thumbnailWidth:600});const n={...e[0],preview:void 0};t.requestThumbnail(n).then((()=>{null==t||t.setOptions({thumbnailWidth:this.opts.thumbnailWidth})}))}}}),Object.defineProperty(this,Oi,{writable:!0,value:e=>{const t=e[0];this.canEditFile(t)&&this.openFileEditor(t)}}),this.initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){const e=yt(this.opts.trigger);e?e.forEach((e=>e.addEventListener("click",this.openModal))):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("file-editor:complete",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",Ii(this,Di)[Di]),this.uppy.on("file-removed",Ii(this,Di)[Di]),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpenFileEditor&&this.uppy.on("files-added",Ii(this,Oi)[Oi])},this.removeEvents=()=>{const e=yt(this.opts.trigger);!this.opts.inline&&e&&e.forEach((e=>e.removeEventListener("click",this.openModal))),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("file-editor:complete",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",Ii(this,Di)[Di]),this.uppy.off("file-removed",Ii(this,Di)[Di]),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpenFileEditor&&this.uppy.off("files-added",Ii(this,Oi)[Oi])},this.superFocusOnEachUpdate=()=>{const e=this.el.contains(document.activeElement),t=document.activeElement===document.body||null===document.activeElement,n=0===this.uppy.getState().info.length,r=!this.opts.inline;n&&(r||e||t&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()},this.afterUpdate=()=>{!this.opts.disabled||this.dashboardIsDisabled?(!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()):this.disableInteractiveElements(!0)},this.saveFileCard=(e,t)=>{this.uppy.setFileMeta(t,e),this.toggleFileCard(!1,t)},Object.defineProperty(this,Ni,{writable:!0,value:e=>{const t=this.uppy.getPlugin(e.id);return{...e,icon:t.icon||this.opts.defaultPickerIcon,render:t.render}}}),Object.defineProperty(this,ki,{writable:!0,value:e=>{const t=this.uppy.getPlugin(e.id);return"function"!=typeof t.isSupported||t.isSupported()}}),Object.defineProperty(this,Fi,{writable:!0,value:Mi((e=>e.filter((e=>"acquirer"===e.type&&Ii(this,ki)[ki](e))).map(Ii(this,Ni)[Ni])))}),Object.defineProperty(this,Bi,{writable:!0,value:Mi((e=>e.filter((e=>"progressindicator"===e.type)).map(Ii(this,Ni)[Ni])))}),Object.defineProperty(this,Ui,{writable:!0,value:Mi((e=>e.filter((e=>"editor"===e.type)).map(Ii(this,Ni)[Ni])))}),this.render=e=>{const t=this.getPluginState(),{files:n,capabilities:r,allowNewUpload:i}=e,{newFiles:o,uploadStartedFiles:a,completeFiles:u,erroredFiles:c,inProgressFiles:d,inProgressNotPausedFiles:h,processingFiles:p,isUploadStarted:f,isAllComplete:m,isAllErrored:g,isAllPaused:y}=this.uppy.getObjectOfFilesPerState(),v=Ii(this,Fi)[Fi](t.targets),b=Ii(this,Bi)[Bi](t.targets),_=Ii(this,Ui)[Ui](t.targets);let E;return E="auto"===this.opts.theme?r.darkMode?"dark":"light":this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),function(e){const t=0===e.totalFileCount,n=1===e.totalFileCount,r=e.containerWidth>576,i=e.containerHeight>330,o=l({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":e.disabled,"uppy-Dashboard--animateOpenClose":e.animateOpenClose,"uppy-Dashboard--isClosing":e.isClosing,"uppy-Dashboard--isDraggingOver":e.isDraggingOver,"uppy-Dashboard--modal":!e.inline,"uppy-size--md":e.containerWidth>576,"uppy-size--lg":e.containerWidth>700,"uppy-size--xl":e.containerWidth>900,"uppy-size--height-md":e.containerHeight>330,"uppy-Dashboard--isAddFilesPanelVisible":e.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":e.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":e.singleFileFullScreen&&n&&i});let a=1;e.containerWidth>900?a=5:e.containerWidth>700?a=4:e.containerWidth>576&&(a=3);const u=e.showSelectedFiles&&!t,c=e.recoveredState?Object.keys(e.recoveredState.files).length:null,d=e.files?Object.keys(e.files).filter((t=>e.files[t].isGhost)).length:null;return(0,s.h)("div",{className:o,"data-uppy-theme":e.theme,"data-uppy-num-acquirers":e.acquirers.length,"data-uppy-drag-drop-supported":!e.disableLocalFiles&&Or(),"aria-hidden":e.inline?"false":e.isHidden,"aria-disabled":e.disabled,"aria-label":e.inline?e.i18n("dashboardTitle"):e.i18n("dashboardWindowTitle"),onPaste:e.handlePaste,onDragOver:e.handleDragOver,onDragLeave:e.handleDragLeave,onDrop:e.handleDrop},(0,s.h)("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:e.handleClickOutside}),(0,s.h)("div",{className:"uppy-Dashboard-inner","aria-modal":!e.inline&&"true",role:!e.inline&&"dialog",style:{width:e.inline&&e.width?e.width:"",height:e.inline&&e.height?e.height:""}},e.inline?null:(0,s.h)("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":e.i18n("closeModal"),title:e.i18n("closeModal"),onClick:e.closeModal},(0,s.h)("span",{"aria-hidden":"true"},"Ã")),(0,s.h)("div",{className:"uppy-Dashboard-innerWrap"},(0,s.h)("div",{className:"uppy-Dashboard-dropFilesHereHint"},e.i18n("dropHint")),u&&(0,s.h)(bi,e),c&&(0,s.h)("div",{className:"uppy-Dashboard-serviceMsg"},(0,s.h)("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19"},(0,s.h)("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd"},(0,s.h)("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),(0,s.h)("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),(0,s.h)("circle",{fill:"#000",cx:"12",cy:"17",r:"1"}))),(0,s.h)("strong",{className:"uppy-Dashboard-serviceMsg-title"},e.i18n("sessionRestored")),(0,s.h)("div",{className:"uppy-Dashboard-serviceMsg-text"},d>0?e.i18n("recoveredXFiles",{smart_count:d}):e.i18n("recoveredAllFiles"))),u?(0,s.h)(ri,{id:e.id,error:e.error,i18n:e.i18n,uppy:e.uppy,files:e.files,acquirers:e.acquirers,resumableUploads:e.resumableUploads,hideRetryButton:e.hideRetryButton,hidePauseResumeButton:e.hidePauseResumeButton,hideCancelButton:e.hideCancelButton,showLinkToFileUploadResult:e.showLinkToFileUploadResult,showRemoveButtonAfterComplete:e.showRemoveButtonAfterComplete,isWide:e.isWide,metaFields:e.metaFields,toggleFileCard:e.toggleFileCard,handleRequestThumbnail:e.handleRequestThumbnail,handleCancelThumbnail:e.handleCancelThumbnail,recoveredState:e.recoveredState,individualCancellation:e.individualCancellation,openFileEditor:e.openFileEditor,canEditFile:e.canEditFile,toggleAddFilesPanel:e.toggleAddFilesPanel,isSingleFile:n,itemsPerRow:a}):(0,s.h)(ai,Si({},e,{isSizeMD:r})),(0,s.h)(Ai,null,e.showAddFilesPanel?(0,s.h)(si,Si({key:"AddFiles"},e,{isSizeMD:r})):null),(0,s.h)(Ai,null,e.fileCardFor?(0,s.h)(Ei,Si({key:"FileCard"},e)):null),(0,s.h)(Ai,null,e.activePickerPanel?(0,s.h)(ui,Si({key:"Picker"},e)):null),(0,s.h)(Ai,null,e.showFileEditor?(0,s.h)(ci,Si({key:"Editor"},e)):null),(0,s.h)("div",{className:"uppy-Dashboard-progressindicators"},e.progressindicators.map((t=>e.uppy.getPlugin(t.id).render(e.state)))))))}({state:e,isHidden:t.isHidden,files:n,newFiles:o,uploadStartedFiles:a,completeFiles:u,erroredFiles:c,inProgressFiles:d,inProgressNotPausedFiles:h,processingFiles:p,isUploadStarted:f,isAllComplete:m,isAllErrored:g,isAllPaused:y,totalFileCount:Object.keys(n).length,totalProgress:e.totalProgress,allowNewUpload:i,acquirers:v,theme:E,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,saveFileEditor:this.saveFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:t.isClosing,progressindicators:b,editors:_,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:t.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:t.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,isTargetDOMEl:this.isTargetDOMEl,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})},this.discoverProviderPlugins=()=>{this.uppy.iteratePlugins((e=>{e&&!e.target&&e.opts&&e.opts.target===this.constructor&&this.addTarget(e)}))},this.install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:!1,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:e,closeAfterFinish:t}=this.opts;if(e&&t)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:n,allowMultipleUploadBatches:r}=this.uppy.opts;(n||r)&&t&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:i}=this.opts;i&&this.mount(i,this),(this.opts.plugins||[]).forEach((e=>{const t=this.uppy.getPlugin(e);t&&t.mount(this,t)})),this.opts.disableStatusBar||this.uppy.use(j,{id:`${this.id}:StatusBar`,target:this,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,showProgressDetails:this.opts.showProgressDetails,hideAfterFinish:this.opts.hideProgressAfterFinish,locale:this.opts.locale,doneButtonHandler:this.opts.doneButtonHandler}),this.opts.disableInformer||this.uppy.use($,{id:`${this.id}:Informer`,target:this}),this.opts.disableThumbnailGenerator||this.uppy.use(mt,{id:`${this.id}:ThumbnailGenerator`,thumbnailWidth:this.opts.thumbnailWidth,thumbnailHeight:this.opts.thumbnailHeight,thumbnailType:this.opts.thumbnailType,waitForThumbnailsBeforeUpload:this.opts.waitForThumbnailsBeforeUpload,lazy:!this.opts.waitForThumbnailsBeforeUpload}),this.darkModeMediaQuery="undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const o=!!this.darkModeMediaQuery&&this.darkModeMediaQuery.matches;this.uppy.log("[Dashboard] Dark mode is "+(o?"on":"off")),this.setDarkModeCapability(o),"auto"===this.opts.theme&&this.darkModeMediaQuery.addListener(this.handleSystemDarkModeChange),this.discoverProviderPlugins(),this.initEvents()},this.uninstall=()=>{if(!this.opts.disableInformer){const e=this.uppy.getPlugin(`${this.id}:Informer`);e&&this.uppy.removePlugin(e)}if(!this.opts.disableStatusBar){const e=this.uppy.getPlugin(`${this.id}:StatusBar`);e&&this.uppy.removePlugin(e)}if(!this.opts.disableThumbnailGenerator){const e=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);e&&this.uppy.removePlugin(e)}(this.opts.plugins||[]).forEach((e=>{const t=this.uppy.getPlugin(e);t&&t.unmount()})),"auto"===this.opts.theme&&this.darkModeMediaQuery.removeListener(this.handleSystemDarkModeChange),this.unmount(),this.removeEvents()},this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.modalName=`uppy-Dashboard-${(0,jn.x)()}`,this.defaultLocale=xi;const r={target:"body",metaFields:[],trigger:null,inline:!1,width:750,height:550,thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:cr,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,doneButtonHandler:()=>{this.uppy.cancelAll(),this.requestCloseModal()},note:null,closeModalOnClickOutside:!1,closeAfterFinish:!1,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,disablePageScrollWhenModalOpen:!0,animateOpenClose:!0,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,onRequestCloseModal:()=>this.closeModal(),showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,browserBackButtonClose:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpenFileEditor:!1,disabled:!1,disableLocalFiles:!1};this.opts={...r,...t},this.i18nInit(),this.superFocus=function(){let e=!1;return Dr(((t,n)=>{const r=Mr(t,n),i=r.contains(document.activeElement);if(i&&e)return;const o=r.querySelector("[data-uppy-super-focusable]");if(!i||o)if(o)o.focus({preventScroll:!0}),e=!0;else{const t=r.querySelector(Cr);null==t||t.focus({preventScroll:!0}),e=!1}}),260)}(),this.ifFocusedOnUppyRecently=!1,this.makeDashboardInsidesVisibleAnywayTimeout=null,this.removeDragOverClassTimeout=null}}zi.VERSION="3.5.1"},8576:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(8596),i=n(8674),o=n(7581);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}var s={"[object HTMLCollection]":!0,"[object NodeList]":!0,"[object RadioNodeList]":!0},l={button:!0,fieldset:!0,reset:!0,submit:!0},u={checkbox:!0,radio:!0},c=/^\s+|\s+$/g,d=Array.prototype.slice,h=Object.prototype.toString;function p(e,t){if(!e)throw new Error("A form is required by getFormData, was given form="+e);t=a({includeDisabled:!1,trim:!1},t);for(var n,r={},i=[],o={},s=0,u=e.elements.length;s<u;s++){var c=e.elements[s];l[c.type]||c.disabled&&!t.includeDisabled||(n=c.name||c.id)&&!o[n]&&(i.push(n),o[n]=!0)}for(var d=0,h=i.length;d<h;d++){var p=f(e,n=i[d],t);null!=p&&(r[n]=p)}return r}function f(e,t,n){if(!e)throw new Error("A form is required by getFieldData, was given form="+e);if(!t&&"[object String]"!==h.call(t))throw new Error("A field name is required by getFieldData, was given fieldName="+t);n=a({includeDisabled:!1,trim:!1},n);var r=e.elements[t];if(!r||r.disabled&&!n.includeDisabled)return null;if(!s[h.call(r)])return m(r,n.trim);for(var i=[],o=!0,l=0,u=r.length;l<u;l++)if(!r[l].disabled||n.includeDisabled){o&&"radio"!==r[l].type&&(o=!1);var c=m(r[l],n.trim);null!=c&&(i=i.concat(c))}return o&&1===i.length?i[0]:i.length>0?i:null}function m(e,t){var n=null,r=e.type;if("select-one"===r)return e.options.length&&(n=e.options[e.selectedIndex].value),n;if("select-multiple"===r){n=[];for(var i=0,o=e.options.length;i<o;i++)e.options[i].selected&&n.push(e.options[i].value);return 0===n.length&&(n=null),n}return"file"===r&&"files"in e?(e.multiple?0===(n=d.call(e.files)).length&&(n=null):n=e.files[0],n):(u[r]?e.checked&&(n="checkbox"===r&&!e.hasAttribute("value")||e.value):n=t?e.value.replace(c,""):e.value,n)}p.getFieldData=f;class g extends r.Z{constructor(e,t){super(e,t),this.type="acquirer",this.id=this.opts.id||"Form",this.title="Form",this.opts={target:null,resultName:"uppyResult",getMetaFromForm:!0,addResultToForm:!0,submitOnSuccess:!1,triggerUploadOnSubmit:!1,...t},this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleUploadStart=this.handleUploadStart.bind(this),this.handleSuccess=this.handleSuccess.bind(this),this.addResultToForm=this.addResultToForm.bind(this),this.getMetaFromForm=this.getMetaFromForm.bind(this)}handleUploadStart(){this.opts.getMetaFromForm&&this.getMetaFromForm()}handleSuccess(e){this.opts.addResultToForm&&this.addResultToForm(e),this.opts.submitOnSuccess&&this.form.submit()}handleFormSubmit(e){if(this.opts.triggerUploadOnSubmit){e.preventDefault();const t=(0,o.Z)(e.target.elements),n=[];t.forEach((e=>{("BUTTON"===e.tagName||"INPUT"===e.tagName&&"submit"===e.type)&&!e.disabled&&(e.disabled=!0,n.push(e))})),this.uppy.upload().then((()=>{n.forEach((e=>{e.disabled=!1}))}),(e=>(n.forEach((e=>{e.disabled=!1})),Promise.reject(e)))).catch((e=>{this.uppy.log(e.stack||e.message||e)}))}}addResultToForm(e){this.uppy.log("[Form] Adding result to the original form:"),this.uppy.log(e);let t=this.form.querySelector(`[name="${this.opts.resultName}"]`);if(t){let n;try{n=JSON.parse(t.value)}catch(e){}return Array.isArray(n)||(n=[]),n.push(e),void(t.value=JSON.stringify(n))}t=document.createElement("input"),t.name=this.opts.resultName,t.type="hidden",t.value=JSON.stringify([e]),this.form.appendChild(t)}getMetaFromForm(){const e=p(this.form);delete e[this.opts.resultName],this.uppy.setMeta(e)}install(){this.form=(0,i.Z)(this.opts.target),this.form&&"FORM"===this.form.nodeName?(this.form.addEventListener("submit",this.handleFormSubmit),this.uppy.on("upload",this.handleUploadStart),this.uppy.on("complete",this.handleSuccess)):this.uppy.log("Form plugin requires a <form> target element passed in options to operate, none was found","error")}uninstall(){this.form.removeEventListener("submit",this.handleFormSubmit),this.uppy.off("upload",this.handleUploadStart),this.uppy.off("complete",this.handleSuccess)}}g.VERSION="3.0.2"},2321:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_n});var r={};n.r(r),n.d(r,{getItem:()=>ut,removeItem:()=>ct,setItem:()=>lt});var i=n(8596);function o(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var a=0;function s(e){return"__private_"+a+++"_"+e}var l=s("queueRequestSocketToken");class u extends i.Z{constructor(){super(...arguments),Object.defineProperty(this,l,{writable:!0,value:void 0})}setQueueRequestSocketToken(e){o(this,l)[l]=e}async uploadRemoteFile(e,t){void 0===t&&(t={});try{if(e.serverToken)return await this.connectToServerSocket(e);const n=await o(this,l)[l](e).abortOn(t.signal);if(!this.uppy.getState().files[e.id])return;return this.uppy.setFileState(e.id,{serverToken:n}),await this.connectToServerSocket(this.uppy.getFile(e.id))}catch(t){var n;if("AbortError"===(null==t||null==(n=t.cause)?void 0:n.name))return;throw this.uppy.setFileState(e.id,{serverToken:void 0}),this.uppy.emit("upload-error",e,t),t}}}const c="function"==typeof btoa,d="function"==typeof Buffer,h=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),p=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),f=((e=>{let t={};e.forEach(((e,n)=>t[e]=n))})(p),String.fromCharCode.bind(String)),m=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_"))),g=c?e=>btoa(e):d?e=>Buffer.from(e,"binary").toString("base64"):e=>{let t,n,r,i,o="";const a=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|r<<8|i,o+=p[t>>18&63]+p[t>>12&63]+p[t>>6&63]+p[63&t]}return a?o.slice(0,a-3)+"===".substring(a):o},y=d?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,r=e.length;n<r;n+=4096)t.push(f.apply(null,e.subarray(n,n+4096)));return g(t.join(""))},v=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?f(192|t>>>6)+f(128|63&t):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|63&t)},b=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,_=d?e=>Buffer.from(e,"utf8").toString("base64"):h?e=>y(h.encode(e)):e=>g(e.replace(b,v)),E=(e,t=!1)=>t?m(_(e)):_(e);var w=n(4564),T=n.n(w);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function S(e){var t="function"==typeof Map?new Map:void 0;return S=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return x(e,arguments,C(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),R(r,e)},S(e)}function x(e,t,n){return x=I()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&R(i,n.prototype),i},x.apply(null,arguments)}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}const M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(o,e);var t,n,r,i=(n=o,r=I(),function(){var e,t=C(n);if(r){var i=C(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e)).originalRequest=r,t.originalResponse=a,t.causingError=n,null!=n&&(e+=", caused by ".concat(n.toString())),null!=r){var s=r.getHeader("X-Request-ID")||"n/a",l=r.getMethod(),u=r.getURL(),c=a?a.getStatus():"n/a",d=a?a.getBody()||"":"n/a";e+=", originated from request (method: ".concat(l,", url: ").concat(u,", response code: ").concat(c,", response text: ").concat(d,", request id: ").concat(s,")")}return t.message=e,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(S(Error));function L(){L=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),s=new S(i||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function h(){}function p(){}function f(){}var m={};l(m,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(x([])));y&&y!==t&&n.call(y,o)&&(m=y);var v=f.prototype=h.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function i(r,o,a,s){var l=c(e[r],e,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==N(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=c(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function x(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=f,r(v,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(_.prototype),l(_.prototype,a,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),l(v,s,"Generator"),l(v,o,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=x,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function P(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return(t=z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,z(r.key),r)}}function z(e){var t=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===N(t)?t:String(t)}var G=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"resume"in n&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=n,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}var t,n,r;return t=e,n=[{key:"findPreviousUploads",value:function(){var e=this;return this.options.fingerprint(this.file,this.options).then((function(t){return e._urlStorage.findUploadsByFingerprint(t)}))}},{key:"resumeFromPreviousUpload",value:function(e){this.url=e.uploadUrl||null,this._parallelUploadUrls=e.parallelUploadUrls||null,this._urlStorageKey=e.urlStorageKey}},{key:"start",value:function(){var e=this,t=this.file;if(t)if(this.options.endpoint||this.options.uploadUrl||this.url){var n=this.options.retryDelays;if(null==n||"[object Array]"===Object.prototype.toString.call(n)){if(this.options.parallelUploads>1)for(var r=0,i=["uploadUrl","uploadSize","uploadLengthDeferred"];r<i.length;r++){var o=i[r];if(this.options[o])return void this._emitError(new Error("tus: cannot use the ".concat(o," option when parallelUploads is enabled")))}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1)return void this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length)return void this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"))}this.options.fingerprint(t,this.options).then((function(n){return null==n||"Calculated fingerprint: ".concat(n),e._fingerprint=n,e._source?e._source:e.options.fileReader.openFile(t,e.options.chunkSize)})).then((function(t){if(e._source=t,e.options.uploadLengthDeferred)e._size=null;else if(null!=e.options.uploadSize){if(e._size=Number(e.options.uploadSize),Number.isNaN(e._size))return void e._emitError(new Error("tus: cannot convert `uploadSize` option into a number"))}else if(e._size=e._source.size,null==e._size)return void e._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));e.options.parallelUploads>1||null!=e._parallelUploadUrls?e._startParallelUpload():e._startSingleUpload()})).catch((function(t){e._emitError(t)}))}else this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"))}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"_startParallelUpload",value:function(){var t,n=this,r=this._size,i=0;this._parallelUploads=[];var o=null!=this._parallelUploadUrls?this._parallelUploadUrls.length:this.options.parallelUploads,a=null!==(t=this.options.parallelUploadBoundaries)&&void 0!==t?t:function(e,t){for(var n=Math.floor(e/t),r=[],i=0;i<t;i++)r.push({start:n*i,end:n*(i+1)});return r[t-1].end=e,r}(this._source.size,o);this._parallelUploadUrls&&a.forEach((function(e,t){e.uploadUrl=n._parallelUploadUrls[t]||null})),this._parallelUploadUrls=new Array(a.length);var s,l=a.map((function(t,o){var s=0;return n._source.slice(t.start,t.end).then((function(l){var u=l.value;return new Promise((function(l,c){var d=F(F({},n.options),{},{uploadUrl:t.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:F(F({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:l,onError:c,onProgress:function(e){i=i-s+e,s=e,n._emitProgress(i,r)},onUploadUrlAvailable:function(){n._parallelUploadUrls[o]=h.url,n._parallelUploadUrls.filter((function(e){return Boolean(e)})).length===a.length&&n._saveUploadInUrlStorage()}}),h=new e(u,d);h.start(),n._parallelUploads.push(h)}))}))}));Promise.all(l).then((function(){(s=n._openRequest("POST",n.options.endpoint)).setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var e=V(n.options.metadata);return""!==e&&s.setHeader("Upload-Metadata",e),n._sendRequest(s,null)})).then((function(e){if(j(e.getStatus(),200)){var t=e.getHeader("Location");null!=t?(n.url=Y(n.options.endpoint,t),"Created upload at ".concat(n.url),n._emitSuccess()):n._emitHttpError(s,e,"tus: invalid or missing Location header")}else n._emitHttpError(s,e,"tus: unexpected response while creating upload")})).catch((function(e){n._emitError(e)}))}},{key:"_startSingleUpload",value:function(){return this._aborted=!1,null!=this.url?("Resuming upload from previous URL: ".concat(this.url),void this._resumeUpload()):null!=this.options.uploadUrl?("Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,void this._resumeUpload()):void this._createUpload()}},{key:"abort",value:function(t){var n=this;return null!=this._parallelUploads&&this._parallelUploads.forEach((function(e){e.abort(t)})),null!==this._req&&this._req.abort(),this._aborted=!0,null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),t&&null!=this.url?e.terminate(this.url,this.options).then((function(){return n._removeFromUrlStorage()})):Promise.resolve()}},{key:"_emitHttpError",value:function(e,t,n,r){this._emitError(new M(n,r,e,t))}},{key:"_emitError",value:function(e){var t=this;if(!this._aborted){if(null!=this.options.retryDelays&&(null!=this._offset&&this._offset>this._offsetBeforeRetry&&(this._retryAttempt=0),W(e,this._retryAttempt,this.options))){var n=this.options.retryDelays[this._retryAttempt++];return this._offsetBeforeRetry=this._offset,void(this._retryTimeout=setTimeout((function(){t.start()}),n))}if("function"!=typeof this.options.onError)throw e;this.options.onError(e)}}},{key:"_emitSuccess",value:function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(e,t){"function"==typeof this.options.onProgress&&this.options.onProgress(e,t)}},{key:"_emitChunkComplete",value:function(e,t,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(e,t,n)}},{key:"_createUpload",value:function(){var e=this;if(this.options.endpoint){var t=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?t.setHeader("Upload-Defer-Length",1):t.setHeader("Upload-Length",this._size);var n,r=V(this.options.metadata);""!==r&&t.setHeader("Upload-Metadata",r),this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,n=this._addChunkToRequest(t)):n=this._sendRequest(t,null),n.then((function(n){if(j(n.getStatus(),200)){var r=n.getHeader("Location");if(null!=r){if(e.url=Y(e.options.endpoint,r),"Created upload at ".concat(e.url),"function"==typeof e.options.onUploadUrlAvailable&&e.options.onUploadUrlAvailable(),0===e._size)return e._emitSuccess(),void e._source.close();e._saveUploadInUrlStorage().then((function(){e.options.uploadDataDuringCreation?e._handleUploadResponse(t,n):(e._offset=0,e._performUpload())}))}else e._emitHttpError(t,n,"tus: invalid or missing Location header")}else e._emitHttpError(t,n,"tus: unexpected response while creating upload")})).catch((function(n){e._emitHttpError(t,null,"tus: failed to create upload",n)}))}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var e=this,t=this._openRequest("HEAD",this.url);this._sendRequest(t,null).then((function(n){var r=n.getStatus();if(!j(r,200))return 423===r?void e._emitHttpError(t,n,"tus: upload is currently locked; retry later"):(j(r,400)&&e._removeFromUrlStorage(),e.options.endpoint?(e.url=null,void e._createUpload()):void e._emitHttpError(t,n,"tus: unable to resume upload (new upload cannot be created without an endpoint)"));var i=parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(i))e._emitHttpError(t,n,"tus: invalid or missing offset value");else{var o=parseInt(n.getHeader("Upload-Length"),10);!Number.isNaN(o)||e.options.uploadLengthDeferred?("function"==typeof e.options.onUploadUrlAvailable&&e.options.onUploadUrlAvailable(),e._saveUploadInUrlStorage().then((function(){if(i===o)return e._emitProgress(o,o),void e._emitSuccess();e._offset=i,e._performUpload()}))):e._emitHttpError(t,n,"tus: invalid or missing length value")}})).catch((function(n){e._emitHttpError(t,null,"tus: failed to resume upload",n)}))}},{key:"_performUpload",value:function(){var e,t=this;this._aborted||(this.options.overridePatchMethod?(e=this._openRequest("POST",this.url)).setHeader("X-HTTP-Method-Override","PATCH"):e=this._openRequest("PATCH",this.url),e.setHeader("Upload-Offset",this._offset),this._addChunkToRequest(e).then((function(n){j(n.getStatus(),200)?t._handleUploadResponse(e,n):t._emitHttpError(e,n,"tus: unexpected response while uploading chunk")})).catch((function(n){t._aborted||t._emitHttpError(e,null,"tus: failed to upload chunk at offset ".concat(t._offset),n)})))}},{key:"_addChunkToRequest",value:function(e){var t=this,n=this._offset,r=this._offset+this.options.chunkSize;return e.setProgressHandler((function(e){t._emitProgress(n+e,t._size)})),e.setHeader("Content-Type","application/offset+octet-stream"),(r===1/0||r>this._size)&&!this.options.uploadLengthDeferred&&(r=this._size),this._source.slice(n,r).then((function(n){var r=n.value,i=n.done,o=r&&r.size?r.size:0;t.options.uploadLengthDeferred&&i&&(t._size=t._offset+o,e.setHeader("Upload-Length",t._size));var a=t._offset+o;return!t.options.uploadLengthDeferred&&i&&a!==t._size?Promise.reject(new Error("upload was configured with a size of ".concat(t._size," bytes, but the source is done after ").concat(a," bytes"))):null===r?t._sendRequest(e):(t._emitProgress(t._offset,t._size),t._sendRequest(e,r))}))}},{key:"_handleUploadResponse",value:function(e,t){var n=parseInt(t.getHeader("Upload-Offset"),10);if(Number.isNaN(n))this._emitHttpError(e,t,"tus: invalid or missing offset value");else{if(this._emitProgress(n,this._size),this._emitChunkComplete(n-this._offset,n,this._size),this._offset=n,n===this._size)return this._emitSuccess(),void this._source.close();this._performUpload()}}},{key:"_openRequest",value:function(e,t){var n=H(e,t,this.options);return this._req=n,n}},{key:"_removeFromUrlStorage",value:function(){var e=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch((function(t){e._emitError(t)})),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var e=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||null!==this._urlStorageKey)return Promise.resolve();var t={size:this._size,metadata:this.options.metadata,creationTime:(new Date).toString()};return this._parallelUploads?t.parallelUploadUrls=this._parallelUploadUrls:t.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,t).then((function(t){e._urlStorageKey=t}))}},{key:"_sendRequest",value:function(e){return Z(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,this.options)}}],r=[{key:"terminate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=H("DELETE",t,n);return Z(r,null,n).then((function(e){if(204!==e.getStatus())throw new M("tus: unexpected response while terminating upload",null,r,e)})).catch((function(i){if(i instanceof M||(i=new M("tus: failed to terminate upload",i,r,null)),!W(i,0,n))throw i;var o=n.retryDelays[0],a=n.retryDelays.slice(1),s=F(F({},n),{},{retryDelays:a});return new Promise((function(e){return setTimeout(e,o)})).then((function(){return e.terminate(t,s)}))}))}}],n&&U(t.prototype,n),r&&U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function V(e){return Object.entries(e).map((function(e){var t=D(e,2),n=t[0],r=t[1];return"".concat(n," ").concat(E(String(r)))})).join(",")}function j(e,t){return e>=t&&e<t+100}function H(e,t,n){var r=n.httpStack.createRequest(e,t);r.setHeader("Tus-Resumable","1.0.0");var i=n.headers||{};if(Object.entries(i).forEach((function(e){var t=D(e,2),n=t[0],i=t[1];r.setHeader(n,i)})),n.addRequestId){var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));r.setHeader("X-Request-ID",o)}return r}function Z(e,t,n){return q.apply(this,arguments)}function q(){var e;return e=L().mark((function e(t,n,r){var i;return L().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof r.onBeforeRequest){e.next=3;break}return e.next=3,r.onBeforeRequest(t);case 3:return e.next=5,t.send(n);case 5:if(i=e.sent,"function"!=typeof r.onAfterResponse){e.next=9;break}return e.next=9,r.onAfterResponse(t,i);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})),q=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){P(o,r,i,a,s,"next",e)}function s(e){P(o,r,i,a,s,"throw",e)}a(void 0)}))},q.apply(this,arguments)}function W(e,t,n){if(null==n.retryDelays||t>=n.retryDelays.length||null==e.originalRequest)return!1;if(n&&"function"==typeof n.onShouldRetry)return n.onShouldRetry(e,t,n);var r,i=e.originalResponse?e.originalResponse.getStatus():0;return(!j(i,400)||409===i||423===i)&&(r=!0,"undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(r=!1),r)}function Y(e,t){return new(T())(t,e).toString()}G.defaultOptions={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null};const K=G;function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Q(r.key),r)}}function Q(e){var t=function(e,t){if("object"!==$(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===$(t)?t:String(t)}var J=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(e){return Promise.resolve([])}},{key:"removeUpload",value:function(e){return Promise.resolve()}},{key:"addUpload",value:function(e,t){return Promise.resolve(null)}}])&&X(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ne(r.key),r)}}function ne(e){var t=function(e,t){if("object"!==ee(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ee(t)?t:String(t)}var re=!1;try{re="localStorage"in window;var ie="tusSupport",oe=localStorage.getItem(ie);localStorage.setItem(ie,oe),null===oe&&localStorage.removeItem(ie)}catch(e){if(e.code!==e.SECURITY_ERR&&e.code!==e.QUOTA_EXCEEDED_ERR)throw e;re=!1}var ae=re,se=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"findAllUploads",value:function(){var e=this._findEntries("tus::");return Promise.resolve(e)}},{key:"findUploadsByFingerprint",value:function(e){var t=this._findEntries("tus::".concat(e,"::"));return Promise.resolve(t)}},{key:"removeUpload",value:function(e){return localStorage.removeItem(e),Promise.resolve()}},{key:"addUpload",value:function(e,t){var n=Math.round(1e12*Math.random()),r="tus::".concat(e,"::").concat(n);return localStorage.setItem(r,JSON.stringify(t)),Promise.resolve(r)}},{key:"_findEntries",value:function(e){for(var t=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(0===r.indexOf(e))try{var i=JSON.parse(localStorage.getItem(r));i.urlStorageKey=r,t.push(i)}catch(e){}}return t}}],n&&te(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function le(e){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(e)}function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,he(r.key),r)}}function de(e,t,n){return t&&ce(e.prototype,t),n&&ce(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function he(e){var t=function(e,t){if("object"!==le(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===le(t)?t:String(t)}var pe=function(){function e(){ue(this,e)}return de(e,[{key:"createRequest",value:function(e,t){return new fe(e,t)}},{key:"getName",value:function(){return"XHRHttpStack"}}]),e}(),fe=function(){function e(t,n){ue(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,n,!0),this._method=t,this._url=n,this._headers={}}return de(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(e,t){this._xhr.setRequestHeader(e,t),this._headers[e]=t}},{key:"getHeader",value:function(e){return this._headers[e]}},{key:"setProgressHandler",value:function(e){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(t){t.lengthComputable&&e(t.loaded)})}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(n,r){e._xhr.onload=function(){n(new me(e._xhr))},e._xhr.onerror=function(e){r(e)},e._xhr.send(t)}))}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}(),me=function(){function e(t){ue(this,e),this._xhr=t}return de(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(e){return this._xhr.getResponseHeader(e)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}]),e}();const ge=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()};function ye(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var e=r.response;t(e)},r.onerror=function(e){n(e)},r.open("GET",e),r.send()}))}function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_e(r.key),r)}}function _e(e){var t=function(e,t){if("object"!==ve(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ve(t)?t:String(t)}var Ee=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._file=t,this.size=t.size}var t,n;return t=e,(n=[{key:"slice",value:function(e,t){if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova))return n=this._file.slice(e,t),new Promise((function(e,t){var r=new FileReader;r.onload=function(){var t=new Uint8Array(r.result);e({value:t})},r.onerror=function(e){t(e)},r.readAsArrayBuffer(n)}));var n,r=this._file.slice(e,t),i=t>=this.size;return Promise.resolve({value:r,done:i})}},{key:"close",value:function(){}}])&&be(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ae(r.key),r)}}function Ae(e){var t=function(e,t){if("object"!==we(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===we(t)?t:String(t)}function Se(e){return void 0===e?0:void 0!==e.size?e.size:e.length}var xe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}var t,n;return t=e,(n=[{key:"slice",value:function(e,t){return e<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(e,t)}},{key:"_readUntilEnoughDataOrDone",value:function(e,t){var n=this,r=t<=this._bufferOffset+Se(this._buffer);if(this._done||r){var i=this._getDataFromBuffer(e,t),o=null==i&&this._done;return Promise.resolve({value:i,done:o})}return this._reader.read().then((function(r){var i=r.value;return r.done?n._done=!0:void 0===n._buffer?n._buffer=i:n._buffer=function(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var n=new e.constructor(e.length+t.length);return n.set(e),n.set(t,e.length),n}throw new Error("Unknown data type")}(n._buffer,i),n._readUntilEnoughDataOrDone(e,t)}))}},{key:"_getDataFromBuffer",value:function(e,t){e>this._bufferOffset&&(this._buffer=this._buffer.slice(e-this._bufferOffset),this._bufferOffset=e);var n=0===Se(this._buffer);return this._done&&n?null:this._buffer.slice(0,t-e)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])&&Te(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function Re(){Re=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),s=new S(i||[]);return r(a,"_invoke",{value:E(e,n,s)}),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function h(){}function p(){}function f(){}var m={};l(m,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(x([])));y&&y!==t&&n.call(y,o)&&(m=y);var v=f.prototype=h.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function i(r,o,a,s){var l=c(e[r],e,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==Ie(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var o;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){i(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function E(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=c(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function x(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=f,r(v,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(_.prototype),l(_.prototype,a,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),l(v,s,"Generator"),l(v,o,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=x,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function Ce(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Le(r.key),r)}}function Le(e){var t=function(e,t){if("object"!==Ie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ie(t)?t:String(t)}var Pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,i;return t=e,n=[{key:"openFile",value:(r=Re().mark((function e(t,n){var r;return Re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ge()||!t||void 0===t.uri){e.next=11;break}return e.prev=1,e.next=4,ye(t.uri);case 4:return r=e.sent,e.abrupt("return",new Ee(r));case 8:throw e.prev=8,e.t0=e.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(e.t0));case 11:if("function"!=typeof t.slice||void 0===t.size){e.next=13;break}return e.abrupt("return",Promise.resolve(new Ee(t)));case 13:if("function"!=typeof t.read){e.next=18;break}if(n=Number(n),Number.isFinite(n)){e.next=17;break}return e.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return e.abrupt("return",Promise.resolve(new xe(t,n)));case 18:return e.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return e.stop()}}),e,null,[[1,8]])})),i=function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function a(e){Ce(o,n,i,a,s,"next",e)}function s(e){Ce(o,n,i,a,s,"throw",e)}a(void 0)}))},function(e,t){return i.apply(this,arguments)})}],n&&Me(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ze(r.key),r)}}function Ne(e,t){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ne(e,t)}function ke(e){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ke(e)}function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ue(e,t,n){return(t=ze(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e){var t=function(e,t){if("object"!==De(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===De(t)?t:String(t)}var Ge=Be(Be({},K.defaultOptions),{},{httpStack:new pe,fileReader:new Pe,urlStorage:ae?new se:new J,fingerprint:function(e,t){return ge()?Promise.resolve(function(e,t){var n=e.exif?function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",n,t.endpoint].join("/")}(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}}),Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}(a,e);var t,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ke(r);if(i){var n=ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t=Be(Be({},Ge),t),o.call(this,e,t)}return t=a,n=[{key:"terminate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=Be(Be({},Ge),t),K.terminate(e,t)}}],null&&Oe(t.prototype,null),n&&Oe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(K),je=window,He=je.XMLHttpRequest,Ze=je.Blob;He&&Ze&&Ze.prototype.slice;class qe extends Error{constructor(e,t){void 0===t&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}const We=qe;var Ye=n(5786);class Ke extends Error{constructor(e,t){void 0===t&&(t={}),super(e),this.cause=t.cause,this.cause&&(0,Ye.Z)(this.cause,"isNetworkError")&&(this.isNetworkError=this.cause.isNetworkError)}}const $e=Ke;class Xe extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}const Qe=Xe;let Je;function et(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var tt=0;function nt(e){return"__private_"+tt+++"_"+e}const rt=new Map;var it=nt("companionHeaders"),ot=nt("getUrl");Je=Symbol.for("uppy test: getCompanionHeaders");class at{constructor(e,t){Object.defineProperty(this,ot,{value:st}),Object.defineProperty(this,it,{writable:!0,value:void 0}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),et(this,it)[it]=null==t?void 0:t.companionHeaders}setCompanionHeaders(e){et(this,it)[it]=e}[Je](){return et(this,it)[it]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}async headers(){return{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":`@uppy/companion-client=${at.VERSION}`,...et(this,it)[it]}}onReceiveResponse(e){let{headers:t}=e;const n=this.uppy.getState().companion||{},r=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==n[r]&&this.uppy.setState({companion:{...n,[r]:t.get("i-am")}})}async preflight(e){const t=rt.get(this.hostname);if(null!=t)return t;const n=["accept","content-type","uppy-auth-token"],r=(async()=>{try{const t=(await fetch(et(this,ot)[ot](e),{method:"OPTIONS"})).headers.get("access-control-allow-headers");if(null==t||"*"===t)return rt.set(this.hostname,n),n;this.uppy.log(`[CompanionClient] adding allowed preflight headers to companion cache: ${this.hostname} ${t}`);const r=t.split(",").map((e=>e.trim().toLowerCase()));return rt.set(this.hostname,r),r}catch(e){return this.uppy.log(`[CompanionClient] unable to make preflight request ${e}`,"warning"),rt.delete(this.hostname),n}})();return rt.set(this.hostname,r),r}async preflightAndHeaders(e){const[t,n]=await Promise.all([this.preflight(e),this.headers()]);return Object.fromEntries(Object.entries(n).filter((e=>{let[n]=e;return!!t.includes(n.toLowerCase())||(this.uppy.log(`[CompanionClient] excluding disallowed header ${n}`),!1)})))}async request(e){let{path:t,method:n="GET",data:r,skipPostResponse:i,signal:o}=e;try{const e=await this.preflightAndHeaders(t),a=await function(){return fetch(...arguments).catch((e=>{throw"AbortError"===e.name?e:new We(e)}))}(et(this,ot)[ot](t),{method:n,signal:o,headers:e,credentials:this.opts.companionCookiesRule||"same-origin",body:r?JSON.stringify(r):null});return i||this.onReceiveResponse(a),async function(e){if(401===e.status)throw new Qe;const t=e.json();if(e.ok)return t;let n=`Failed request with status: ${e.status}. ${e.statusText}`;try{const e=await t;n=e.message?`${n} message: ${e.message}`:n,n=e.requestId?`${n} request-Id: ${e.requestId}`:n}catch{}throw new Error(n)}(a)}catch(e){if(null!=e&&e.isAuthError)throw e;throw new $e(`Could not ${n} ${et(this,ot)[ot](t)}`,{cause:e})}}async get(e,t){return void 0===t&&(t=void 0),"boolean"==typeof t&&(t={skipPostResponse:t}),this.request({...t,path:e})}async post(e,t,n){return void 0===n&&(n=void 0),"boolean"==typeof n&&(n={skipPostResponse:n}),this.request({...n,path:e,method:"POST",data:t})}async delete(e,t,n){return void 0===t&&(t=void 0),"boolean"==typeof n&&(n={skipPostResponse:n}),this.request({...n,path:e,method:"DELETE",data:t})}}function st(e){return/^(https?:|)\/\//.test(e)?e:`${this.hostname}/${e}`}function lt(e,t){return new Promise((n=>{localStorage.setItem(e,t),n()}))}function ut(e){return Promise.resolve(localStorage.getItem(e))}function ct(e){return new Promise((t=>{localStorage.removeItem(e),t()}))}function dt(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}at.VERSION="3.3.0";var ht=0;function pt(e){return"__private_"+ht+++"_"+e}function ft(e){return"string"==typeof e?new RegExp(`^${e}$`):e instanceof RegExp?e:void 0}var mt=pt("refreshingTokenPromise"),gt=pt("getAuthToken"),yt=pt("removeAuthToken");class vt extends at{constructor(e,t){super(e,t),Object.defineProperty(this,yt,{value:_t}),Object.defineProperty(this,gt,{value:bt}),Object.defineProperty(this,mt,{writable:!0,value:void 0}),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||(e=>this.id.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "))(),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null}async headers(){const[e,t]=await Promise.all([super.headers(),dt(this,gt)[gt]()]),n={};return t&&(n["uppy-auth-token"]=t),this.companionKeysParams&&(n["uppy-credentials-params"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...e,...n}}onReceiveResponse(e){super.onReceiveResponse(e);const t=this.uppy.getPlugin(this.pluginId),n=t.getPluginState().authenticated?401!==e.status:e.status<400;return t.setPluginState({authenticated:n}),e}async setAuthToken(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error("Could not load authentication data required for third-party login. Please try again later.")}authUrl(e){void 0===e&&(e={});const t=new URLSearchParams({state:btoa(JSON.stringify({origin:location.origin})),...e});return this.preAuthToken&&t.set("uppyPreAuthToken",this.preAuthToken),`${this.hostname}/${this.id}/connect?${t}`}async login(e){return await this.ensurePreAuth(),new Promise(((t,n)=>{const r=this.authUrl(e),i=window.open(r,"_blank"),o=e=>{if(e.source!==i)return void this.uppy.log.warn("ignoring event from unknown source",e);const{companionAllowedHosts:r}=this.uppy.getPlugin(this.pluginId).opts;if(a=e.origin,s=r,!(Array.isArray(s)?s.map(ft):[ft(s)]).some((e=>(null==e?void 0:e.test(a))||(null==e?void 0:e.test(`${a}/`)))))return void n(new Error(`rejecting event from ${e.origin} vs allowed pattern ${r}`));var a,s;const l="string"==typeof e.data?JSON.parse(e.data):e.data;if(l.error){const{uppy:e}=this,t=e.i18n("authAborted");return e.info({message:t},"warning",5e3),void n(new Error("auth aborted"))}l.token?(i.close(),window.removeEventListener("message",o),this.setAuthToken(l.token),t()):n(new Error("did not receive token from auth window"))};window.addEventListener("message",o)}))}refreshTokenUrl(){return`${this.hostname}/${this.id}/refresh-token`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async request(){await dt(this,mt)[mt];try{return await super.request(...arguments)}catch(e){if(!e.isAuthError)throw e;return await dt(this,mt)[mt],dt(this,mt)[mt]=(async()=>{try{const e=await super.request({path:this.refreshTokenUrl(),method:"POST"});await this.setAuthToken(e.uppyAuthToken)}finally{dt(this,mt)[mt]=void 0}})(),await dt(this,mt)[mt],super.request(...arguments)}}async fetchPreAuthToken(){if(this.companionKeysParams)try{const e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,"warning")}}list(e,t){return this.get(`${this.id}/list/${e||""}`,t)}async logout(e){const t=await this.get(`${this.id}/logout`,e);return await dt(this,yt)[yt](),t}static initPlugin(e,t,n){if(e.type="acquirer",e.files=[],n&&(e.opts={...n,...t}),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){const n=t.companionAllowedHosts;if(!("string"==typeof n||Array.isArray(n)||n instanceof RegExp))throw new TypeError(`${e.id}: the option "companionAllowedHosts" must be one of string, Array, RegExp`);e.opts.companionAllowedHosts=n}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts=`https://${t.companionUrl.replace(/^\/\//,"")}`:e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||r}}async function bt(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}async function _t(){return this.uppy.getPlugin(this.pluginId).storage.removeItem(this.tokenKey)}var Et=n(4800);let wt,Tt;function At(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var St=0;function xt(e){return"__private_"+St+++"_"+e}var It=xt("queued"),Rt=xt("emitter"),Ct=xt("isOpen"),Mt=xt("socket"),Lt=xt("handleMessage");wt=Symbol.for("uppy test: getSocket"),Tt=Symbol.for("uppy test: getQueued");class Pt{constructor(e){Object.defineProperty(this,It,{writable:!0,value:[]}),Object.defineProperty(this,Rt,{writable:!0,value:Et()}),Object.defineProperty(this,Ct,{writable:!0,value:!1}),Object.defineProperty(this,Mt,{writable:!0,value:void 0}),Object.defineProperty(this,Lt,{writable:!0,value:e=>{try{const t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(e){console.log(e)}}}),this.opts=e,e&&!1===e.autoOpen||this.open()}get isOpen(){return At(this,Ct)[Ct]}[wt](){return At(this,Mt)[Mt]}[Tt](){return At(this,It)[It]}open(){null==At(this,Mt)[Mt]&&(At(this,Mt)[Mt]=new WebSocket(this.opts.target),At(this,Mt)[Mt].onopen=()=>{for(At(this,Ct)[Ct]=!0;At(this,It)[It].length>0&&At(this,Ct)[Ct];){const e=At(this,It)[It].shift();this.send(e.action,e.payload)}},At(this,Mt)[Mt].onclose=()=>{At(this,Ct)[Ct]=!1,At(this,Mt)[Mt]=null},At(this,Mt)[Mt].onmessage=At(this,Lt)[Lt])}close(){var e;null==(e=At(this,Mt)[Mt])||e.close()}send(e,t){At(this,Ct)[Ct]?At(this,Mt)[Mt].send(JSON.stringify({action:e,payload:t})):At(this,It)[It].push({action:e,payload:t})}on(e,t){At(this,Rt)[Rt].on(e,t)}emit(e,t){At(this,Rt)[Rt].emit(e,t)}once(e,t){At(this,Rt)[Rt].once(e,t)}}const Dt=n(3493)((function(e,t,n){const{progress:r,bytesUploaded:i,bytesTotal:o}=t;r&&(e.uppy.log(`Upload progress: ${r}`),e.uppy.emit("upload-progress",n,{uploader:e,bytesUploaded:i,bytesTotal:o}))}),300,{leading:!0,trailing:!0});function Ot(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Nt=0;function kt(e){return"__private_"+Nt+++"_"+e}var Ft=kt("emitter"),Bt=kt("events");class Ut{constructor(e){Object.defineProperty(this,Ft,{writable:!0,value:void 0}),Object.defineProperty(this,Bt,{writable:!0,value:[]}),Ot(this,Ft)[Ft]=e}on(e,t){return Ot(this,Bt)[Bt].push([e,t]),Ot(this,Ft)[Ft].on(e,t)}remove(){for(const[e,t]of Ot(this,Bt)[Bt].splice(0))Ot(this,Ft)[Ft].off(e,t)}}function zt(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Gt=0;function Vt(e){return"__private_"+Gt+++"_"+e}function jt(e){if(null!=e){var t;const n=()=>this.abort(e.reason);e.addEventListener("abort",n,{once:!0});const r=()=>{e.removeEventListener("abort",n)};null==(t=this.then)||t.call(this,r,r)}return this}var Ht=Vt("activeRequests"),Zt=Vt("queuedHandlers"),qt=Vt("paused"),Wt=Vt("pauseTimer"),Yt=Vt("downLimit"),Kt=Vt("upperLimit"),$t=Vt("rateLimitingTimer"),Xt=Vt("call"),Qt=Vt("queueNext"),Jt=Vt("next"),en=Vt("queue"),tn=Vt("dequeue"),nn=Vt("resume"),rn=Vt("increaseLimit");class on{constructor(e){Object.defineProperty(this,tn,{value:cn}),Object.defineProperty(this,en,{value:un}),Object.defineProperty(this,Jt,{value:ln}),Object.defineProperty(this,Qt,{value:sn}),Object.defineProperty(this,Xt,{value:an}),Object.defineProperty(this,Ht,{writable:!0,value:0}),Object.defineProperty(this,Zt,{writable:!0,value:[]}),Object.defineProperty(this,qt,{writable:!0,value:!1}),Object.defineProperty(this,Wt,{writable:!0,value:void 0}),Object.defineProperty(this,Yt,{writable:!0,value:1}),Object.defineProperty(this,Kt,{writable:!0,value:void 0}),Object.defineProperty(this,$t,{writable:!0,value:void 0}),Object.defineProperty(this,nn,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,rn,{writable:!0,value:()=>{if(zt(this,qt)[qt])zt(this,$t)[$t]=setTimeout(zt(this,rn)[rn],0);else{zt(this,Yt)[Yt]=this.limit,this.limit=Math.ceil((zt(this,Kt)[Kt]+zt(this,Yt)[Yt])/2);for(let e=zt(this,Yt)[Yt];e<=this.limit;e++)zt(this,Qt)[Qt]();zt(this,Kt)[Kt]-zt(this,Yt)[Yt]>3?zt(this,$t)[$t]=setTimeout(zt(this,rn)[rn],2e3):zt(this,Yt)[Yt]=Math.floor(zt(this,Yt)[Yt]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!zt(this,qt)[qt]&&zt(this,Ht)[Ht]<this.limit?zt(this,Xt)[Xt](e):zt(this,en)[en](e,t)}wrapSyncFunction(e,t){var n=this;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];const a=n.run((()=>(e(...i),queueMicrotask((()=>a.done())),()=>{})),t);return{abortOn:jt,abort(){a.abort()}}}}wrapPromiseFunction(e,t){var n=this;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];let a;const s=new Promise(((r,o)=>{a=n.run((()=>{let t,n;try{n=Promise.resolve(e(...i))}catch(e){n=Promise.reject(e)}return n.then((e=>{t?o(t):(a.done(),r(e))}),(e=>{t?o(t):(a.done(),o(e))})),e=>{t=function(e){return new Error("Cancelled",{cause:e})}(e)}}),t)}));return s.abort=e=>{a.abort(e)},s.abortOn=jt,s}}resume(){zt(this,qt)[qt]=!1,clearTimeout(zt(this,Wt)[Wt]);for(let e=0;e<this.limit;e++)zt(this,Qt)[Qt]()}pause(e){void 0===e&&(e=null),zt(this,qt)[qt]=!0,clearTimeout(zt(this,Wt)[Wt]),null!=e&&(zt(this,Wt)[Wt]=setTimeout(zt(this,nn)[nn],e))}rateLimit(e){clearTimeout(zt(this,$t)[$t]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(zt(this,Kt)[Kt]=this.limit-1,this.limit=zt(this,Yt)[Yt],zt(this,$t)[$t]=setTimeout(zt(this,rn)[rn],e))}get isPaused(){return zt(this,qt)[qt]}}function an(e){zt(this,Ht)[Ht]+=1;let t,n=!1;try{t=e()}catch(e){throw zt(this,Ht)[Ht]-=1,e}return{abort:e=>{n||(n=!0,zt(this,Ht)[Ht]-=1,t(e),zt(this,Qt)[Qt]())},done:()=>{n||(n=!0,zt(this,Ht)[Ht]-=1,zt(this,Qt)[Qt]())}}}function sn(){queueMicrotask((()=>zt(this,Jt)[Jt]()))}function ln(){if(zt(this,qt)[qt]||zt(this,Ht)[Ht]>=this.limit)return;if(0===zt(this,Zt)[Zt].length)return;const e=zt(this,Zt)[Zt].shift(),t=zt(this,Xt)[Xt](e.fn);e.abort=t.abort,e.done=t.done}function un(e,t){void 0===t&&(t={});const n={fn:e,priority:t.priority||0,abort:()=>{zt(this,tn)[tn](n)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},r=zt(this,Zt)[Zt].findIndex((e=>n.priority>e.priority));return-1===r?zt(this,Zt)[Zt].push(n):zt(this,Zt)[Zt].splice(r,0,n),n}function cn(e){const t=zt(this,Zt)[Zt].indexOf(e);-1!==t&&zt(this,Zt)[Zt].splice(t,1)}function dn(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}Symbol("__queue");var hn=0;function pn(e){return"__private_"+hn+++"_"+e}const fn={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1};var mn=pn("retryDelayIterator"),gn=pn("upload"),yn=pn("requestSocketToken"),vn=pn("uploadFiles"),bn=pn("handleUpload");class _n extends u{constructor(e,t){var n,r;super(e,t),Object.defineProperty(this,vn,{value:wn}),Object.defineProperty(this,gn,{value:En}),Object.defineProperty(this,mn,{writable:!0,value:void 0}),Object.defineProperty(this,yn,{writable:!0,value:async(e,t)=>{const n=new(e.remote.providerOptions.provider?vt:at)(this.uppy,e.remote.providerOptions),r={...this.opts};return e.tus&&Object.assign(r,e.tus),(await n.post(e.remote.url,{...e.remote.body,endpoint:r.endpoint,uploadUrl:r.uploadUrl,protocol:"tus",size:e.data.size,headers:"function"==typeof r.headers?r.headers(e):r.headers,metadata:e.meta},t)).token}}),Object.defineProperty(this,bn,{writable:!0,value:async e=>{if(0===e.length)return void this.uppy.log("[Tus] No files to upload");0===this.opts.limit&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");const t=this.uppy.getFilesByIds(e);await dn(this,vn)[vn](t)}}),this.type="uploader",this.id=this.opts.id||"Tus",this.title="Tus";const i={useFastRemoteRetry:!0,limit:20,retryDelays:fn.retryDelays,withCredentials:!1};if(this.opts={...i,...t},void 0===(null==t?void 0:t.allowedMetaFields)&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in t)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=null!=(n=this.opts.rateLimitedQueue)?n:new on(this.opts.limit),dn(this,mn)[mn]=null==(r=this.opts.retryDelays)?void 0:r.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null),this.uploaderSockets=Object.create(null),this.handleResetProgress=this.handleResetProgress.bind(this),this.setQueueRequestSocketToken(this.requests.wrapPromiseFunction(dn(this,yn)[yn],{priority:-1}))}handleResetProgress(){const e={...this.uppy.getState().files};Object.keys(e).forEach((t=>{if(e[t].tus&&e[t].tus.uploadUrl){const n={...e[t].tus};delete n.uploadUrl,e[t]={...e[t],tus:n}}})),this.uppy.setState({files:e})}resetUploaderReferences(e,t){if(void 0===t&&(t={}),this.uploaders[e]){const n=this.uploaders[e];n.abort(),t.abort&&n.abort(!0),this.uploaders[e]=null}this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)}async connectToServerSocket(e){var t=this;return new Promise(((n,r)=>{const i=e.serverToken,o=function(e){const t=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(e)[1];return`${/^http:\/\//i.test(e)?"ws":"wss"}://${t}`}(e.remote.companionUrl),a=new Pt({target:`${o}/api/${i}`,autoOpen:!1});let s;this.uploaderSockets[e.id]=a,this.uploaderEvents[e.id]=new Ut(this.uppy),this.onFileRemove(e.id,(()=>{a.send("cancel",{}),s.abort(),this.resetUploaderReferences(e.id),n(`upload ${e.id} was removed`)})),this.onPause(e.id,(e=>{e?(a.send("pause",{}),s.abort()):(s.abort(),s=this.requests.run((()=>(a.open(),a.send("resume",{}),()=>{}))))})),this.onPauseAll(e.id,(()=>{a.send("pause",{}),s.abort()})),this.onCancelAll(e.id,(function(r){let{reason:i}=void 0===r?{}:r;"user"===i&&(a.send("cancel",{}),s.abort(),t.resetUploaderReferences(e.id)),n(`upload ${e.id} was canceled`)})),this.onResumeAll(e.id,(()=>{s.abort(),e.error&&a.send("pause",{}),s=this.requests.run((()=>(a.open(),a.send("resume",{}),()=>{})))})),this.onRetry(e.id,(()=>{a.isOpen&&(a.send("pause",{}),a.send("resume",{}))})),this.onRetryAll(e.id,(()=>{a.isOpen&&(a.send("pause",{}),a.send("resume",{}))})),a.on("progress",(t=>Dt(this,t,e))),a.on("error",(t=>{const{message:n}=t.error,i=Object.assign(new Error(n),{cause:t.error});this.opts.useFastRemoteRetry?a.close():(this.resetUploaderReferences(e.id),this.uppy.setFileState(e.id,{serverToken:null})),this.uppy.emit("upload-error",e,i),s.done(),r(i)})),a.on("success",(t=>{const r={uploadURL:t.url};this.uppy.emit("upload-success",e,r),this.resetUploaderReferences(e.id),s.done(),a.close(),n()})),s=this.requests.run((()=>(e.isPaused?a.send("pause",{}):a.open(),()=>{})))}))}onReceiveUploadUrl(e,t){const n=this.uppy.getFile(e.id);n&&(n.tus&&n.tus.uploadUrl===t||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(n.id,{tus:{...n.tus,uploadUrl:t}})))}onFileRemove(e,t){this.uploaderEvents[e].on("file-removed",(n=>{e===n.id&&t(n.id)}))}onPause(e,t){this.uploaderEvents[e].on("upload-pause",((n,r)=>{e===n&&t(r)}))}onRetry(e,t){this.uploaderEvents[e].on("upload-retry",(n=>{e===n&&t()}))}onRetryAll(e,t){this.uploaderEvents[e].on("retry-all",(()=>{this.uppy.getFile(e)&&t()}))}onPauseAll(e,t){this.uploaderEvents[e].on("pause-all",(()=>{this.uppy.getFile(e)&&t()}))}onCancelAll(e,t){var n=this;this.uploaderEvents[e].on("cancel-all",(function(){n.uppy.getFile(e)&&t(...arguments)}))}onResumeAll(e,t){this.uploaderEvents[e].on("resume-all",(()=>{this.uppy.getFile(e)&&t()}))}install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(dn(this,bn)[bn]),this.uppy.on("reset-progress",this.handleResetProgress)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(dn(this,bn)[bn])}}function En(e){var t=this;return this.resetUploaderReferences(e.id),new Promise(((n,r)=>{let i,o,a;const s={...this.opts,...e.tus||{}};"function"==typeof s.headers&&(s.headers=s.headers(e));const l={...fn,...s};var u;l.fingerprint=(u=e,(e,t)=>{if("undefined"!=typeof window&&(void 0!==window.PhoneGap||void 0!==window.Cordova||void 0!==window.cordova)||"undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return Ge.fingerprint(e,t);const n=["tus",u.id,t.endpoint].join("-");return Promise.resolve(n)}),l.onBeforeRequest=t=>{let n;if(t.getUnderlyingObject().withCredentials=!!s.withCredentials,"function"==typeof s.onBeforeRequest&&(n=s.onBeforeRequest(t,e)),(0,Ye.Z)(i,"shouldBeRequeued")){if(!i.shouldBeRequeued)return Promise.reject();let t;const r=new Promise((e=>{t=e}));return i=this.requests.run((()=>(e.isPaused&&i.abort(),t(),()=>{}))),Promise.all([r,n])}return n},l.onError=t=>{var n;this.uppy.log(t);const o=t.originalRequest?t.originalRequest.getUnderlyingObject():null;(function(e){return!!e&&(0!==e.readyState&&4!==e.readyState||0===e.status)})(o)&&(t=new We(t,o)),this.resetUploaderReferences(e.id),null==(n=i)||n.abort(),this.uppy.emit("upload-error",e,t),r(t)},l.onProgress=(t,n)=>{this.onReceiveUploadUrl(e,a.url),this.uppy.emit("upload-progress",e,{uploader:this,bytesUploaded:t,bytesTotal:n})},l.onSuccess=()=>{const t={uploadURL:a.url};this.resetUploaderReferences(e.id),i.done(),this.uppy.emit("upload-success",e,t),a.url&&this.uppy.log(`Download ${a.file.name} from ${a.url}`),n(a)};const c=e=>{var t;const n=null==e||null==(t=e.originalResponse)?void 0:t.getStatus();if(429===n){if(!this.requests.isPaused){var r;const e=null==(r=dn(this,mn)[mn])?void 0:r.next();if(null==e||e.done)return!1;this.requests.rateLimit(e.value)}}else{if(n>400&&n<500&&409!==n&&423!==n)return!1;"undefined"!=typeof navigator&&!1===navigator.onLine&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",(()=>{this.requests.resume()}),{once:!0})))}return i.abort(),i={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};null!=s.onShouldRetry?l.onShouldRetry=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.onShouldRetry(...t,c)}:l.onShouldRetry=c;const d=(e,t,n)=>{(0,Ye.Z)(e,t)&&!(0,Ye.Z)(e,n)&&(e[n]=e[t])},h={};(Array.isArray(s.allowedMetaFields)?s.allowedMetaFields:Object.keys(e.meta)).forEach((t=>{h[t]=e.meta[t]})),d(h,"type","filetype"),d(h,"name","filename"),l.metadata=h,a=new Ve(e.data,l),this.uploaders[e.id]=a,this.uploaderEvents[e.id]=new Ut(this.uppy),o=()=>(e.isPaused||a.start(),()=>{}),a.findPreviousUploads().then((t=>{const n=t[0];n&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${n.creationTime}`),a.resumeFromPreviousUpload(n))})),i=this.requests.run(o),this.onFileRemove(e.id,(t=>{i.abort(),this.resetUploaderReferences(e.id,{abort:!!a.url}),n(`upload ${t} was removed`)})),this.onPause(e.id,(e=>{i.abort(),e?a.abort():i=this.requests.run(o)})),this.onPauseAll(e.id,(()=>{i.abort(),a.abort()})),this.onCancelAll(e.id,(function(r){let{reason:o}=void 0===r?{}:r;"user"===o&&(i.abort(),t.resetUploaderReferences(e.id,{abort:!!a.url})),n(`upload ${e.id} was canceled`)})),this.onResumeAll(e.id,(()=>{i.abort(),e.error&&a.abort(),i=this.requests.run(o)}))})).catch((t=>{throw this.uppy.emit("upload-error",e,t),t}))}async function wn(e){const t=function(e){return e.filter((e=>!(e=>"error"in e&&e.error)(e)))}(e),n=function(e){return e.filter((e=>!e.progress.uploadStarted||!e.isRestored))}(t);this.uppy.emit("upload-start",n),await Promise.allSettled(t.map(((t,n)=>{const r=n+1,i=e.length;if(t.isRemote){const e=new AbortController,n=n=>{n.id===t.id&&e.abort()};this.uppy.on("file-removed",n),this.resetUploaderReferences(t.id);const r=this.uploadRemoteFile(t,{signal:e.signal});return this.requests.wrapSyncFunction((()=>{this.uppy.off("file-removed",n)}),{priority:-1})(),r}return dn(this,gn)[gn](t,r,i)})))}_n.VERSION="3.1.3"},8214:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(5786);function i(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var o=0;function a(e){return"__private_"+o+++"_"+e}function s(e,t,n){const r=[];return e.forEach((e=>"string"!=typeof e?r.push(e):t[Symbol.split](e).forEach(((e,t,i)=>{""!==e&&r.push(e),t<i.length-1&&r.push(n)})))),r}function l(e,t){const n=/\$/g;let r=[e];if(null==t)return r;for(const e of Object.keys(t))if("_"!==e){let i=t[e];"string"==typeof i&&(i=n[Symbol.replace](i,"$$$$")),r=s(r,new RegExp(`%\\{${e}\\}`,"g"),i)}return r}var u=a("apply");class c{constructor(e){Object.defineProperty(this,u,{value:d}),this.locale={strings:{},pluralize:e=>1===e?0:1},Array.isArray(e)?e.forEach(i(this,u)[u],this):i(this,u)[u](e)}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){if(!(0,r.Z)(this.locale.strings,e))throw new Error(`missing string: ${e}`);const n=this.locale.strings[e];if("object"==typeof n){if(t&&void 0!==t.smart_count)return l(n[this.locale.pluralize(t.smart_count)],t);throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}return l(n,t)}}function d(e){if(null==e||!e.strings)return;const t=this.locale;this.locale={...t,strings:{...t.strings,...e.strings}},this.locale.pluralize=e.pluralize||t.pluralize}},8674:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(1423);function i(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):(0,r.Z)(e)?e:null}},1988:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var r=n(3563);function i(e){let t="";return e.replace(/[^A-Z0-9]/gi,(e=>(t+=`-${function(e){return e.charCodeAt(0).toString(32)}(e)}`,"/")))+t}function o(e){if(function(e){return!(!e.isRemote||!e.remote)&&new Set(["box","dropbox","drive","facebook","unsplash"]).has(e.remote.provider)}(e))return e.id;const t=(0,r.Z)(e);return function(e){let t="uppy";return"string"==typeof e.name&&(t+=`-${i(e.name.toLowerCase())}`),void 0!==e.type&&(t+=`-${e.type}`),e.meta&&"string"==typeof e.meta.relativePath&&(t+=`-${i(e.meta.relativePath.toLowerCase())}`),void 0!==e.data.size&&(t+=`-${e.data.size}`),void 0!==e.data.lastModified&&(t+=`-${e.data.lastModified}`),t}({...e,type:t})}},3454:(e,t,n)=>{"use strict";function r(e){const t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}n.d(t,{Z:()=>r})},3563:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(3454);const i={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function o(e){var t;if(e.type)return e.type;const n=e.name?null==(t=(0,r.Z)(e.name).extension)?void 0:t.toLowerCase():null;return n&&n in i?i[n]:"application/octet-stream"}},9507:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir}},5786:(e,t,n)=>{"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.d(t,{Z:()=>r})},1423:(e,t,n)=>{"use strict";function r(e){return(null==e?void 0:e.nodeType)===Node.ELEMENT_NODE}n.d(t,{Z:()=>r})},7581:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=Array.from},9295:(e,t,n)=>{"use strict";function r(){}function i(e,t,n,r,i){for(var o=0,a=t.length,s=0,l=0;o<a;o++){var u=t[o];if(u.removed){if(u.value=e.join(r.slice(l,l+u.count)),l+=u.count,o&&t[o-1].added){var c=t[o-1];t[o-1]=t[o],t[o]=c}}else{if(!u.added&&i){var d=n.slice(s,s+u.count);d=d.map((function(e,t){var n=r[l+t];return n.length>e.length?n:e})),u.value=e.join(d)}else u.value=e.join(n.slice(s,s+u.count));s+=u.count,u.added||(l+=u.count)}}var h=t[a-1];return a>1&&"string"==typeof h.value&&(h.added||h.removed)&&e.equals("",h.value)&&(t[a-2].value+=h.value,t.pop()),t}r.prototype={diff:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.callback;"function"==typeof n&&(r=n,n={}),this.options=n;var o=this;function a(e){return r?(setTimeout((function(){r(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var s=(t=this.removeEmpty(this.tokenize(t))).length,l=e.length,u=1,c=s+l;n.maxEditLength&&(c=Math.min(c,n.maxEditLength));var d=[{newPos:-1,components:[]}],h=this.extractCommon(d[0],t,e,0);if(d[0].newPos+1>=s&&h+1>=l)return a([{value:this.join(t),count:t.length}]);function p(){for(var n=-1*u;n<=u;n+=2){var r=void 0,c=d[n-1],h=d[n+1],p=(h?h.newPos:0)-n;c&&(d[n-1]=void 0);var f=c&&c.newPos+1<s,m=h&&0<=p&&p<l;if(f||m){if(!f||m&&c.newPos<h.newPos?(r={newPos:(g=h).newPos,components:g.components.slice(0)},o.pushComponent(r.components,void 0,!0)):((r=c).newPos++,o.pushComponent(r.components,!0,void 0)),p=o.extractCommon(r,t,e,n),r.newPos+1>=s&&p+1>=l)return a(i(o,r.components,t,e,o.useLongestToken));d[n]=r}else d[n]=void 0}var g;u++}if(r)!function e(){setTimeout((function(){if(u>c)return r();p()||e()}),0)}();else for(;u<=c;){var f=p();if(f)return f}},pushComponent:function(e,t,n){var r=e[e.length-1];r&&r.added===t&&r.removed===n?e[e.length-1]={count:r.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,r){for(var i=t.length,o=n.length,a=e.newPos,s=a-r,l=0;a+1<i&&s+1<o&&this.equals(t[a+1],n[s+1]);)a++,s++,l++;return l&&e.components.push({count:l}),e.newPos=a,s},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}},new r;var o=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,a=/\S/,s=new r;s.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!a.test(e)&&!a.test(t)},s.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&o.test(t[n])&&o.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var l=new r;function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}l.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var i=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),t.push(i))}return t},(new r).tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)},(new r).tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var c=Object.prototype.toString,d=new r;function h(e,t,n,r,i){var o,a;for(t=t||[],n=n||[],r&&(e=r(i,e)),o=0;o<t.length;o+=1)if(t[o]===e)return n[o];if("[object Array]"===c.call(e)){for(t.push(e),a=new Array(e.length),n.push(a),o=0;o<e.length;o+=1)a[o]=h(e[o],t,n,r,i);return t.pop(),n.pop(),a}if(e&&e.toJSON&&(e=e.toJSON()),"object"===u(e)&&null!==e){t.push(e),a={},n.push(a);var s,l=[];for(s in e)e.hasOwnProperty(s)&&l.push(s);for(l.sort(),o=0;o<l.length;o+=1)a[s=l[o]]=h(e[s],t,n,r,s);t.pop(),n.pop()}else a=e;return a}d.useLongestToken=!0,d.tokenize=l.tokenize,d.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,i=void 0===r?function(e,t){return void 0===t?n:t}:r;return"string"==typeof e?e:JSON.stringify(h(e,null,null,i),i,"  ")},d.equals=function(e,t){return r.prototype.equals.call(d,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var p=new r;p.tokenize=function(e){return e.slice()},p.join=p.removeEmpty=function(e){return e}},3041:(e,t,n)=>{"use strict";function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}n.r(t),n.d(t,{default:()=>io});var i,o,a,s,l,u={exports:{}};i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u.exports=l={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=l.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=l.normalizePath(r.path),l.buildURLFromParts(r)}var i=l.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return n.alwaysNormalize?(i.path=l.normalizePath(i.path),l.buildURLFromParts(i)):t;var a=l.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var s=o.exec(a.path);a.netLoc=s[1],a.path=s[2]}a.netLoc&&!a.path&&(a.path="/");var u={scheme:a.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(u.netLoc=a.netLoc,"/"!==i.path[0]))if(i.path){var c=a.path,d=c.substring(0,c.lastIndexOf("/")+1)+i.path;u.path=l.normalizePath(d)}else u.path=a.path,i.params||(u.params=a.params,i.query||(u.query=a.query));return null===u.path&&(u.path=n.alwaysNormalize?l.normalizePath(i.path):i.path),l.buildURLFromParts(u)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};var c=u.exports;function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}const m=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)};let g=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e}({}),y=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),v=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({});const b=function(){},_={trace:b,debug:b,log:b,warn:b,info:b,error:b};let E=_;const w=E,T=/^(\d+)x(\d+)$/,A=/(.+?)=(".*?"|.*?)(?:,|$)/g;class S{constructor(e){"string"==typeof e&&(e=S.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const n=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){const t=T.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={};for(A.lastIndex=0;null!==(t=A.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1)),n[t[1].trim()]=e}return n}}function x(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}class I{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const t in n)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==n[t]){w.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=f(new S({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=new Date(this.attr["END-DATE"]);m(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(m(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&m(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class R{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var C="audio",M="video",L="audiovideo";class P{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[C]:null,[M]:null,[L]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2),r=[];1===n.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(n[1]),r[1]=parseInt(n[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=c.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class D extends P{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new R,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!m(this.programDateTime))return null;const e=m(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,n,r,i,o=!1){const{elementaryStreams:a}=this,s=a[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,r),s.endDTS=Math.max(s.endDTS,i)):a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:i,partial:o}}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[C]=null,e[M]=null,e[L]=null}}class O extends P{constructor(e,t,n,r,i){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new R,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class N{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&m(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function k(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function F(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(e=>e.charCodeAt(0)))}var B={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},U="org.w3.clearkey",z="com.apple.streamingkeydelivery",G="com.microsoft.playready",V="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function j(e){switch(e){case z:return B.FAIRPLAY;case G:return B.PLAYREADY;case V:return B.WIDEVINE;case U:return B.CLEARKEY}}var H="edef8ba979d64acea3c827dcd51d21ed";function Z(e){switch(e){case B.FAIRPLAY:return z;case B.PLAYREADY:return G;case B.WIDEVINE:return V;case B.CLEARKEY:return U}}function q(e){const{drmSystems:t,widevineLicenseUrl:n}=e,r=t?[B.FAIRPLAY,B.WIDEVINE,B.PLAYREADY,B.CLEARKEY].filter((e=>!!t[e])):[];return!r[B.WIDEVINE]&&n&&r.push(B.WIDEVINE),r}const W="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function Y(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}const K=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,$=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,X=(e,t)=>{const n=t;let r=0;for(;K(e,t);)r+=10,r+=Q(e,t+6),$(e,t+10)&&(r+=10),t+=r;if(r>0)return e.subarray(n,n+r)},Q=(e,t)=>{let n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3],n},J=(e,t)=>K(e,t)&&Q(e,t+6)+10<=e.length-t,ee=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,te=e=>{const t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=Q(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},ne=e=>{let t=0;const n=[];for(;K(e,t);){const r=Q(e,t+6);t+=10;const i=t+r;for(;t+8<i;){const r=te(e.subarray(t)),i=re(r);i&&n.push(i),t+=r.size+10}$(e,t)&&(t+=10)}return n},re=e=>"PRIV"===e.type?ie(e):"W"===e.type[0]?ae(e):oe(e),ie=e=>{if(e.size<2)return;const t=le(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}},oe=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1;const n=le(e.data.subarray(t),!0);t+=n.length+1;const r=le(e.data.subarray(t));return{key:e.type,info:n,data:r}}const t=le(e.data.subarray(1));return{key:e.type,data:t}},ae=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1;const n=le(e.data.subarray(t),!0);t+=n.length+1;const r=le(e.data.subarray(t));return{key:e.type,info:n,data:r}}const t=le(e.data);return{key:e.type,data:t}},se=e=>{if(8===e.data.byteLength){const t=new Uint8Array(e.data),n=1&t[3];let r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}},le=(e,t=!1)=>{const n=ce();if(n){const r=n.decode(e);if(t){const e=r.indexOf("\0");return-1!==e?r.substring(0,e):r}return r.replace(/\0/g,"")}const r=e.length;let i,o,a,s="",l=0;for(;l<r;){if(i=e[l++],0===i&&t)return s;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s+=String.fromCharCode(i);break;case 12:case 13:o=e[l++],s+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e[l++],a=e[l++],s+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&a)<<0)}}return s};let ue;function ce(){return ue||void 0===self.TextDecoder||(ue=new self.TextDecoder("utf-8")),ue}const de=function(e){let t="";for(let n=0;n<e.length;n++){let r=e[n].toString(16);r.length<2&&(r="0"+r),t+=r}return t},he=Math.pow(2,32)-1,pe=[].push,fe={video:1,audio:2,id3:3,text:4};function me(e){return String.fromCharCode.apply(null,e)}function ge(e,t){const n=e[t]<<8|e[t+1];return n<0?65536+n:n}function ye(e,t){const n=ve(e,t);return n<0?4294967296+n:n}function ve(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function be(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function _e(e,t){const n=[];if(!t.length)return n;const r=e.byteLength;for(let i=0;i<r;){const o=ye(e,i),a=o>1?i+o:r;if(me(e.subarray(i+4,i+8))===t[0])if(1===t.length)n.push(e.subarray(i+8,a));else{const r=_e(e.subarray(i+8,a),t.slice(1));r.length&&pe.apply(n,r)}i=a}return n}function Ee(e){const t=[],n=e[0];let r=8;const i=ye(e,r);r+=4,r+=0===n?8:16,r+=2;let o=e.length+0;const a=ge(e,r);r+=2;for(let n=0;n<a;n++){let n=r;const a=ye(e,n);n+=4;const s=2147483647&a;if(1==(2147483648&a)>>>31)return w.warn("SIDX has hierarchical references (not supported)"),null;const l=ye(e,n);n+=4,t.push({referenceSize:s,subsegmentDuration:l,info:{duration:l/i,start:o,end:o+s-1}}),o+=s,n+=4,r=n}return{earliestPresentationTime:0,timescale:i,version:n,referencesCount:a,references:t}}function we(e){const t=[],n=_e(e,["moov","trak"]);for(let e=0;e<n.length;e++){const r=n[e],i=_e(r,["tkhd"])[0];if(i){let e=i[0],n=0===e?12:20;const o=ye(i,n),a=_e(r,["mdia","mdhd"])[0];if(a){e=a[0],n=0===e?12:20;const i=ye(a,n),s=_e(r,["mdia","hdlr"])[0];if(s){const e=me(s.subarray(8,12)),n={soun:C,vide:M}[e];if(n){const e=_e(r,["mdia","minf","stbl","stsd"])[0];let a;e&&(a=me(e.subarray(12,16))),t[o]={timescale:i,type:n},t[n]={timescale:i,id:o,codec:a}}}}}}return _e(e,["moov","mvex","trex"]).forEach((e=>{const n=ye(e,4),r=t[n];r&&(r.default={duration:ye(e,12),flags:ye(e,20)})})),t}function Te(e){const t=_e(e,["schm"])[0];if(t){const n=me(t.subarray(4,8));if("cbcs"===n||"cenc"===n)return _e(e,["schi","tenc"])[0]}return w.error("[eme] missing 'schm' box"),null}function Ae(e){const t=ye(e,0);let n=8;1&t&&(n+=4),4&t&&(n+=4);let r=0;const i=ye(e,4);for(let o=0;o<i;o++)256&t&&(r+=ye(e,n),n+=4),512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4);return r}function Se(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function xe(e,t){const n=[],r=t.samples,i=t.timescale,o=t.id;let a=!1;return _e(r,["moof"]).map((s=>{const l=s.byteOffset-8;_e(s,["traf"]).map((s=>{const u=_e(s,["tfdt"]).map((e=>{const t=e[0];let n=ye(e,4);return 1===t&&(n*=Math.pow(2,32),n+=ye(e,8)),n/i}))[0];return void 0!==u&&(e=u),_e(s,["tfhd"]).map((u=>{const c=ye(u,4),d=16777215&ye(u,0);let h=0;const p=0!=(16&d);let f=0;const m=0!=(32&d);let g=8;c===o&&(0!=(1&d)&&(g+=8),0!=(2&d)&&(g+=4),0!=(8&d)&&(h=ye(u,g),g+=4),p&&(f=ye(u,g),g+=4),m&&(g+=4),"video"===t.type&&(a=function(e){if(!e)return!1;const t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}(t.codec)),_e(s,["trun"]).map((o=>{const s=o[0],u=16777215&ye(o,0),c=0!=(1&u);let d=0;const p=0!=(4&u),m=0!=(256&u);let g=0;const y=0!=(512&u);let v=0;const b=0!=(1024&u),_=0!=(2048&u);let E=0;const w=ye(o,4);let T=8;c&&(d=ye(o,T),T+=4),p&&(T+=4);let A=d+l;for(let l=0;l<w;l++){if(m?(g=ye(o,T),T+=4):g=h,y?(v=ye(o,T),T+=4):v=f,b&&(T+=4),_&&(E=0===s?ye(o,T):ve(o,T),T+=4),t.type===M){let t=0;for(;t<v;){const o=ye(r,A);A+=4,Ie(a,r[A])&&Re(r.subarray(A,A+o),a?2:1,e+E/i,n),A+=o,t+=o+4}}e+=g/i}})))}))}))})),n}function Ie(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6==(31&t)}function Re(e,t,n,r){const i=Ce(e);let o=0;o+=t;let a=0,s=0,l=!1,u=0;for(;o<i.length;){a=0;do{if(o>=i.length)break;u=i[o++],a+=u}while(255===u);s=0;do{if(o>=i.length)break;u=i[o++],s+=u}while(255===u);const e=i.length-o;if(!l&&4===a&&o<i.length){if(l=!0,181===i[o++]){const e=ge(i,o);if(o+=2,49===e){const e=ye(i,o);if(o+=4,1195456820===e){const e=i[o++];if(3===e){const t=i[o++],s=64&t,l=s?2+3*(31&t):0,u=new Uint8Array(l);if(s){u[0]=t;for(let e=1;e<l;e++)u[e]=i[o++]}r.push({type:e,payloadType:a,pts:n,bytes:u})}}}}}else if(5===a&&s<e){if(l=!0,s>16){const e=[];for(let t=0;t<16;t++){const n=i[o++].toString(16);e.push(1==n.length?"0"+n:n),3!==t&&5!==t&&7!==t&&9!==t||e.push("-")}const t=s-16,l=new Uint8Array(t);for(let e=0;e<t;e++)l[e]=i[o++];r.push({payloadType:a,pts:n,uuid:e.join(""),userData:le(l),userDataBytes:l})}}else if(s<e)o+=s;else if(s>e)break}}function Ce(e){const t=e.byteLength,n=[];let r=1;for(;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;const i=t-n.length,o=new Uint8Array(i);let a=0;for(r=0;r<i;a++,r++)a===n[0]&&(a++,n.shift()),o[r]=e[a];return o}let Me={};class Le{static clearKeyUriToKeyIdMap(){Me={}}constructor(e,t,n,r=[1],i=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=i,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case z:case V:case G:case U:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"!==this.method||this.iv||w.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}(e);return new Le(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=function(e){const t=e.split(":");let n=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),r=e[e.length-1].split(",");if(2===r.length){const t="base64"===r[0],i=r[1];t?(e.splice(-1,1),n=k(i)):n=function(e){const t=F(e).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}(i)}}return n}(this.uri);if(t)switch(this.keyFormat){case V:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case G:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,n){if(16!==e.byteLength)throw new RangeError("Invalid system id");let r,i,o;if(t){r=1,i=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){const n=t[e];if(16!==n.byteLength)throw new RangeError("Invalid key");i.set(n,16*e)}}else r=0,i=new Uint8Array;r>0?(o=new Uint8Array(4),t.length>0&&new DataView(o.buffer).setUint32(0,t.length,!1)):o=new Uint8Array;const a=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(a.buffer).setUint32(0,n.byteLength,!1),function(e,...t){const n=t.length;let r=8,i=n;for(;i--;)r+=t[i].byteLength;const o=new Uint8Array(r);for(o[0]=r>>24&255,o[1]=r>>16&255,o[2]=r>>8&255,o[3]=255&r,o.set(e,4),i=0,r=8;i<n;i++)o.set(t[i],r),r+=t[i].byteLength;return o}([112,115,115,104],new Uint8Array([r,0,0,0]),e,o,i,a,n||new Uint8Array)}(e,null,t);const n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(n)),i=r.substring(r.indexOf("<"),r.length),o=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(o){const e=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(e){const t=k(e).subarray(0,16);!function(e){const t=function(e,t,n){const r=e[t];e[t]=e[n],e[n]=r};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=Me[this.uri];if(!e){const t=Object.keys(Me).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16),new DataView(e.buffer,12,4).setUint32(0,t),Me[this.uri]=e}this.keyId=e}return this}}const Pe=/\{\$([a-zA-Z0-9-_]+)\}/g;function De(e){return Pe.test(e)}function Oe(e,t,n){if(null!==e.variableList||e.hasVariableRefs)for(let r=n.length;r--;){const i=n[r],o=t[i];o&&(t[i]=Ne(e,o))}}function Ne(e,t){if(null!==e.variableList||e.hasVariableRefs){const n=e.variableList;return t.replace(Pe,(t=>{const r=t.substring(2,t.length-1),i=null==n?void 0:n[r];return void 0===i?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),t):i}))}return t}function ke(e,t,n){let r,i,o=e.variableList;if(o||(e.variableList=o={}),"QUERYPARAM"in t){r=t.QUERYPARAM;try{const e=new self.URL(n).searchParams;if(!e.has(r))throw new Error(`"${r}" does not match any query parameter in URI: "${n}"`);i=e.get(r)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else r=t.NAME,i=t.VALUE;r in o?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):o[r]=i||""}function Fe(e,t,n){const r=t.IMPORT;if(n&&r in n){let t=e.variableList;t||(e.variableList=t={}),t[r]=n[r]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}function Be(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}const Ue={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},ze=Be();function Ge(e,t){var n;return null!=(n=null==ze?void 0:ze.isTypeSupported(`${t||"video"}/mp4;codecs="${e}"`))&&n}const Ve=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,je=/#EXT-X-MEDIA:(.*)/g,He=/^#EXT(?:INF|-X-TARGETDURATION):/m,Ze=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),qe=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class We{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let e=t.shift()+".";return e+=parseInt(t.shift()).toString(16),e+=("000"+parseInt(t.shift()).toString(16)).slice(-4),e}return e}static resolve(e,t){return c.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return He.test(e)}static parseMasterPlaylist(e,t){const n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:De(e)},r=[];let i;for(Ve.lastIndex=0;null!=(i=Ve.exec(e));)if(i[1]){var o;const e=new S(i[1]);Oe(n,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const a=Ne(n,i[2]),s={attrs:e,bitrate:e.decimalInteger("AVERAGE-BANDWIDTH")||e.decimalInteger("BANDWIDTH"),name:e.NAME,url:We.resolve(a,t)},l=e.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),$e((e.CODECS||"").split(/[ ,]+/).filter((e=>e)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=We.convertAVC1ToAVCOTI(s.videoCodec)),null!=(o=s.unknownCodecs)&&o.length||r.push(s),n.levels.push(s)}else if(i[3]){const e=i[3],r=i[4];switch(e){case"SESSION-DATA":{const e=new S(r);Oe(n,e,["DATA-ID","LANGUAGE","VALUE","URI"]);const t=e["DATA-ID"];t&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[t]=e);break}case"SESSION-KEY":{const e=Ye(r,t,n);e.encrypted&&e.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(e)):w.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${r}"`);break}case"DEFINE":{const e=new S(r);Oe(n,e,["NAME","VALUE","QUERYPARAM"]),ke(n,e,t)}break;case"CONTENT-STEERING":{const e=new S(r);Oe(n,e,["SERVER-URI","PATHWAY-ID"]),n.contentSteering={uri:We.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":n.startTimeOffset=Ke(r)}}const a=r.length>0&&r.length<n.levels.length;return n.levels=a?r:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,t,n){let r;const i={},o=n.levels,a={AUDIO:o.map((e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec}))),SUBTITLES:o.map((e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec}))),"CLOSED-CAPTIONS":[]};let s=0;for(je.lastIndex=0;null!==(r=je.exec(e));){const e=new S(r[1]),o=e.TYPE;if(o){const r=a[o],l=i[o]||[];i[o]=l,Oe(n,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const u={attrs:e,bitrate:0,id:s++,groupId:e["GROUP-ID"]||"",instreamId:e["INSTREAM-ID"],name:e.NAME||e.LANGUAGE||"",type:o,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:e.LANGUAGE,url:e.URI?We.resolve(e.URI,t):""};if(null!=r&&r.length){const e=We.findGroup(r,u.groupId)||r[0];Xe(u,e,"audioCodec"),Xe(u,e,"textCodec")}l.push(u)}}return i}static parseLevelPlaylist(e,t,n,r,i,o){const a=new N(t),s=a.fragments;let l,u,c,d=null,h=0,p=0,g=0,y=0,v=null,b=new D(r,t),_=-1,E=!1;for(Ze.lastIndex=0,a.m3u8=e,a.hasVariableRefs=De(e);null!==(l=Ze.exec(e));){E&&(E=!1,b=new D(r,t),b.start=g,b.sn=h,b.cc=y,b.level=n,d&&(b.initSegment=d,b.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null));const e=l[1];if(e){b.duration=parseFloat(e);const t=(" "+l[2]).slice(1);b.title=t||null,b.tagList.push(t?["INF",e,t]:["INF",e])}else if(l[3]){if(m(b.duration)){b.start=g,c&&et(b,c,a),b.sn=h,b.level=n,b.cc=y,b.urlId=i,s.push(b);const e=(" "+l[3]).slice(1);b.relurl=Ne(a,e),Qe(b,v),v=b,g+=b.duration,h++,p=0,E=!0}}else if(l[4]){const e=(" "+l[4]).slice(1);v?b.setByteRange(e,v):b.setByteRange(e)}else if(l[5])b.rawProgramDateTime=(" "+l[5]).slice(1),b.tagList.push(["PROGRAM-DATE-TIME",b.rawProgramDateTime]),-1===_&&(_=s.length);else{if(l=l[0].match(qe),!l){w.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length&&void 0===l[u];u++);const e=(" "+l[u]).slice(1),i=(" "+l[u+1]).slice(1),g=l[u+2]?(" "+l[u+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":a.type=i.toUpperCase();break;case"MEDIA-SEQUENCE":h=a.startSN=parseInt(i);break;case"SKIP":{const e=new S(i);Oe(a,e,["RECENTLY-REMOVED-DATERANGES"]);const t=e.decimalInteger("SKIPPED-SEGMENTS");if(m(t)){a.skippedSegments=t;for(let e=t;e--;)s.unshift(null);h+=t}const n=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");n&&(a.recentlyRemovedDateranges=n.split("\t"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(i),1);break;case"VERSION":a.version=parseInt(i);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(i||g)&&b.tagList.push(g?[i,g]:[i]);break;case"DISCONTINUITY":y++,b.tagList.push(["DIS"]);break;case"GAP":b.gap=!0,b.tagList.push([e]);break;case"BITRATE":b.tagList.push([e,i]);break;case"DATERANGE":{const e=new S(i);Oe(a,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Oe(a,e,e.clientAttrs);const t=new I(e,a.dateRanges[e.ID]);t.isValid||a.skippedSegments?a.dateRanges[t.id]=t:w.warn(`Ignoring invalid DATERANGE tag: "${i}"`),b.tagList.push(["EXT-X-DATERANGE",i]);break}case"DEFINE":{const e=new S(i);Oe(a,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?Fe(a,e,o):ke(a,e,t)}break;case"DISCONTINUITY-SEQUENCE":y=parseInt(i);break;case"KEY":{const e=Ye(i,t,a);if(e.isSupported()){if("NONE"===e.method){c=void 0;break}c||(c={}),c[e.keyFormat]&&(c=f({},c)),c[e.keyFormat]=e}else w.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${i}"`);break}case"START":a.startTimeOffset=Ke(i);break;case"MAP":{const e=new S(i);if(Oe(a,e,["BYTERANGE","URI"]),b.duration){const i=new D(r,t);Je(i,e,n,c),d=i,b.initSegment=d,d.rawProgramDateTime&&!b.rawProgramDateTime&&(b.rawProgramDateTime=d.rawProgramDateTime)}else Je(b,e,n,c),d=b,E=!0;break}case"SERVER-CONTROL":{const e=new S(i);a.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),a.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const e=new S(i);a.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=a.partList;e||(e=a.partList=[]);const n=p>0?e[e.length-1]:void 0,r=p++,o=new S(i);Oe(a,o,["BYTERANGE","URI"]);const s=new O(o,b,t,r,n);e.push(s),b.duration+=s.duration;break}case"PRELOAD-HINT":{const e=new S(i);Oe(a,e,["URI"]),a.preloadHint=e;break}case"RENDITION-REPORT":{const e=new S(i);Oe(a,e,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(e);break}default:w.warn(`line parsed but not handled: ${l}`)}}}v&&!v.relurl?(s.pop(),g-=v.duration,a.partList&&(a.fragmentHint=v)):a.partList&&(Qe(b,v),b.cc=y,a.fragmentHint=b,c&&et(b,c,a));const T=s.length,A=s[0],x=s[T-1];if(g+=a.skippedSegments*a.targetduration,g>0&&T&&x){a.averagetargetduration=g/T;const e=x.sn;a.endSN="initSegment"!==e?e:0,a.live||(x.endList=!0),A&&(a.startCC=A.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(g+=a.fragmentHint.duration),a.totalduration=g,a.endCC=y,_>0&&function(e,t){let n=e[t];for(let r=t;r--;){const t=e[r];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(s,_),a}}function Ye(e,t,n){var r,i;const o=new S(e);Oe(n,o,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=null!=(r=o.METHOD)?r:"",s=o.URI,l=o.hexadecimalInteger("IV"),u=o.KEYFORMATVERSIONS,c=null!=(i=o.KEYFORMAT)?i:"identity";s&&o.IV&&!l&&w.error(`Invalid IV: ${o.IV}`);const d=s?We.resolve(s,t):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Le(a,d,c,h,l)}function Ke(e){const t=new S(e).decimalFloatingPoint("TIME-OFFSET");return m(t)?t:null}function $e(e,t){["video","audio","text"].forEach((n=>{const r=e.filter((e=>function(e,t){const n=Ue[t];return!!n&&!0===n[e.slice(0,4)]}(e,n)));if(r.length){const i=r.filter((e=>0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)));t[`${n}Codec`]=i.length>0?i[0]:r[0],e=e.filter((e=>-1===r.indexOf(e)))}})),t.unknownCodecs=e}function Xe(e,t,n){const r=t[n];r&&(e[n]=r)}function Qe(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),m(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function Je(e,t,n,r){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",r&&(e.levelkeys=r),e.initSegment=null}function et(e,t,n){e.levelkeys=t;const{encryptedFragments:r}=n;r.length&&r[r.length-1].levelkeys===t||!Object.keys(t).some((e=>t[e].isCommonEncryption))||r.push(e)}var tt="manifest",nt="level",rt="audioTrack",it="subtitleTrack",ot="main",at="audio",st="subtitle";function lt(e){const{type:t}=e;switch(t){case rt:return at;case it:return st;default:return ot}}function ut(e,t){let n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}class ct{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(g.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_LOADING,this.onLevelLoading,this),e.off(g.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(g.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,i=new(n||r)(t);return this.loaders[e.type]=i,i}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:tt,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:r,url:i,deliveryDirectives:o}=t;this.load({id:n,level:r,responseType:"text",type:nt,url:i,deliveryDirectives:o})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:i,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:rt,url:i,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:i,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:it,url:i,deliveryDirectives:o})}load(e){var t;const n=this.hls.config;let r,i=this.getInternalLoader(e);if(i){const t=i.context;if(t&&t.url===e.url)return void w.trace("[playlist-loader]: playlist request ongoing");w.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}if(r=e.type===tt?n.manifestLoadPolicy.default:f({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let t;if(e.type===nt&&null!==e.level?t=this.hls.levels[e.level].details:e.type===rt&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===it&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,n=t.targetduration;if(e&&n){const t=1e3*Math.max(3*e,.8*n);r=f({},r,{maxTimeToFirstByteMs:Math.min(t,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},a={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},s={onSuccess:(e,t,n,r)=>{const i=this.getInternalLoader(n);this.resetInternalLoader(n.type);const o=e.data;0===o.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),We.isMediaPlaylist(o)?this.handleTrackOrLevelPlaylist(e,t,n,r||null,i):this.handleMasterPlaylist(e,t,n,r)):this.handleManifestParsingError(e,n,new Error("no EXTM3U delimiter"),r||null,t)},onError:(e,t,n,r)=>{this.handleNetworkError(t,n,!1,e,r)},onTimeout:(e,t,n)=>{this.handleNetworkError(t,n,!0,void 0,e)}};i.load(e,a,s)}handleMasterPlaylist(e,t,n,r){const i=this.hls,o=e.data,a=ut(e,n),s=We.parseMasterPlaylist(o,a);if(s.playlistParsingError)return void this.handleManifestParsingError(e,n,s.playlistParsingError,r,t);const{contentSteering:l,levels:u,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:p}=s;this.variableList=p;const{AUDIO:f=[],SUBTITLES:m,"CLOSED-CAPTIONS":y}=We.parseMasterPlaylistMedia(o,a,s);f.length&&(f.some((e=>!e.url))||!u[0].audioCodec||u[0].attrs.AUDIO||(w.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),f.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new S({}),bitrate:0,url:""}))),i.trigger(g.MANIFEST_LOADED,{levels:u,audioTracks:f,subtitles:m,captions:y,contentSteering:l,url:a,stats:t,networkDetails:r,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,r,i){const o=this.hls,{id:a,level:s,type:l}=n,u=ut(e,n),c=m(a)?a:0,d=m(s)?s:c,h=lt(n),p=We.parseLevelPlaylist(e.data,u,d,h,c,this.variableList);if(l===tt){const e={attrs:new S({}),bitrate:0,details:p,name:"",url:u};o.trigger(g.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:u,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,r,i)}handleManifestParsingError(e,t,n,r,i){this.hls.trigger(g.ERROR,{type:y.NETWORK_ERROR,details:v.MANIFEST_PARSING_ERROR,fatal:t.type===tt,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:i})}handleNetworkError(e,t,n=!1,r,i){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===nt?o+=`: ${e.level} id: ${e.id}`:e.type!==rt&&e.type!==it||(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);w.warn(`[playlist-loader]: ${o}`);let s=v.UNKNOWN,l=!1;const u=this.getInternalLoader(e);switch(e.type){case tt:s=n?v.MANIFEST_LOAD_TIMEOUT:v.MANIFEST_LOAD_ERROR,l=!0;break;case nt:s=n?v.LEVEL_LOAD_TIMEOUT:v.LEVEL_LOAD_ERROR,l=!1;break;case rt:s=n?v.AUDIO_TRACK_LOAD_TIMEOUT:v.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case it:s=n?v.SUBTITLE_TRACK_LOAD_TIMEOUT:v.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);const c={type:y.NETWORK_ERROR,details:s,fatal:l,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:i};if(r){const n=(null==t?void 0:t.url)||e.url;c.response=h({url:n,data:void 0},r)}this.hls.trigger(g.ERROR,c)}handlePlaylistLoaded(e,t,n,r,i,o){const a=this.hls,{type:s,level:l,id:u,groupId:c,deliveryDirectives:d}=r,h=ut(t,r),p=lt(r),f="number"==typeof r.level&&p===ot?l:void 0;if(!e.fragments.length){const e=new Error("No Segments found in Playlist");return void a.trigger(g.ERROR,{type:y.NETWORK_ERROR,details:v.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:e,reason:e.message,response:t,context:r,level:f,parent:p,networkDetails:i,stats:n})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const m=e.playlistParsingError;if(m)a.trigger(g.ERROR,{type:y.NETWORK_ERROR,details:v.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:r,level:f,parent:p,networkDetails:i,stats:n});else switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),o.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case tt:case nt:a.trigger(g.LEVEL_LOADED,{details:e,level:f||0,id:u||0,stats:n,networkDetails:i,deliveryDirectives:d});break;case rt:a.trigger(g.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:i,deliveryDirectives:d});break;case it:a.trigger(g.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:n,networkDetails:i,deliveryDirectives:d})}}}function dt(e,t){let n;try{n=new Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function ht(e,t){const n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(n){w.debug(`[texttrack-utils]: ${n}`);try{const n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){w.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===n&&(e.mode=n)}function pt(e){const t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function ft(e,t,n,r){const i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&e.cues.length>0){const i=function(e,t,n){const r=[],i=function(e,t){if(t<e[0].startTime)return 0;const n=e.length-1;if(t>e[n].endTime)return-1;let r=0,i=n;for(;r<=i;){const o=Math.floor((i+r)/2);if(t<e[o].startTime)i=o-1;else{if(!(t>e[o].startTime&&r<n))return o;r=o+1}}return e[r].startTime-t<t-e[i].startTime?r:i}(e,t);if(i>-1)for(let o=i,a=e.length;o<a;o++){const i=e[o];if(i.startTime>=t&&i.endTime<=n)r.push(i);else if(i.startTime>n)return r}return r}(e.cues,t,n);for(let t=0;t<i.length;t++)r&&!r(i[t])||e.removeCue(i[t])}"disabled"===i&&(e.mode=i)}var mt="org.id3",gt="https://aomedia.org/emsg/ID3";function yt(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const vt=(()=>{const e=yt();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function bt(e,t){return e.getTime()/1e3-t}class _t{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(pt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if("metadata"===n.kind&&"id3"===n.label)return dt(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;const{samples:i}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=yt();for(let e=0;e<i.length;e++){const t=i[e].type;if(t===gt&&!n||!r)continue;const a=ne(i[e].data);if(a){const n=i[e].pts;let r=n+i[e].duration;r>vt&&(r=vt),r-n<=0&&(r=n+.25);for(let e=0;e<a.length;e++){const i=a[e];if(!ee(i)){this.updateId3CueEnds(n,t);const e=new o(n,r,"");e.value=i,t&&(e.type=t),this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var n;const r=null==(n=this.id3Track)?void 0:n.cues;if(r)for(let n=r.length;n--;){const i=r[n];i.type===t&&i.startTime<e&&i.endTime===vt&&(i.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:i,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:s}}=o;if(i&&(a||s)){let e;e="audio"===r?e=>e.type===mt&&s:"video"===r?e=>e.type===gt&&a:e=>e.type===mt&&s||e.type===gt&&a,ft(i,t,n,e)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:i}=t,o=Object.keys(i);if(r){const e=Object.keys(n).filter((e=>!o.includes(e)));for(let t=e.length;t--;){const i=e[t];Object.keys(n[i].cues).forEach((e=>{r.removeCue(n[i].cues[e])})),delete n[i]}}const a=t.fragments[t.fragments.length-1];if(0===o.length||!m(null==a?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=a.programDateTime/1e3-a.start,l=yt();for(let e=0;e<o.length;e++){const t=o[e],r=i[t],a=n[t],d=(null==a?void 0:a.cues)||{};let h=(null==a?void 0:a.durationKnown)||!1;const p=bt(r.startDate,s);let f=vt;const m=r.endDate;if(m)f=bt(m,s),h=!0;else if(r.endOnNext&&!h){const e=o.reduce(((e,t)=>{const n=i[t];return n.class===r.class&&n.id!==t&&n.startDate>r.startDate&&e.push(n),e}),[]).sort(((e,t)=>e.startDate.getTime()-t.startDate.getTime()))[0];e&&(f=bt(e.startDate,s),h=!0)}const g=Object.keys(r.attr);for(let e=0;e<g.length;e++){const n=g[e];if("ID"===(c=n)||"CLASS"===c||"START-DATE"===c||"DURATION"===c||"END-DATE"===c||"END-ON-NEXT"===c)continue;let i=d[n];if(i)h&&!a.durationKnown&&(i.endTime=f);else{let e=r.attr[n];i=new l(p,f,""),x(n)&&(u=e,e=Uint8Array.from(u.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),i.value={key:n,data:e},i.type="com.apple.quicktime.HLS",i.id=t,this.id3Track.addCue(i),d[n]=i}}n[t]={cues:d,dateRange:r,durationKnown:h}}var u,c}}class Et{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(null===e)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:i,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,s=this.hls.userConfig;let l=a&&n||t;(s.liveSyncDuration||s.liveSyncDurationCount||0===l)&&(l=void 0!==i?i:o*r);const u=r;return l+Math.min(1*this.stallCount,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;const r=n.edge,i=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,i),a)}get drift(){const{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(g.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(g.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===v.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(n=this.levelDetails)&&n.live&&w.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(null===n)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:i}=this.config;if(!r||1===i)return;const o=this.targetLatency;if(null===o)return;const a=n-o,s=a<Math.min(this.maxLatency,o+t.targetduration);if(t.live&&s&&a>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,i)),n=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(t,Math.max(1,n))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}const wt=["NONE","TYPE-0","TYPE-1",null];class Tt{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class At{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((e=>e)).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function St(e,t){const n=t.startPTS;if(m(n)){let r,i=0;t.sn>e.sn?(i=n-e.start,r=e):(i=e.start-n,r=t),r.duration!==i&&(r.duration=i)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function xt(e,t,n,r,i,o){r-n<=0&&(w.warn("Fragment should have a positive duration",t),r=n+t.duration,o=i+t.duration);let a=n,s=r;const l=t.startPTS,u=t.endPTS;if(m(l)){const e=Math.abs(l-n);m(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,a=Math.max(n,l),n=Math.min(n,l),i=Math.min(i,t.startDTS),s=Math.min(r,u),r=Math.max(r,u),o=Math.max(o,t.endDTS)}const c=n-t.start;0!==t.start&&(t.start=n),t.duration=r-t.start,t.startPTS=n,t.maxStartPTS=a,t.startDTS=i,t.endPTS=r,t.minEndPTS=s,t.endDTS=o;const d=t.sn;if(!e||d<e.startSN||d>e.endSN)return 0;let h;const p=d-e.startSN,f=e.fragments;for(f[p]=t,h=p;h>0;h--)St(f[h],f[h-1]);for(h=p;h<f.length-1;h++)St(f[h],f[h+1]);return e.fragmentHint&&St(f[f.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,c}function It(e,t){const n=t.startSN+t.skippedSegments-e.startSN,r=e.fragments;n<0||n>=r.length||Rt(t,r[n].start)}function Rt(e,t){if(t){const n=e.fragments;for(let r=e.skippedSegments;r<n.length;r++)n[r].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function Ct(e,t,n){var r;return null!=e&&e.details?Mt(null==(r=e.details)?void 0:r.partList,t,n):null}function Mt(e,t,n){if(e)for(let r=e.length;r--;){const i=e[r];if(i.index===n&&i.fragment.sn===t)return i}return null}function Lt(e){switch(e.details){case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_TIMEOUT:case v.LEVEL_LOAD_TIMEOUT:case v.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Pt(e,t){const n=Lt(t);return e.default[(n?"timeout":"error")+"Retry"]}function Dt(e,t){const n="linear"===e.backoff?1:Math.pow(2,t);return Math.min(n*e.retryDelayMs,e.maxRetryDelayMs)}function Ot(e){return h(h({},e),{errorRetry:null,timeoutRetry:null})}function Nt(e,t,n,r){return!!e&&t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(r)||!!n)}const kt={search:function(e,t){let n=0,r=e.length-1,i=null,o=null;for(;n<=r;){i=(n+r)/2|0,o=e[i];const a=t(o);if(a>0)n=i+1;else{if(!(a<0))return o;r=i-1}}return null}};function Ft(e,t,n=0,r=0){let i=null;if(e?i=t[e.sn-t[0].sn+1]||null:0===n&&0===t[0].start&&(i=t[0]),i&&0===Bt(n,r,i))return i;const o=kt.search(t,Bt.bind(null,n,r));return!o||o===e&&i?i:o}function Bt(e=0,t=0,n){if(n.start<=e&&n.start+n.duration>e)return 0;const r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-r<=e?1:n.start-r>e&&n.start?-1:0}function Ut(e,t,n){const r=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-r>e}function zt(e,t,n){if(performance.now()-e.lastErrorPerfMs>3e5)return!0;const r=e.details;if(t.details===v.FRAG_GAP&&r&&t.frag){const e=t.frag.start,n=Ft(null,r.fragments,e);if(n&&!n.gap)return!0}if(n&&e.errors.length<n.errors.length){const n=e.errors[e.errors.length-1];if(r&&n.frag&&t.frag&&Math.abs(n.frag.start-t.frag.start)>3*r.targetduration)return!0}return!1}class Gt{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=w.log.bind(w,`${t}:`),this.warn=w.warn.bind(w,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const n=null==t?void 0:t.renditionReports;if(n){let r=-1;for(let i=0;i<n.length;i++){const o=n[i];let a;try{a=new self.URL(o.URI,t.url).href}catch(e){w.warn(`Could not construct new URL for Rendition Report: ${e}`),a=o.URI||""}if(a===e){r=i;break}a===e.substring(0,a.length)&&(r=i)}if(-1!==r){const e=n[r],i=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let o=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);o>=0&&e>t.partTarget&&(o+=1)}return new Tt(i,o>=0?o:void 0,"")}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:r,stats:i}=t,o=self.performance.now(),a=i.loading.first?Math.max(0,o-i.loading.first):0;if(r.advancedDateTime=Date.now()-a,r.live||null!=n&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:"MISSED"}`),n&&r.fragments.length>0&&function(e,t){let n=null;const r=e.fragments;for(let e=r.length-1;e>=0;e--){const t=r[e].initSegment;if(t){n=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let i,o=0;if(function(e,t,n){const r=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,o=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=i;e<=o;e++){const i=l[a+e];let o=s[e];r&&!o&&e<r&&(o=t.fragments[e]=i),i&&o&&n(i,o)}}(e,t,((e,r)=>{e.relurl&&(o=e.cc-r.cc),m(e.startPTS)&&m(e.endPTS)&&(r.start=r.startPTS=e.startPTS,r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.duration=e.endPTS-e.startPTS,r.duration&&(i=r),t.PTSKnown=t.alignedSliding=!0),r.elementaryStreams=e.elementaryStreams,r.loader=e.loader,r.stats=e.stats,r.urlId=e.urlId,e.initSegment&&(r.initSegment=e.initSegment,n=e.initSegment)})),n&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((e=>{var t;e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n)})),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((e=>!e)),t.deltaUpdateFailed){w.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,n){const r=f({},e);return n&&n.forEach((e=>{delete r[e]})),Object.keys(t).forEach((e=>{const n=new I(t[e].attr,r[e]);n.isValid?r[e]=n:w.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)})),r}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const a=t.fragments;if(o){w.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<a.length;e++)a[e].cc+=o}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,n){if(e&&t){let r=0;for(let i=0,o=e.length;i<=o;i++){const o=e[i],a=t[i+r];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?n(o,a):r--}}}(e.partList,t.partList,((e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),i?xt(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):It(e,t),a.length&&(t.totalduration=t.edge-a[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const s=t.advancedDateTime;if(t.advanced&&s){const e=t.edge;t.driftStart||(t.driftStartTime=s,t.driftStart=e),t.driftEndTime=s,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}(n,r),!this.canLoad||!r.live)return;let a,s,l;if(r.canBlockReload&&r.endSN&&r.advanced){const e=this.hls.config.lowLatencyMode,i=r.lastPartSn,o=r.endSN,u=r.lastPartIndex,c=i===o;-1!==u?(s=c?o+1:i,l=c?e?0:u:u+1):s=o+1;const d=r.age,h=d+r.ageHeader;let p=Math.min(h-r.partTarget,1.5*r.targetduration);if(p>0){if(n&&p>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${p} with playlist age: ${r.age}`),p=0;else{const e=Math.floor(p/r.targetduration);s+=e,void 0!==l&&(l+=Math.round(p%r.targetduration/r.partTarget)),this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${d.toFixed(2)}s goal: ${p} skip sn ${e} to part ${l}`)}r.tuneInGoal=p}if(a=this.getDeliveryDirectives(r,t.deliveryDirectives,s,l),e||!c)return void this.loadPlaylist(a)}else r.canBlockReload&&(a=this.getDeliveryDirectives(r,t.deliveryDirectives,s,l));const u=this.hls.mainForwardBufferInfo,c=u?u.end-u.len:0,d=function(e,t=1/0){let n=1e3*e.targetduration;if(e.updated){const r=e.fragments,i=4;if(r.length&&n*i>t){const e=1e3*r[r.length-1].duration;e<n&&(n=e)}}else n/=2;return Math.round(n)}(r,1e3*(r.edge-c));r.updated&&o>this.requestScheduled+d&&(this.requestScheduled=i.loading.start),void 0!==s&&r.canBlockReload?this.requestScheduled=i.loading.first+d-(1e3*r.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+d<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=d);let h=this.requestScheduled-o;h=Math.max(0,h),this.log(`reload live playlist ${e} in ${Math.round(h)} ms`),this.timer=self.setTimeout((()=>this.loadPlaylist(a)),h)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let i=function(e,t){const{canSkipUntil:n,canSkipDateRanges:r,endSN:i}=e;return n&&(void 0!==t?t-i:0)<n?r?"v2":"YES":""}(e,n);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,i=""),new Tt(n,r,i)}checkRetry(e){const t=e.details,n=Lt(e),r=e.errorAction,{action:i,retryCount:o=0,retryConfig:a}=r||{},s=!!r&&!!a&&(5===i||!r.resolved&&2===i);if(s){var l;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Dt(a,o);this.timer=self.setTimeout((()=>this.loadPlaylist()),e),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,r.resolved=!0}return s}}let Vt;class jt extends Gt{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this),e.on(g.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this),e.off(g.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach((e=>{e.loadError=0,e.fragmentError=0})),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=[],r={};let i;t.levels.forEach((e=>{var t;const o=e.attrs;-1!==(null==(t=e.audioCodec)?void 0:t.indexOf("mp4a.40.34"))&&(Vt||(Vt=/chrome|firefox/i.test(navigator.userAgent)),Vt&&(e.audioCodec=void 0));const{AUDIO:a,CODECS:s,"FRAME-RATE":l,"PATHWAY-ID":u,RESOLUTION:c,SUBTITLES:d}=o,h=`${u||"."}-${e.bitrate}-${c}-${l}-${s}`;i=r[h],i?i.addFallback(e):(i=new At(e),r[h]=i,n.push(i)),Ht(i,"audio",a),Ht(i,"text",d)})),this.filterAndSortMediaOptions(n,t)}filterAndSortMediaOptions(e,t){let n=[],r=[],i=!1,o=!1,a=!1,s=e.filter((({audioCodec:e,videoCodec:t,width:n,height:r,unknownCodecs:s})=>(i||(i=!(!n||!r)),o||(o=!!t),a||(a=!!e),!(null!=s&&s.length)&&(!e||Ge(e,"audio"))&&(!t||Ge(t,"video")))));if((i||o)&&a&&(s=s.filter((({videoCodec:e,width:t,height:n})=>!!e||!(!t||!n)))),0===s.length)return void Promise.resolve().then((()=>{if(this.hls){const e=new Error("no level with compatible codecs found in manifest");this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}));t.audioTracks&&(n=t.audioTracks.filter((e=>!e.audioCodec||Ge(e.audioCodec,"audio"))),Zt(n)),t.subtitles&&(r=t.subtitles,Zt(r));const l=s.slice(0);s.sort(((e,t)=>e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs["FRAME-RATE"]!==t.attrs["FRAME-RATE"]?e.attrs.decimalFloatingPoint("FRAME-RATE")-t.attrs.decimalFloatingPoint("FRAME-RATE"):e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):i&&e.height!==t.height?e.height-t.height:0));let u=l[0];if(this.steering&&(s=this.steering.filterParsedLevels(s),s.length!==l.length))for(let e=0;e<l.length;e++)if(l[e].pathwayId===s[0].pathwayId){u=l[e];break}this._levels=s;for(let e=0;e<s.length;e++)if(s[e]===u){this._firstLevel=e,this.log(`manifest loaded, ${s.length} level(s) found, first bitrate: ${u.bitrate}`);break}const c=a&&!o,d={levels:s,audioTracks:n,subtitleTracks:r,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:o,altAudio:!c&&n.some((e=>!!e.url))};this.hls.trigger(g.MANIFEST_PARSED,d),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const n=new Error("invalid level idx"),r=e<0;if(this.hls.trigger(g.ERROR,{type:y.OTHER_ERROR,details:v.LEVEL_SWITCH_ERROR,level:e,fatal:r,error:n,reason:n.message}),r)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,i=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&r&&i===a)return;this.log(`Switching to level ${e}${a?" with Pathway "+a:""} from level ${n}${i?" with Pathway "+i:""}`);const s=f({},o,{level:e,maxBitrate:o.maxBitrate,attrs:o.attrs,uri:o.uri,urlId:o.urlId});delete s._attrs,delete s._urlId,this.hls.trigger(g.LEVEL_SWITCHING,s);const l=o.details;if(!l||l.live){const e=this.switchParams(o.uri,null==r?void 0:r.details);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===nt&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===ot){const e=this._levels[t.level];void 0!==e&&(e.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:i}=t,o=this._levels[r];var a;if(!o)return this.warn(`Invalid level index ${r}`),void(null!=(a=t.deliveryDirectives)&&a.skip&&(i.deltaUpdateFailed=!0));r===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):null!=(n=t.deliveryDirectives)&&n.skip&&(i.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const n=this.currentLevel;if(!n)return;const r=this.hls.audioTracks[t.id].groupId;if(n.audioGroupIds&&n.audioGroupId!==r){let e=-1;for(let t=0;t<n.audioGroupIds.length;t++)if(n.audioGroupIds[t]===r){e=t;break}-1!==e&&e!==n.urlId&&(n.urlId=e,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){const r=n.urlId;let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}const o=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${o?" Pathway "+o:""} URI ${r+1}/${n.url.length} ${i}`),this.clearTimer(),this.hls.trigger(g.LEVEL_LOADING,{url:i,level:t,id:r,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const n=(e,n)=>n!==t,r=this._levels.filter(((r,i)=>i!==e||(r.url.length>1&&void 0!==t?(r.url=r.url.filter(n),r.audioGroupIds&&(r.audioGroupIds=r.audioGroupIds.filter(n)),r.textGroupIds&&(r.textGroupIds=r.textGroupIds.filter(n)),r.urlId=0,!0):(this.steering&&this.steering.removeLevel(r),!1))));this.hls.trigger(g.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){t.forEach(((e,t)=>{const{details:n}=e;null!=n&&n.fragments&&n.fragments.forEach((e=>{e.level=t}))})),this._levels=t}}function Ht(e,t,n){n&&("audio"===t?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=n):"text"===t&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=n))}function Zt(e){const t={};e.forEach((e=>{const n=e.groupId||"";e.id=t[n]=t[n]||0,t[n]++}))}var qt="NOT_LOADED",Wt="APPENDING",Yt="PARTIAL",Kt="OK";class $t{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(g.BUFFER_APPENDED,this.onBufferAppended,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.BUFFER_APPENDED,this.onBufferAppended,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let t=n.length;t--;){const r=n[t];if(!r)break;const i=r.end;if(r.start<=e&&null!==i&&e<=i)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,r=Object.keys(n);for(let i=r.length;i--;){const o=n[r[i]];if((null==o?void 0:o.body.type)===t&&o.buffered){const t=o.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);const i=(null==r?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach((r=>{const o=this.fragments[r];if(!o)return;if(i>=o.body.sn)return;if(!o.buffered&&!o.loaded)return void(o.body.type===n&&this.removeFragment(o.body));const a=o.range[e];a&&a.time.some((e=>{const n=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return n&&this.removeFragment(o.body),n}))}))}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:r}=e;if(!t||"initSegment"===n.sn)return;const i=Qt(n),o=this.fragments[i];if(!o||o.buffered&&n.gap)return;const a=!n.relurl;Object.keys(t).forEach((e=>{const i=n.elementaryStreams[e];if(!i)return;const s=t[e],l=a||!0===i.partial;o.range[e]=this.getBufferedTimes(n,r,l,s)})),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,o.body.endList&&(this.endListFragments[o.body.type]=o),Xt(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter((t=>t.fragment.sn>=e)))}fragBuffered(e,t){const n=Qt(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const i={time:[],partial:n},o=e.start,a=e.end,s=e.minEndPTS||a,l=e.maxStartPTS||o;for(let e=0;e<r.length;e++){const t=r.start(e)-this.bufferPadding,n=r.end(e)+this.bufferPadding;if(l>=t&&s<=n){i.time.push({startPTS:Math.max(o,r.start(e)),endPTS:Math.min(a,r.end(e))});break}if(o<n&&a>t)i.partial=!0,i.time.push({startPTS:Math.max(o,r.start(e)),endPTS:Math.min(a,r.end(e))});else if(a<=t)break}return i}getPartialFragment(e){let t,n,r,i=null,o=0;const{bufferPadding:a,fragments:s}=this;return Object.keys(s).forEach((l=>{const u=s[l];u&&Xt(u)&&(n=u.body.start-a,r=u.body.end+a,e>=n&&e<=r&&(t=Math.min(e-n,r-e),o<=t&&(i=u.body,o=t)))})),i}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||Xt(t))}getState(e){const t=Qt(e),n=this.fragments[t];return n?n.buffered?Xt(n)?Yt:Kt:Wt:qt}isTimeBuffered(e,t,n){let r,i;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,i=n.end(o)+this.bufferPadding,e>=r&&t<=i)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:r}=t;if("initSegment"===n.sn||n.bitrateTest)return;const i=r?null:t,o=Qt(n);this.fragments[o]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:i}=t;if("initSegment"===n.sn)return;const o=n.type;if(r){let e=this.activePartLists[o];e||(this.activePartLists[o]=e=[]),e.push(r)}this.timeRanges=i,Object.keys(i).forEach((e=>{const t=i[e];this.detectEvictedFragments(e,t,o,r)}))}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Qt(e);return!!this.fragments[t]}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,n,r,i){r&&!this.hasGaps||Object.keys(this.fragments).forEach((o=>{const a=this.fragments[o];if(!a)return;const s=a.body;s.type!==n||r&&!s.gap||s.start<t&&s.end>e&&(a.buffered||i)&&this.removeFragment(s)}))}removeFragment(e){const t=Qt(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const t=e.sn;this.activePartLists[e.type]=n.filter((e=>e.fragment.sn!==t))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Xt(e){var t,n,r;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(n=e.range.audio)?void 0:n.partial)||(null==(r=e.range.audiovideo)?void 0:r.partial))}function Qt(e){return`${e.type}_${e.level}_${e.urlId}_${e.sn}`}const Jt=Math.pow(2,17);class en{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new rn({type:y.NETWORK_ERROR,details:v.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(n?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,i=r.fLoader,o=r.loader;return new Promise(((a,s)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some((e=>"GAP"===e[0])))return void s(nn(e));e.gap=!1}const l=this.loader=e.loader=i?new i(r):new o(r),u=tn(e),c=Ot(r.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Jt};e.stats=l.stats,l.load(u,d,{onSuccess:(t,n,r,i)=>{this.resetLoader(e,l);let o=t.data;r.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(o.slice(0,16)),o=o.slice(16)),a({frag:e,part:null,payload:o,networkDetails:i})},onError:(t,r,i,o)=>{this.resetLoader(e,l),s(new rn({type:y.NETWORK_ERROR,details:v.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:h({url:n,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:i,stats:o}))},onAbort:(t,n,r)=>{this.resetLoader(e,l),s(new rn({type:y.NETWORK_ERROR,details:v.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,n,r)=>{this.resetLoader(e,l),s(new rn({type:y.NETWORK_ERROR,details:v.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:r,stats:t}))},onProgress:(n,r,i,o)=>{t&&t({frag:e,part:null,payload:i,networkDetails:o})}})}))}loadPart(e,t,n){this.abort();const r=this.config,i=r.fLoader,o=r.loader;return new Promise(((a,s)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void s(nn(e,t));const l=this.loader=e.loader=i?new i(r):new o(r),u=tn(e,t),c=Ot(r.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Jt};t.stats=l.stats,l.load(u,d,{onSuccess:(r,i,o,s)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);const u={frag:e,part:t,payload:r.data,networkDetails:s};n(u),a(u)},onError:(n,r,i,o)=>{this.resetLoader(e,l),s(new rn({type:y.NETWORK_ERROR,details:v.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:h({url:u.url,data:void 0},n),error:new Error(`HTTP Error ${n.code} ${n.text}`),networkDetails:i,stats:o}))},onAbort:(n,r,i)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),s(new rn({type:y.NETWORK_ERROR,details:v.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:i,stats:n}))},onTimeout:(n,r,i)=>{this.resetLoader(e,l),s(new rn({type:y.NETWORK_ERROR,details:v.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${d.timeout}ms`),networkDetails:i,stats:n}))}})}))}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,i=r.total;if(n.loaded+=r.loaded,i){const r=Math.round(e.duration/t.duration),o=Math.min(Math.round(n.loaded/i),r),a=(r-o)*Math.round(n.loaded/o);n.total=n.loaded+a}else n.total=Math.max(n.loaded,n.total);const o=n.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function tn(e,t=null){const n=t||e,r={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},i=n.byteRangeStartOffset,o=n.byteRangeEndOffset;if(m(i)&&m(o)){var a;let t=i,n=o;if("initSegment"===e.sn&&"AES-128"===(null==(a=e.decryptdata)?void 0:a.method)){const e=o-i;e%16&&(n=o+(16-e%16)),0!==i&&(r.resetIV=!0,t=i-16)}r.rangeStart=t,r.rangeEnd=n}return r}function nn(e,t){const n=new Error(`GAP ${e.gap?"tag":"attribute"} found`),r={type:y.MEDIA_ERROR,details:v.FRAG_GAP,fatal:!1,frag:e,error:n,networkDetails:null};return t&&(r.part=t),(t||e).stats.aborted=!0,new rn(r)}class rn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class on{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;if(n){if(e&&e!==n.context.frag.type)return;n.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=v.KEY_LOAD_ERROR,n,r,i){return new rn({type:y.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:r}=e;for(let e=0;e<t.length;e++){const i=t[e];if(r<=i.cc&&("initSegment"===n||"initSegment"===i.sn||n<i.sn)){this.emeController.selectKeySystemFormat(i).then((e=>{i.setKeyFormat(e)}));break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((t=>this.loadInternal(e,t))):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const i=e.decryptdata;if(!i){const n=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,v.KEY_LOAD_ERROR,n))}const o=i.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,v.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if(null!=(n=a)&&n.decryptdata.key)return i.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});var s;if(null!=(r=a)&&r.keyLoadPromise)switch(null==(s=a.mediaKeySessionContext)?void 0:s.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then((t=>(i.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:a})))}switch(a=this.keyUriToKeyInfo[o]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===i.keyFormat?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,v.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(n);if(t)return(e.keyLoadPromise=t.then((t=>(e.mediaKeySessionContext=t,n)))).catch((t=>{throw e.keyLoadPromise=null,t}))}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=new(0,n.loader)(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise(((i,o)=>{const a={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},s=n.keyLoadPolicy.default,l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,n,r)=>{const{frag:a,keyInfo:s,url:l}=n;if(!a.decryptdata||s!==this.keyUriToKeyInfo[l])return o(this.createKeyLoadError(a,v.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),r));s.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,s.loader=null,i({frag:a,keyInfo:s})},onError:(e,n,r,i)=>{this.resetLoader(n),o(this.createKeyLoadError(t,v.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),r,h({url:a.url,data:void 0},e)))},onTimeout:(e,n,r)=>{this.resetLoader(n),o(this.createKeyLoadError(t,v.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),r))},onAbort:(e,n,r)=>{this.resetLoader(n),o(this.createKeyLoadError(t,v.INTERNAL_ABORTED,new Error("key loading aborted"),r))}};r.load(a,l,u)}))}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,i=n.loader;t.keyLoader===i&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],i&&i.destroy()}}class an{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const sn={length:0,start:()=>0,end:()=>0};class ln{static isBuffered(e,t){try{if(e){const n=ln.getBuffered(e);for(let e=0;e<n.length;e++)if(t>=n.start(e)&&t<=n.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,n){try{if(e){const r=ln.getBuffered(e),i=[];let o;for(o=0;o<r.length;o++)i.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(i,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort((function(e,t){return e.start-t.start||t.end-e.end}));let r=[];if(n)for(let t=0;t<e.length;t++){const i=r.length;if(i){const o=r[i-1].end;e[t].start-o<n?e[t].end>o&&(r[i-1].end=e[t].end):r.push(e[t])}else r.push(e[t])}else r=e;let i,o=0,a=t,s=t;for(let e=0;e<r.length;e++){const l=r[e].start,u=r[e].end;if(t+n>=l&&t<u)a=l,s=u,o=s-t;else if(t+n<l){i=l;break}}return{len:o,start:a||0,end:s||0,nextStart:i}}static getBuffered(e){try{return e.buffered}catch(e){return w.log("failed to get media.buffered",e),sn}}}class un{constructor(e,t,n,r=0,i=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=i,this.partial=o}}function cn(e,t){let n=null;for(let r=0,i=e.length;r<i;r++){const i=e[r];if(i&&i.cc===t){n=i;break}}return n}function dn(e,t){if(e){const n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function hn(e,t){const n=t.fragments;for(let t=0,r=n.length;t<r;t++)dn(n[t],e);t.fragmentHint&&dn(t.fragmentHint,e),t.alignedSliding=!0}function pn(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=e.fragments,r=t.fragments;if(!n.length||!r.length)return;const i=r[Math.round(r.length/2)-1],o=cn(n,i.cc)||n[Math.round(n.length/2)-1],a=i.programDateTime,s=o.programDateTime;null!==a&&null!==s&&hn((s-a)/1e3-(o.start-i.start),e)}class fn{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class mn{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class gn{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let e=0;e<4;e++)n[e]=t.getUint32(4*e);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],o=n[2],a=n[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],h=new Uint32Array(256);let p=0,f=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let n=f^f<<1^f<<2^f<<3^f<<4;n=n>>>8^255&n^99,e[p]=n,t[n]=p;const s=h[p],m=h[s],g=h[m];let y=257*h[n]^16843008*n;r[p]=y<<24|y>>>8,i[p]=y<<16|y>>>16,o[p]=y<<8|y>>>24,a[p]=y,y=16843009*g^65537*m^257*s^16843008*p,l[n]=y<<24|y>>>8,u[n]=y<<16|y>>>16,c[n]=y<<8|y>>>24,d[n]=y,p?(p=s^h[h[h[g^s]]],f^=h[h[f]]):p=f=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);const o=this.ksRows=4*(i+6+1);let a,s;const l=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),c=this.sBox,d=this.rcon,h=this.invSubMix,p=h[0],f=h[1],m=h[2],g=h[3];let y,v;for(a=0;a<o;a++)a<i?y=l[a]=t[a]:(v=y,a%i==0?(v=v<<8|v>>>24,v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v],v^=d[a/i|0]<<24):i>6&&a%i==4&&(v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v]),l[a]=y=(l[a-i]^v)>>>0);for(s=0;s<o;s++)a=o-s,v=3&s?l[a]:l[a-4],u[s]=s<4||a<=4?v:p[c[v>>>24]]^f[c[v>>>16&255]]^m[c[v>>>8&255]]^g[c[255&v]],u[s]=u[s]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,i=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,s=a[0],l=a[1],u=a[2],c=a[3],d=this.uint8ArrayToUint32Array_(n);let h=d[0],p=d[1],f=d[2],m=d[3];const g=new Int32Array(e),y=new Int32Array(g.length);let v,b,_,E,w,T,A,S,x,I,R,C,M,L;const P=this.networkToHostOrderSwap;for(;t<g.length;){for(x=P(g[t]),I=P(g[t+1]),R=P(g[t+2]),C=P(g[t+3]),w=x^i[0],T=C^i[1],A=R^i[2],S=I^i[3],M=4,L=1;L<r;L++)v=s[w>>>24]^l[T>>16&255]^u[A>>8&255]^c[255&S]^i[M],b=s[T>>>24]^l[A>>16&255]^u[S>>8&255]^c[255&w]^i[M+1],_=s[A>>>24]^l[S>>16&255]^u[w>>8&255]^c[255&T]^i[M+2],E=s[S>>>24]^l[w>>16&255]^u[T>>8&255]^c[255&A]^i[M+3],w=v,T=b,A=_,S=E,M+=4;v=o[w>>>24]<<24^o[T>>16&255]<<16^o[A>>8&255]<<8^o[255&S]^i[M],b=o[T>>>24]<<24^o[A>>16&255]<<16^o[S>>8&255]<<8^o[255&w]^i[M+1],_=o[A>>>24]<<24^o[S>>16&255]<<16^o[w>>8&255]<<8^o[255&T]^i[M+2],E=o[S>>>24]<<24^o[w>>16&255]<<16^o[T>>8&255]<<8^o[255&A]^i[M+3],y[t]=P(v^h),y[t+1]=P(E^p),y[t+2]=P(_^f),y[t+3]=P(b^m),h=x,p=I,f=R,m=C,t+=4}return y.buffer}}class yn{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?Y(e,0,t-n):e}(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise(((r,i)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const o=this.flush();o?r(o.buffer):i(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:r,currentResult:i,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=Se(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;r&&(n=r);let s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new gn),s.expandKey(t);const l=i;return this.currentResult=s.decrypt(a.buffer,0,n),this.currentIV=Y(a,-16).buffer,l||null}webCryptoDecrypt(e,t,n){const r=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new mn(r,t)),this.fastAesKey.expandKey().then((t=>r?(this.logOnce("WebCrypto AES decrypt"),new fn(r,new Uint8Array(n)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized")))).catch((r=>(w.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n))))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%16;return n!==e.length&&(t=Y(e,0,n),this.remainderData=Y(e,n)),t}logOnce(e){this.logEnabled&&(w.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const vn="STOPPED",bn="IDLE",_n="KEY_LOADING",En="FRAG_LOADING",wn="FRAG_LOADING_WAITING_RETRY",Tn="WAITING_TRACK",An="PARSING",Sn="PARSED",xn="ENDED",In="ERROR",Rn="WAITING_INIT_PTS",Cn="WAITING_LEVEL";class Mn extends an{constructor(e,t,n,r,i){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=vn,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=i,this.logPrefix=r,this.log=w.log.bind(w,`${r}:`),this.warn=w.warn.bind(w,`${r}:`),this.hls=e,this.fragmentLoader=new en(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new yn(e.config),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=vn}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1];return ln.isBuffered(this.media,e.start+e.duration/2)}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===vn&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:i}=this,o=n?n.currentTime:0,a=ln.bufferInfo(r||n,o,e.maxBufferHole);if(this.log(`media seeking to ${m(o)?o.toFixed(3):o}, state: ${i}`),this.state===xn)this.resetLoadingState();else if(t){const n=e.maxFragLookUpTolerance,r=t.start-n,i=t.start+t.duration+n;if(!a.len||i<a.start||r>a.end){const e=o>i;(o<r||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=vn,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){this._doFragLoad(e,t,n,(t=>{if(this.fragContextChanged(e))return this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const n=this.state;this.fragContextChanged(e)?(n===En||!this.fragCurrent&&n===An)&&(this.fragmentTracker.removeFragment(e),this.state=bn):("payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(g.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((t=>{this.state!==vn&&this.state!==In&&(this.warn(t),this.resetFragmentLoading(e))}))}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Wt){const t=e.type,r=this.getFwdBufferInfo(this.mediaBuffer,t),i=Math.max(e.duration,r?r.len:this.config.maxBufferLength);this.reduceMaxBufferLength(i)&&n.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Yt&&n.removeFragment(e))}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(g.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then((t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:n}=this,{payload:r}=t,i=e.decryptdata;if(r&&r.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(r),i.key.buffer,i.iv.buffer).catch((t=>{throw n.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((r=>{const i=self.performance.now();return n.trigger(g.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:o,tdecrypt:i}}),t.payload=r,t}))}return t})).then((n=>{const{fragCurrent:r,hls:i,levels:o}=this;if(!o)throw new Error("init load aborted, missing levels");const a=e.stats;this.state=bn,t.fragmentError=0,e.data=new Uint8Array(n.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),n.frag===r&&i.trigger(g.FRAG_BUFFERED,{stats:a,frag:r,part:null,id:e.type}),this.tick()})).catch((t=>{this.state!==vn&&this.state!==In&&(this.warn(t),this.resetFragmentLoading(e))}))}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var n,r,i,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===ot?"level":"track"} ${e.level} (frag:[${(null!=(n=e.startPTS)?n:NaN).toFixed(3)}-${(null!=(r=e.endPTS)?r:NaN).toFixed(3)}] > buffer:${a?function(e){let t="";const n=e.length;for(let r=0;r<n;r++)t+=`[${e.start(r).toFixed(3)}-${e.end(r).toFixed(3)}]`;return t}(ln.getBuffered(a)):"(detached)"})`),this.state=bn,a&&(!this.loadedmetadata&&e.type==ot&&a.buffered.length&&(null==(i=this.fragCurrent)?void 0:i.sn)===(null==(o=this.fragPrevious)?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:i}=e,o=!i||0===i.length||i.some((e=>!e)),a=new un(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var i;const o=null==t?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(!e.encrypted||null!=(i=e.decryptdata)&&i.key?!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=_n,this.fragCurrent=e,a=this.keyLoader.load(e).then((e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(g.KEY_LOADED,e),this.state===_n&&(this.state=bn),e})),this.hls.trigger(g.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){const i=o.partList;if(i&&r){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);const s=this.getNextPart(i,e,n);if(s>-1){const l=i[s];let u;return this.log(`Loading part sn: ${e.sn} p: ${l.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${s}-${i.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=l.start+l.duration,this.state=En,u=a?a.then((n=>!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(e,l,t,r))).catch((e=>this.handleFragLoadError(e))):this.doFragPartsLoad(e,l,t,r).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(g.FRAG_LOADING,{frag:e,part:l,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}if(!e.url||this.loadedEndOfParts(i,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),m(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=En;const s=this.config.progressive;let l;return l=s&&a?a.then((t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,r))).catch((e=>this.handleFragLoadError(e))):Promise.all([this.fragmentLoader.load(e,s?r:void 0),a]).then((([e])=>(!s&&e&&r&&r(e),e))).catch((e=>this.handleFragLoadError(e))),this.hls.trigger(g.FRAG_LOADING,{frag:e,targetBufferTime:n}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,n,r){return new Promise(((i,o)=>{var a;const s=[],l=null==(a=n.details)?void 0:a.partList,u=t=>{this.fragmentLoader.loadPart(e,t,r).then((r=>{s[t.index]=r;const o=r.part;this.hls.trigger(g.FRAG_LOADED,r);const a=Ct(n,e.sn,t.index+1)||Mt(l,e.sn,t.index+1);if(!a)return i({frag:e,part:o,partsLoaded:s});u(a)})).catch(o)};u(t)}))}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===v.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(g.ERROR,t)}else this.hls.trigger(g.ERROR,{type:y.OTHER_ERROR,details:v.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==An)return void(this.fragCurrent||this.state===vn||this.state===In||(this.state=bn));const{frag:n,part:r,level:i}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,i,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:i,part:o}=e;if(null==t||!t[r])return this.warn(`Levels object was unset while buffering fragment ${i} of level ${r}. The current chunk will not be buffered.`),null;const a=t[r],s=o>-1?Ct(a,i,o):null,l=s?s.fragment:function(e,t,n){if(null==e||!e.details)return null;const r=e.details;let i=r.fragments[t-r.startSN];return i||(i=r.fragmentHint,i&&i.sn===t?i:t<r.startSN&&n&&n.sn===t?n:null)}(a,i,n);return l?(n&&n!==l&&(l.stats=n.stats),{frag:l,part:s,level:a}):null}bufferFragmentData(e,t,n,r,i){var o;if(!e||this.state!==An)return;const{data1:a,data2:s}=e;let l=a;if(a&&s&&(l=Se(a,s)),null==(o=l)||!o.length)return;const u={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:l};if(this.hls.trigger(g.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(i)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!ln.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const n=t.currentTime,r=ln.bufferInfo(t,n,0),i=e.duration,o=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return m(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:r}}=this,i=ln.bufferInfo(e,t,r);if(0===i.len&&void 0!==i.nextStart){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&i.nextStart<o.end)return ln.bufferInfo(e,t,Math.max(i.nextStart,r))}return i}getMaxBufferLength(e){const{config:t}=this;let n;return n=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t=ot){const n=this.fragmentTracker.getAppendedFrag(e,ot);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:i}=this,o=n[0].start;let a;if(t.live){const o=i.initialLiveManifestSize;if(r<o)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${o})`),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(a=this.getInitialLiveFragment(t,n),this.startPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){const n=i.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,n,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Kt||n===Yt&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,i){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(null===a)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(null!==t&&n.len+t.len>=i)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,n){let r=-1,i=!1,o=!0;for(let a=0,s=e.length;a<s;a++){const s=e[a];if(o=o&&!s.independent,r>-1&&n<s.start)break;const l=s.loaded;l?r=-1:(i||s.independent||o)&&s.fragment===t&&(r=a),i=l}return r}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=function(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!m(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(let r=0;r<e.length;++r){const i=e[r];if(Ut(t,n,i))return i}return null}(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const i=n.sn+1;if(i>=e.startSN&&i<=e.endSN){const o=t[i-e.startSN];n.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=function(e,t){return kt.search(e,(e=>e.cc<t?1:e.cc>t?-1:0))}(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(r=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:i}=this,{fragments:o,endSN:a}=n;const{fragmentHint:s}=n,l=r.maxFragLookUpTolerance,u=n.partList,c=!!(r.lowLatencyMode&&null!=u&&u.length&&s);let d;if(c&&s&&!this.bitrateTest&&(o=o.concat(s),a=s.sn),d=e<t?Ft(i,o,e,e>t-l?0:l):o[o.length-1],d){const e=d.sn-n.startSN,t=this.fragmentTracker.getState(d);if((t===Kt||t===Yt&&d.gap)&&(i=d),i&&d.sn===i.sn&&(!c||u[0].fragment.sn>d.sn)&&i&&d.level===i.level){const t=o[e+1];d=d.sn<a&&this.fragmentTracker.getState(t)!==Kt?t:null}}return d}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,i=n.currentTime,o=e.fragments[0].start,a=e.edge,s=i>=o-t.maxFragLookUpTolerance&&i<=a;if(null!==r&&n.duration>r&&(i<r||!s)){const o=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&n.readyState<4||i<a-o)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t){const{levels:n,levelLastLoaded:r,fragPrevious:i}=this,o=null!==r?n[r]:null,a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,l=!t,u=e.alignedSliding&&m(s);if(l||!u&&!s){!function(e,t,n){t&&(function(e,t,n){if(function(e,t,n){return!(!t.details||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}(e,n,t)){const e=function(e,t,n=0){const r=e.fragments,i=t.fragments;if(!i.length||!r.length)return void w.log("No fragments to align");const o=cn(r,i[0].cc);if(o&&(!o||o.startPTS))return o;w.log("No frag in previous level to align on")}(n.details,t);e&&m(e.start)&&(w.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),hn(e.start,t))}}(e,n,t),!n.alignedSliding&&t.details&&function(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;const n=t.fragments[0].programDateTime,r=e.fragments[0].programDateTime,i=(r-n)/1e3+t.fragments[0].start;i&&m(i)&&(w.log(`Adjusting PTS using programDateTime delta ${r-n}ms, sliding:${i.toFixed(3)} ${e.url} `),hn(i,e))}(n,t.details),n.alignedSliding||!t.details||n.skippedSegments||It(t.details,n))}(i,o,e);const n=e.fragments[0].start;return this.log(`Live playlist sliding: ${n.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${i?i.sn:"na"} fragments: ${a}`),n}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){const r=null!==this.startTimeOffset,i=r?this.startTimeOffset:e.startTimeOffset;null!==i&&m(i)?(n=t+i,i<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${i} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===wn)||(this.state=bn)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;var r;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(r=this.fragCurrent)?void 0:r.url}`);const i=t.details===v.FRAG_GAP;i&&this.fragmentTracker.fragBuffered(n,!0);const o=t.errorAction,{action:a,retryCount:s=0,retryConfig:l}=o||{};if(o&&5===a&&l){var u;this.resetStartWhenNotLoaded(null!=(u=this.levelLastLoaded)?u:n.level);const r=Dt(l,s);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${s+1}/${l.maxNumRetry} in ${r}ms`),o.resolved=!0,this.retryDate=self.performance.now()+r,this.state=wn}else l&&o?(this.resetFragmentErrors(e),s<l.maxNumRetry?i||(o.resolved=!0):w.warn(`${t.details} reached or exceeded max retry (${s})`)):2===(null==o?void 0:o.action)?this.state=Cn:this.state=In;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===An||this.state===Sn){const t=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,t),r=n&&n.len>.5;r&&this.reduceMaxBufferLength(n.len);const i=!r;return i&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),i}return!1}resetFragmentErrors(e){e===at&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==vn&&(this.state=bn)}afterBufferFlushed(e,t,n){if(!e)return;const r=ln.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===xn&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=bn}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var i;const o=n.details;if(o){if(Object.keys(e.elementaryStreams).reduce(((t,i)=>{const a=e.elementaryStreams[i];if(a){const s=a.endPTS-a.startPTS;if(s<=0)return this.warn(`Could not parse fragment ${e.sn} ${i} duration reliably (${s})`),t||!1;const l=r?0:xt(o,e,a.startPTS,a.endPTS,a.startDTS,a.endDTS);return this.hls.trigger(g.LEVEL_PTS_UPDATED,{details:o,level:n,drift:l,type:i,frag:e,start:a.startPTS,end:a.endPTS}),!0}return t}),!1))n.fragmentError=0;else if(null===(null==(i=this.transmuxer)?void 0:i.error)){const t=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===n.fragmentError&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Sn,this.hls.trigger(g.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){var t,n,r;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(n=this.levelLastLoaded)?n:null==(r=this.fragCurrent)?void 0:r.level)?t:0),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function Ln(){return self.SourceBuffer||self.WebKitSourceBuffer}function Pn(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Dn{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Se(this.cachedData,e),this.cachedData=null);let n,r=X(e,0),i=r?r.length:0;const o=this._audioTrack,a=this._id3Track,s=r?(e=>{const t=ne(e);for(let e=0;e<t.length;e++){const n=t[e];if(ee(n))return se(n)}})(r):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&m(s))&&(this.basePTS=On(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&r.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:mt,duration:Number.POSITIVE_INFINITY});i<l;){if(this.canParse(e,i)){const t=this.appendFrame(o,e,i);t?(this.frameIndex++,this.lastPTS=t.sample.pts,i+=t.length,n=i):i=l}else J(e,i)?(r=X(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:mt,duration:Number.POSITIVE_INFINITY}),i+=r.length,n=i):i++;if(i===l&&n!==l){const t=Y(e,n);this.cachedData?this.cachedData=Se(this.cachedData,t):this.cachedData=t}}return{audioTrack:o,videoTrack:Pn(),id3Track:a,textTrack:Pn()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Pn(),id3Track:this._id3Track,textTrack:Pn()}}destroy(){}}const On=(e,t,n)=>m(e)?90*e:9e4*t+(n?9e4*n.baseTime/n.timescale:0);function Nn(e,t){return 255===e[t]&&240==(246&e[t+1])}function kn(e,t){return 1&e[t+1]?7:9}function Fn(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function Bn(e,t){return t+1<e.length&&Nn(e,t)}function Un(e,t){if(Bn(e,t)){const n=kn(e,t);if(t+n>=e.length)return!1;const r=Fn(e,t);if(r<=n)return!1;const i=t+r;return i===e.length||Bn(e,i)}return!1}function zn(e,t,n,r,i){if(!e.samplerate){const o=function(e,t,n,r){let i,o,a,s;const l=navigator.userAgent.toLowerCase(),u=r,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=1+((192&t[n+2])>>>6);const d=(60&t[n+2])>>>2;if(!(d>c.length-1))return a=(1&t[n+2])<<2,a|=(192&t[n+3])>>>6,w.log(`manifest codec:${r}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,s=new Array(4),o=d-3):(i=2,s=new Array(2),o=d):-1!==l.indexOf("android")?(i=2,s=new Array(2),o=d):(i=5,s=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&d>=6?o=d-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(d>=6&&1===a||/vivaldi/i.test(l))||!r&&1===a)&&(i=2,s=new Array(2)),o=d)),s[0]=i<<3,s[0]|=(14&d)>>1,s[1]|=(1&d)<<7,s[1]|=a<<3,5===i&&(s[1]|=(14&o)>>1,s[2]=(1&o)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[d],channelCount:a,codec:"mp4a.40."+i,manifestCodec:u};e.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${d}`})}(t,n,r,i);if(!o)return;e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,w.log(`parsed codec:${e.codec}, rate:${o.samplerate}, channels:${o.channelCount}`)}}function Gn(e){return 9216e4/e}function Vn(e,t,n,r,i){const o=r+i*Gn(e.samplerate),a=function(e,t){const n=kn(e,t);if(t+n<=e.length){const r=Fn(e,t)-n;if(r>0)return{headerLength:n,frameLength:r}}}(t,n);let s;if(a){const{frameLength:r,headerLength:i}=a,l=i+r,u=Math.max(0,n+l-t.length);u?(s=new Uint8Array(l-i),s.set(t.subarray(n+i,t.length),0)):s=t.subarray(n+i,n+l);const c={unit:s,pts:o};return u||e.samples.push(c),{sample:c,length:l,missing:u}}const l=t.length-n;return s=new Uint8Array(l),s.set(t.subarray(n,t.length),0),{sample:{unit:s,pts:o},length:l,missing:-1}}const jn=/\/emsg[-/]ID3/i;let Hn=null;const Zn=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],qn=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Wn=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Yn=[0,1,1,4];function Kn(e,t,n,r,i){if(n+24>t.length)return;const o=$n(t,n);if(o&&n+o.frameLength<=t.length){const a=r+i*(9e4*o.samplesPerFrame/o.sampleRate),s={unit:t.subarray(n,n+o.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(s),{sample:s,length:o.frameLength,missing:0}}}function $n(e,t){const n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3;if(1!==n&&0!==i&&15!==i&&3!==o){const a=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*Zn[14*(3===n?3-r:3===r?3:4)+i-1],u=qn[3*(3===n?0:2===n?1:2)+o],c=3===s?1:2,d=Wn[n][r],h=Yn[r],p=8*d*h,f=Math.floor(d*l/u+a)*h;if(null===Hn){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Hn=e?parseInt(e[1]):0}return!!Hn&&Hn<=87&&2===r&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:f,samplesPerFrame:p}}}function Xn(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function Qn(e,t){return t+1<e.length&&Xn(e,t)}function Jn(e,t){if(t+1<e.length&&Xn(e,t)){const n=4,r=$n(e,t);let i=n;null!=r&&r.frameLength&&(i=r.frameLength);const o=t+i;return o===e.length||Qn(e,o)}return!1}class er{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&w.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,n=8,r=8;for(let i=0;i<e;i++)0!==r&&(t=this.readEG(),r=(n+t+256)%256),n=0===r?n:r}readSPS(){let e,t,n,r=0,i=0,o=0,a=0;const s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),h=this.skipEG.bind(this),p=this.skipUEG.bind(this),f=this.skipScalingList.bind(this);s();const m=s();if(l(5),d(3),s(),p(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){const e=u();if(3===e&&d(1),p(),p(),d(1),c())for(t=3!==e?8:12,n=0;n<t;n++)c()&&f(n<6?16:64)}p();const g=u();if(0===g)u();else if(1===g)for(d(1),h(),h(),e=u(),n=0;n<e;n++)h();p(),d(1);const y=u(),v=u(),b=l(1);0===b&&d(1),d(1),c()&&(r=u(),i=u(),o=u(),a=u());let _=[1,1];if(c()&&c())switch(s()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(y+1)-2*r-2*i),height:(2-b)*(v+1)*16-(b?2:4)*(o+a),pixelRatio:_}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class tr{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new yn(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const i=r.subarray(16,r.length-r.length%16),o=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(o).then((i=>{const o=new Uint8Array(i);r.set(o,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}))}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,n),this.decrypter.isSync())))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t);let r=0;for(let t=32;t<e.length-16;t+=160,r+=16)n.set(e.subarray(t,t+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let t=32;t<e.length-16;t+=160,r+=16)e.set(n.subarray(r,r+16),t);return e}decryptAvcSample(e,t,n,r,i){const o=Ce(i.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then((a=>{i.data=this.getAvcDecryptedUnit(o,a),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)}))}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void r();const i=e[t].units;for(;!(n>=i.length);n++){const o=i[n];if(!(o.data.length<=48||1!==o.type&&5!==o.type||(this.decryptAvcSample(e,t,n,r,o),this.decrypter.isSync())))return}}}}const nr=188;class rr{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}static probe(e){const t=rr.syncOffset(e);return t>0&&w.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){const t=e.length;let n=Math.min(940,e.length-nr)+1,r=0;for(;r<n;){let i=!1,o=-1,a=0;for(let s=r;s<t;s+=nr){if(71!==e[s]){if(a)return-1;break}if(a++,-1===o&&(o=s,0!==o&&(n=Math.min(o+18612,e.length-nr)+1)),i||(i=0===or(e,s)),i&&a>1&&(0===o&&a>2||s+nr>n))return o}r++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:fe[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=rr.createTrack("video"),this._audioTrack=rr.createTrack("audio",r),this._id3Track=rr.createTrack("id3"),this._txtTrack=rr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,n=!1,r=!1){let i;n||(this.sampleAes=null);const o=this._avcTrack,a=this._audioTrack,s=this._id3Track,l=this._txtTrack;let u=o.pid,c=o.pesData,d=a.pid,h=s.pid,p=a.pesData,f=s.pesData,m=null,b=this.pmtParsed,_=this._pmtId,E=e.length;if(this.remainderData&&(E=(e=Se(this.remainderData,e)).length,this.remainderData=null),E<nr&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:s,textTrack:l};const T=Math.max(0,rr.syncOffset(e));E-=(E-T)%nr,E<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,E,e.buffer.byteLength-E));let A=0;for(let t=T;t<E;t+=nr)if(71===e[t]){const r=!!(64&e[t+1]),g=or(e,t);let y;if((48&e[t+3])>>4>1){if(y=t+5+e[t+4],y===t+nr)continue}else y=t+4;switch(g){case u:r&&(c&&(i=lr(c))&&this.parseAVCPES(o,l,i,!1),c={data:[],size:0}),c&&(c.data.push(e.subarray(y,t+nr)),c.size+=t+nr-y);break;case d:if(r){if(p&&(i=lr(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,i);break;case"mp3":this.parseMPEGPES(a,i)}p={data:[],size:0}}p&&(p.data.push(e.subarray(y,t+nr)),p.size+=t+nr-y);break;case h:r&&(f&&(i=lr(f))&&this.parseID3PES(s,i),f={data:[],size:0}),f&&(f.data.push(e.subarray(y,t+nr)),f.size+=t+nr-y);break;case 0:r&&(y+=e[y]+1),_=this._pmtId=ar(e,y);break;case _:{r&&(y+=e[y]+1);const i=sr(e,y,this.typeSupported,n);u=i.avc,u>0&&(o.pid=u),d=i.audio,d>0&&(a.pid=d,a.segmentCodec=i.segmentCodec),h=i.id3,h>0&&(s.pid=h),null===m||b||(w.warn(`MPEG-TS PMT found at ${t} after unknown PID '${m}'. Backtracking to sync byte @${T} to parse all TS packets.`),m=null,t=T-188),b=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=g}}else A++;if(A>0){const e=new Error(`Found ${A} TS packet/s that do not start with 0x47`);this.observer.emit(g.ERROR,g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message})}o.pesData=c,a.pesData=p,s.pesData=f;const S={audioTrack:a,videoTrack:o,id3Track:s,textTrack:l};return r&&this.extractRemainingSamples(S),S}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:i}=e,o=n.pesData,a=t.pesData,s=r.pesData;let l;if(o&&(l=lr(o))?(this.parseAVCPES(n,i,l,!0),n.pesData=null):n.pesData=o,a&&(l=lr(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,l);break;case"mp3":this.parseMPEGPES(t,l)}t.pesData=null}else null!=a&&a.size&&w.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;s&&(l=lr(s))?(this.parseID3PES(r,l),r.pesData=null):r.pesData=s}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),i=this.sampleAes=new tr(this.observer,this.config,t);return this.decrypt(r,i)}decrypt(e,t){return new Promise((n=>{const{audioTrack:r,videoTrack:i}=e;r.samples&&"aac"===r.segmentCodec?t.decryptAacSamples(r.samples,0,(()=>{i.samples?t.decryptAvcSamples(i.samples,0,0,(()=>{n(e)})):n(e)})):i.samples&&t.decryptAvcSamples(i.samples,0,0,(()=>{n(e)}))}))}destroy(){this._duration=0}parseAVCPES(e,t,n,r){const i=this.parseAVCNALu(e,n.data);let o,a=this.avcSample,s=!1;n.data=null,a&&i.length&&!e.audFound&&(ur(a,e),a=this.avcSample=ir(!1,n.pts,n.dts,"")),i.forEach((r=>{var i;switch(r.type){case 1:{let t=!1;o=!0;const i=r.data;if(s&&i.length>4){const e=new er(i).readSliceType();2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;t&&null!=(l=a)&&l.frame&&!a.key&&(ur(a,e),a=this.avcSample=null),a||(a=this.avcSample=ir(!0,n.pts,n.dts,"")),a.frame=!0,a.key=t;break}case 5:o=!0,null!=(i=a)&&i.frame&&!a.key&&(ur(a,e),a=this.avcSample=null),a||(a=this.avcSample=ir(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:o=!0,Re(r.data,1,n.pts,t.samples);break;case 7:if(o=!0,s=!0,!e.sps){const t=r.data,n=new er(t).readSPS();e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t],e.duration=this._duration;const i=t.subarray(1,4);let o="avc1.";for(let e=0;e<3;e++){let t=i[e].toString(16);t.length<2&&(t="0"+t),o+=t}e.codec=o}break;case 8:o=!0,e.pps||(e.pps=[r.data]);break;case 9:o=!1,e.audFound=!0,a&&ur(a,e),a=this.avcSample=ir(!1,n.pts,n.dts,"");break;case 12:o=!0;break;default:o=!1,a&&(a.debug+="unknown NAL "+r.type+" ")}a&&o&&a.units.push(r)})),r&&a&&(ur(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let n,r=this.avcSample;if(r&&0!==r.units.length||(r=e[e.length-1]),null!=(t=r)&&t.units){const e=r.units;n=e[e.length-1]}return n}parseAVCNALu(e,t){const n=t.byteLength;let r=e.naluState||0;const i=r,o=[];let a,s,l,u=0,c=-1,d=0;for(-1===r&&(c=0,d=31&t[0],r=0,u=1);u<n;)if(a=t[u++],r)if(1!==r)if(a)if(1===a){if(c>=0){const e={data:t.subarray(c,u-r-1),type:d};o.push(e)}else{const n=this.getLastNalUnit(e.samples);if(n&&(i&&u<=4-i&&n.state&&(n.data=n.data.subarray(0,n.data.byteLength-i)),s=u-r-1,s>0)){const e=new Uint8Array(n.data.byteLength+s);e.set(n.data,0),e.set(t.subarray(0,s),n.data.byteLength),n.data=e,n.state=0}}u<n?(l=31&t[u],c=u,d=l,r=0):r=-1}else r=0;else r=3;else r=a?0:2;else r=a?0:1;if(c>=0&&r>=0){const e={data:t.subarray(c,n),type:d,state:r};o.push(e)}if(0===o.length){const n=this.getLastNalUnit(e.samples);if(n){const e=new Uint8Array(n.data.byteLength+t.byteLength);e.set(n.data,0),e.set(t,n.data.byteLength),n.data=e}}return e.naluState=r,o}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let i,o,a,s=t.data;if(r){this.aacOverFlow=null;const t=r.missing,i=r.sample.unit.byteLength;if(-1===t){const e=new Uint8Array(i+s.byteLength);e.set(r.sample.unit,0),e.set(s,i),s=e}else{const o=i-t;r.sample.unit.set(s.subarray(0,t),o),e.samples.push(r.sample),n=r.missing}}for(i=n,o=s.length;i<o-1&&!Bn(s,i);i++);if(i!==n){let e;const t=i<o-1;e=t?`AAC PES did not start with ADTS header,offset:${i}`:"No ADTS header found in AAC PES";const n=new Error(e);if(w.warn(`parsing error: ${e}`),this.observer.emit(g.ERROR,g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:n,reason:e}),!t)return}if(zn(e,this.observer,s,i,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!r)return void w.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=Gn(e.samplerate);a=r.sample.pts+t}}let l,u=0;for(;i<o;){if(l=Vn(e,s,i,a,u),i+=l.length,l.missing){this.aacOverFlow=l;break}for(u++;i<o-1&&!Bn(s,i);i++);}}parseMPEGPES(e,t){const n=t.data,r=n.length;let i=0,o=0;const a=t.pts;if(void 0!==a)for(;o<r;)if(Qn(n,o)){const t=Kn(e,n,o,a,i);if(!t)break;o+=t.length,i++}else o++;else w.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseID3PES(e,t){if(void 0===t.pts)return void w.warn("[tsdemuxer]: ID3 PES unknown PTS");const n=f({},t,{type:this._avcTrack?gt:mt,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function ir(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}function or(e,t){return((31&e[t+1])<<8)+e[t+2]}function ar(e,t){return(31&e[t+10])<<8|e[t+11]}function sr(e,t,n,r){const i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){const o=or(e,t);switch(e[t]){case 207:if(!r){w.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=o);break;case 21:-1===i.id3&&(i.id3=o);break;case 219:if(!r){w.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=o);break;case 3:case 4:!0!==n.mpeg&&!0!==n.mp3?w.log("MPEG audio found, not supported in this browser"):-1===i.audio&&(i.audio=o,i.segmentCodec="mp3");break;case 36:w.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return i}function lr(e){let t,n,r,i,o,a=0;const s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;){const e=new Uint8Array(s[0].length+s[1].length);e.set(s[0]),e.set(s[1],s[0].length),s[0]=e,s.splice(1,1)}if(t=s[0],1===(t[0]<<16)+(t[1]<<8)+t[2]){if(n=(t[4]<<8)+t[5],n&&n>e.size-6)return null;const l=t[7];192&l&&(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&l?(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,i-o>54e5&&(w.warn(`${Math.round((i-o)/9e4)}s delta between PTS and DTS, align them`),i=o)):o=i),r=t[8];let u=r+9;if(e.size<=u)return null;e.size-=u;const c=new Uint8Array(e.size);for(let e=0,n=s.length;e<n;e++){t=s[e];let n=t.byteLength;if(u){if(u>n){u-=n;continue}t=t.subarray(u),n-=u,u=0}c.set(t,a),a+=n}return n&&(n-=r+3),{data:c,pts:i,dts:o,len:n}}return null}function ur(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const n=t.samples,r=n.length;if(!r)return void t.dropped++;{const t=n[r-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}e.debug.length&&w.log(e.pts+"/"+e.dts+":"+e.debug)}class cr{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const dr=Math.pow(2,32)-1;class hr{static init(){let e;for(e in hr.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},hr.types)hr.types.hasOwnProperty(e)&&(hr.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);hr.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);hr.STTS=hr.STSC=hr.STCO=i,hr.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),hr.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),hr.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),hr.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);hr.FTYP=hr.box(hr.types.ftyp,o,s,o,a),hr.DINF=hr.box(hr.types.dinf,hr.box(hr.types.dref,r))}static box(e,...t){let n=8,r=t.length;const i=r;for(;r--;)n+=t[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=255&n,o.set(e,4),r=0,n=8;r<i;r++)o.set(t[r],n),n+=t[r].byteLength;return o}static hdlr(e){return hr.box(hr.types.hdlr,hr.HDLR_TYPES[e])}static mdat(e){return hr.box(hr.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(dr+1)),r=Math.floor(t%(dr+1));return hr.box(hr.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))}static mdia(e){return hr.box(hr.types.mdia,hr.mdhd(e.timescale,e.duration),hr.hdlr(e.type),hr.minf(e))}static mfhd(e){return hr.box(hr.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?hr.box(hr.types.minf,hr.box(hr.types.smhd,hr.SMHD),hr.DINF,hr.stbl(e)):hr.box(hr.types.minf,hr.box(hr.types.vmhd,hr.VMHD),hr.DINF,hr.stbl(e))}static moof(e,t,n){return hr.box(hr.types.moof,hr.mfhd(e),hr.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=hr.trak(e[t]);return hr.box.apply(null,[hr.types.moov,hr.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(hr.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=hr.trex(e[t]);return hr.box.apply(null,[hr.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(dr+1)),r=Math.floor(t%(dr+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return hr.box(hr.types.mvhd,i)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,i;for(r=0;r<t.length;r++)i=t[r].flags,n[r+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return hr.box(hr.types.sdtp,n)}static stbl(e){return hr.box(hr.types.stbl,hr.stsd(e),hr.box(hr.types.stts,hr.STTS),hr.box(hr.types.stsc,hr.STSC),hr.box(hr.types.stsz,hr.STSZ),hr.box(hr.types.stco,hr.STCO))}static avc1(e){let t,n,r,i=[],o=[];for(t=0;t<e.sps.length;t++)n=e.sps[t],r=n.byteLength,i.push(r>>>8&255),i.push(255&r),i=i.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)n=e.pps[t],r=n.byteLength,o.push(r>>>8&255),o.push(255&r),o=o.concat(Array.prototype.slice.call(n));const a=hr.box(hr.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(o))),s=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return hr.box(hr.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,hr.box(hr.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),hr.box(hr.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return hr.box(hr.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),hr.box(hr.types.esds,hr.esds(e)))}static mp3(e){const t=e.samplerate;return hr.box(hr.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?hr.box(hr.types.stsd,hr.STSD,hr.mp3(e)):hr.box(hr.types.stsd,hr.STSD,hr.mp4a(e)):hr.box(hr.types.stsd,hr.STSD,hr.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,r=e.width,i=e.height,o=Math.floor(n/(dr+1)),a=Math.floor(n%(dr+1));return hr.box(hr.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,i>>8&255,255&i,0,0]))}static traf(e,t){const n=hr.sdtp(e),r=e.id,i=Math.floor(t/(dr+1)),o=Math.floor(t%(dr+1));return hr.box(hr.types.traf,hr.box(hr.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),hr.box(hr.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o])),hr.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,hr.box(hr.types.trak,hr.tkhd(e),hr.mdia(e))}static trex(e){const t=e.id;return hr.box(hr.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,i=12+16*r,o=new Uint8Array(i);let a,s,l,u,c,d;for(t+=8+i,o.set(["video"===e.type?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),a=0;a<r;a++)s=n[a],l=s.duration,u=s.size,c=s.flags,d=s.cts,o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,u>>>24&255,u>>>16&255,u>>>8&255,255&u,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,d>>>24&255,d>>>16&255,d>>>8&255,255&d],12+16*a);return hr.box(hr.types.trun,o)}static initSegment(e){hr.types||hr.init();const t=hr.moov(e),n=new Uint8Array(hr.FTYP.byteLength+t.byteLength);return n.set(hr.FTYP),n.set(t,hr.FTYP.byteLength),n}}hr.types=void 0,hr.HDLR_TYPES=void 0,hr.STTS=void 0,hr.STSC=void 0,hr.STCO=void 0,hr.STSZ=void 0,hr.VMHD=void 0,hr.SMHD=void 0,hr.STSD=void 0,hr.FTYP=void 0,hr.DINF=void 0;function pr(e,t,n=1,r=!1){const i=e*t*n;return r?Math.round(i):i}function fr(e,t=!1){return pr(e,1e3,1/9e4,t)}let mr,gr=null,yr=null;class vr{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===gr){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);gr=e?parseInt(e[1]):0}if(null===yr){const e=navigator.userAgent.match(/Safari\/(\d+)/i);yr=e?parseInt(e[1]):0}}destroy(){}resetTimeStamp(e){w.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){w.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){w.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const n=e.reduce(((e,n)=>{const r=n.pts-e;return r<-4294967296?(t=!0,br(e,n.pts)):r>0?e:n.pts}),e[0].pts);return t&&w.debug("PTS rollover detected"),n}remux(e,t,n,r,i,o,a,s){let l,u,c,d,h,p,f=i,m=i;const g=e.pid>-1,y=t.pid>-1,v=t.samples.length,b=e.samples.length>0,_=a&&v>0||v>1;if((!g||b)&&(!y||_)||this.ISGenerated||a){this.ISGenerated||(c=this.generateIS(e,t,i,o));const n=this.isVideoContiguous;let r,a=-1;if(_&&(a=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!n&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,a>0){w.warn(`[mp4-remuxer]: Dropped ${a} out of ${v} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(a),t.dropped+=a,m+=(t.samples[0].pts-e)/t.inputTimeScale,r=m}else-1===a&&(w.warn(`[mp4-remuxer]: No keyframe found out of ${v} video samples`),p=!1);if(this.ISGenerated){if(b&&_){const n=this.getVideoStartPts(t.samples),r=(br(e.samples[0].pts,n)-n)/t.inputTimeScale;f+=Math.max(0,r),m+=Math.max(0,-r)}if(b){if(e.samplerate||(w.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,i,o)),u=this.remuxAudio(e,f,this.isAudioContiguous,o,y||_||s===at?m:void 0),_){const r=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(w.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,i,o)),l=this.remuxVideo(t,m,n,r)}}else _&&(l=this.remuxVideo(t,m,n,0));l&&(l.firstKeyFrame=a,l.independent=-1!==a,l.firstKeyFramePTS=r)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(h=_r(n,i,this._initPTS,this._initDTS)),r.samples.length&&(d=Er(r,i,this._initPTS))),{audio:u,video:l,initSegment:c,independent:p,text:d,id3:h}}generateIS(e,t,n,r){const i=e.samples,o=t.samples,a=this.typeSupported,s={},l=this._initPTS;let u,c,d,h=!l||r,p="audio/mp4";if(h&&(u=c=1/0),e.config&&i.length&&(e.timescale=e.samplerate,"mp3"===e.segmentCodec&&(a.mpeg?(p="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3")),s.audio={id:"audio",container:p,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&a.mpeg?new Uint8Array(0):hr.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(d=e.inputTimeScale,l&&d===l.timescale?h=!1:u=c=i[0].pts-Math.round(d*n))),t.sps&&t.pps&&o.length&&(t.timescale=t.inputTimeScale,s.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:hr.initSegment([t]),metadata:{width:t.width,height:t.height}},h))if(d=t.inputTimeScale,l&&d===l.timescale)h=!1;else{const e=this.getVideoStartPts(o),t=Math.round(d*n);c=Math.min(c,br(o[0].dts,e)-t),u=Math.min(u,e-t)}if(Object.keys(s).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:u,timescale:d},this._initDTS={baseTime:c,timescale:d}):u=d=void 0,{tracks:s,initPTS:u,timescale:d}}remuxVideo(e,t,n,r){const i=e.inputTimeScale,o=e.samples,a=[],s=o.length,l=this._initPTS;let u,c,d=this.nextAvcDts,h=8,p=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,_=!1;n&&null!==d||(d=t*i-(o[0].pts-br(o[0].dts,o[0].pts)));const E=l.baseTime*i/l.timescale;for(let e=0;e<s;e++){const t=o[e];t.pts=br(t.pts-E,d),t.dts=br(t.dts-E,d),t.dts<o[e>0?e-1:e].dts&&(_=!0)}_&&o.sort((function(e,t){const n=e.dts-t.dts,r=e.pts-t.pts;return n||r})),u=o[0].dts,c=o[o.length-1].dts;const T=c-u,A=T?Math.round(T/(s-1)):p||e.inputTimeScale/30;if(n){const e=u-d,t=e>A,n=e<-1;if((t||n)&&(t?w.warn(`AVC: ${fr(e,!0)} ms (${e}dts) hole between fragments detected, filling it`):w.warn(`AVC: ${fr(-e,!0)} ms (${e}dts) overlapping between fragments detected`),!n||d>=o[0].pts)){u=d;const t=o[0].pts-e;o[0].dts=u,o[0].pts=t,w.log(`Video: First PTS/DTS adjusted: ${fr(t,!0)}/${fr(u,!0)}, delta: ${fr(e,!0)} ms`)}}u=Math.max(0,u);let S=0,x=0;for(let e=0;e<s;e++){const t=o[e],n=t.units,r=n.length;let i=0;for(let e=0;e<r;e++)i+=n[e].data.length;x+=i,S+=r,t.length=i,t.dts=Math.max(t.dts,u),m=Math.min(t.pts,m),b=Math.max(t.pts,b)}c=o[s-1].dts;const I=x+4*S+8;let R;try{R=new Uint8Array(I)}catch(e){return void this.observer.emit(g.ERROR,g.ERROR,{type:y.MUX_ERROR,details:v.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:I,reason:`fail allocating video mdat ${I}`})}const C=new DataView(R.buffer);C.setUint32(0,I),R.set(hr.types.mdat,4);let M=!1,L=Number.POSITIVE_INFINITY,P=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(let e=0;e<s;e++){const t=o[e],n=t.units;let l,u=0;for(let e=0,t=n.length;e<t;e++){const t=n[e],r=t.data,i=t.data.byteLength;C.setUint32(h,i),h+=4,R.set(r,h),h+=i,u+=4+i}if(e<s-1)p=o[e+1].dts-t.dts,l=o[e+1].pts-t.pts;else{const n=this.config,a=e>0?t.dts-o[e-1].dts:A;if(l=e>0?t.pts-o[e-1].pts:A,n.stretchShortVideoTrack&&null!==this.nextAudioPts){const e=Math.floor(n.maxBufferHole*i),o=(r?m+r*i:this.nextAudioPts)-t.pts;o>e?(p=o-a,p<0?p=a:M=!0,w.log(`[mp4-remuxer]: It is approximately ${o/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=a}else p=a}const c=Math.round(t.pts-t.dts);L=Math.min(L,p),D=Math.max(D,p),P=Math.min(P,l),O=Math.max(O,l),a.push(new wr(t.key,p,u,c))}if(a.length)if(gr){if(gr<70){const e=a[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(yr&&O-P<D-L&&A/D<.025&&0===a[0].cts){w.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=u;for(let t=0,n=a.length;t<n;t++){const r=e+a[t].duration,i=e+a[t].cts;if(t<n-1){const e=r+a[t+1].cts;a[t].duration=e-i}else a[t].duration=t?a[t-1].duration:A;a[t].cts=0,e=r}}p=M||!p?A:p,this.nextAvcDts=d=c+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const N={data1:hr.moof(e.sequenceNumber++,u,f({},e,{samples:a})),data2:R,startPTS:m/i,endPTS:(b+p)/i,startDTS:u/i,endDTS:d/i,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,N}remuxAudio(e,t,n,r,i){const o=e.inputTimeScale,a=o/(e.samplerate?e.samplerate:o),s="aac"===e.segmentCodec?1024:1152,l=s*a,u=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,d=[],h=void 0!==i;let p=e.samples,m=c?0:8,b=this.nextAudioPts||-1;const _=t*o,E=u.baseTime*o/u.timescale;if(this.isAudioContiguous=n=n||p.length&&b>0&&(r&&Math.abs(_-b)<9e3||Math.abs(br(p[0].pts-E,_)-b)<20*l),p.forEach((function(e){e.pts=br(e.pts-E,_)})),!n||b<0){if(p=p.filter((e=>e.pts>=0)),!p.length)return;b=0===i?0:r&&!h?Math.max(0,_):p[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let n=0,r=b;n<p.length;n++){const i=p[n],a=i.pts,s=a-r,u=Math.abs(1e3*s/o);if(s<=-t*l&&h)0===n&&(w.warn(`Audio frame @ ${(a/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*s/o)} ms.`),this.nextAudioPts=b=r=a);else if(s>=t*l&&u<1e4&&h){let t=Math.round(s/l);r=a-t*l,r<0&&(t--,r+=l),0===n&&(this.nextAudioPts=b=r),w.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(r/o).toFixed(3)}s due to ${Math.round(1e3*s/o)} ms gap.`);for(let o=0;o<t;o++){const t=Math.max(r,0);let o=cr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);o||(w.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),o=i.unit.subarray()),p.splice(n,0,{unit:o,pts:t}),r+=l,n++}}i.pts=r,r+=l}}let T,A=null,S=null,x=0,I=p.length;for(;I--;)x+=p[I].unit.byteLength;for(let t=0,r=p.length;t<r;t++){const r=p[t],i=r.unit;let o=r.pts;if(null!==S)d[t-1].duration=Math.round((o-S)/a);else{if(n&&"aac"===e.segmentCodec&&(o=b),A=o,!(x>0))return;x+=m;try{T=new Uint8Array(x)}catch(e){return void this.observer.emit(g.ERROR,g.ERROR,{type:y.MUX_ERROR,details:v.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:x,reason:`fail allocating audio mdat ${x}`})}c||(new DataView(T.buffer).setUint32(0,x),T.set(hr.types.mdat,4))}T.set(i,m);const l=i.byteLength;m+=l,d.push(new wr(!0,s,l,0)),S=o}const R=d.length;if(!R)return;const C=d[d.length-1];this.nextAudioPts=b=S+a*C.duration;const M=c?new Uint8Array(0):hr.moof(e.sequenceNumber++,A/a,f({},e,{samples:d}));e.samples=[];const L=A/o,P=b/o,D={data1:M,data2:T,startPTS:L,endPTS:P,startDTS:L,endDTS:P,type:"audio",hasAudio:!0,hasVideo:!1,nb:R};return this.isAudioContiguous=!0,D}remuxEmptyAudio(e,t,n,r){const i=e.inputTimeScale,o=i/(e.samplerate?e.samplerate:i),a=this.nextAudioPts,s=this._initDTS,l=9e4*s.baseTime/s.timescale,u=(null!==a?a:r.startDTS*i)+l,c=r.endDTS*i+l,d=1024*o,h=Math.ceil((c-u)/d),p=cr.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(w.warn("[mp4-remuxer]: remux empty Audio"),!p)return void w.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");const f=[];for(let e=0;e<h;e++){const t=u+e*d;f.push({unit:p,pts:t,dts:t})}return e.samples=f,this.remuxAudio(e,t,n,!1)}}function br(e,t){let n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function _r(e,t,n,r){const i=e.samples.length;if(!i)return;const o=e.inputTimeScale;for(let a=0;a<i;a++){const i=e.samples[a];i.pts=br(i.pts-n.baseTime*o/n.timescale,t*o)/o,i.dts=br(i.dts-r.baseTime*o/r.timescale,t*o)/o}const a=e.samples;return e.samples=[],{samples:a}}function Er(e,t,n){const r=e.samples.length;if(!r)return;const i=e.inputTimeScale;for(let o=0;o<r;o++){const r=e.samples[o];r.pts=br(r.pts-n.baseTime*i/n.timescale,t*i)/i}e.samples.sort(((e,t)=>e.pts-t.pts));const o=e.samples;return e.samples=[],{samples:o}}class wr{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags=new Tr(e)}}class Tr{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function Ar(e,t){const n=null==e?void 0:e.codec;return n&&n.length>4?n:"hvc1"===n||"hev1"===n?"hvc1.1.6.L120.90":"av01"===n?"av01.0.04M.08":"avc1"===n||t===M?"avc1.42e01e":"mp4a.40.5"}try{mr=self.performance.now.bind(self.performance)}catch(e){w.debug("Unable to use Performance API on this environment"),mr="undefined"!=typeof self&&self.Date.now}const Sr=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const i=this.videoTrack=Pn("video",1),o=this.audioTrack=Pn("audio",1),a=this.txtTrack=Pn("text",1);if(this.id3Track=Pn("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const s=we(e);if(s.video){const{id:e,timescale:t,codec:n}=s.video;i.id=e,i.timescale=a.timescale=t,i.codec=n}if(s.audio){const{id:e,timescale:t,codec:n}=s.audio;o.id=e,o.timescale=t,o.codec=n}a.id=fe.text,i.sampleDuration=0,i.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return _e(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Se(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},n=_e(e,["moof"]);if(!n)return t;if(n.length<2)return t.remainder=e,t;const r=n[n.length-1];return t.valid=Y(e,0,r.byteOffset-8),t.remainder=Y(e,r.byteOffset-8),t}(n);this.remainderData=t.remainder,r.samples=t.valid||new Uint8Array}else r.samples=n;const o=this.extractID3Track(r,t);return i.samples=xe(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=xe(e,t),{videoTrack:t,audioTrack:Pn(),id3Track:r,textTrack:Pn()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=_e(e.samples,["emsg"]);r&&r.forEach((e=>{const r=function(e){const t=e[0];let n="",r="",i=0,o=0,a=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==me(e.subarray(u,u+1));)n+=me(e.subarray(u,u+1)),u+=1;for(n+=me(e.subarray(u,u+1)),u+=1;"\0"!==me(e.subarray(u,u+1));)r+=me(e.subarray(u,u+1)),u+=1;r+=me(e.subarray(u,u+1)),u+=1,i=ye(e,12),o=ye(e,16),s=ye(e,20),l=ye(e,24),u=28}else if(1===t){u+=4,i=ye(e,u),u+=4;const t=ye(e,u);u+=4;const o=ye(e,u);for(u+=4,a=2**32*t+o,Number.isSafeInteger(a)||(a=Number.MAX_SAFE_INTEGER,w.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=ye(e,u),u+=4,l=ye(e,u),u+=4;"\0"!==me(e.subarray(u,u+1));)n+=me(e.subarray(u,u+1)),u+=1;for(n+=me(e.subarray(u,u+1)),u+=1;"\0"!==me(e.subarray(u,u+1));)r+=me(e.subarray(u,u+1)),u+=1;r+=me(e.subarray(u,u+1)),u+=1}return{schemeIdUri:n,value:r,timeScale:i,presentationTime:a,presentationTimeDelta:o,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(jn.test(r.schemeIdUri)){const e=m(r.presentationTime)?r.presentationTime/r.timeScale:t+r.presentationTimeDelta/r.timeScale;let i=4294967295===r.eventDuration?Number.POSITIVE_INFINITY:r.eventDuration/r.timeScale;i<=.001&&(i=Number.POSITIVE_INFINITY);const o=r.payload;n.samples.push({data:o,len:o.byteLength,dts:e,pts:e,type:gt,duration:i})}}))}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(function(e,t){if(!e||!t)return e;const n=t.keyId;return n&&t.isCommonEncryption&&_e(e,["moov","trak"]).forEach((e=>{const t=_e(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let r=_e(t,["enca"]);const i=r.length>0;i||(r=_e(t,["encv"])),r.forEach((e=>{_e(i?e.subarray(28):e.subarray(78),["sinf"]).forEach((e=>{const t=Te(e);if(t){const e=t.subarray(8,24);e.some((e=>0!==e))||(w.log(`[eme] Patching keyId in 'enc${i?"a":"v"}>sinf>>tenc' box: ${de(e)} -> ${de(n)}`),t.set(n,8))}}))}))})),e}(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const r=this.initData=we(e);t||(t=Ar(r.audio,C)),n||(n=Ar(r.video,M));const i={};r.audio&&r.video?i.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?i.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?i.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:w.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i}remux(e,t,n,r,i,o){var a,s;let{initPTS:l,lastEndTime:u}=this;const c={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};m(u)||(u=this.lastEndTime=i||0);const d=t.samples;if(null==d||!d.length)return c;const h={initPTS:void 0,timescale:1};let p=this.initData;if(null!=(a=p)&&a.length||(this.generateInitSegment(d),p=this.initData),null==(s=p)||!s.length)return w.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1);const f=function(e,t){let n=0,r=0,i=0;const o=_e(e,["moof","traf"]);for(let e=0;e<o.length;e++){const a=o[e],s=_e(a,["tfhd"])[0],l=t[ye(s,4)];if(!l)continue;const u=l.default,c=ye(s,0)|(null==u?void 0:u.flags);let d=null==u?void 0:u.duration;8&c&&(d=ye(s,2&c?12:8));const h=l.timescale||9e4,p=_e(a,["trun"]);for(let e=0;e<p.length;e++)n=Ae(p[e]),!n&&d&&(n=d*ye(p[e],4)),l.type===M?r+=n/h:l.type===C&&(i+=n/h)}if(0===r&&0===i){let t=0;const n=_e(e,["sidx"]);for(let e=0;e<n.length;e++){const r=Ee(n[e]);null!=r&&r.references&&(t+=r.references.reduce(((e,t)=>e+t.info.duration||0),0))}return t}return r||i}(d,p),g=function(e,t){return _e(t,["moof","traf"]).reduce(((t,n)=>{const r=_e(n,["tfdt"])[0],i=r[0],o=_e(n,["tfhd"]).reduce(((t,n)=>{const o=ye(n,4),a=e[o];if(a){let e=ye(r,4);if(1===i){if(e===he)return w.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;e*=he+1,e+=ye(r,8)}const n=e/(a.timescale||9e4);if(isFinite(n)&&(null===t||n<t))return n}return t}),null);return null!==o&&isFinite(o)&&(null===t||o<t)?o:t}),null)}(p,d),y=null===g?i:g;(function(e,t,n,r){if(null===e)return!0;const i=Math.max(r,1),o=t-e.baseTime/e.timescale;return Math.abs(o-n)>i}(l,y,i,f)||h.timescale!==l.timescale&&o)&&(h.initPTS=y-i,l&&1===l.timescale&&w.warn("Adjusting initPTS by "+(h.initPTS-l.baseTime)),this.initPTS=l={baseTime:h.initPTS,timescale:1});const v=e?y-l.baseTime/l.timescale:u,b=v+f;!function(e,t,n){_e(t,["moof","traf"]).forEach((t=>{_e(t,["tfhd"]).forEach((r=>{const i=ye(r,4),o=e[i];if(!o)return;const a=o.timescale||9e4;_e(t,["tfdt"]).forEach((e=>{const t=e[0];let r=ye(e,4);if(0===t)r-=n*a,r=Math.max(r,0),be(e,4,r);else{r*=Math.pow(2,32),r+=ye(e,8),r-=n*a,r=Math.max(r,0);const t=Math.floor(r/(he+1)),i=Math.floor(r%(he+1));be(e,4,t),be(e,8,i)}}))}))}))}(p,d,l.baseTime/l.timescale),f>0?this.lastEndTime=b:(w.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const _=!!p.audio,E=!!p.video;let T="";_&&(T+="audio"),E&&(T+="video");const A={data1:d,startPTS:v,startDTS:v,endPTS:b,endDTS:b,type:T,hasAudio:_,hasVideo:E,nb:1,dropped:0};return c.audio="audio"===A.type?A:void 0,c.video="audio"!==A.type?A:void 0,c.initSegment=h,c.id3=_r(n,i,l,l),r.samples.length&&(c.text=Er(r,i,l)),c}}},{demux:rr,remux:vr},{demux:class extends Dn{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(X(e,0)||[]).length;for(let n=e.length;t<n;t++)if(Un(e,t))return w.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&Nn(e,t)&&Fn(e,t)<=e.length-t}(e,t)}appendFrame(e,t,n){zn(e,this.observer,t,n,e.manifestCodec);const r=Vn(e,t,n,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r}},remux:vr},{demux:class extends Dn{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=(X(e,0)||[]).length;for(let n=e.length;t<n;t++)if(Jn(e,t))return w.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return Xn(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,n){if(null!==this.basePTS)return Kn(e,t,n,this.basePTS,this.frameIndex)}},remux:vr}];class xr{constructor(e,t,n,r,i){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=i}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const i=n.transmuxing;i.executeStart=mr();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:s}=this;r&&(this.currentTransmuxState=r);const{contiguous:l,discontinuity:u,trackSwitch:c,accurateTimeOffset:d,timeOffset:h,initSegmentChange:p}=r||a,{audioCodec:f,videoCodec:m,defaultInitPts:b,duration:_,initSegmentData:E}=s,T=function(e,t){let n=null;return e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(n=t),n}(o,t);if(T&&"AES-128"===T.method){const e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(o,T.key.buffer,T.iv.buffer).then((e=>{const t=this.push(e,null,n);return this.decryptionPromise=null,t})),this.decryptionPromise;{let t=e.softwareDecrypt(o,T.key.buffer,T.iv.buffer);if(n.part>-1&&(t=e.flush()),!t)return i.executeEnd=mr(),Ir(n);o=new Uint8Array(t)}}const A=this.needsProbing(u,c);if(A){const e=this.configureTransmuxer(o);if(e)return w.warn(`[transmuxer] ${e.message}`),this.observer.emit(g.ERROR,g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),i.executeEnd=mr(),Ir(n)}(u||c||p||A)&&this.resetInitSegment(E,f,m,_,t),(u||p||A)&&this.resetInitialTimestamp(b),l||this.resetContiguity();const S=this.transmux(o,T,h,d,n),x=this.currentTransmuxState;return x.contiguous=!0,x.discontinuity=!1,x.trackSwitch=!1,i.executeEnd=mr(),S}flush(e){const t=e.transmuxing;t.executeStart=mr();const{decrypter:n,currentTransmuxState:r,decryptionPromise:i}=this;if(i)return i.then((()=>this.flush(e)));const o=[],{timeOffset:a}=r;if(n){const t=n.flush();t&&o.push(this.push(t,null,e))}const{demuxer:s,remuxer:l}=this;if(!s||!l)return t.executeEnd=mr(),[Ir(e)];const u=s.flush(a);return Rr(u)?u.then((t=>(this.flushRemux(o,t,e),o))):(this.flushRemux(o,u,e),o)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:i,id3Track:o,textTrack:a}=t,{accurateTimeOffset:s,timeOffset:l}=this.currentTransmuxState;w.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const u=this.remuxer.remux(r,i,o,a,l,s,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=mr()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,i){const{demuxer:o,remuxer:a}=this;o&&a&&(o.resetInitSegment(e,t,n,r),a.resetInitSegment(e,t,n,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,i){let o;return o=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,r,i):this.transmuxUnencrypted(e,n,r,i),o}transmuxUnencrypted(e,t,n,r){const{audioTrack:i,videoTrack:o,id3Track:a,textTrack:s}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,o,a,s,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,i){return this.demuxer.demuxSampleAes(e,t,n).then((e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,r,!1,this.id),chunkMeta:i})))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r,vendor:i}=this;let o;for(let t=0,n=Sr.length;t<n;t++)if(Sr[t].demux.probe(e)){o=Sr[t];break}if(!o)return new Error("Failed to find demuxer by probing fragment data");const a=this.demuxer,s=this.remuxer,l=o.remux,u=o.demux;s&&s instanceof l||(this.remuxer=new l(n,t,r,i)),a&&a instanceof u||(this.demuxer=new u(n,t,r),this.probe=u.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new yn(this.config)),e}}const Ir=e=>({remuxResult:{},chunkMeta:e});function Rr(e){return"then"in e&&e.then instanceof Function}class Cr{constructor(e,t,n,r,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=i||null}}class Mr{constructor(e,t,n,r,i,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=i,this.initSegmentChange=o}}var Lr={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(Lr);var Pr=r(Lr.exports);const Dr=Be()||{isTypeSupported:()=>!1};class Or{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const i=e.config;this.hls=e,this.id=t,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const o=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===g.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new Pr,this.observer.on(g.FRAG_DECRYPTED,o),this.observer.on(g.ERROR,o);const a={mp4:Dr.isTypeSupported("video/mp4"),mpeg:Dr.isTypeSupported("audio/mpeg"),mp3:Dr.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(!this.useWorker||"undefined"==typeof Worker||!i.workerPath&&"function"!=typeof __HLS_WORKER_BUNDLE__)this.transmuxer=new xr(this.observer,a,i,s,t);else try{i.workerPath?(w.log(`loading Web Worker ${i.workerPath} for "${t}"`),this.workerContext=function(e){const t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}(i.workerPath)):(w.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e);return{worker:new self.Worker(t),objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);const{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{const n=new Error(`${e.message}  (${e.filename}:${e.lineno})`);i.enableWorker=!1,w.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(g.ERROR,{type:y.OTHER_ERROR,details:v.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:n})},e.postMessage({cmd:"init",typeSupported:a,vendor:s,id:t,config:JSON.stringify(i)})}catch(e){w.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new xr(this.observer,a,i,s,t)}}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,i,o,a,s,l,u){var c,d;l.transmuxing.start=self.performance.now();const{transmuxer:h}=this,p=o?o.start:i.start,f=i.decryptdata,m=this.frag,g=!(m&&i.cc===m.cc),y=!(m&&l.level===m.level),v=m?l.sn-m.sn:-1,b=this.part?l.part-this.part.index:-1,_=0===v&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),E=!y&&(1===v||0===v&&(1===b||_&&b<=0)),T=self.performance.now();(y||v||0===i.stats.parsing.start)&&(i.stats.parsing.start=T),!o||!b&&E||(o.stats.parsing.start=T);const A=!(m&&(null==(c=i.initSegment)?void 0:c.url)===(null==(d=m.initSegment)?void 0:d.url)),S=new Mr(g,E,s,y,p,A);if(!E||g||A){w.log(`[transmuxer-interface, ${i.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}\n        discontinuity: ${g}\n        trackSwitch: ${y}\n        contiguous: ${E}\n        accurateTimeOffset: ${s}\n        timeOffset: ${p}\n        initSegmentChange: ${A}`);const e=new Cr(n,r,t,a,u);this.configureTransmuxer(e)}if(this.frag=i,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:f,chunkMeta:l,state:S},e instanceof ArrayBuffer?[e]:[]);else if(h){const t=h.push(e,f,l,S);Rr(t)?(h.async=!0,t.then((e=>{this.handleTransmuxComplete(e)})).catch((e=>{this.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Rr(n)||t.async?(Rr(n)||(n=Promise.resolve(n)),n.then((t=>{this.handleFlushResult(t,e)})).catch((t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach((e=>{this.handleTransmuxComplete(e)})),this.onFlush(t)}onWorkerMessage(e){const t=e.data,n=this.hls;switch(t.event){case"init":{var r;const e=null==(r=this.workerContext)?void 0:r.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":w[t.data.logType]&&w[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class Nr{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:r,stalled:i}=this;if(null===r)return;const{currentTime:o,seeking:a}=r,s=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,null!==i){if(this.stallReported){const e=self.performance.now()-i;w.warn(`playback not stuck anymore @${o}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(l||s)return void(this.stalled=null);if(r.paused&&!a||r.ended||0===r.playbackRate||!ln.getBuffered(r).length)return;const u=ln.bufferInfo(r,o,0),c=u.len>0,d=u.nextStart||0;if(!c&&!d)return;if(a){const e=u.len>2,n=!d||t&&t.start<=o||d-o>2&&!this.fragmentTracker.getPartialFragment(o);if(e||n)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var h;const e=Math.max(d,u.start||0)-o,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,n=(null==t||null==(h=t.details)?void 0:h.live)?2*t.details.targetduration:2,r=this.fragmentTracker.getPartialFragment(o);if(e>0&&(e<=n||r))return void this._trySkipBufferHole(r)}const p=self.performance.now();if(null===i)return void(this.stalled=p);const f=p-i;if(!a&&f>=250&&(this._reportStall(u),!this.media))return;const m=ln.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(m,f)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:r,media:i}=this;if(null===i)return;const o=i.currentTime,a=r.getPartialFragment(o);(!a||!this._trySkipBufferHole(a)&&this.media)&&(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>1e3*n.highBufferWatchdogPeriod&&(w.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;const r=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);w.warn(r.message),t.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_STALLED_ERROR,fatal:!1,error:r,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:r}=this;if(null===r)return 0;const i=r.currentTime,o=ln.bufferInfo(r,i,0),a=i<o.start?o.start:o.nextStart;if(a){const s=o.len<=t.maxBufferHole,l=o.len>0&&o.len<1&&r.readyState<3,u=a-i;if(u>0&&(s||l)){if(u>t.maxBufferHole){const{fragmentTracker:t}=this;let n=!1;if(0===i){const e=t.getAppendedFrag(0,ot);e&&a<e.end&&(n=!0)}if(!n){const n=e||t.getAppendedFrag(i,ot);if(n){let e=!1,r=n.end;for(;r<a;){const n=t.getPartialFragment(r);if(!n){e=!0;break}r+=n.duration}if(e)return 0}}}const o=Math.max(a+.05,i+.1);if(w.warn(`skipping hole, adjusting currentTime from ${i} to ${o}`),this.moved=!0,this.stalled=null,r.currentTime=o,e&&!e.gap){const t=new Error(`fragment loaded with buffer holes, seeking from ${i} to ${o}`);n.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return o}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:r}=this;if(null===n)return;const i=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const o=i+(r+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${i} to ${o}`);w.warn(a.message),n.currentTime=o,t.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const n=new Error(`Playhead still not moving while enough data buffered @${i} after ${e.nudgeMaxRetry} nudges`);w.error(n.message),t.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_STALLED_ERROR,error:n,fatal:!0})}}}class kr extends Mn{constructor(e,t,n){super(e,t,n,"[stream-controller]",ot),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(g.ERROR,this.onError,this),e.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(g.BUFFER_CREATED,this.onBufferCreated,this),e.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(g.ERROR,this.onError,this),e.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(g.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(g.BUFFER_CREATED,this.onBufferCreated,this),e.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(g.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=n.startLevel;-1===e&&(n.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=n.nextAutoLevel),this.level=n.nextLoadLevel=e,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=bn,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=vn}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Cn:{var e;const{levels:t,level:n}=this,r=null==t||null==(e=t[n])?void 0:e.details;if(r&&(!r.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(r))break;this.state=bn;break}if(this.hls.nextLoadLevel!==this.level){this.state=bn;break}break}case wn:{var t;const e=self.performance.now(),n=this.retryDate;(!n||e>=n||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=bn)}}this.state===bn&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this,{config:i,nextLoadLevel:o}=e;if(null===t||!r&&(this.startFragRequested||!i.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;if(null==n||!n[o])return;const a=n[o],s=this.getMainFwdBufferInfo();if(null===s)return;const l=this.getLevelDetails();if(l&&this._streamEnded(s,l)){const e={};return this.altAudio&&(e.type="video"),this.hls.trigger(g.BUFFER_EOS,e),void(this.state=xn)}e.loadLevel!==o&&-1===e.manualLevel&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const u=a.details;if(!u||this.state===Cn||u.live&&this.levelLastLoaded!==o)return this.level=o,void(this.state=Cn);const c=s.len,d=this.getMaxBufferLength(a.maxBitrate);if(c>=d)return;this.backtrackFragment&&this.backtrackFragment.start>s.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:s.end;let p=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&p&&"initSegment"!==p.sn&&this.fragmentTracker.getState(p)!==Kt){var f;const e=(null!=(f=this.backtrackFragment)?f:p).sn-u.startSN,t=u.fragments[e-1];t&&p.cc===t.cc&&(p=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&s.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,h)){if(!p.gap){const e=this.audioOnly&&!this.altAudio?C:M,t=(e===M?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,ot)}p=this.getNextFragmentLoopLoading(p,u,s,ot,d)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,a,h))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===qt||r===Yt?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ot)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const i=this.getLevelDetails();if(null!=i&&i.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*i.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],r=this.fragLastKbps;n=r&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*r)+1:0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const e=this.followingBufferedFrag(o);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,n=e.duration,r=Math.max(o.end,t+Math.min(Math.max(n-this.config.maxFragLookUpTolerance,.5*n),.75*n));this.flushMainBuffer(r,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case _n:case En:case wn:case An:case Sn:this.state=bn}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Nr(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;m(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();null!==n&&0!==n.len?this.tick():this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`)}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(g.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let n,r=!1,i=!1;t.levels.forEach((e=>{n=e.audioCodec,n&&(-1!==n.indexOf("mp4a.40.2")&&(r=!0),-1!==n.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=r&&i&&!function(){var e;const t=Ln();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==bn)return;const r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=Cn)}onLevelLoaded(e,t){var n;const{levels:r}=this,i=t.level,o=t.details,a=o.totalduration;if(!r)return void this.warn(`Levels were reset while loading level ${i}`);this.log(`Level ${i} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const s=r[i],l=this.fragCurrent;!l||this.state!==En&&this.state!==wn||l.level===t.level&&l.urlId===s.urlId||!l.loader||this.abortCurrentFrag();let u=0;if(o.live||null!=(n=s.details)&&n.live){if(o.fragments[0]||(o.deltaUpdateFailed=!0),o.deltaUpdateFailed)return;u=this.alignPlaylists(o,s.details)}if(s.details=o,this.levelLastLoaded=i,this.hls.trigger(g.LEVEL_UPDATED,{details:o,level:i}),this.state===Cn){if(this.waitForCdnTuneIn(o))return;this.state=bn}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:i}=e,{levels:o}=this;if(!o)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const a=o[n.level],s=a.details;if(!s)return this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),void this.fragmentTracker.removeFragment(n);const l=a.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=n.initSegment)?void 0:t.data,d=this._getAudioCodec(a),h=this.transmuxer=this.transmuxer||new Or(this.hls,ot,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=r?r.index:-1,f=-1!==p,m=new un(n.level,n.sn,n.stats.chunkCount,i.byteLength,p,f),g=this.initPTS[n.cc];h.push(i,c,d,l,n,r,s.totalduration,u,m,g)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const e=this.hls;n&&(e.trigger(g.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(g.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,r=!!this.hls.audioTracks[n].url;if(r){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,i,o=!1;for(const e in n){const t=n[e];if("main"===t.id){if(i=e,r=t,"video"===e){const t=n[e];t&&(this.videoBuffer=t.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n&&n.type!==ot)return;if(this.fragContextChanged(n))return this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Sn&&(this.state=bn));const i=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal)this.state=In;else switch(t.details){case v.FRAG_GAP:case v.FRAG_PARSING_ERROR:case v.FRAG_DECRYPT_ERROR:case v.FRAG_LOAD_ERROR:case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_ERROR:case v.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ot,t);break;case v.LEVEL_LOAD_ERROR:case v.LEVEL_LOAD_TIMEOUT:case v.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Cn||(null==(n=t.context)?void 0:n.type)!==nt||(this.state=bn);break;case v.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case v.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){const{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!ln.getBuffered(e).length){const e=this.state!==bn?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=bn,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==C||this.audioOnly&&!this.altAudio){const e=(t===M?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,ot)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log(`could not seek to ${n}, already seeking at ${t}`);const r=ln.getBuffered(e),i=(r.length?r.start(0):0)-n;i>0&&(i<this.config.maxBufferHole||i<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${i} to match buffer start`),n+=i,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then((n=>{const{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=bn,this.startFragRequested=!1,this.bitrateTest=!1;const i=e.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),r.trigger(g.FRAG_LOADED,n),e.bitrateTest=!1}))}_handleTransmuxComplete(e){var t;const n="main",{hls:r}=this,{remuxResult:i,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a)return void this.resetWhenMissingContext(o);const{frag:s,part:l,level:u}=a,{video:c,text:d,id3:h,initSegment:p}=i,{details:f}=u,y=this.altAudio?void 0:i.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=An,p){if(null!=p&&p.tracks){const e=s.initSegment||s;this._bufferInitSegment(u,p.tracks,e,o),r.trigger(g.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:p.tracks})}const e=p.initPTS,t=p.timescale;m(e)&&(this.initPTS[s.cc]={baseTime:e,timescale:t},r.trigger(g.INIT_PTS_FOUND,{frag:s,id:n,initPTS:e,timescale:t}))}if(c&&f&&"initSegment"!==s.sn){const e=f.fragments[s.sn-1-f.startSN],t=s.sn===f.startSN,n=!e||s.cc>e.cc;if(!1!==i.independent){const{startPTS:e,endPTS:r,startDTS:i,endDTS:a}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:r,startDTS:i,endDTS:a};else if(c.firstKeyFrame&&c.independent&&1===o.id&&!n&&(this.couldBacktrack=!0),c.dropped&&c.independent){const i=this.getMainFwdBufferInfo(),o=(i?i.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&o<l-this.config.maxBufferHole&&!n)return void this.backtrack(s);n&&(s.gap=!0),s.setElementaryStreamInfo(c.type,s.start,r,s.start,a,!0)}s.setElementaryStreamInfo(c.type,e,r,i,a),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,o,t||n)}else{if(!t&&!n)return void this.backtrack(s);s.gap=!0}}if(y){const{startPTS:e,endPTS:t,startDTS:n,endDTS:r}=y;l&&(l.elementaryStreams[C]={startPTS:e,endPTS:t,startDTS:n,endDTS:r}),s.setElementaryStreamInfo(C,e,t,n,r),this.bufferFragmentData(y,s,l,o)}if(f&&null!=h&&null!=(t=h.samples)&&t.length){const e={id:n,frag:s,details:f,samples:h.samples};r.trigger(g.FRAG_PARSING_METADATA,e)}if(f&&d){const e={id:n,frag:s,details:f,samples:d.samples};r.trigger(g.FRAG_PARSING_USERDATA,e)}}}_bufferInitSegment(e,t,n,r){if(this.state!==An)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:i,video:o,audiovideo:a}=t;if(i){let t=e.audioCodec;const n=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==i.metadata.channelCount&&-1===n.indexOf("firefox")&&(t="mp4a.40.5")),-1!==n.indexOf("android")&&"audio/mpeg"!==i.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),i.levelCodec=t,i.id="main",this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${i.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${a.codec}]`),this.hls.trigger(g.BUFFER_CODECS,t),Object.keys(t).forEach((e=>{const i=t[e].initSegment;null!=i&&i.byteLength&&this.hls.trigger(g.BUFFER_APPENDING,{type:e,data:i,frag:n,part:null,chunkMeta:r,parent:n.type})})),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ot)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=bn}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const n=e.currentTime;if(ln.isBuffered(e,n)?t=this.getAppendedFrag(n):ln.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,n=t.level;e&&t.sn===e.sn&&e.level===n&&t.urlId===e.urlId||(this.fragPlaying=t,this.hls.trigger(g.FRAG_CHANGED,{frag:t}),e&&e.level===n||this.hls.trigger(g.LEVEL_SWITCHED,{level:n}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&m(t)&&m(n.programDateTime)){const e=n.programDateTime+1e3*(t-n.start);return new Date(e)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Fr{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class Br{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Fr(e),this.fast_=new Fr(t),this.defaultTTFB_=r,this.ttfb_=new Fr(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:i}=this;n.halfLife!==e&&(this.slow_=new Fr(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Fr(t,r.getEstimate(),r.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new Fr(e,i.getEstimate(),i.getTotalWeight()))}sample(e,t){const n=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/n;this.fast_.sample(n,r),this.slow_.sample(n,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class Ur{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;return e.length?(n=1===e.length?e[0]:function(e,t){const n=new Uint8Array(t);let r=0;for(let t=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}(e,t),this.reset(),n):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function zr(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Gr(e[n].attrs,t[n].attrs))return!1;return!0}function Gr(e,t){const n=e["STABLE-RENDITION-ID"];return n?n===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some((n=>e[n]!==t[n]))}class Vr{constructor(e){this.buffered=void 0;const t=(t,n,r)=>{if((n>>>=0)>r-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${r})`);return e[n][t]};this.buffered={get length(){return e.length},end:n=>t("end",n,e.length),start:n=>t("start",n,e.length)}}}function jr(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];"subtitles"!==r.kind&&"captions"!==r.kind||!r.label||t.push(e[n])}return t}class Hr{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const n=this.queues[t];n.push(e),1===n.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise((e=>{t=e})),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){const{buffers:t,queues:n}=this,r=t[e],i=n[e];if(i.length){const t=i[0];try{t.execute()}catch(n){w.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),t.onError(n),null!=r&&r.updating||(i.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Zr=Be(),qr=/([ha]vc.)(?:\.[^.,]+)+/,Wr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Yr=function(e){let t=e;return Wr.hasOwnProperty(e)&&(t=Wr[e]),String.fromCharCode(t)},Kr=15,$r=100,Xr={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Qr={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Jr={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},ei={25:2,26:4,29:6,30:8,31:10,27:13,28:15},ti=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class ni{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n="function"==typeof t?t():t;w.log(`${this.time} [${e}] ${n}`)}}}const ri=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class ii{constructor(e,t,n,r,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class oi{constructor(e,t,n,r,i,o){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new ii(t,n,r,i,o)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class ai{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let e=0;e<$r;e++)this.chars.push(new oi);this.logger=e,this.pos=0,this.currPenState=new ii}equals(e){let t=!0;for(let n=0;n<$r;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}copy(e){for(let t=0;t<$r;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<$r;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>$r&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=$r)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Yr(e);this.pos>=$r?this.logger.log(0,(()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<$r;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<$r;n++){const r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class si{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<Kr;t++)this.rows.push(new ai(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<Kr;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let n=0;n<Kr;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Kr;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Kr;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,(()=>"pacData = "+JSON.stringify(e)));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<Kr;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){const r=n.rows[e].cueStartTime,i=this.logger.time;if(r&&null!==i&&r<i)for(let r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(n.rows[e+r])}}this.currRow=t;const n=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,r=Math.max(t-1,0);n.setCursor(e.indent),e.color=n.chars[r].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,(()=>"bkgData = "+JSON.stringify(e))),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let n=0;n<Kr;n++){const i=this.rows[n].getTextString();i&&(r=n+1,e?t.push("Row "+r+": '"+i+"'"):t.push(i.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}getTextAndFormat(){return this.rows}}class li{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new si(n),this.nonDisplayedMemory=new si(n),this.lastOutputScreen=new si(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(()=>"MODE="+e)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>t+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class ui{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const r=new ni;this.channels=[null,new li(e,t,r),new li(e+1,n,r)],this.cmdHistory={a:null,b:null},this.logger=r}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let n,r,i,o=!1;this.logger.time=e;for(let e=0;e<t.length;e+=2)if(r=127&t[e],i=127&t[e+1],0!==r||0!==i){if(this.logger.log(3,"["+ri([t[e],t[e+1]])+"] -> ("+ri([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(o=this.parseChars(r,i),o)){const e=this.currentChannel;e&&e>0?this.channels[e].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}n||o||this.logger.log(2,"Couldn't parse cleaned data "+ri([r,i])+" orig: "+ri([t[e],t[e+1]]))}}parseCmd(e,t){const{cmdHistory:n}=this;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(di(e,t,n))return ci(null,null,n),this.logger.log(3,"Repeated command ("+ri([e,t])+") is dropped"),!0;const r=20===e||21===e||23===e?1:2,i=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),ci(e,t,n),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((17===e||25===e)&&t>=32&&t<=47){if(n=17===e?1:2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return!!r&&(r.ccMIDROW(t),this.logger.log(3,"MIDROW ("+ri([e,t])+")"),!0)}return!1}parsePAC(e,t){let n;const r=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(di(e,t,r))return ci(null,null,r),!0;const i=e<=23?1:2;n=t>=64&&t<=95?1===i?Xr[e]:Jr[e]:1===i?Qr[e]:ei[e];const o=this.channels[i];return!!o&&(o.setPAC(this.interpretPAC(n,t)),ci(e,t,r),this.currentChannel=i,!0)}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r}parseChars(e,t){let n,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),i>=17&&i<=19){let e;e=17===i?t+80:18===i?t+112:t+144,this.logger.log(2,"Special char '"+Yr(e)+"' in channel "+n),r=[e]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){const n=ri(r);this.logger.log(3,"Char codes =  "+n.join(",")),ci(e,t,this.cmdHistory)}return r}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;let n;const r={};16===e||24===e?(n=Math.floor((t-32)/2),r.background=ti[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0));const i=e<=23?1:2;return this.channels[i].setBkgData(r),ci(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function ci(e,t,n){n.a=e,n.b=t}function di(e,t,n){return n.a===e&&n.b===t}class hi{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var pi=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function n(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const n=t.toLowerCase();return!!~e.indexOf(n)&&n}function r(e){return n(t,e)}function i(e,...t){let n=1;for(;n<arguments.length;n++){const t=arguments[n];for(const n in t)e[n]=t[n]}return e}function o(t,o,a){const s=this,l={enumerable:!0};s.hasBeenReset=!1;let u="",c=!1,d=t,h=o,p=a,f=null,m="",g=!0,y="auto",v="start",b=50,_="middle",E=50,w="middle";Object.defineProperty(s,"id",i({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(s,"pauseOnExit",i({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",i({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",i({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",i({},l,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",i({},l,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",i({},l,{get:function(){return m},set:function(t){const r=function(t){return n(e,t)}(t);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");m=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",i({},l,{get:function(){return g},set:function(e){g=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",i({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",i({},l,{get:function(){return v},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",i({},l,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",i({},l,{get:function(){return _},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",i({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",i({},l,{get:function(){return w},set:function(e){const t=r(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),s.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class fi{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function mi(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(r||0)}const n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class gi{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function yi(e,t,n,r){const i=r?e.split(r):[e];for(const e in i){if("string"!=typeof i[e])continue;const r=i[e].split(n);2===r.length&&t(r[0],r[1])}}const vi=new pi(0,0,""),bi="middle"===vi.align?"middle":"center";function _i(e,t,n){const r=e;function i(){const t=mi(e);if(null===t)throw new Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function o(){e=e.replace(/^\s+/,"")}if(o(),t.startTime=i(),o(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.slice(3),o(),t.endTime=i(),o(),function(e,t){const r=new gi;yi(e,(function(e,t){let i;switch(e){case"region":for(let i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":i=t.split(","),r.integer(e,i[0]),r.percent(e,i[0])&&r.set("snapToLines",!1),r.alt(e,i[0],["auto"]),2===i.length&&r.alt("lineAlign",i[1],["start",bi,"end"]);break;case"position":i=t.split(","),r.percent(e,i[0]),2===i.length&&r.alt("positionAlign",i[1],["start",bi,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",bi,"end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");let i=r.get("line","auto");"auto"===i&&-1===vi.line&&(i=-1),t.line=i,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",bi);let o=r.get("position","auto");"auto"===o&&50===vi.position&&(o="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=o}(e,t)}function Ei(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class wi{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new fi,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function n(){let e=t.buffer,n=0;for(e=Ei(e);n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;const r=e.slice(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.slice(n),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=n();const r=e.match(/^(Ã¯Â»Â¿)?WEBVTT([ \t].*)?$/);if(null==r||!r[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let r=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:e=n(),t.state){case"HEADER":/:/.test(e)?yi(e,(function(e,t){}),/:/):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new pi(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{_i(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const n=-1!==e.indexOf("--\x3e");if(!e||n&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Ti=/\r\n|\n\r|\n|\r/g,Ai=function(e,t,n=0){return e.slice(n,n+t.length)===t},Si=function(e){let t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function xi(e,t,n){return Si(e.toString())+Si(t.toString())+Si(n)}const Ii="stpp.ttml.im1t",Ri=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ci=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Mi={left:"start",center:"center",right:"end",start:"start",end:"end"};function Li(e,t,n,r){const i=_e(new Uint8Array(e),["mdat"]);if(0===i.length)return void r(new Error("Could not parse IMSC1 mdat"));const o=i.map((e=>le(e))),a=function(e,t,n=1,r=!1){return pr(e,t,1/n,r)}(t.baseTime,1,t.timescale);try{o.forEach((e=>n(function(e,t){const n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},i=Object.keys(r).reduce(((e,t)=>(e[t]=n.getAttribute(`ttp:${t}`)||r[t],e)),{}),o="preserve"!==n.getAttribute("xml:space"),a=Di(Pi(n,"styling","style")),s=Di(Pi(n,"layout","region")),l=Pi(n,"body","[begin]");return[].map.call(l,(e=>{const n=Oi(e,o);if(!n||!e.hasAttribute("begin"))return null;const r=Fi(e.getAttribute("begin"),i),l=Fi(e.getAttribute("dur"),i);let u=Fi(e.getAttribute("end"),i);if(null===r)throw ki(e);if(null===u){if(null===l)throw ki(e);u=r+l}const c=new pi(r-t,u-t,n);c.id=xi(c.startTime,c.endTime,c.text);const d=function(e,t,n){const r="http://www.w3.org/ns/ttml#styling";let i=null;const o=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return o&&n.hasOwnProperty(o)&&(i=n[o]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(((n,o)=>{const a=Ni(t,r,o)||Ni(e,r,o)||Ni(i,r,o);return a&&(n[o]=a),n}),{})}(s[e.getAttribute("region")],a[e.getAttribute("style")],a),{textAlign:h}=d;if(h){const e=Mi[h];e&&(c.lineAlign=e),c.align=h}return f(c,d),c})).filter((e=>null!==e))}(e,a))))}catch(e){r(e)}}function Pi(e,t,n){const r=e.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(n)):[]}function Di(e){return e.reduce(((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e}),{})}function Oi(e,t){return[].slice.call(e.childNodes).reduce(((e,n,r)=>{var i;return"br"===n.nodeName&&r?e+"\n":null!=(i=n.childNodes)&&i.length?Oi(n,t):t?e+n.textContent.trim().replace(/\s+/g," "):e+n.textContent}),"")}function Ni(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function ki(e){return new Error(`Could not parse ttml timestamp ${e}`)}function Fi(e,t){if(!e)return null;let n=mi(e);return null===n&&(Ri.test(e)?n=function(e,t){const n=Ri.exec(e),r=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+r/t.frameRate}(e,t):Ci.test(e)&&(n=function(e,t){const n=Ci.exec(e),r=Number(n[1]);switch(n[2]){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/t.frameRate;case"t":return r/t.tickRate}return r}(e,t))),n}function Bi(e,t){return!!e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}class Ui{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(g.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.BUFFER_CODECS,this.onBufferCodecs,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(g.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.BUFFER_CODECS,this.onBufferCodecs,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter(((t,n)=>this.isLevelAllowed(t)&&n<=e));return this.clientRect=null,Ui.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){return!this.restrictedLevels.some((t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height))}static getMaxLevelByMediaSize(e,t,n){if(null==e||!e.length)return-1;let r=e.length-1;for(let a=0;a<e.length;a+=1){const s=e[a];if((s.width>=t||s.height>=n)&&(i=s,!(o=e[a+1])||i.width!==o.width||i.height!==o.height)){r=a;break}}var i,o;return r}}const zi="[eme]";class Gi{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Gi.CDMCleanupPromise?[Gi.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=w.debug.bind(w,zi),this.log=w.log.bind(w,zi),this.warn=w.warn.bind(w,zi),this.error=w.error.bind(w,zi),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(g.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(g.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(g.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(g.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(g.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===B.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(e,t,n)=>!!e&&n.indexOf(e)===t,r=t.map((e=>e.audioCodec)).filter(n),i=t.map((e=>e.videoCodec)).filter(n);return r.length+i.length===0&&i.push("avc1.42e01e"),new Promise(((t,n)=>{const o=e=>{const a=e.shift();this.getMediaKeysPromise(a,r,i).then((e=>t({keySystem:a,mediaKeys:e}))).catch((t=>{e.length?o(e):n(t instanceof Vi?t:new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))};o(e)}))}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if("function"!=typeof n){let e=`Configured requestMediaKeySystemAccess is not a function ${n}`;return null===W&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return n(e,t)}getMediaKeysPromise(e,t,n){const r=function(e,t,n,r){let i;switch(e){case B.FAIRPLAY:i=["cenc","sinf"];break;case B.WIDEVINE:case B.PLAYREADY:i=["cenc"];break;case B.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,n,r){return[{initDataTypes:e,persistentState:r.persistentState||"not-allowed",distinctiveIdentifier:r.distinctiveIdentifier||"not-allowed",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:t.map((e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null}))),videoCapabilities:n.map((e=>({contentType:`video/mp4; codecs="${e}"`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null})))}]}(i,t,n,r)}(e,t,n,this.config.drmSystemOptions),i=this.keySystemAccessPromises[e];let o=null==i?void 0:i.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),o=this.requestMediaKeySystemAccess(e,r);const t=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)})),o.then((n=>{this.log(`Access for key-system "${n.keySystem}" obtained`);const r=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=n.createMediaKeys().then((t=>(this.log(`Media-keys created for "${e}"`),r.then((n=>n?this.setMediaKeysServerCertificate(t,e,n):t))))),t.mediaKeys.catch((t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)})),t.mediaKeys}))}return o.then((()=>i.mediaKeys))}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${de(e.keyId||[])}`);const r=n.createSession(),i={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),i="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,i,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return de(e.keyId)}updateKeySession(e,t){var n;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${de((null==(n=e.decryptdata)?void 0:n.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise(((t,n)=>{const r=q(this.config),i=e.map(j).filter((e=>!!e&&-1!==r.indexOf(e)));return this.getKeySystemSelectionPromise(i).then((({keySystem:e})=>{const r=Z(e);r?t(r):n(new Error(`Unable to find format for key-system "${e}"`))})).catch(n)}))}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let i=this.keyIdToKeySessionPromise[n];return i||(i=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then((({keySystem:n,mediaKeys:i})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(n,i).then((()=>{this.throwIfDestroyed();const e=this.createMediaKeySessionContext({keySystem:n,mediaKeys:i,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")}))))),i.catch((e=>this.handleError(e)))),i}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Vi?this.hls.trigger(g.ERROR,e.data):this.hls.trigger(g.ERROR,{type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const t=j(e.keyFormat),n=t?[t]:q(this.config);return this.attemptKeySystemAccess(n)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=q(this.config)),0===e.length)throw new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),null===n)return;let r,i;if("sinf"===t&&this.config.drmSystems[B.FAIRPLAY]){const e=me(new Uint8Array(n));try{const t=k(JSON.parse(e).sinf),n=Te(new Uint8Array(t));if(!n)return;r=n.subarray(8,24),i=B.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{const e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},n=new DataView(e),r=n.getUint32(0);if(e.byteLength!==r&&r>44)return null;if(1886614376!==n.getUint32(4))return null;if(t.version=n.getUint32(8)>>>24,t.version>1)return null;t.systemId=de(new Uint8Array(e,12,16));const i=n.getUint32(28);if(0===t.version){if(r-32<i)return null;t.data=new Uint8Array(e,32,i)}else if(1===t.version){t.kids=[];for(let n=0;n<i;n++)t.kids.push(new Uint8Array(e,32+16*n,16))}return t}(n);if(null===e)return;0===e.version&&e.systemId===H&&e.data&&(r=e.data.subarray(8,24)),i=function(e){if(e===H)return B.WIDEVINE}(e.systemId)}if(!i||!r)return;const o=de(r),{keyIdToKeySessionPromise:a,mediaKeySessions:s}=this;let l=a[o];for(let e=0;e<s.length;e++){const i=s[e],u=i.decryptdata;if(u.pssh||!u.keyId)continue;const c=de(u.keyId);if(o===c||-1!==u.uri.replace(/-/g,"").indexOf(o)){l=a[c],delete a[c],u.pssh=new Uint8Array(n),u.keyId=r,l=a[o]=l.then((()=>this.generateRequestWithPreferredKeySession(i,t,n,"encrypted-event-key-match")));break}}l||(l=a[o]=this.getKeySystemSelectionPromise([i]).then((({keySystem:e,mediaKeys:i})=>{var a;this.throwIfDestroyed();const s=new Le("ISO-23001-7",o,null!=(a=Z(e))?a:"");return s.pssh=new Uint8Array(n),s.keyId=r,this.attemptSetMediaKeys(e,i).then((()=>{this.throwIfDestroyed();const r=this.createMediaKeySessionContext({decryptdata:s,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(r,t,n,"encrypted-event-no-match")}))}))),l.catch((e=>this.handleError(e)))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then((()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(r),r.then((()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((e=>-1===n.indexOf(e)))}))}generateRequestWithPreferredKeySession(e,t,n,r){var i,o;const a=null==(i=this.config.drmSystems)||null==(o=i[e.keySystem])?void 0:o.generateRequest;if(a)try{const r=a.call(this.hls,t,n,e);if(!r)throw new Error("Invalid response from configured generateRequest filter");t=r.initDataType,n=e.decryptdata.pssh=r.initData?new Uint8Array(r.initData):null}catch(e){var s;if(this.warn(e.message),null!=(s=this.hls)&&s.config.debug)throw e}if(null===n)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${l} (init data type: ${t} length: ${n?n.byteLength:null})`);const u=new Pr;e.mediaKeysSession.onmessage=t=>{const n=e.mediaKeysSession;if(!n)return void u.emit("error",new Error("invalid state"));const{messageType:r,message:i}=t;this.log(`"${r}" message event for session "${n.sessionId}" message size: ${i.byteLength}`),"license-request"===r||"license-renewal"===r?this.renewLicense(e,i).catch((e=>{this.handleError(e),u.emit("error",e)})):"license-release"===r?e.keySystem===B.FAIRPLAY&&(this.updateKeySession(e,F("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${r}"`)},e.mediaKeysSession.onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void u.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const n=e.keyStatus;u.emit("keyStatus",n),"expired"===n&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};const c=new Promise(((e,t)=>{u.on("error",t),u.on("keyStatus",(n=>{n.startsWith("usable")?e():"output-restricted"===n?t(new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===n?t(new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${n}"`)):"expired"===n?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${n}"`)}))}));return e.mediaKeysSession.generateRequest(t,n).then((()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)})).catch((e=>{throw new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>c)).catch((t=>{throw u.removeAllListeners(),this.removeSession(e),t})).then((()=>(u.removeAllListeners(),e)))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach(((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${de("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${de(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t}))}fetchServerCertificate(e){const t=this.config,n=new(0,t.loader)(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching serverCertificate for "${e}"`),new Promise(((i,o)=>{const a={responseType:"arraybuffer",url:r},s=t.certLoadPolicy.default,l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(e,t,n,r)=>{i(e.data)},onError:(t,n,i,s)=>{o(new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:h({url:a.url,data:void 0},t)},`"${e}" certificate request failed (${r}). Status: ${t.code} (${t.text})`))},onTimeout:(t,n,i)=>{o(new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:a.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(e,t,n)=>{o(new Error("aborted"))}};n.load(a,l,u)}))):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise(((r,i)=>{e.setServerCertificate(n).then((i=>{this.log(`setServerCertificate ${i?"success":"not supported by CDM"} (${null==n?void 0:n.byteLength}) on "${t}"`),r(e)})).catch((e=>{i(new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then((t=>this.updateKeySession(e,new Uint8Array(t)).catch((e=>{throw new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))))}setupLicenseXHR(e,t,n,r){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then((()=>{if(!n.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,t,n,r)})).catch((o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),i.call(this.hls,e,t,n,r)})).then((n=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:n||r}))):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise(((r,i)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(4===a.readyState)if(200===a.status){this._requestLicenseFailureCount=0;let t=a.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const n=this.config.licenseResponseCallback;if(n)try{t=n.call(this.hls,a,o,e)}catch(e){this.error(e)}r(t)}else{const s=n.errorRetry,l=s?s.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||a.status>=400&&a.status<500)i(new Vi({type:y.KEY_SYSTEM_ERROR,details:v.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const n=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${n} attempts left`),this.requestLicense(e,t).then(r,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then((({xhr:e,licenseChallenge:t})=>{e.send(t)}))}))}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Le.clearKeyUriToKeyIdMap();const n=t.length;Gi.CDMCleanupPromise=Promise.all(t.map((e=>this.removeSession(e))).concat(null==e?void 0:e.setMediaKeys(null).catch((t=>{this.log(`Could not clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)})))).then((()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)})).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce(((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e)),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch((e=>{this.log(`Could not remove session: ${e}`)})).then((()=>t.close())).catch((e=>{this.log(`Could not close session: ${e}`)}))}}}Gi.CDMCleanupPromise=void 0;class Vi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var ji="a",Hi="av";class Zi{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:"m",su:!this.initialized})}catch(e){w.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const t=e.frag,n=this.hls.levels[t.level],r=this.getObjectType(t),i={d:1e3*t.duration,ot:r};"v"!==r&&r!==ji&&r!=Hi||(i.br=n.bitrate/1e3,i.tb=this.getTopBandwidth(r)/1e3,i.bl=this.getBufferLength(r)),this.apply(e,i)}catch(e){w.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||Zi.uuid(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.registerListeners())}registerListeners(){const e=this.hls;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHED,this.onMediaDetached,this),e.on(g.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHED,this.onMediaDetached,this),e.off(g.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=null==(n=t.tracks.audio)?void 0:n.buffer,this.videoBuffer=null==(r=t.tracks.video)?void 0:r.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){f(t,this.createData());const n="i"===t.ot||"v"===t.ot||t.ot===Hi;if(this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){const n=Zi.toHeaders(t);if(!Object.keys(n).length)return;e.headers||(e.headers={}),f(e.headers,n)}else{const n=Zi.toQuery(t);if(!n)return;e.url=Zi.appendQueryToUri(e.url,n)}}getObjectType(e){const{type:t}=e;return"subtitle"===t?"tt":"initSegment"===e.sn?"i":"audio"===t?ji:"main"===t?this.hls.audioTracks.length?"v":Hi:void 0}getTopBandwidth(e){let t,n=0;const r=this.hls;if(e===ji)t=r.audioTracks;else{const e=r.maxAutoLevel,n=e>-1?e+1:r.levels.length;t=r.levels.slice(0,n)}for(const e of t)e.bitrate>n&&(n=e.bitrate);return n>0?n:NaN}getBufferLength(e){const t=this.hls.media,n=e===ji?this.audioBuffer:this.videoBuffer;return n&&t?1e3*ln.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,r){t(e),this.loader.load(e,n,r)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new n(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,n,r){t(e),this.loader.load(e,n,r)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],n=e=>!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e,r=e=>Math.round(e),i=e=>100*r(e/100),o={br:r,d:r,bl:i,dl:i,mtp:i,nor:e=>encodeURIComponent(e),rtp:i,tb:r},a=Object.keys(e||{}).sort();for(const r of a){let i=e[r];if(!n(i))continue;if("v"===r&&1===i)continue;if("pr"==r&&1===i)continue;const a=o[r];a&&(i=a(i));const s=typeof i;let l;l="ot"===r||"sf"===r||"st"===r?`${r}=${i}`:"boolean"===s?r:"number"===s?`${r}=${i}`:`${r}=${JSON.stringify(i)}`,t.push(l)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),n={},r=["Object","Request","Session","Status"],i=[{},{},{},{}],o={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const n of t)i[null!=o[n]?o[n]:1][n]=e[n];for(let e=0;e<i.length;e++){const t=Zi.serialize(i[e]);t&&(n[`CMCD-${r[e]}`]=t)}return n}static toQuery(e){return`CMCD=${encodeURIComponent(Zi.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const n=e.includes("?")?"&":"?";return`${e}${n}${t}`}}function qi(e,t,n,r){e&&Object.keys(t).forEach((i=>{const o=e.filter((e=>e.groupId===i)).map((e=>{const o=f({},e);return o.details=void 0,o.attrs=new S(o.attrs),o.url=o.attrs.URI=Wi(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),o.groupId=o.attrs["GROUP-ID"]=t[i],o.attrs["PATHWAY-ID"]=r,o}));e.push(...o)}))}function Wi(e,t,n,r){const{HOST:i,PARAMS:o,[n]:a}=r;let s;t&&(s=null==a?void 0:a[t],s&&(e=s));const l=new self.URL(e);return i&&!s&&(l.host=i),o&&Object.keys(o).sort().forEach((e=>{e&&l.searchParams.set(e,o[e])})),l.href}const Yi=/^age:\s*[\d.]+\s*$/im;class Ki{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new R,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then((()=>{if(!this.stats.aborted)return i(n,t.url)})).catch((e=>(n.open("GET",t.url,!0),i(n,t.url)))).then((()=>{this.stats.aborted||this.openAndSendXhr(n,t,e)})).catch((e=>{this.callbacks.onError({code:n.status,text:e.message},t,n,r)})):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=this.context.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(const t in r)e.setRequestHeader(t,r[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=i&&m(i)?i:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,i=this.config;if(!n.aborted&&r>=2&&(0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),4===r)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const r=t.status,o="text"!==t.responseType;if(r>=200&&r<300&&(o&&t.response||null!==t.responseText)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const i=o?t.response:t.responseText,a="arraybuffer"===t.responseType?i.byteLength:i.length;if(n.loaded=n.total=a,n.bwEstimate=8e3*n.total/(n.loading.end-n.loading.first),!this.callbacks)return;const s=this.callbacks.onProgress;if(s&&s(n,e,i,t),!this.callbacks)return;const l={url:t.responseURL,data:i,code:r};this.callbacks.onSuccess(l,n,e,t)}else{const o=i.loadPolicy.errorRetry;Nt(o,n.retry,!1,r)?this.retry(o):(w.error(`${r} while loading ${e.url}`),this.callbacks.onError({code:r,text:t.statusText},e,t,n))}}}loadtimeout(){var e;const t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(Nt(t,this.stats.retry,!0))this.retry(t);else{w.warn(`timeout while loading ${this.context.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Dt(e,n.retry),n.retry++,w.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Yi.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const $i=/(\d+)-(\d+)\/(\d+)/;class Xi{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||Qi,this.controller=new self.AbortController,this.stats=new R}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const i=function(e,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(f({},e.headers))};return e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),n}(e,this.controller.signal),o=n.onProgress,a="arraybuffer"===e.responseType,s=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),t.timeout=l&&m(l)?l:u,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(r,e,this.response)}),t.timeout),self.fetch(this.request).then((i=>{this.response=this.loader=i;const s=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout((()=>{this.abortInternal(),n.onTimeout(r,e,this.response)}),u-(s-r.loading.start)),!i.ok){const{status:e,statusText:t}=i;throw new Ji(t||"fetch, bad network response",e,i)}return r.loading.first=s,r.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=$i.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(m(e))return e}const n=e.get("Content-Length");if(n)return parseInt(n)}(i.headers)||r.total,o&&m(t.highWaterMark)?this.loadProgressively(i,r,e,t.highWaterMark,o):a?i.arrayBuffer():"json"===e.responseType?i.json():i.text()})).then((i=>{const{response:a}=this;self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const l=i[s];l&&(r.loaded=r.total=l);const u={url:a.url,data:i,code:a.status};o&&!m(t.highWaterMark)&&o(r,e,i,a),n.onSuccess(u,r,e,a)})).catch((t=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const i=t&&t.code||0,o=t?t.message:null;n.onError({code:i,text:o},e,t?t.details:null,r)}))}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,i){const o=new Ur,a=e.body.getReader(),s=()=>a.read().then((a=>{if(a.done)return o.dataLength&&i(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const l=a.value,u=l.length;return t.loaded+=u,u<r||o.dataLength?(o.push(l),o.dataLength>=r&&i(t,n,o.flush(),e)):i(t,n,l,e),s()})).catch((()=>Promise.reject()));return s()}}function Qi(e,t){return new self.Request(e.url,t)}class Ji extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const eo=/\s/,to={newCue(e,t,n,r){const i=[];let o,a,s,l,u;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<r.rows.length;h++)if(o=r.rows[h],s=!0,l=0,u="",!o.isEmpty()){var d;for(let e=0;e<o.chars.length;e++)eo.test(o.chars[e].uchar)&&s?l++:(u+=o.chars[e].uchar,s=!1);o.cueStartTime=t,t===n&&(n+=1e-4),l>=16?l--:l++;const r=Ei(u.trim()),p=xi(t,n,r);null!=e&&null!=(d=e.cues)&&d.getCueById(p)||(a=new c(t,n,r),a.id=p,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),i.push(a))}return e&&i.length&&(i.sort(((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line)),i.forEach((t=>ht(e,t)))),i}},no=h(h({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ki,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new Br(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(g.FRAG_LOADING,this.onFragLoading,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this),e.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(g.FRAG_LOADING,this.onFragLoading,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this),e.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var n;const r=t.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=null!=(n=t.part)?n:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,n,r){return e+n/t+(r?this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const n=this.hls.config,{total:r,bwEstimate:i}=t.stats;m(r)&&m(i)&&(this.lastLevelLoadSec=8*r/i),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{autoLevelEnabled:r,media:i}=n;if(!e||!i)return;const o=performance.now(),a=t?t.stats:e.stats,s=t?t.duration:e.duration,l=o-a.loading.start;if(a.aborted||a.loaded&&a.loaded===a.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!r||i.paused||!i.playbackRate||!i.readyState)return;const u=n.mainForwardBufferInfo;if(null===u)return;const c=this.bwEstimator.getEstimateTTFB(),d=Math.abs(i.playbackRate);if(l<=Math.max(c,s/(2*d)*1e3))return;const h=u.len/d;if(h>=2*s/d)return;const p=a.loading.first?a.loading.first-a.loading.start:-1,f=a.loaded&&p>-1,y=this.bwEstimator.getEstimate(),{levels:v,minAutoLevel:b}=n,_=v[e.level],E=a.total||Math.max(a.loaded,Math.round(s*_.maxBitrate/8));let T=l-p;T<1&&f&&(T=Math.min(l,8*a.loaded/y));const A=f?1e3*a.loaded/T:0,S=A?(E-a.loaded)/A:8*E/y+c/1e3;if(S<=h)return;const x=A?8*A:y;let I,R=Number.POSITIVE_INFINITY;for(I=e.level-1;I>b;I--){const e=v[I].maxBitrate;if(R=this.getTimeToLoadFrag(c/1e3,x,s*e,!v[I].details),R<h)break}R>=S||R>10*s||(n.nextLoadLevel=I,f?this.bwEstimator.sample(l-Math.min(c,p),a.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),w.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;\n      Time to underbuffer: ${h.toFixed(3)} s\n      Estimated load time for current fragment: ${S.toFixed(3)} s\n      Estimated load time for down switch fragment: ${R.toFixed(3)} s\n      TTFB estimate: ${p}\n      Current BW estimate: ${m(y)?(y/1024).toFixed(3):"Unknown"} Kb/s\n      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s\n      Aborting and switching to level ${I}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),n.trigger(g.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:a}))}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===ot&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const e=n?n.duration:t.duration,i=this.hls.levels[t.level],o=(i.loaded?i.loaded.bytes:0)+r.loaded,a=(i.loaded?i.loaded.duration:0)+e;i.loaded={bytes:o,duration:a},i.realBitrate=Math.round(8*o/a)}if(t.bitrateTest){const e={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(g.FRAG_BUFFERED,e),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:n,part:r}=t,i=null!=r&&r.stats.loaded?r.stats:n.stats;if(i.aborted)return;if(this.ignoreFragment(n))return;const o=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ot||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;let n=this.getNextABRAutoLevel();if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,n)&&t[e].loadError<=t[n].loadError)return e}return-1!==e&&(n=Math.min(e,n)),n}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:i,minAutoLevel:o,media:a}=n,s=t?t.duration:e?e.duration:0,l=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,c=n.mainForwardBufferInfo,d=(c?c.len:0)/l;let h=this.findBestLevel(u,o,r,d,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(h>=0)return h;w.trace(`[abr] ${d?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let p=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,f=i.abrBandWidthFactor,m=i.abrBandWidthUpFactor;if(!d){const e=this.bitrateTestDelay;e&&(p=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-e,w.trace(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),f=m=1)}return h=this.findBestLevel(u,o,r,d+p,f,m),Math.max(h,0)}findBestLevel(e,t,n,r,i,o){var a;const{fragCurrent:s,partCurrent:l,lastLoadedFragLevel:u}=this,{levels:c}=this.hls,d=c[u],h=!(null==d||null==(a=d.details)||!a.live),p=null==d?void 0:d.codecSet,f=l?l.duration:s?s.duration:0,g=this.bwEstimator.getEstimateTTFB()/1e3;let y=t,v=-1;for(let a=n;a>=t;a--){const t=c[a];if(!t||p&&t.codecSet!==p){t&&(y=Math.min(a,y),v=Math.max(a,v));continue}-1!==v&&w.trace(`[abr] Skipped level(s) ${y}-${v} with CODECS:"${c[v].attrs.CODECS}"; not compatible with "${d.attrs.CODECS}"`);const n=t.details,s=(l?null==n?void 0:n.partTarget:null==n?void 0:n.averagetargetduration)||f;let b;b=a<=u?i*e:o*e;const _=c[a].maxBitrate,E=this.getTimeToLoadFrag(g,b,_*s,void 0===n);if(w.trace(`[abr] level:${a} adjustedbw-bitrate:${Math.round(b-_)} avgDuration:${s.toFixed(1)} maxFetchDuration:${r.toFixed(1)} fetchDuration:${E.toFixed(1)}`),b>_&&(0===E||!m(E)||h&&!this.bitrateTestDelay||E<r))return a}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}},bufferController:class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:e,mediaSource:t}=this;w.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(g.MEDIA_ATTACHED,{media:e})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{w.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{w.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:e,_objectUrl:t}=this;e&&e.src!==t&&w.error(`Media element src was set while attaching MediaSource (${t} > ${e.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.BUFFER_RESET,this.onBufferReset,this),e.on(g.BUFFER_APPENDING,this.onBufferAppending,this),e.on(g.BUFFER_CODECS,this.onBufferCodecs,this),e.on(g.BUFFER_EOS,this.onBufferEos,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(g.FRAG_PARSED,this.onFragParsed,this),e.on(g.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.BUFFER_RESET,this.onBufferReset,this),e.off(g.BUFFER_APPENDING,this.onBufferAppending,this),e.off(g.BUFFER_CODECS,this.onBufferCodecs,this),e.off(g.BUFFER_EOS,this.onBufferEos,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(g.FRAG_PARSED,this.onFragParsed,this),e.off(g.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Hr(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,w.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media;if(n&&Zr){const e=this.mediaSource=new Zr;e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(e),this._objectUrl=n.src,n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(w.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){w.warn(`[buffer-controller]: onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):w.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(g.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){w.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}})),this._initSourceBuffer()}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length;Object.keys(t).forEach((e=>{if(n){const n=this.tracks[e];if(n&&"function"==typeof n.buffer.changeType){const{id:r,codec:i,levelCodec:o,container:a,metadata:s}=t[e],l=(n.levelCodec||n.codec).replace(qr,"$1"),u=(o||i).replace(qr,"$1");if(l!==u){const t=`${a};codecs=${o||i}`;this.appendChangeType(e,t),w.log(`[buffer-controller]: switching codec ${l} to ${u}`),this.tracks[e]={buffer:n.buffer,codec:i,container:a,levelCodec:o,metadata:s,id:r}}}}else this.pendingTracks[e]=t[e]})),n||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:n}=this,r={execute:()=>{const r=this.sourceBuffer[e];r&&(w.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),r.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{w.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}};n.append(r,e)}onBufferAppending(e,t){const{hls:n,operationQueue:r,tracks:i}=this,{data:o,type:a,frag:s,part:l,chunkMeta:u}=t,c=u.buffering[a],d=self.performance.now();c.start=d;const h=s.stats.buffering,p=l?l.stats.buffering:null;0===h.start&&(h.start=d),p&&0===p.start&&(p.start=d);const f=i.audio;let m=!1;"audio"===a&&"audio/mpeg"===(null==f?void 0:f.container)&&(m=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const b=s.start,_={execute:()=>{if(c.executeStart=self.performance.now(),m){const e=this.sourceBuffer[a];if(e){const t=b-e.timestampOffset;Math.abs(t)>=.1&&(w.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${b} (delta: ${t}) sn: ${s.sn})`),e.timestampOffset=b)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();c.executeEnd=c.end=e,0===h.first&&(h.first=e),p&&0===p.first&&(p.first=e);const{sourceBuffer:t}=this,n={};for(const e in t)n[e]=ln.getBuffered(t[e]);this.appendError=0,this.hls.trigger(g.BUFFER_APPENDED,{type:a,frag:s,part:l,chunkMeta:u,parent:s.type,timeRanges:n})},onError:e=>{w.error(`[buffer-controller]: Error encountered while trying to append to the ${a} SourceBuffer`,e);const t={type:y.MEDIA_ERROR,parent:s.type,details:v.BUFFER_APPEND_ERROR,frag:s,part:l,chunkMeta:u,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=v.BUFFER_FULL_ERROR:(this.appendError++,t.details=v.BUFFER_APPEND_ERROR,this.appendError>n.config.appendErrorMaxRetry&&(w.error(`[buffer-controller]: Failed ${n.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),t.fatal=!0)),n.trigger(g.ERROR,t)}};r.append(_,a)}onBufferFlushing(e,t){const{operationQueue:n}=this,r=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(g.BUFFER_FLUSHED,{type:e})},onError:t=>{w.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach((e=>{n.append(r(e),e)}))}onFragParsed(e,t){const{frag:n,part:r}=t,i=[],o=r?r.elementaryStreams:n.elementaryStreams;o[L]?i.push("audiovideo"):(o[C]&&i.push("audio"),o[M]&&i.push("video")),0===i.length&&w.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers((()=>{const e=self.performance.now();n.stats.buffering.end=e,r&&(r.stats.buffering.end=e);const t=r?r.stats:n.stats;this.hls.trigger(g.FRAG_BUFFERED,{frag:n,part:r,stats:t,id:n.type})}),i)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce(((e,n)=>{const r=this.sourceBuffer[n];return!r||t.type&&t.type!==n||(r.ending=!0,r.ended||(r.ended=!0,w.log(`[buffer-controller]: ${n} sourceBuffer now EOS`))),e&&!(r&&!r.ended)}),!0)&&(w.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((()=>{this.getSourceBufferTypes().forEach((e=>{const t=this.sourceBuffer[e];t&&(t.ending=!1)}));const{mediaSource:e}=this;e&&"open"===e.readyState?(w.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()):e&&w.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:n,sourceBuffer:r}=this;if(!n||null===t)return;const i=this.getSourceBufferTypes();if(!i.length)return;const o=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!m(o)||o<0)return;const a=n.currentTime,s=t.levelTargetDuration,l=Math.max(o,s),u=Math.floor(a/s)*s-l;i.forEach((n=>{const i=r[n];if(i){const r=ln.getBuffered(i);if(r.length>0&&u>r.start(0)){if(e.trigger(g.BACK_BUFFER_REACHED,{bufferEnd:u}),t.live)e.trigger(g.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u});else if(i.ended&&r.end(r.length-1)-a<2*s)return void w.info(`[buffer-controller]: Cannot flush ${n} back buffer while SourceBuffer is in ended state`);e.trigger(g.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:n})}}}))}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;const{details:e,hls:t,media:n,mediaSource:r}=this,i=e.fragments[0].start+e.totalduration,o=n.duration,a=m(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(w.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(e)):(i>a&&i>o||!m(o))&&(w.log(`[buffer-controller]: Updating Media Source duration to ${i.toFixed(3)}`),r.duration=i)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){const r=Math.max(0,n[0].start),i=Math.max(r,r+e.totalduration);t.setLiveSeekableRange(r,i)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&!e||2===r){this.createSourceBuffers(n),this.pendingTracks={};const e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(g.BUFFER_CREATED,{tracks:this.tracks}),e.forEach((e=>{t.executeNext(e)}));else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){const i=e[r];if(!i)throw Error(`source buffer exists for track ${r}, however track does not`);const o=i.levelCodec||i.codec,a=`${i.container};codecs=${o}`;w.log(`[buffer-controller]: creating sourceBuffer(${a})`);try{const e=t[r]=n.addSourceBuffer(a),s=r;this.addBufferListener(s,"updatestart",this._onSBUpdateStart),this.addBufferListener(s,"updateend",this._onSBUpdateEnd),this.addBufferListener(s,"error",this._onSBUpdateError),this.tracks[r]={buffer:e,codec:o,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id}}catch(e){w.error(`[buffer-controller]: error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:a})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const n=new Error(`${e} SourceBuffer error`);w.error(`[buffer-controller]: ${n}`,t),this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.BUFFER_APPENDING_ERROR,error:n,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(t)}removeExecutor(e,t,n){const{media:r,mediaSource:i,operationQueue:o,sourceBuffer:a}=this,s=a[e];if(!r||!i||!s)return w.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void o.shiftAndExecuteNext(e);const l=m(r.duration)?r.duration:1/0,u=m(i.duration)?i.duration:1/0,c=Math.max(0,t),d=Math.min(n,l,u);d>c&&!s.ending?(s.ended=!1,w.log(`[buffer-controller]: Removing [${c},${d}] from the ${e} SourceBuffer`),s.remove(c,d)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:n,sourceBuffer:r}=this,i=r[t];if(!i)return w.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),void n.shiftAndExecuteNext(t);i.ended=!1,i.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length)return w.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map((e=>n.appendBlocker(e)));Promise.all(r).then((()=>{e(),t.forEach((e=>{const t=this.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)}))}))}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const r=this.sourceBuffer[e];if(!r)return;const i=n.bind(this,e);this.listeners[e].push({event:t,listener:i}),r.addEventListener(t,i)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach((e=>{t.removeEventListener(e.event,e.listener)}))}},capLevelController:Ui,errorController:class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=w.log.bind(w,"[info]:"),this.warn=w.warn.bind(w,"[warning]:"),this.error=w.error.bind(w,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(g.ERROR,this.onError,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(g.ERROR,this.onError,this),e.off(g.ERROR,this.onErrorOut,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(null==e?void 0:e.type)===ot?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;const i=this.hls,o=t.context;switch(t.details){case v.FRAG_LOAD_ERROR:case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_ERROR:case v.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case v.FRAG_PARSING_ERROR:if(null!=(n=t.frag)&&n.gap)return void(t.errorAction={action:0,flags:0});case v.FRAG_GAP:case v.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=2);case v.LEVEL_EMPTY_ERROR:case v.LEVEL_PARSING_ERROR:{var a,s;const e=t.parent===ot?t.level:i.loadLevel;t.details===v.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(s=a.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case v.LEVEL_LOAD_ERROR:case v.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==o?void 0:o.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level)));case v.AUDIO_TRACK_LOAD_ERROR:case v.AUDIO_TRACK_LOAD_TIMEOUT:case v.SUBTITLE_LOAD_ERROR:case v.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const e=i.levels[i.loadLevel];if(e&&(o.type===rt&&o.groupId===e.audioGroupId||o.type===it&&o.groupId===e.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=2,void(t.errorAction.flags=1)}return;case v.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=i.levels[i.loadLevel],n=null==e?void 0:e.attrs["HDCP-LEVEL"];n&&(t.errorAction={action:2,flags:2,hdcpLevel:n})}return;case v.BUFFER_ADD_CODEC_ERROR:case v.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(r=t.level)?r:i.loadLevel));case v.INTERNAL_EXCEPTION:case v.BUFFER_APPENDING_ERROR:case v.BUFFER_APPEND_ERROR:case v.BUFFER_FULL_ERROR:case v.LEVEL_SWITCH_ERROR:case v.BUFFER_STALLED_ERROR:case v.BUFFER_SEEK_OVER_HOLE:case v.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:0,flags:0})}if(t.type===y.KEY_SYSTEM_ERROR){const e=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,e))}}getPlaylistRetryOrSwitchAction(e,t){var n;const r=Pt(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++,o=null==(n=e.response)?void 0:n.code;if(Nt(r,i,Lt(e),o))return{action:5,flags:0,retryConfig:r,retryCount:i};const a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=i),a}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:i,keyLoadPolicy:o}=t.config,a=Pt(e.details.startsWith("key")?o:i,e),s=t.levels.reduce(((e,t)=>e+t.fragmentError),0);if(r){var l;e.details!==v.FRAG_GAP&&r.fragmentError++;const t=null==(l=e.response)?void 0:l.code;if(Nt(a,s,Lt(e),t))return{action:5,flags:0,retryConfig:a,retryCount:s}}const u=this.getLevelSwitchAction(e,n);return a&&(u.retryConfig=a,u.retryCount=s),u}getLevelSwitchAction(e,t){const n=this.hls;null==t&&(t=n.loadLevel);const r=this.hls.levels[t];if(r&&(r.loadError++,n.autoLevelEnabled)){var i,o;let t=-1;const{levels:a,loadLevel:s,minAutoLevel:l,maxAutoLevel:u}=n,c=null==(i=e.frag)?void 0:i.type,{type:d,groupId:h}=null!=(o=e.context)?o:{};for(let n=a.length;n--;){const i=(n+s)%a.length;if(i!==s&&i>=l&&i<=u&&0===a[i].loadError){const n=a[i];if(e.details===v.FRAG_GAP&&e.frag){const t=a[i].details;if(t){const n=Ft(e.frag,t.fragments,e.frag.start);if(null!=n&&n.gap)continue}}else{if(d===rt&&h===n.audioGroupId||d===it&&h===n.textGroupId)continue;if(c===at&&r.audioGroupId===n.audioGroupId||c===st&&r.textGroupId===n.textGroupId)continue}t=i;break}}if(t>-1&&n.loadLevel!==t)return e.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:t}}return{action:2,flags:1}}onErrorOut(e,t){var n;switch(null==(n=t.errorAction)?void 0:n.action){case 0:break;case 2:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===v.FRAG_GAP||(t.fatal=!0)}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r,hdcpLevel:i,nextAutoLevel:o}=n;switch(r){case 0:this.switchLevel(e,o);break;case 1:n.resolved||(n.resolved=this.redundantFailover(e));break;case 2:i&&(t.maxHdcpLevel=wt[wt.indexOf(i)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:n}=this,r=e.parent===ot?e.level:t.loadLevel,i=t.levels[r],o=i.url.length,a=e.frag?e.frag.urlId:i.urlId;i.urlId!==a||e.frag&&!i.details||this.penalizeRendition(i,e);for(let s=1;s<o;s++){const l=(a+s)%o,u=n[l];if(!u||zt(u,e,n[a]))return this.warn(`Switching to Redundant Stream ${l+1}/${o}: "${i.url[l]}" after ${e.details}`),this.playlistError=0,t.levels.forEach((e=>{e.urlId=l})),t.nextLoadLevel=r,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:n}=this,r=n[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};r.lastErrorPerfMs=performance.now(),r.errors.push(t),r.details=e.details,n[e.urlId]=r}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const e=r-this.lastTime,i=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,a=1e3*i/e,s=this.hls;if(s.trigger(g.FPS_DROP,{currentDropped:i,currentDecoded:o,totalDroppedFrames:n}),a>0&&i>s.config.fpsDroppedMonitoringThreshold*o){let e=s.currentLevel;w.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===s.autoLevelCapping||s.autoLevelCapping>=e)&&(e-=1,s.trigger(g.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:s.currentLevel}),s.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:W,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:to,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Mn{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",st),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.ERROR,this.onError,this),e.on(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(g.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.ERROR,this.onError,this),e.off(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(g.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(g.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=bn,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=bn,!r)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let o;const a=n.start;for(let e=0;e<i.length;e++)if(a>=i[e].start&&a<=i[e].end){o=i[e];break}const s=n.start+n.duration;o?o.end=s:(o={start:a,end:s},i.push(o)),this.fragmentTracker.fragBuffered(n)}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(0===n&&r!==Number.POSITIVE_INFINITY){const e=r-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach((t=>{for(let n=0;n<t.length;)if(t[n].end<=e)t.shift();else{if(!(t[n].start<e))break;t[n].start=e,n++}})),this.fragmentTracker.removeFragmentsInRange(n,e,st)}}onFragBuffered(e,t){var n;this.loadedmetadata||t.frag.type!==ot||null!=(n=this.media)&&n.buffered.length&&(this.loadedmetadata=!0)}onError(e,t){const n=t.frag;(null==n?void 0:n.type)===st&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==vn&&(this.state=bn))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){zr(this.levels,t)?this.levels=t.map((e=>new At(e))):(this.tracksBuffered=[],this.levels=t.map((e=>{const t=new At(e);return this.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,st),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId)return void this.clearInterval();const n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var n;const{details:r,id:i}=t,{currentTrackId:o,levels:a}=this;if(!a.length)return;const s=a[o];if(i>=a.length||i!==o||!s)return;this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(r.live||null!=(n=s.details)&&n.live){const e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;const t=e.fragments[0];s.details?(l=this.alignPlaylists(r,s.details),0===l&&t&&(l=t.start,Rt(r,l))):r.hasProgramDateTime&&e.hasProgramDateTime?(pn(r,e),l=r.fragments[0].start):t&&(l=t.start,Rt(r,l))}s.details=r,this.levelLastLoaded=i,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(s.details,l),this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===bn&&(Ft(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,i=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){const e=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch((e=>{throw i.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e})).then((n=>{const r=performance.now();i.trigger(g.FRAG_DECRYPTED,{frag:t,payload:n,stats:{tstart:e,tdecrypt:r}})})).catch((e=>{this.warn(`${e.name}: ${e.message}`),this.state=bn}))}}doTick(){if(this.media){if(this.state===bn){const{currentTrackId:e,levels:t}=this,n=t[e];if(!t.length||!n||!n.details)return;const{config:r}=this,i=this.getLoadPosition(),o=ln.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,r.maxBufferHole),{end:a,len:s}=o,l=this.getFwdBufferInfo(this.media,ot),u=n.details;if(s>this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration)return;const c=u.fragments,d=c.length,h=u.edge;let p=null;const f=this.fragPrevious;if(a<h){const e=r.maxFragLookUpTolerance,t=a>h-e?0:e;p=Ft(f,c,Math.max(c[0].start,a),t),!p&&f&&f.start<c[0].start&&(p=c[0])}else p=c[d-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),"initSegment"!==p.sn){const e=c[p.sn-u.startSN-1];e&&e.cc===p.cc&&this.fragmentTracker.getState(e)===qt&&(p=e)}this.fragmentTracker.getState(p)===qt&&this.loadFragment(p,n,a)}}else this.state=bn}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Vr(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Gt{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVEL_LOADING,this.onLevelLoading,this),e.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(g.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(g.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),jr(this.media.textTracks).forEach((e=>{pt(e)})),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,details:r}=t,{trackId:i}=this,o=this.tracksInGroup[i];if(!o)return void this.warn(`Invalid subtitle track id ${n}`);const a=o.details;o.details=t.details,this.log(`subtitle track ${n} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.textGroupIds)return;const n=t.textGroupIds[t.urlId],r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==n){const e=this.tracks.filter((e=>!n||e.groupId===n));this.tracksInGroup=e;const t=this.findTrackId(null==r?void 0:r.name)||this.findTrackId();this.groupId=n||null;const i={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${n}" group-id`),this.hls.trigger(g.SUBTITLE_TRACKS_UPDATED,i),-1!==t&&this.setSubtitleTrack(t,r)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId,r)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1}onError(e,t){!t.fatal&&t.context&&t.context.type===it&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,r=t.groupId;let i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(g.SUBTITLE_TRACK_LOADING,{url:i,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:n}=this;if(!t)return;const r=jr(t.textTracks),i=r.filter((e=>e.groupId===this.groupId));if(-1===e)[].slice.call(r).forEach((e=>{e.mode="disabled"}));else{const e=i[n];e&&(e.mode="disabled")}const o=i[e];o&&(o.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var n;const r=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(n=r[e])&&n.details)||e<-1||e>=r.length)return;this.clearTimer();const i=r[e];if(this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:"")),this.trackId=e,i){const{id:e,groupId:n="",name:r,type:o,url:a}=i;this.hls.trigger(g.SUBTITLE_TRACK_SWITCH,{id:e,groupId:n,name:r,type:o,url:a});const s=this.switchParams(i.url,null==t?void 0:t.details);this.loadPlaylist(s)}else this.hls.trigger(g.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=jr(this.media.textTracks);for(let n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},timelineController:class{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const e=new hi(this,"textTrack1"),t=new hi(this,"textTrack2"),n=new hi(this,"textTrack3"),r=new hi(this,"textTrack4");this.cea608Parser1=new ui(1,e,t),this.cea608Parser2=new ui(3,n,r)}e.on(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(g.FRAG_LOADING,this.onFragLoading,this),e.on(g.FRAG_LOADED,this.onFragLoaded,this),e.on(g.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(g.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(g.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(g.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(g.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(g.FRAG_LOADING,this.onFragLoading,this),e.off(g.FRAG_LOADED,this.onFragLoaded,this),e.off(g.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(g.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(g.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(g.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,n,r,i){let o=!1;for(let e=i.length;e--;){const r=i[e],c=(a=r[0],s=r[1],l=t,u=n,Math.min(s,u)-Math.max(a,l));if(c>=0&&(r[0]=Math.min(r[0],t),r[1]=Math.max(r[1],n),o=!0,c/(n-t)>.5))return}var a,s,l,u;if(o||i.push([t,n]),this.config.renderTextTracksNatively){const i=this.captionsTracks[e];this.Cues.newCue(i,t,n,r)}else{const i=this.Cues.newCue(null,t,n,r);this.hls.trigger(g.CUES_PARSED,{type:"captions",cues:i,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:i}){const{unparsedVttFrags:o}=this;"main"===n&&(this.initPTS[t.cc]={baseTime:r,timescale:i}),o.length&&(this.unparsedVttFrags=[],o.forEach((e=>{this.onFragLoaded(g.FRAG_LOADED,e)})))}getExistingTrack(e){const{media:t}=this;if(t)for(let n=0;n<t.textTracks.length;n++){const r=t.textTracks[n];if(r[e])return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:i,languageCode:o}=t[e],a=this.getExistingTrack(e);if(a)n[e]=a,pt(n[e]),dt(n[e],r);else{const t=this.createTextTrack("captions",i,o);t&&(t[e]=!0,n[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(g.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach((t=>{pt(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)pt(t[e])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some((e=>e.textCodec===Ii));if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(zr(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const e=this.media?this.media.textTracks:null;this.tracks.forEach(((t,n)=>{let r;if(e&&n<e.length){let n=null;for(let r=0;r<e.length;r++)if(Bi(e[r],t)){n=e[r];break}n&&(r=n)}if(r)pt(r);else{const e=this._captionsOrSubtitlesFromCharacteristics(t);r=this.createTextTrack(e,t.name,t.lang),r&&(r.mode="disabled")}r&&(r.groupId=t.groupId,this.textTracks.push(r))}))}else if(this.tracks.length){const e=this.tracks.map((e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e})));this.hls.trigger(g.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),n=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&n)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const n=`textTrack${t[1]}`,r=this.captionsProperties[n];r&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e)}))}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:n,cea608Parser2:r,lastSn:i,lastPartIndex:o}=this;if(this.enabled&&n&&r&&t.frag.type===ot){var a,s;const e=t.frag.sn,l=null!=(a=null==t||null==(s=t.part)?void 0:s.index)?a:-1;e===i+1||e===i&&l===o+1||(n.reset(),r.reset()),this.lastSn=e,this.lastPartIndex=l}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===st)if(r.byteLength){const e=n.decryptdata,i="stats"in t;if(null==e||!e.encrypted||i){const e=this.tracks[n.level],i=this.vttCCs;i[n.cc]||(i[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),e&&e.textCodec===Ii?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Li(t,this.initPTS[e.cc],(t=>{this._appendCues(t,e.level),n.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(t=>{w.log(`Failed to parse IMSC1: ${t}`),n.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:i,unparsedVttFrags:o}=this,a=i.length-1;if(!i[n.cc]&&-1===a)return void o.push(e);const s=this.hls;!function(e,t,n,r,i,o,a){const s=new wi,l=le(new Uint8Array(e)).trim().replace(Ti,"\n").split("\n"),u=[],c=t?function(e,t=1){return pr(e,9e4,1/t)}(t.baseTime,t.timescale):0;let d,h="00:00.000",p=0,f=0,g=!0;s.oncue=function(e){const o=n[r];let a=n.ccOffset;const s=(p-c)/9e4;if(null!=o&&o.new&&(void 0!==f?a=n.ccOffset=o.start:function(e,t,n){let r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;null!=(o=i)&&o.new;){var o;e.ccOffset+=r.start-i.start,r.new=!1,r=i,i=e[r.prevCC]}e.presentationOffset=n}(n,r,s)),s){if(!t)return void(d=new Error("Missing initPTS for VTT MPEGTS"));a=s-n.presentationOffset}const l=e.endTime-e.startTime,h=br(9e4*(e.startTime+a-f),9e4*i)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+l,0);const m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=xi(e.startTime,e.endTime,m)),e.endTime>0&&u.push(e)},s.onparsingerror=function(e){d=e},s.onflush=function(){d?a(d):o(u)},l.forEach((e=>{if(g){if(Ai(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach((e=>{Ai(e,"LOCAL:")?h=e.slice(6):Ai(e,"MPEGTS:")&&(p=parseInt(e.slice(7)))}));try{f=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(m(t)&&m(n)&&m(r)&&m(i)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=6e4*r,t+=36e5*i,t}(h)/1e3}catch(e){d=e}return}""===e&&(g=!1)}s.parse(e+"\n")})),s.flush()}(null!=(t=n.initSegment)&&t.data?Se(n.initSegment.data,new Uint8Array(r)):r,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(e=>{this._appendCues(e,n.level),s.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(t=>{const i="Missing initPTS for VTT MPEGTS"===t.message;i?o.push(e):this._fallbackToIMSC1(n,r),w.log(`Failed to parse VTT cue: ${t}`),i&&a>n.cc||s.trigger(g.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Li(t,this.initPTS[e.cc],(()=>{n.textCodec=Ii,this._parseIMSC1(e,t)}),(()=>{n.textCodec="wvtt"}))}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((e=>ht(n,e)))}else{const r=this.tracks[t];if(!r)return;const i=r.default?"default":"subtitles"+t;n.trigger(g.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===st&&this.onFragLoaded(g.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;const{frag:i,samples:o}=t;if(i.type!==ot||"NONE"!==this.closedCaptionsForLevel(i))for(let e=0;e<o.length;e++){const t=o[e].bytes;if(t){const i=this.extractCea608Data(t);n.addData(o[e].pts,i[0]),r.addData(o[e].pts,i[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:i}){const{media:o}=this;if(o&&!(o.currentTime<n)){if(!i||"video"===i){const{captionsTracks:e}=this;Object.keys(e).forEach((r=>ft(e[r],t,n)))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==r){const{textTracks:e}=this;Object.keys(e).forEach((n=>ft(e[n],t,r)))}}}extractCea608Data(e){const t=[[],[]],n=31&e[0];let r=2;for(let i=0;i<n;i++){const n=e[r++],i=127&e[r++],o=127&e[r++];if((0!==i||0!==o)&&0!=(4&n)){const e=3&n;0!==e&&1!==e||(t[e].push(i),t[e].push(o))}}return t}},audioStreamController:class extends Mn{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",at),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(g.ERROR,this.onError,this),e.on(g.BUFFER_RESET,this.onBufferReset,this),e.on(g.BUFFER_CREATED,this.onBufferCreated,this),e.on(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(g.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(g.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(g.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(g.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(g.ERROR,this.onError,this),e.off(g.BUFFER_RESET,this.onBufferReset,this),e.off(g.BUFFER_CREATED,this.onBufferCreated,this),e.off(g.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(g.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(g.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:i}){if("main"===n){const e=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:i},this.log(`InitPTS for cc: ${e} found from main: ${r}`),this.videoTrackCC=e,this.state===Rn&&this.tick()}}startLoad(e){if(!this.levels)return this.startPosition=e,void(this.state=vn);const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=bn):(this.loadedmetadata=!1,this.state=Tn),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case bn:this.doTickIdle();break;case Tn:{var e;const{levels:t,trackId:n}=this,r=null==t||null==(e=t[n])?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=Rn}break}case wn:{var t;const e=performance.now(),n=this.retryDate;(!n||e>=n||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=bn);break}case Rn:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:r,complete:i}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=En;const e={frag:t,part:n,payload:r.flush(),networkDetails:null};this._handleFragmentLoadProgress(e),i&&super._handleFragmentLoadComplete(e)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const e=this.getLoadPosition(),n=ln.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole);Bt(n.end,this.config.maxFragLookUpTolerance,t)<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${n.end} is needed`),this.clearWaitingFragment())}}else this.state=bn}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=bn)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:r}=this,i=e.config;if(null==t||!t[r])return;if(!n&&(this.startFragRequested||!i.startFragPrefetch))return;const o=t[r],a=o.details;if(!a||a.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(a))return void(this.state=Tn);const s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,C,at));const l=this.getFwdBufferInfo(s,at);if(null===l)return;const{bufferedTrack:u,switchingTrack:c}=this;if(!c&&this._streamEnded(l,a))return e.trigger(g.BUFFER_EOS,{type:"audio"}),void(this.state=xn);const d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ot),h=l.len,p=this.getMaxBufferLength(null==d?void 0:d.len);if(h>=p&&!c)return;const f=a.fragments[0].start;let m=l.end;if(c&&n){const e=this.getLoadPosition();u&&c.attrs!==u.attrs&&(m=e),a.PTSKnown&&e<f&&(l.end>f||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=f+.05)}let y=this.getNextFragment(m,a),v=!1;if(y&&this.isLoopLoading(y,m)&&(v=!!y.gap,y=this.getNextFragmentLoopLoading(y,a,l,ot,p)),!y)return void(this.bufferFlushed=!0);const b=d&&y.start>d.end+a.targetduration;if(b||(null==d||!d.len)&&l.len){const e=this.getAppendedFrag(y.start,ot);if(null===e)return;if(v||(v=!!e.gap||!!b&&0===d.len),b&&!v||v&&l.nextStart&&l.nextStart<e.end)return}this.loadFragment(y,o,m)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map((e=>new At(e)))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=bn):(this.switchingTrack=null,this.bufferedTrack=t,this.state=vn),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(g.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(null==this.mainDetails)return void(this.cachedTrackLoadedData=t);const{levels:r}=this,{details:i,id:o}=t;if(!r)return void this.warn(`Audio tracks were reset while loading level ${o}`);this.log(`Track ${o} loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const a=r[o];let s=0;if(i.live||null!=(n=a.details)&&n.live){const e=this.mainDetails;if(i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed||!e)return;!a.details&&i.hasProgramDateTime&&e.hasProgramDateTime?(pn(i,e),s=i.fragments[0].start):s=this.alignPlaylists(i,a.details)}a.details=i,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(a.details,s),this.state!==Tn||this.waitForCdnTuneIn(i)||(this.state=bn),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:i}=e,{config:o,trackId:a,levels:s}=this;if(!s)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);const l=s[a];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(n.start);const c=o.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new Or(this.hls,at,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const h=this.initPTS[n.cc],p=null==(t=n.initSegment)?void 0:t.data;if(void 0!==h){const e=!1,t=r?r.index:-1,o=-1!==t,a=new un(n.level,n.sn,n.stats.chunkCount,i.byteLength,t,o);d.push(i,p,c,"",n,r,u.totalduration,e,a,h)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:e}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new Ur,complete:!1};e.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=Rn}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type===at)if(this.fragContextChanged(n))this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if("initSegment"!==n.sn){this.fragPrevious=n;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(g.AUDIO_TRACK_SWITCHED,h({},e)))}this.fragBufferedComplete(n,r)}else if(!this.loadedmetadata&&n.type===ot){const e=this.videoBuffer||this.media;e&&ln.getBuffered(e).length&&(this.loadedmetadata=!0)}}onError(e,t){var n;if(t.fatal)this.state=In;else switch(t.details){case v.FRAG_GAP:case v.FRAG_PARSING_ERROR:case v.FRAG_DECRYPT_ERROR:case v.FRAG_LOAD_ERROR:case v.FRAG_LOAD_TIMEOUT:case v.KEY_LOAD_ERROR:case v.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(at,t);break;case v.AUDIO_TRACK_LOAD_ERROR:case v.AUDIO_TRACK_LOAD_TIMEOUT:case v.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Tn||(null==(n=t.context)?void 0:n.type)!==rt||(this.state=bn);break;case v.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case v.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===C&&(this.bufferFlushed=!0,this.state===xn&&(this.state=bn))}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:i,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a)return void this.resetWhenMissingContext(o);const{frag:s,part:l,level:u}=a,{details:c}=u,{audio:d,text:h,id3:p,initSegment:m}=i;if(!this.fragContextChanged(s)&&c){if(this.state=An,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){const e=s.initSegment||s;this._bufferInitSegment(m.tracks,e,o),r.trigger(g.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:n,tracks:m.tracks})}if(d){const{startPTS:e,endPTS:t,startDTS:n,endDTS:r}=d;l&&(l.elementaryStreams[C]={startPTS:e,endPTS:t,startDTS:n,endDTS:r}),s.setElementaryStreamInfo(C,e,t,n,r),this.bufferFragmentData(d,s,l,o)}if(null!=p&&null!=(t=p.samples)&&t.length){const e=f({id:n,frag:s,details:c},p);r.trigger(g.FRAG_PARSING_METADATA,e)}if(h){const e=f({id:n,frag:s,details:c},h);r.trigger(g.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(s)}_bufferInitSegment(e,t,n){if(this.state!==An)return;e.video&&delete e.video;const r=e.audio;if(!r)return;r.levelCodec=r.codec,r.id="audio",this.log(`Init audio buffer, container:${r.container}, codecs[parsed]=[${r.codec}]`),this.hls.trigger(g.BUFFER_CODECS,e);const i=r.initSegment;if(null!=i&&i.byteLength){const e={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:i};this.hls.trigger(g.BUFFER_APPENDING,e)}this.tick()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);var i;this.fragCurrent=e,this.switchingTrack||r===qt||r===Yt?"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(i=t.details)&&i.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Rn):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:n,bufferedTrack:r}=this,i=null==r?void 0:r.attrs,o=e.attrs;n&&i&&(i.CHANNELS!==o.CHANNELS||i.NAME!==o.NAME||i.LANGUAGE!==o.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(g.AUDIO_TRACK_SWITCHED,h({},e))}},audioTrackController:class extends Gt{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.LEVEL_LOADING,this.onLevelLoading,this),e.on(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.LEVEL_LOADING,this.onLevelLoading,this),e.off(g.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(g.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(g.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:i}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r)return void this.warn(`Track with id:${n} and group:${r} not found in active group ${o.groupId}`);const a=o.details;o.details=t.details,this.log(`audio-track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(null==t||!t.audioGroupIds)return;const n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n||null;const e=this.tracks.filter((e=>!n||e.groupId===n));this.selectDefaultTrack&&!e.some((e=>e.default))&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;const t={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group:${n}`),this.hls.trigger(g.AUDIO_TRACKS_UPDATED,t),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&t.context.type===rt&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn("Invalid id passed to audio-track controller");this.clearTimer();const n=this.currentTrack;t[this.trackId];const r=t[e],{groupId:i,name:o}=r;if(this.log(`Switching to audio-track ${e} "${o}" lang:${r.lang} group:${i}`),this.trackId=e,this.currentTrack=r,this.selectDefaultTrack=!1,this.hls.trigger(g.AUDIO_TRACK_SWITCHING,h({},r)),r.details&&!r.details.live)return;const a=this.switchParams(r.url,null==n?void 0:n.details);this.loadPlaylist(a)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{const t=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(g.ERROR,{type:y.MEDIA_ERROR,details:v.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!this.selectDefaultTrack||r.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===r.attrs["STABLE-RENDITION-ID"])return r.id;if(e.name===r.name&&e.lang===r.lang)return r.id}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const n=t.id,r=t.groupId;let i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(g.AUDIO_TRACK_LOADING,{url:i,id:n,groupId:r,deliveryDirectives:e||null})}}},emeController:Gi,cmcdController:Zi,contentSteeringController:class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=w.log.bind(w,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(g.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.MANIFEST_PARSED,this.onManifestParsed,this),e.on(g.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(g.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.MANIFEST_PARSED,this.onManifestParsed,this),e.off(g.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter((t=>t!==e)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;null!==n&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(2===(null==n?void 0:n.action)&&1===n.flags){let e=this.pathwayPriority;const t=this.pathwayId;this.penalizedPathways[t]||(this.penalizedPathways[t]=performance.now()),!e&&this.levels&&(e=this.levels.reduce(((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e)),[])),e&&e.length>1&&(this.updatePathwayPriority(e),n.resolved=this.pathwayId!==t)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter((t=>e===t.pathwayId))}updatePathwayPriority(e){let t;this.pathwayPriority=e;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach((e=>{r-n[e]>3e5&&delete n[e]}));for(let r=0;r<e.length;r++){const i=e[r];if(n[i])continue;if(i===this.pathwayId)return;const o=this.hls.nextLoadLevel,a=this.hls.levels[o];if(t=this.getLevelsForPathway(i),t.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,this.hls.trigger(g.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[o];a&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==a.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==a.bitrate&&this.log(`Unstable Pathways change from bitrate ${a.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=o);break}}}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach((e=>{const{ID:i,"BASE-ID":o,"URI-REPLACEMENT":a}=e;if(t.some((e=>e.pathwayId===i)))return;const s=this.getLevelsForPathway(o).map((e=>{const t=f({},e);t.details=void 0,t.url=Wi(e.uri,e.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a);const o=new S(e.attrs);o["PATHWAY-ID"]=i;const s=o.AUDIO&&`${o.AUDIO}_clone_${i}`,l=o.SUBTITLES&&`${o.SUBTITLES}_clone_${i}`;s&&(n[o.AUDIO]=s,o.AUDIO=s),l&&(r[o.SUBTITLES]=l,o.SUBTITLES=l),t.attrs=o;const u=new At(t);return Ht(u,"audio",s),Ht(u,"text",l),u}));t.push(...s),qi(this.audioTracks,n,a,i),qi(this.subtitleTracks,r,a,i)}))}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;let r;this.loader&&this.loader.destroy(),this.loader=new n(t);try{r=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==r.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+e)}const i={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},s={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(e,t,n,i)=>{this.log(`Loaded steering manifest: "${r}"`);const o=e.data;if(1!==o.VERSION)return void this.log(`Steering VERSION ${o.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=o.TTL;const{"RELOAD-URI":a,"PATHWAY-CLONES":s,"PATHWAY-PRIORITY":l}=o;if(a)try{this.uri=new self.URL(a,r).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${a}`)}this.scheduleRefresh(this.uri||n.url),s&&this.clonePathways(s),l&&this.updatePathwayPriority(l)},onError:(e,t,n,r)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let i=1e3*this.timeToLoad;if(429!==e.code)this.scheduleRefresh(this.uri||t.url,i);else{const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(i=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`)}},onTimeout:(e,t,n)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(i,s,l)}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout((()=>{this.loadSteeringManifest(e)}),t)}}});function ro(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(ro):Object.keys(e).reduce(((t,n)=>(t[n]=ro(e[n]),t)),{}):e}class io{static get version(){return"1.4.10"}static isSupported(){return function(){const e=Be();if(!e)return!1;const t=Ln(),n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!n&&!!r}()}static get Events(){return g}static get ErrorTypes(){return y}static get ErrorDetails(){return v}static get DefaultConfig(){return io.defaultConfig?io.defaultConfig:no}static set DefaultConfig(e){io.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Pr,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function(e,t){if(self.console&&!0===e||"object"==typeof e){!function(e,...t){t.forEach((function(t){E[t]=e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[${e}] >`):b}(t)}))}(e,"debug","log","info","warn","error");try{E.log('Debug logs enabled for "Hls instance" in hls.js version 1.4.10')}catch(e){E=_}}else E=_}(e.debug||!1);const t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=ro(e),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((e=>{const i=`${"level"===e?"playlist":e}LoadPolicy`,o=void 0===t[i],a=[];r.forEach((r=>{const s=`${e}Loading${r}`,l=t[s];if(void 0!==l&&o){a.push(s);const e=n[i].default;switch(t[i]={default:e},r){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&w.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${i}": ${JSON.stringify(t[i])}`)})),h(h({},n),t)}(io.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&function(e){const t=e.loader;t!==Xi&&t!==Ki?(w.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=Xi,e.progressive=!0,e.enableSoftwareAES=!0,w.log("[config]: Progressive streaming enabled, using FetchLoader"))}(t);const{abrController:n,bufferController:r,capLevelController:i,errorController:o,fpsController:a}=t,s=new o(this),l=this.abrController=new n(this),u=this.bufferController=new r(this),c=this.capLevelController=new i(this),d=new a(this),p=new ct(this),f=new _t(this),m=t.contentSteeringController,y=m?new m(this):null,v=this.levelController=new jt(this,y),T=new $t(this),A=new on(this.config),S=this.streamController=new kr(this,T,A);c.setStreamController(S),d.setStreamController(S);const x=[p,v,S];y&&x.splice(1,0,y),this.networkControllers=x;const I=[l,u,c,d,f,T];this.audioTrackController=this.createController(t.audioTrackController,x);const R=t.audioStreamController;R&&x.push(new R(this,T,A)),this.subtitleTrackController=this.createController(t.subtitleTrackController,x);const C=t.subtitleStreamController;C&&x.push(new C(this,T,A)),this.createController(t.timelineController,I),A.emeController=this.emeController=this.createController(t.emeController,I),this.cmcdController=this.createController(t.cmcdController,I),this.latencyController=this.createController(Et,I),this.coreComponents=I,x.push(s);const M=s.onErrorOut;"function"==typeof M&&this.on(g.ERROR,M,s)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){w.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(g.ERROR,{type:y.OTHER_ERROR,details:v.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){w.log("destroy"),this.trigger(g.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((e=>e.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((e=>e.destroy())),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){w.log("attachMedia"),this._media=e,this.trigger(g.MEDIA_ATTACHING,{media:e})}detachMedia(){w.log("detachMedia"),this.trigger(g.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,r=this.url=c.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});w.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(g.MANIFEST_LOADING,{url:e})}startLoad(e=-1){w.log(`startLoad(${e})`),this.networkControllers.forEach((t=>{t.startLoad(e)}))}stopLoad(){w.log("stopLoad"),this.networkControllers.forEach((e=>{e.stopLoad()}))}swapAudioCodec(){w.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){w.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){return this.levelController.levels||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){w.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){w.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){w.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){w.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){w.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(w.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){wt.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(r=-1===t&&e&&e.length?e.length-1:t,n)for(let t=r;t--;){const r=e[t].attrs["HDCP-LEVEL"];if(r&&r<=n)return t}return r}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}io.defaultConfig=void 0},9022:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});let r=(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t}}}]);